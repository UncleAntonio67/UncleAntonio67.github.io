<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Uncle Antonio">
<meta property="og:url" content="http://example.com/page/7/index.html">
<meta property="og:site_name" content="Uncle Antonio">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Uncle Antonio">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/7/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Uncle Antonio</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Uncle Antonio</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>Schedule</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>Commonweal 404</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/22/%E6%97%A5%E5%B8%B8%E5%8A%9B%E6%89%A3/%E7%83%AD%E9%A2%98100/11.%20%E7%9B%9B%E6%B0%B4%E6%9C%80%E5%A4%9A%E7%9A%84%E5%AE%B9%E5%99%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/icon.JPG">
      <meta itemprop="name" content="Uncle Antonio">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Uncle Antonio">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/11/22/%E6%97%A5%E5%B8%B8%E5%8A%9B%E6%89%A3/%E7%83%AD%E9%A2%98100/11.%20%E7%9B%9B%E6%B0%B4%E6%9C%80%E5%A4%9A%E7%9A%84%E5%AE%B9%E5%99%A8/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-11-22 22:50:52" itemprop="dateCreated datePublished" datetime="2025-11-22T22:50:52+08:00">2025-11-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-10-25 17:00:01" itemprop="dateModified" datetime="2025-10-25T17:00:01+08:00">2025-10-25</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ğŸ·ä¸­ç­‰ #è´ªå¿ƒ #æ•°ç»„ #åŒæŒ‡é’ˆ </p>
<p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸ºÂ <code>n</code>Â çš„æ•´æ•°æ•°ç»„Â <code>height</code>Â ã€‚æœ‰Â <code>n</code>Â æ¡å‚çº¿ï¼Œç¬¬Â <code>i</code>Â æ¡çº¿çš„ä¸¤ä¸ªç«¯ç‚¹æ˜¯Â <code>(i, 0)</code>Â å’ŒÂ <code>(i, height[i])</code>Â ã€‚</p>
<p>æ‰¾å‡ºå…¶ä¸­çš„ä¸¤æ¡çº¿ï¼Œä½¿å¾—å®ƒä»¬ä¸Â <code>x</code>Â è½´å…±åŒæ„æˆçš„å®¹å™¨å¯ä»¥å®¹çº³æœ€å¤šçš„æ°´ã€‚</p>
<p>è¿”å›å®¹å™¨å¯ä»¥å‚¨å­˜çš„æœ€å¤§æ°´é‡ã€‚</p>
<p>**è¯´æ˜ï¼šä½ ä¸èƒ½å€¾æ–œå®¹å™¨ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<p><img src="https://aliyun-lc-upload.oss-cn-hangzhou.aliyuncs.com/aliyun-lc-upload/uploads/2018/07/25/question_11.jpg"></p>
<p><strong>è¾“å…¥ï¼š</strong>[1,8,6,2,5,4,8,3,7]<br>**è¾“å‡ºï¼š49<br>è§£é‡Šï¼šå›¾ä¸­å‚ç›´çº¿ä»£è¡¨è¾“å…¥æ•°ç»„ [1,8,6,2,5,4,8,3,7]ã€‚åœ¨æ­¤æƒ…å†µä¸‹ï¼Œå®¹å™¨èƒ½å¤Ÿå®¹çº³æ°´ï¼ˆè¡¨ç¤ºä¸ºè“è‰²éƒ¨åˆ†ï¼‰çš„æœ€å¤§å€¼ä¸ºÂ 49ã€‚</p>
<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<p>**è¾“å…¥ï¼šheight &#x3D; [1,1]<br>è¾“å‡ºï¼š1</p>
<p><strong>æç¤ºï¼š</strong></p>
<ul>
<li><code>n == height.length</code></li>
<li><code>2 &lt;= n &lt;= 105</code></li>
<li><code>0 &lt;= height[i] &lt;= 104</code></li>
</ul>
<h1 id="è§£é¢˜æ€è·¯ä¸å®ç°"><a href="#è§£é¢˜æ€è·¯ä¸å®ç°" class="headerlink" title="è§£é¢˜æ€è·¯ä¸å®ç°"></a>è§£é¢˜æ€è·¯ä¸å®ç°</h1><p>åœ¨æ¯ä¸ªçŠ¶æ€ä¸‹ï¼Œæ— è®ºé•¿æ¿æˆ–çŸ­æ¿å‘ä¸­é—´æ”¶çª„ä¸€æ ¼ï¼Œéƒ½ä¼šå¯¼è‡´æ°´æ§½ åº•è¾¹å®½åº¦ âˆ’1â€‹ å˜çŸ­ï¼š</p>
<p>è‹¥å‘å†… <strong>ç§»åŠ¨çŸ­æ¿</strong> ï¼Œæ°´æ§½çš„çŸ­æ¿ min(h[i],h[j]) å¯èƒ½å˜å¤§ï¼Œå› æ­¤ä¸‹ä¸ªæ°´æ§½çš„é¢ç§¯ å¯èƒ½å¢å¤§ ã€‚<br>è‹¥å‘å†… ç§»åŠ¨é•¿æ¿ ï¼Œæ°´æ§½çš„çŸ­æ¿ min(h[i],h[j])â€‹ ä¸å˜æˆ–å˜å°ï¼Œå› æ­¤ä¸‹ä¸ªæ°´æ§½çš„é¢ç§¯ ä¸€å®šå˜å° ã€‚</p>
<h2 id="æ–¹æ³•ä¸€ï¼šåŒæŒ‡é’ˆæ³•"><a href="#æ–¹æ³•ä¸€ï¼šåŒæŒ‡é’ˆæ³•" class="headerlink" title="æ–¹æ³•ä¸€ï¼šåŒæŒ‡é’ˆæ³•"></a>æ–¹æ³•ä¸€ï¼šåŒæŒ‡é’ˆæ³•</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">Â  Â  <span class="keyword">def</span> <span class="title function_">maxArea</span>(<span class="params">self, height: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">Â  Â  Â  Â  i,j,res = <span class="number">0</span>, <span class="built_in">len</span>(height)-<span class="number">1</span>,<span class="number">0</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">while</span>(i &lt; j):</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> height[i] &lt; height[j]:</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  res = <span class="built_in">max</span>(res, height[i]*(j-i))</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  i += <span class="number">1</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">else</span>:</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  res = <span class="built_in">max</span>(res, height[j]*(j-i))</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  j -= <span class="number">1</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/22/%E6%97%A5%E5%B8%B8%E5%8A%9B%E6%89%A3/%E7%83%AD%E9%A2%98100/114.%20%E4%BA%8C%E5%8F%89%E6%A0%91%E5%B1%95%E5%BC%80%E4%B8%BA%E9%93%BE%E8%A1%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/icon.JPG">
      <meta itemprop="name" content="Uncle Antonio">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Uncle Antonio">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/11/22/%E6%97%A5%E5%B8%B8%E5%8A%9B%E6%89%A3/%E7%83%AD%E9%A2%98100/114.%20%E4%BA%8C%E5%8F%89%E6%A0%91%E5%B1%95%E5%BC%80%E4%B8%BA%E9%93%BE%E8%A1%A8/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-11-22 22:50:52" itemprop="dateCreated datePublished" datetime="2025-11-22T22:50:52+08:00">2025-11-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-11-11 22:00:16" itemprop="dateModified" datetime="2025-11-11T22:00:16+08:00">2025-11-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ğŸ·ä¸­ç­‰ #æ ˆ #æ ‘ #æ·±åº¦ä¼˜å…ˆæœç´¢ #é“¾è¡¨ #äºŒå‰æ ‘ </p>
<p>ç»™ä½ äºŒå‰æ ‘çš„æ ¹ç»“ç‚¹Â <code>root</code>Â ï¼Œè¯·ä½ å°†å®ƒå±•å¼€ä¸ºä¸€ä¸ªå•é“¾è¡¨ï¼š</p>
<ul>
<li>å±•å¼€åçš„å•é“¾è¡¨åº”è¯¥åŒæ ·ä½¿ç”¨Â <code>TreeNode</code>Â ï¼Œå…¶ä¸­Â <code>right</code>Â å­æŒ‡é’ˆæŒ‡å‘é“¾è¡¨ä¸­ä¸‹ä¸€ä¸ªç»“ç‚¹ï¼Œè€Œå·¦å­æŒ‡é’ˆå§‹ç»ˆä¸ºÂ <code>null</code>Â ã€‚</li>
<li>å±•å¼€åçš„å•é“¾è¡¨åº”è¯¥ä¸äºŒå‰æ ‘Â <a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%85%88%E5%BA%8F%E9%81%8D%E5%8E%86/6442839?fr=aladdin"><strong>å…ˆåºéå†</strong></a>Â é¡ºåºç›¸åŒã€‚</li>
</ul>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2021/01/14/flaten.jpg" alt="| 400"></p>
<p>è¾“å…¥ï¼šroot &#x3D; [1,2,5,3,4,null,6]<br>è¾“å‡ºï¼š[1,null,2,null,3,null,4,null,5,null,6]<br>ç¤ºä¾‹ 2ï¼š</p>
<p>è¾“å…¥ï¼šroot &#x3D; []<br>è¾“å‡ºï¼š[]<br>ç¤ºä¾‹ 3ï¼š</p>
<p>è¾“å…¥ï¼šroot &#x3D; [0]<br>è¾“å‡ºï¼š[0]</p>
<p><strong>æç¤ºï¼š</strong></p>
<ul>
<li>æ ‘ä¸­ç»“ç‚¹æ•°åœ¨èŒƒå›´Â <code>[0, 2000]</code>Â å†…</li>
<li><code>-100 &lt;= Node.val &lt;= 100</code></li>
</ul>
<p>**è¿›é˜¶ï¼šä½ å¯ä»¥ä½¿ç”¨åŸåœ°ç®—æ³•ï¼ˆ<code>O(1)</code>Â é¢å¤–ç©ºé—´ï¼‰å±•å¼€è¿™æ£µæ ‘å—ï¼Ÿ</p>
<h1 id="è§£é¢˜æ€è·¯ä¸å®ç°"><a href="#è§£é¢˜æ€è·¯ä¸å®ç°" class="headerlink" title="è§£é¢˜æ€è·¯ä¸å®ç°"></a>è§£é¢˜æ€è·¯ä¸å®ç°</h1><ul>
<li>æ¯æ¬¡éå†å½“å‰èŠ‚ç‚¹ï¼Œä»¤ <code>node.right = prev</code>ï¼Œ<code>node.left = None</code></li>
<li>ç”¨ä¸€ä¸ªå˜é‡ <code>prev</code> ä¿å­˜ä¸Šä¸€ä¸ªè®¿é—®çš„èŠ‚ç‚¹</li>
</ul>
<h2 id="æ–¹æ³•ä¸€ï¼šé€’å½’"><a href="#æ–¹æ³•ä¸€ï¼šé€’å½’" class="headerlink" title="æ–¹æ³•ä¸€ï¼šé€’å½’"></a>æ–¹æ³•ä¸€ï¼šé€’å½’</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">flatten</span>(<span class="params">self, root: <span class="type">Optional</span>[TreeNode]</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Do not return anything, modify root in-place instead.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        prev = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">dfs</span>(<span class="params">node</span>):</span><br><span class="line">            <span class="keyword">nonlocal</span> prev</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> node:</span><br><span class="line">                <span class="keyword">return</span> </span><br><span class="line">            dfs(node.right)</span><br><span class="line">            dfs(node.left)</span><br><span class="line">            node.right = prev</span><br><span class="line">            node.left = <span class="literal">None</span></span><br><span class="line">            prev = node</span><br><span class="line">        dfs(root)</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/22/%E6%97%A5%E5%B8%B8%E5%8A%9B%E6%89%A3/%E7%83%AD%E9%A2%98100/108.%20%E5%B0%86%E6%9C%89%E5%BA%8F%E6%95%B0%E7%BB%84%E8%BD%AC%E6%8D%A2%E4%B8%BA%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/icon.JPG">
      <meta itemprop="name" content="Uncle Antonio">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Uncle Antonio">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/11/22/%E6%97%A5%E5%B8%B8%E5%8A%9B%E6%89%A3/%E7%83%AD%E9%A2%98100/108.%20%E5%B0%86%E6%9C%89%E5%BA%8F%E6%95%B0%E7%BB%84%E8%BD%AC%E6%8D%A2%E4%B8%BA%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-11-22 22:50:52" itemprop="dateCreated datePublished" datetime="2025-11-22T22:50:52+08:00">2025-11-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-11-11 21:47:37" itemprop="dateModified" datetime="2025-11-11T21:47:37+08:00">2025-11-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ğŸ·ç®€å• #æ ‘ #äºŒå‰æœç´¢æ ‘ #æ•°ç»„ #åˆ†æ²» #äºŒå‰æ ‘ </p>
<p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„Â <code>nums</code>Â ï¼Œå…¶ä¸­å…ƒç´ å·²ç»æŒ‰Â <strong>å‡åº</strong>Â æ’åˆ—ï¼Œè¯·ä½ å°†å…¶è½¬æ¢ä¸ºä¸€æ£µÂ å¹³è¡¡Â äºŒå‰æœç´¢æ ‘ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2021/02/18/btree1.jpg" alt="230"></p>
<p>è¾“å…¥ï¼šnums &#x3D; [-10,-3,0,5,9]<br>è¾“å‡ºï¼š[0,-3,9,-10,null,5]<br>è§£é‡Šï¼š[0,-10,5,null,-3,null,9] ä¹Ÿå°†è¢«è§†ä¸ºæ­£ç¡®ç­”æ¡ˆï¼š</p>
<p><img src="https://assets.leetcode.com/uploads/2021/02/18/btree2.jpg" alt="|240"></p>
<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2021/02/18/btree.jpg" alt="|300"></p>
<p>è¾“å…¥ï¼šnums &#x3D; [1,3]<br>è¾“å‡ºï¼š[3,1]<br>è§£é‡Šï¼š[1,null,3] å’Œ [3,1] éƒ½æ˜¯é«˜åº¦å¹³è¡¡äºŒå‰æœç´¢æ ‘ã€‚</p>
<p><strong>æç¤ºï¼š</strong></p>
<ul>
<li><code>1 &lt;= nums.length &lt;= 104</code></li>
<li><code>-104 &lt;= nums[i] &lt;= 104</code></li>
<li><code>nums</code>Â æŒ‰Â <strong>ä¸¥æ ¼é€’å¢</strong>Â é¡ºåºæ’åˆ—</li>
</ul>
<h1 id="è§£é¢˜æ€è·¯ä¸å®ç°"><a href="#è§£é¢˜æ€è·¯ä¸å®ç°" class="headerlink" title="è§£é¢˜æ€è·¯ä¸å®ç°"></a>è§£é¢˜æ€è·¯ä¸å®ç°</h1><ul>
<li>é€’å½’ï¼Œå¹³è¡¡äºŒå‰æœç´¢æ ‘æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼šBST â†’ å·¦ &lt; æ ¹ &lt; å³ï¼›å¹³è¡¡ â†’ å·¦å³èŠ‚ç‚¹æ•°é‡å°½é‡æ¥è¿‘</li>
</ul>
<h2 id="æ–¹æ³•ä¸€ï¼šé€’å½’"><a href="#æ–¹æ³•ä¸€ï¼šé€’å½’" class="headerlink" title="æ–¹æ³•ä¸€ï¼šé€’å½’"></a>æ–¹æ³•ä¸€ï¼šé€’å½’</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sortedArrayToBST</span>(<span class="params">self, nums: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="type">Optional</span>[TreeNode]:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        mid = <span class="built_in">len</span>(nums)//<span class="number">2</span></span><br><span class="line">        root = TreeNode(nums[mid])</span><br><span class="line">        root.left = <span class="variable language_">self</span>.sortedArrayToBST(nums[:mid])</span><br><span class="line">        root.right = <span class="variable language_">self</span>.sortedArrayToBST(nums[mid+<span class="number">1</span>:])</span><br><span class="line">        <span class="keyword">return</span> root</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/22/%E6%97%A5%E5%B8%B8%E5%8A%9B%E6%89%A3/%E7%83%AD%E9%A2%98100/105.%20%E4%BB%8E%E5%89%8D%E5%BA%8F%E4%B8%8E%E4%B8%AD%E5%BA%8F%E9%81%8D%E5%8E%86%E5%BA%8F%E5%88%97%E6%9E%84%E9%80%A0%E4%BA%8C%E5%8F%89%E6%A0%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/icon.JPG">
      <meta itemprop="name" content="Uncle Antonio">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Uncle Antonio">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/11/22/%E6%97%A5%E5%B8%B8%E5%8A%9B%E6%89%A3/%E7%83%AD%E9%A2%98100/105.%20%E4%BB%8E%E5%89%8D%E5%BA%8F%E4%B8%8E%E4%B8%AD%E5%BA%8F%E9%81%8D%E5%8E%86%E5%BA%8F%E5%88%97%E6%9E%84%E9%80%A0%E4%BA%8C%E5%8F%89%E6%A0%91/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-11-22 22:50:52" itemprop="dateCreated datePublished" datetime="2025-11-22T22:50:52+08:00">2025-11-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-11-11 23:14:51" itemprop="dateModified" datetime="2025-11-11T23:14:51+08:00">2025-11-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ğŸ·ä¸­ç­‰ #æ ‘ #æ•°ç»„ #å“ˆå¸Œè¡¨ #åˆ†æ²» #äºŒå‰æ ‘ </p>
<p>ç»™å®šä¸¤ä¸ªæ•´æ•°æ•°ç»„Â <code>preorder</code>Â å’ŒÂ <code>inorder</code>Â ï¼Œå…¶ä¸­Â <code>preorder</code>Â æ˜¯äºŒå‰æ ‘çš„<strong>å…ˆåºéå†</strong>ï¼ŒÂ <code>inorder</code>Â æ˜¯åŒä¸€æ£µæ ‘çš„<strong>ä¸­åºéå†</strong>ï¼Œè¯·æ„é€ äºŒå‰æ ‘å¹¶è¿”å›å…¶æ ¹èŠ‚ç‚¹ã€‚</p>
<p><strong>ç¤ºä¾‹ 1:</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2021/02/19/tree.jpg" alt="| 200"></p>
<p>è¾“å…¥: preorder &#x3D; [3,9,20,15,7], inorder &#x3D; [9,3,15,20,7]<br>è¾“å‡º: [3,9,20,null,null,15,7]<br>ç¤ºä¾‹ 2:</p>
<p>è¾“å…¥: preorder &#x3D; [-1], inorder &#x3D; [-1]<br>è¾“å‡º: [-1]</p>
<p><strong>æç¤º:</strong></p>
<ul>
<li><code>1 &lt;= preorder.length &lt;= 3000</code></li>
<li><code>inorder.length == preorder.length</code></li>
<li><code>-3000 &lt;= preorder[i], inorder[i] &lt;= 3000</code></li>
<li><code>preorder</code>Â å’ŒÂ <code>inorder</code>Â å‡Â <strong>æ— é‡å¤</strong>Â å…ƒç´ </li>
<li><code>inorder</code>Â å‡å‡ºç°åœ¨Â <code>preorder</code></li>
<li><code>preorder</code>Â <strong>ä¿è¯</strong>Â ä¸ºäºŒå‰æ ‘çš„å‰åºéå†åºåˆ—</li>
<li><code>inorder</code>Â <strong>ä¿è¯</strong>Â ä¸ºäºŒå‰æ ‘çš„ä¸­åºéå†åºåˆ—</li>
</ul>
<h1 id="è§£é¢˜æ€è·¯ä¸å®ç°"><a href="#è§£é¢˜æ€è·¯ä¸å®ç°" class="headerlink" title="è§£é¢˜æ€è·¯ä¸å®ç°"></a>è§£é¢˜æ€è·¯ä¸å®ç°</h1><ul>
<li>å…ˆåºéå†é¡ºåºï¼š[ æ ¹èŠ‚ç‚¹ | å·¦å­æ ‘ | å³å­æ ‘ ]</li>
<li>ä¸­åºéå†é¡ºåºï¼š[ å·¦å­æ ‘ | æ ¹èŠ‚ç‚¹ | å³å­æ ‘ ]</li>
</ul>
<h2 id="æ–¹æ³•ä¸€ï¼šé€’å½’"><a href="#æ–¹æ³•ä¸€ï¼šé€’å½’" class="headerlink" title="æ–¹æ³•ä¸€ï¼šé€’å½’"></a>æ–¹æ³•ä¸€ï¼šé€’å½’</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">buildTree</span>(<span class="params">self, preorder: <span class="type">List</span>[<span class="built_in">int</span>], inorder: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="type">Optional</span>[TreeNode]:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> preorder <span class="keyword">or</span> <span class="keyword">not</span> inorder:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        root_val = preorder[<span class="number">0</span>]</span><br><span class="line">        root = TreeNode(root_val)</span><br><span class="line"></span><br><span class="line">        mid = inorder.index(root_val)</span><br><span class="line"></span><br><span class="line">        root.left = <span class="variable language_">self</span>.buildTree(preorder[<span class="number">1</span>:mid+<span class="number">1</span>],inorder[:mid])</span><br><span class="line">        root.right = <span class="variable language_">self</span>.buildTree(preorder[mid+<span class="number">1</span>:],inorder[mid+<span class="number">1</span>:])</span><br><span class="line">        <span class="keyword">return</span> root</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/22/%E6%97%A5%E5%B8%B8%E5%8A%9B%E6%89%A3/%E7%83%AD%E9%A2%98100/104.%20%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E6%9C%80%E5%A4%A7%E6%B7%B1%E5%BA%A6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/icon.JPG">
      <meta itemprop="name" content="Uncle Antonio">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Uncle Antonio">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/11/22/%E6%97%A5%E5%B8%B8%E5%8A%9B%E6%89%A3/%E7%83%AD%E9%A2%98100/104.%20%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E6%9C%80%E5%A4%A7%E6%B7%B1%E5%BA%A6/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-11-22 22:50:52" itemprop="dateCreated datePublished" datetime="2025-11-22T22:50:52+08:00">2025-11-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-11-08 15:22:45" itemprop="dateModified" datetime="2025-11-08T15:22:45+08:00">2025-11-08</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ğŸ·ç®€å• #æ ‘ #æ·±åº¦ä¼˜å…ˆæœç´¢ #äºŒå‰æ ‘ </p>
<p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘Â <code>root</code>Â ï¼Œè¿”å›å…¶æœ€å¤§æ·±åº¦ã€‚</p>
<p>äºŒå‰æ ‘çš„Â <strong>æœ€å¤§æ·±åº¦</strong>Â æ˜¯æŒ‡ä»æ ¹èŠ‚ç‚¹åˆ°æœ€è¿œå¶å­èŠ‚ç‚¹çš„æœ€é•¿è·¯å¾„ä¸Šçš„èŠ‚ç‚¹æ•°ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2020/11/26/tmp-tree.jpg" alt="|300 "></p>
<p>è¾“å…¥ï¼šroot &#x3D; [3,9,20,null,null,15,7]<br>è¾“å‡ºï¼š3<br>ç¤ºä¾‹ 2ï¼š</p>
<p>è¾“å…¥ï¼šroot &#x3D; [1,null,2]<br>è¾“å‡ºï¼š2</p>
<p><strong>æç¤ºï¼š</strong></p>
<ul>
<li>æ ‘ä¸­èŠ‚ç‚¹çš„æ•°é‡åœ¨Â <code>[0, 104]</code>Â åŒºé—´å†…ã€‚</li>
<li><code>-100 &lt;= Node.val &lt;= 100</code></li>
</ul>
<h1 id="è§£é¢˜æ€è·¯ä¸å®ç°"><a href="#è§£é¢˜æ€è·¯ä¸å®ç°" class="headerlink" title="è§£é¢˜æ€è·¯ä¸å®ç°"></a>è§£é¢˜æ€è·¯ä¸å®ç°</h1><ul>
<li>é€’å½’</li>
<li>è¿­ä»£</li>
</ul>
<h2 id="æ–¹æ³•ä¸€ï¼šé€’å½’"><a href="#æ–¹æ³•ä¸€ï¼šé€’å½’" class="headerlink" title="æ–¹æ³•ä¸€ï¼šé€’å½’"></a>æ–¹æ³•ä¸€ï¼šé€’å½’</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">maxDepth</span>(<span class="params">self, root: <span class="type">Optional</span>[TreeNode]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        left_depth = <span class="variable language_">self</span>.maxDepth(root.left)</span><br><span class="line">        right_depth = <span class="variable language_">self</span>.maxDepth(root.right)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">max</span>(left_depth, right_depth) + <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h2 id="æ–¹æ³•äºŒï¼šè¿­ä»£"><a href="#æ–¹æ³•äºŒï¼šè¿­ä»£" class="headerlink" title="æ–¹æ³•äºŒï¼šè¿­ä»£"></a>æ–¹æ³•äºŒï¼šè¿­ä»£</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">maxDepth</span>(<span class="params">self, root: <span class="type">Optional</span>[TreeNode]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        queue = deque([root])</span><br><span class="line">        depth = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> queue:</span><br><span class="line">            level_size = <span class="built_in">len</span>(queue)</span><br><span class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(level_size):</span><br><span class="line">                node = queue.popleft()</span><br><span class="line">                <span class="keyword">if</span> node.left:</span><br><span class="line">                    queue.append(node.left)</span><br><span class="line">                <span class="keyword">if</span> node.right:</span><br><span class="line">                    queue.append(node.right)</span><br><span class="line">            depth += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> depth</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/22/%E6%97%A5%E5%B8%B8%E5%8A%9B%E6%89%A3/%E7%83%AD%E9%A2%98100/102.%20%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E5%B1%82%E5%BA%8F%E9%81%8D%E5%8E%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/icon.JPG">
      <meta itemprop="name" content="Uncle Antonio">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Uncle Antonio">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/11/22/%E6%97%A5%E5%B8%B8%E5%8A%9B%E6%89%A3/%E7%83%AD%E9%A2%98100/102.%20%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E5%B1%82%E5%BA%8F%E9%81%8D%E5%8E%86/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-11-22 22:50:52" itemprop="dateCreated datePublished" datetime="2025-11-22T22:50:52+08:00">2025-11-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-11-08 18:39:30" itemprop="dateModified" datetime="2025-11-08T18:39:30+08:00">2025-11-08</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ğŸ·ä¸­ç­‰ #æ ‘ #äºŒå‰æ ‘ #å¹¿åº¦ä¼˜å…ˆæœç´¢ </p>
<p>ç»™ä½ äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹Â <code>root</code>Â ï¼Œè¿”å›å…¶èŠ‚ç‚¹å€¼çš„Â <strong>å±‚åºéå†</strong>Â ã€‚ ï¼ˆå³é€å±‚åœ°ï¼Œä»å·¦åˆ°å³è®¿é—®æ‰€æœ‰èŠ‚ç‚¹ï¼‰ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2021/02/19/tree1.jpg" alt="| 200"></p>
<p>è¾“å…¥ï¼šroot &#x3D; [3,9,20,null,null,15,7]<br>è¾“å‡ºï¼š[[3],[9,20],[15,7]]<br>ç¤ºä¾‹ 2ï¼š</p>
<p>è¾“å…¥ï¼šroot &#x3D; [1]<br>è¾“å‡ºï¼š[[1]]<br>ç¤ºä¾‹ 3ï¼š</p>
<p>è¾“å…¥ï¼šroot &#x3D; []<br>è¾“å‡ºï¼š[]<br><strong>æç¤ºï¼š</strong></p>
<ul>
<li>æ ‘ä¸­èŠ‚ç‚¹æ•°ç›®åœ¨èŒƒå›´Â <code>[0, 2000]</code>Â å†…</li>
<li><code>-1000 &lt;= Node.val &lt;= 1000</code></li>
</ul>
<h1 id="è§£é¢˜æ€è·¯ä¸å®ç°"><a href="#è§£é¢˜æ€è·¯ä¸å®ç°" class="headerlink" title="è§£é¢˜æ€è·¯ä¸å®ç°"></a>è§£é¢˜æ€è·¯ä¸å®ç°</h1><ul>
<li>é€’å½’</li>
</ul>
<h2 id="æ–¹æ³•ä¸€ï¼šé€’å½’"><a href="#æ–¹æ³•ä¸€ï¼šé€’å½’" class="headerlink" title="æ–¹æ³•ä¸€ï¼šé€’å½’"></a>æ–¹æ³•ä¸€ï¼šé€’å½’</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">levelOrder</span>(<span class="params">self, root: <span class="type">Optional</span>[TreeNode]</span>) -&gt; <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">int</span>]]:</span><br><span class="line">        res = []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">dfs</span>(<span class="params">node,level</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> node:</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(res) == level:</span><br><span class="line">                res.append([])</span><br><span class="line">            res[level].append(node.val)</span><br><span class="line">            dfs(node.left, level+<span class="number">1</span>)</span><br><span class="line">            dfs(node.right, level+<span class="number">1</span>)</span><br><span class="line">        dfs(root,<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/22/%E6%97%A5%E5%B8%B8%E5%8A%9B%E6%89%A3/%E7%83%AD%E9%A2%98100/101.%20%E5%AF%B9%E7%A7%B0%E4%BA%8C%E5%8F%89%E6%A0%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/icon.JPG">
      <meta itemprop="name" content="Uncle Antonio">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Uncle Antonio">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/11/22/%E6%97%A5%E5%B8%B8%E5%8A%9B%E6%89%A3/%E7%83%AD%E9%A2%98100/101.%20%E5%AF%B9%E7%A7%B0%E4%BA%8C%E5%8F%89%E6%A0%91/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-11-22 22:50:52" itemprop="dateCreated datePublished" datetime="2025-11-22T22:50:52+08:00">2025-11-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-11-08 17:04:02" itemprop="dateModified" datetime="2025-11-08T17:04:02+08:00">2025-11-08</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ğŸ·ç®€å• #æ ‘ #æ·±åº¦ä¼˜å…ˆæœç´¢ #å¹¿åº¦ä¼˜å…ˆæœç´¢ #äºŒå‰æ ‘</p>
<p>ç»™ä½ ä¸€ä¸ªäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹Â <code>root</code>Â ï¼Œ æ£€æŸ¥å®ƒæ˜¯å¦è½´å¯¹ç§°ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<p><img src="https://pic.leetcode.cn/1698026966-JDYPDU-image.png" alt=" | 250"></p>
<p>è¾“å…¥ï¼šroot &#x3D; [1,2,2,3,4,4,3]<br>è¾“å‡ºï¼štrue<br><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<p><img src="https://pic.leetcode.cn/1698027008-nPFLbM-image.png" alt="250"></p>
<p>è¾“å…¥ï¼šroot &#x3D; [1,2,2,null,3,null,3]<br>è¾“å‡ºï¼šfalse</p>
<p><strong>æç¤ºï¼š</strong></p>
<ul>
<li>æ ‘ä¸­èŠ‚ç‚¹æ•°ç›®åœ¨èŒƒå›´Â <code>[1, 1000]</code>Â å†…</li>
<li><code>-100 &lt;= Node.val &lt;= 100</code></li>
</ul>
<p>**è¿›é˜¶ï¼šä½ å¯ä»¥è¿ç”¨é€’å½’å’Œè¿­ä»£ä¸¤ç§æ–¹æ³•è§£å†³è¿™ä¸ªé—®é¢˜å—ï¼Ÿ</p>
<h1 id="è§£é¢˜æ€è·¯ä¸å®ç°"><a href="#è§£é¢˜æ€è·¯ä¸å®ç°" class="headerlink" title="è§£é¢˜æ€è·¯ä¸å®ç°"></a>è§£é¢˜æ€è·¯ä¸å®ç°</h1><ul>
<li>é€’å½’</li>
</ul>
<h2 id="æ–¹æ³•ä¸€ï¼šé€’å½’"><a href="#æ–¹æ³•ä¸€ï¼šé€’å½’" class="headerlink" title="æ–¹æ³•ä¸€ï¼šé€’å½’"></a>æ–¹æ³•ä¸€ï¼šé€’å½’</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">isSymmetric</span>(<span class="params">self, root: <span class="type">Optional</span>[TreeNode]</span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">isMirror</span>(<span class="params">t1,t2</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> t1 <span class="keyword">and</span> <span class="keyword">not</span> t2:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> t1 <span class="keyword">or</span> <span class="keyword">not</span> t2:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="keyword">return</span> (t1.val == t2.val <span class="keyword">and</span></span><br><span class="line">            isMirror(t1.left,t2.right) <span class="keyword">and</span></span><br><span class="line">            isMirror(t1.right,t2.left))</span><br><span class="line">        <span class="keyword">return</span> isMirror(root.left, root.right)</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/11/22/%E6%97%A5%E5%B8%B8%E5%8A%9B%E6%89%A3/%E7%83%AD%E9%A2%98100/1.%20%E4%B8%A4%E6%95%B0%E4%B9%8B%E5%92%8C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/icon.JPG">
      <meta itemprop="name" content="Uncle Antonio">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Uncle Antonio">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/11/22/%E6%97%A5%E5%B8%B8%E5%8A%9B%E6%89%A3/%E7%83%AD%E9%A2%98100/1.%20%E4%B8%A4%E6%95%B0%E4%B9%8B%E5%92%8C/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-11-22 22:50:52" itemprop="dateCreated datePublished" datetime="2025-11-22T22:50:52+08:00">2025-11-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-10-15 23:14:19" itemprop="dateModified" datetime="2025-10-15T23:14:19+08:00">2025-10-15</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ğŸ·ç®€å• #æ•°ç»„ #å“ˆå¸Œè¡¨ </p>
<p>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„Â <code>nums</code>Â å’Œä¸€ä¸ªæ•´æ•°ç›®æ ‡å€¼Â <code>target</code>ï¼Œè¯·ä½ åœ¨è¯¥æ•°ç»„ä¸­æ‰¾å‡ºÂ <strong>å’Œä¸ºç›®æ ‡å€¼</strong>Â <em><code>target</code></em>Â  çš„é‚£Â <strong>ä¸¤ä¸ª</strong>Â æ•´æ•°ï¼Œå¹¶è¿”å›å®ƒä»¬çš„æ•°ç»„ä¸‹æ ‡ã€‚</p>
<p>ä½ å¯ä»¥å‡è®¾æ¯ç§è¾“å…¥åªä¼šå¯¹åº”ä¸€ä¸ªç­”æ¡ˆï¼Œå¹¶ä¸”ä½ ä¸èƒ½ä½¿ç”¨ä¸¤æ¬¡ç›¸åŒçš„å…ƒç´ ã€‚</p>
<p>ä½ å¯ä»¥æŒ‰ä»»æ„é¡ºåºè¿”å›ç­”æ¡ˆã€‚</p>
<blockquote>
<p>ç¤ºä¾‹ 1:<br>è¾“å…¥ï¼šnums &#x3D; [2,7,11,15], target &#x3D; 9<br>è¾“å‡ºï¼š[0,1]<br>è§£é‡Šï¼šå› ä¸º nums[0] + nums[1] &#x3D;&#x3D; 9 ï¼Œè¿”å› [0, 1] ã€‚</p>
</blockquote>
<blockquote>
<p>ç¤ºä¾‹ 2ï¼š<br>è¾“å…¥ï¼šnums &#x3D; [3,2,4], target &#x3D; 6<br>è¾“å‡ºï¼š**[1,2]</p>
</blockquote>
<blockquote>
<p>ç¤ºä¾‹ 3ï¼š**<br>è¾“å…¥ï¼šnums &#x3D; [3,3], target &#x3D; 6<br>è¾“å‡ºï¼š**[0,1]</p>
</blockquote>
<p><strong>æç¤ºï¼š</strong></p>
<ul>
<li><code>2 &lt;= nums.length &lt;= 104</code></li>
<li><code>-109 &lt;= nums[i] &lt;= 109</code></li>
<li><code>-109 &lt;= target &lt;= 109</code></li>
<li>åªä¼šå­˜åœ¨ä¸€ä¸ªæœ‰æ•ˆç­”æ¡ˆ</li>
</ul>
<h1 id="è§£é¢˜æ€è·¯ä¸å®ç°"><a href="#è§£é¢˜æ€è·¯ä¸å®ç°" class="headerlink" title="è§£é¢˜æ€è·¯ä¸å®ç°"></a>è§£é¢˜æ€è·¯ä¸å®ç°</h1><p><strong>å…³é”®ä¿¡æ¯</strong><br>å‡è®¾åªæœ‰ä¸€ç§ç­”æ¡ˆï¼Œæ‰€ä»¥å¯ä»¥é€ä¸€æ±‚å’Œå»åˆ¤æ–­ã€‚</p>
<h2 id="æ–¹æ³•ä¸€ï¼šæ•°ç»„éå†"><a href="#æ–¹æ³•ä¸€ï¼šæ•°ç»„éå†" class="headerlink" title="æ–¹æ³•ä¸€ï¼šæ•°ç»„éå†"></a>æ–¹æ³•ä¸€ï¼šæ•°ç»„éå†</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">Â  Â  <span class="keyword">def</span> <span class="title function_">twoSum</span>(<span class="params">self, nums: <span class="built_in">list</span>[<span class="built_in">int</span>], target: <span class="built_in">int</span></span>) -&gt; <span class="built_in">list</span>[<span class="built_in">int</span>]:</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">for</span> i,x <span class="keyword">in</span> <span class="built_in">enumerate</span>(nums):</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>, <span class="built_in">len</span>(nums)):</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> x + nums[j] == target:</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> [i,j]</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/08/17/%E6%8A%80%E6%9C%AF%E4%B9%A6%E7%B1%8D/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/icon.JPG">
      <meta itemprop="name" content="Uncle Antonio">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Uncle Antonio">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/08/17/%E6%8A%80%E6%9C%AF%E4%B9%A6%E7%B1%8D/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/" class="post-title-link" itemprop="url">å‡¤å‡°æ¶æ„</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-08-17 13:50:00 / Modified: 14:19:11" itemprop="dateCreated datePublished" datetime="2025-08-17T13:50:00+08:00">2025-08-17</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">è¯»ä¹¦ç¬”è®°</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ä½œè€…ï¼šå‘¨å¿—å<br>é˜…è¯»æ—¥æœŸï¼š20250611â€”â€”20250630<br>å­¦ä¹ ç½‘ç«™ï¼š<a target="_blank" rel="noopener" href="https://icyfenix.cn/">https://icyfenix.cn/</a></p>
<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><blockquote>
<p><strong>å¢¨è²å®šå¾‹</strong><br>Anything that can go wrong will go wrong.<br>   å¦‚æœäº‹æƒ…å¯èƒ½å‡ºé”™å°±æ€»ä¼šå‡ºé”™ã€‚</p>
</blockquote>
<h2 id="å¯é çš„ç³»ç»Ÿï¼š"><a href="#å¯é çš„ç³»ç»Ÿï¼š" class="headerlink" title="å¯é çš„ç³»ç»Ÿï¼š"></a>å¯é çš„ç³»ç»Ÿï¼š</h2><p>å†¯è¯ºä¼Šæ›¼ã€Šè‡ªå¤åˆ¶è‡ªåŠ¨æœºã€‹ï¼Œå¦‚ä½•ç”¨ä¸å¯é çš„ä¸è§æ„å»ºå¯é çš„ç³»ç»Ÿï¼›æ¯ä¸€ä¸ªéƒ¨ä»¶éƒ½å¯ä»¥çœ‹ä½œä¸€åªä¸æ­»é¸Ÿï¼ˆPhoenixï¼‰ï¼Œèƒ½å¤Ÿæ¶…æ§ƒé‡ç”Ÿã€‚</p>
<h2 id="æ¶æ„çš„æ¼”è¿›ï¼š"><a href="#æ¶æ„çš„æ¼”è¿›ï¼š" class="headerlink" title="æ¶æ„çš„æ¼”è¿›ï¼š"></a>æ¶æ„çš„æ¼”è¿›ï¼š</h2><p>å¤§å‹æœºï¼ˆMainframeï¼‰â€”â€”&gt;åŸå§‹åˆ†å¸ƒå¼ï¼ˆDistributedï¼‰â€”â€”&gt;å¤§å‹å•ä½“ï¼ˆMonolithicï¼‰â€”â€”&gt;é¢å‘æœåŠ¡ï¼ˆService-Orientedï¼‰â€”â€”&gt;å¾®æœåŠ¡ï¼ˆMicroservicesï¼‰â€”â€”&gt;æœåŠ¡ç½‘æ ¼ï¼ˆService Meshï¼‰â€”â€”&gt;æ— æœåŠ¡ï¼ˆServerlessï¼‰</p>
<blockquote>
<p>åªè¦åœ¨æ•´ä½“æ¶æ„è®¾è®¡æœ‰æ°å½“çš„ã€è‡ªåŠ¨åŒ–çš„é”™è¯¯ç†”æ–­ã€æœåŠ¡æ·˜æ±°å’Œé‡å»ºçš„æœºåˆ¶ï¼Œåœ¨ç³»ç»Ÿå¤–éƒ¨æ¥è§‚å¯Ÿï¼Œæ•´ä½“ä¸Šä»ç„¶æœ‰å¯èƒ½è¡¨ç°å‡ºç¨³å®šå’Œå¥å£®çš„æœåŠ¡èƒ½åŠ›ã€‚</p>
</blockquote>
<h2 id="ğŸš£å‡¤å‡°æ¶æ„"><a href="#ğŸš£å‡¤å‡°æ¶æ„" class="headerlink" title="ğŸš£å‡¤å‡°æ¶æ„"></a>ğŸš£å‡¤å‡°æ¶æ„</h2><h1 id="æ¢ç´¢èµ·æ­¥"><a href="#æ¢ç´¢èµ·æ­¥" class="headerlink" title="æ¢ç´¢èµ·æ­¥"></a>æ¢ç´¢èµ·æ­¥</h1><h2 id="ç« èŠ‚ä¸€è§ˆ"><a href="#ç« èŠ‚ä¸€è§ˆ" class="headerlink" title="ç« èŠ‚ä¸€è§ˆ"></a>ç« èŠ‚ä¸€è§ˆ</h2><ol>
<li>æ¼”è¿›ä¸­çš„æ¶æ„â€”â€”ä»‹ç»æœåŠ¡æ¶æ„æ¼”è¿›å²</li>
<li>æ¶æ„å¸ˆçš„è§†è§’â€”â€”æ¶æ„è®¾è®¡è§£å†³æ–¹æ¡ˆåŠæ ‡å‡†</li>
<li>åˆ†å¸ƒå¼çš„åŸºçŸ³â€”â€”åˆ†å¸ƒå¼ç”Ÿæ€çš„ä¸€äº›åˆ—é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ</li>
<li>ä¸å¯å˜åŸºç¡€è®¾æ–½â€”â€”äº‘åŸç”ŸåŸºç¡€è®¾æ–½ä¸å¯å˜æ€§</li>
<li>æŠ€æœ¯æ–¹æ³•è®ºâ€”â€”åˆ†å¸ƒå¼ã€å¾®æœåŠ¡ã€æ¶æ„ç›¸å…³åŠ¡è™šè¯é¢˜</li>
</ol>
<h1 id="æ¼”è¿›ä¸­çš„æ¶æ„"><a href="#æ¼”è¿›ä¸­çš„æ¶æ„" class="headerlink" title="æ¼”è¿›ä¸­çš„æ¶æ„"></a>æ¼”è¿›ä¸­çš„æ¶æ„</h1><h2 id="åŸå§‹åˆ†å¸ƒå¼æ—¶ä»£"><a href="#åŸå§‹åˆ†å¸ƒå¼æ—¶ä»£" class="headerlink" title="åŸå§‹åˆ†å¸ƒå¼æ—¶ä»£"></a>åŸå§‹åˆ†å¸ƒå¼æ—¶ä»£</h2><blockquote>
<p><strong>UNIX çš„åˆ†å¸ƒå¼è®¾è®¡å“²å­¦</strong><br>ä¿æŒæ¥å£ä¸å®ç°çš„ç®€å•æ€§ï¼Œæ¯”ç³»ç»Ÿçš„ä»»ä½•å…¶ä»–å±æ€§ï¼ŒåŒ…æ‹¬å‡†ç¡®æ€§ã€ä¸€è‡´æ€§å’Œå®Œæ•´æ€§ï¼Œéƒ½æ¥å¾—æ›´åŠ é‡è¦ã€‚</p>
</blockquote>
<p>20ä¸–çºª70å¹´ä»£æœ«æœŸåˆ°80å¹´ä»£åˆï¼Œè®¡ç®—æœºç»å†äº†ä»å¤§å‹æœºä¸ºä¸»å‘å¾®å‹æœºä¸ºä¸»çš„èœ•å˜ï¼Œç§‘ç ”è®¾å¤‡è½¬å˜ä¸ºå¨±ä¹è®¾å¤‡ã€‚ä½†æ˜¯å½“å‰å¾®å‹æœºçš„å¤„ç†å™¨ã€å†…å­˜éƒ½å¾ˆæœ‰é™ï¼Œäºæ˜¯å¼€å§‹å¯»æ‰¾å¤šå°è®¡ç®—æœºå…±åŒåä½œæ”¯æ’‘ç³»ç»Ÿè¿è¡Œçš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>äº§ç”Ÿäº†ä¸€ç³»åˆ—çš„ä¸­é—´æˆæœï¼Œç‰µå¼•äº†åç»­æ¶æ„çš„æ¼”åŒ–æ¶æ„ï¼š</p>
<ul>
<li>ç½‘ç»œè¿ç®—æ¶æ„ï¼ˆæƒ æ™®å…¬å¸æä¾›ï¼‰â€”â€”â€“è¿œç¨‹æœåŠ¡è°ƒç”¨é›å½¢</li>
<li>AFSæ–‡ä»¶ç³»ç»Ÿï¼ˆå¡å†…åŸºæ¢…éš†å¤§å­¦æå‡ºï¼‰â€”â€”-åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿé›å½¢</li>
<li>Kerberosåè®®ï¼ˆéº»çœç†å·¥å­¦é™¢æå‡ºï¼‰â€”â€”â€“æœåŠ¡è®¤è¯å’Œè®¿é—®æ§åˆ¶çš„åŸºç¡€</li>
</ul>
<p>OSFåˆ¶è®¢â€åˆ†å¸ƒå¼è¿ç®—ç¯å¢ƒâ€œï¼ˆDCEï¼‰çš„åˆ†å¸ƒå¼æŠ€æœ¯ä½“ç³»ï¼Œè¿™æ¬¡å°è¯•æœ€å¤§çš„æ”¶è·å°±æ˜¯å¯¹ RPCã€DFS ç­‰æ¦‚å¿µçš„å¼€åˆ›ï¼Œä»¥åŠå¾—åˆ°äº†ä¸€ä¸ªä»·å€¼åƒé‡‘çš„æ•™è®­ï¼š<strong>æŸä¸ªåŠŸèƒ½èƒ½å¤Ÿè¿›è¡Œåˆ†å¸ƒå¼ï¼Œå¹¶ä¸æ„å‘³ç€å®ƒå°±åº”è¯¥è¿›è¡Œåˆ†å¸ƒå¼ï¼Œå¼ºè¡Œè¿½æ±‚é€æ˜çš„åˆ†å¸ƒå¼æ“ä½œï¼Œåªä¼šè‡ªå¯»è‹¦æœã€‚</strong></p>
<p>20ä¸–çºª80å¹´ä»£ï¼Œæ‘©å°”å®šå¾‹å‘æŒ¥ä½œç”¨ï¼Œç®—åŠ›æå‡é€Ÿåº¦æƒŠäººï¼Œé€æ­¥å¼€å§‹è½¬å‘å¤§å‹å•ä½“ã€‚</p>
<p>ğŸ–Šä¸ºçªç ´ç®—åŠ›ï¼Œç”±å¤§å‹æœºå¼€å±•å‘åŸå§‹åˆ†å¸ƒå¼å‘å±•ï¼ŒåŸå§‹åˆ†å¸ƒå¼æ˜¯ç°ä»£åˆ†å¸ƒå¼è¯¸å¤šæŠ€æœ¯çš„é›å½¢ï¼Œä¹Ÿç»™å‡ºäº†é‡è¦æ•™è®­ã€‚ åç»­ç®—åŠ›é€æ¸æå‡ï¼Œå¼€å±•ä¸“é¡¹å¤§å‹å•ä½“åº”ç”¨</p>
<h2 id="å•ä½“ç³»ç»Ÿæ—¶ä»£"><a href="#å•ä½“ç³»ç»Ÿæ—¶ä»£" class="headerlink" title="å•ä½“ç³»ç»Ÿæ—¶ä»£"></a>å•ä½“ç³»ç»Ÿæ—¶ä»£</h2><blockquote>
<p><strong>å•ä½“æ¶æ„ï¼ˆMonolithicï¼‰</strong><br>â€œå•ä½“â€åªæ˜¯è¡¨æ˜ç³»ç»Ÿä¸­ä¸»è¦çš„è¿‡ç¨‹è°ƒç”¨éƒ½æ˜¯è¿›ç¨‹å†…è°ƒç”¨ï¼Œä¸ä¼šå‘ç”Ÿè¿›ç¨‹é—´é€šä¿¡ï¼Œä»…æ­¤è€Œå·²ã€‚</p>
</blockquote>
<p>å•ä½“å¹¶éâ€åæ´¾è§’è‰²â€œï¼Œå¯¹äºå°å‹ç³»ç»Ÿï¼Œå•ä½“æ˜“äºå¼€å‘ã€æµ‹è¯•ã€éƒ¨ç½²ï¼Œæ˜¯æ•ˆç‡æœ€é«˜çš„ä¸€ç§æ¶æ„é£æ ¼ã€‚å®ƒçš„ä¸è¶³ï¼Œå¿…é¡»æ˜¯åŸºäºè½¯ä»¶æ€§èƒ½éœ€æ±‚è¶…è¿‡äº†å•æœºï¼Œæ‰æœ‰è®¨è®ºçš„ä»·å€¼ã€‚</p>
<p>å•ä½“æ¶æ„å¹¶éæ„å‘³ç€ä¸è¿›è¡Œæ‹†åˆ†ï¼Œå…¶çºµå‘å¯ä»¥è¿›è¡Œåˆ†å±‚æ¶æ„è®¾è®¡ï¼Œæ¨ªå‘ä¹Ÿå¯ä»¥æŒ‰éœ€æ±‚è¿›è¡Œæ¨¡å—æ‹†åˆ†ã€‚<strong>å…¶çœŸæ­£çš„ç¼ºé™·åœ¨äºæ‹†åˆ†ä¹‹åçš„éš”ç¦»å’Œè‡ªæ²»èƒ½åŠ›ä¼¤çš„æ¬ ç¼º</strong> ã€‚æ— æ³•éš”ç¦»ï¼Œå³åˆå‘å•ç‹¬åœæ­¢ã€æ›´æ–°ã€å‡çº§ï¼Œå¯ç»´æŠ¤æ€§æ²¡æœ‰ä¼˜åŠ¿ï¼Œç¨‹åºå‡çº§ã€ä¿®æ”¹ç¼ºé™·éƒ½å¾€å¾€éœ€è¦åˆ¶å®šä¸“é—¨çš„åœæœºæ›´æ–°è®¡åˆ’ã€‚</p>
<p>å¾®æœåŠ¡å–ä»£å•ä½“ç³»ç»Ÿæˆä¸ºæ½®æµè¶‹åŠ¿çš„æ ¹æœ¬åŸå› ï¼š<strong>å•ä½“ç³»ç»Ÿå¾ˆéš¾å…¼å®¹â€Phoenixçš„ç‰¹æ€§â€œ</strong>ã€‚æœ¬è´¨ä¸Šæ˜¯ä¸€ç§è§‚å¿µè½¬å˜â€è¿½æ±‚å°½é‡ä¸å‡ºé”™â€ï¼Œåˆ°æ­£è§†â€œå‡ºé”™æ˜¯å¿…ç„¶â€œã€‚</p>
<p>ğŸ–Šä¸ºäº†å…è®¸ç¨‹åºå‡ºé”™ï¼Œè®©å…¶è·å¾—éš”ç¦»ã€è‡ªæ²»ç­‰èƒ½åŠ›ï¼Œå•ä½“åº”ç”¨é€æ­¥å¼€å§‹è½¬å‘åˆ†å¸ƒå¼æ¶æ„ï¼Œæœ€æ—©å…´ç››çš„å³é¢å‘æœåŠ¡æ¶æ„ï¼ˆSOAï¼‰</p>
<h2 id="SOAæ—¶ä»£"><a href="#SOAæ—¶ä»£" class="headerlink" title="SOAæ—¶ä»£"></a>SOAæ—¶ä»£</h2><blockquote>
<p><strong>SOA æ¶æ„ï¼ˆService-Oriented Architectureï¼‰</strong><br>é¢å‘æœåŠ¡çš„æ¶æ„æ˜¯ä¸€æ¬¡å…·ä½“åœ°ã€ç³»ç»Ÿæ€§åœ°æˆåŠŸè§£å†³åˆ†å¸ƒå¼æœåŠ¡ä¸»è¦é—®é¢˜çš„æ¶æ„æ¨¡å¼ã€‚</p>
</blockquote>
<p>å•ä½“ç³»ç»Ÿæ‹†åˆ†è¾ƒæœ‰ä»£è¡¨æ€§çš„æ¶æ„æ¨¡å¼ï¼š</p>
<ul>
<li><strong>çƒŸå›±å¼æ¶æ„</strong>ï¼šå­¤å²›å¼ä¿¡æ¯ç³»ç»Ÿï¼Œç‹¬ç«‹æ‹†åˆ†ã€è€æ­»ä¸ç›¸å¾€æ¥çš„æ¶æ„ï¼Œä¸è´´è¿‘å®é™…éœ€æ±‚</li>
<li><strong>å¾®å†…æ ¸æ¶æ„</strong>ï¼šæ’ä»¶å¼æ¶æ„ï¼Œä¸€ä¸ªæ ¸å¿ƒç³»ç»Ÿï¼Œå…¶å®ƒä¸šåŠ¡ç³»ç»Ÿä»¥æ’ä»¶å½¢å¼å­˜åœ¨ï¼Œé€‚åˆæ¡Œé¢åŠWebåº”ç”¨ã€‚å„æ’ä»¶ä¸ä¼šç›´æ¥äº¤äº’æ˜¯å¤§å‰æ</li>
<li><strong>äº‹ä»¶é©±åŠ¨æ¶æ„</strong>ï¼šå­ç³»ç»Ÿå»ºç«‹ä¸€å¥—äº‹ä»¶é˜Ÿåˆ—ç®¡é“ï¼Œå¤–éƒ¨æ¶ˆæ¯å‘ç»™ç®¡é“ï¼Œå­ç³»ç»ŸæŒ‰éœ€æ¶ˆè´¹ï¼Œæ¶ˆè´¹è€…é«˜åº¦è§£è€¦ä¸”èƒ½é€šè¿‡ç®¡é“äº¤äº’ã€‚</li>
</ul>
<p>å½“æ¼”åŒ–è‡³äº‹ä»¶é©±åŠ¨æ¶æ„ï¼ŒÂ SOAP åè®®è¯ç”Ÿï¼ŒSOAå¼€å§‹ç™»ä¸Šè½¯ä»¶æ¶æ„èˆå°ğŸ™ã€‚</p>
<p>SOAç”±Gartneråœ¨1994å¹´æå‡ºï¼Œ2006å¹´æˆç«‹è”ç›Ÿåˆ¶å®šæ ‡å‡†ï¼Œå¾®æœåŠ¡çš„è¯¸å¤šæ€æƒ³ã€æ¦‚å¿µéƒ½åœ¨SOAä¸­å¯ä»¥çœ‹åˆ°ï¼Œå®ƒæ›´åŠ ç³»ç»Ÿã€æ›´åŠ å…·ä½“ï¼š</p>
<ul>
<li>æ›´å…·ä½“ï¼šæœ‰æ ‡å‡†ã€æœ‰åŸåˆ™ã€æœ‰åè®®ï¼ŒåŒ…æ‹¬ESBï¼ˆæ€»çº¿ï¼‰ã€SDOï¼ˆæ•°æ®è®¿é—®ï¼‰ã€SCAï¼ˆæ•°æ®æœåŠ¡ï¼‰ç­‰ç­‰</li>
<li>æ›´ç³»ç»Ÿï¼šç›®æ ‡æ˜¯ä¸€æ½å­è§£å†³æ‰å…¨éƒ¨é—®é¢˜</li>
</ul>
<p><strong>è¾¹ç¼˜åŒ–çš„åŸå› </strong>ï¼šè¿‡äºä¸¥æ ¼çš„è§„èŒƒå®šä¹‰å¸¦æ¥è¿‡åº¦çš„å¤æ‚æ€§</p>
<p>ğŸ–ŠSOAç»ˆç©¶æ˜¯é˜³æ˜¥ç™½é›ªï¼Œå›é¡¾è¿‡å»ï¼Œä¸å¿˜â€œé€æ˜â€çš„åˆå¿ƒ</p>
<h2 id="å¾®æœåŠ¡æ—¶ä»£"><a href="#å¾®æœåŠ¡æ—¶ä»£" class="headerlink" title="å¾®æœåŠ¡æ—¶ä»£"></a>å¾®æœåŠ¡æ—¶ä»£</h2><blockquote>
<p><strong>å¾®æœåŠ¡æ¶æ„ï¼ˆMicroservicesï¼‰</strong><br>å¾®æœåŠ¡æ˜¯ä¸€ç§é€šè¿‡å¤šä¸ªå°å‹æœåŠ¡ç»„åˆæ¥æ„å»ºå•ä¸ªåº”ç”¨çš„æ¶æ„é£æ ¼ï¼Œè¿™äº›æœåŠ¡å›´ç»•ä¸šåŠ¡èƒ½åŠ›è€Œéç‰¹å®šçš„æŠ€æœ¯æ ‡å‡†æ¥æ„å»ºã€‚å„ä¸ªæœåŠ¡å¯ä»¥é‡‡ç”¨ä¸åŒçš„ç¼–ç¨‹è¯­è¨€ï¼Œä¸åŒçš„æ•°æ®å­˜å‚¨æŠ€æœ¯ï¼Œè¿è¡Œåœ¨ä¸åŒçš„è¿›ç¨‹ä¹‹ä¸­ã€‚æœåŠ¡é‡‡å–è½»é‡çº§çš„é€šä¿¡æœºåˆ¶å’Œè‡ªåŠ¨åŒ–çš„éƒ¨ç½²æœºåˆ¶å®ç°é€šä¿¡ä¸è¿ç»´ã€‚</p>
</blockquote>
<p>2005å¹´ç”±Rodgersåšå£«æå‡ºï¼Œ2014å¹´å´›èµ·ï¼ŒMartin Fowler ä¸ James Lewisç»™å‡ºå¾®æœåŠ¡çš„æ¦‚å¿µï¼š<br><strong>å¾®æœåŠ¡æ˜¯ä¸€ç§é€šè¿‡å¤šä¸ªå°å‹æœåŠ¡ç»„åˆæ¥æ„å»ºå•ä¸ªåº”ç”¨çš„æ¶æ„é£æ ¼ï¼Œè¿™äº›æœåŠ¡å›´ç»•ä¸šåŠ¡èƒ½åŠ›è€Œéç‰¹å®šçš„æŠ€æœ¯æ ‡å‡†æ¥æ„å»ºã€‚å„ä¸ªæœåŠ¡å¯ä»¥é‡‡ç”¨ä¸åŒçš„ç¼–ç¨‹è¯­è¨€ï¼Œä¸åŒçš„æ•°æ®å­˜å‚¨æŠ€æœ¯ï¼Œè¿è¡Œåœ¨ä¸åŒçš„è¿›ç¨‹ä¹‹ä¸­ã€‚æœåŠ¡é‡‡å–è½»é‡çº§çš„é€šä¿¡æœºåˆ¶å’Œè‡ªåŠ¨åŒ–çš„éƒ¨ç½²æœºåˆ¶å®ç°é€šä¿¡ä¸è¿ç»´ã€‚</strong></p>
<p>ä¹ä¸ªæ ¸å¿ƒçš„ä¸šåŠ¡ä¸æŠ€æœ¯ç‰¹å¾ï¼š</p>
<ol>
<li>å›´ç»•ä¸šåŠ¡èƒ½åŠ›å»ºè®¾ï¼šå›¢é˜Ÿå’Œäº§å“çš„ç»“æ„</li>
<li>åˆ†æ•£æ²»ç†ï¼šè°å®¶çš„å­©å­è°æ¥ç®¡</li>
<li>æœåŠ¡æ¥å®ç°ç‹¬ç«‹è‡ªæ²»çš„ç»„ä»¶ï¼šæœåŠ¡è¿œç¨‹è°ƒç”¨æä¾›åŠŸèƒ½</li>
<li>äº§å“åŒ–æ€ç»´ï¼šå…¨ç”Ÿå‘½å‘¨æœŸçš„æŒç»­æ”¹è¿›ã€æå‡</li>
<li>æ•°æ®å»ä¸­å¿ƒåŒ–ï¼šæ•°æ®é¢†åŸŸåˆ†æ•£ç®¡ç†</li>
<li>å¼ºç»ˆç«¯å¼±ç®¡é“ï¼šèƒ½åŠ›é›†ä¸­åœ¨ç»ˆç«¯</li>
<li>å®¹é”™æ€§è®¾è®¡ï¼šå¯å‡ºé”™ä¹Ÿå¯é </li>
<li>æ¼”è¿›å¼è®¾è®¡ï¼šæœåŠ¡å¯æ·˜æ±°</li>
<li>åŸºç¡€è®¾æ–½è‡ªåŠ¨åŒ–ï¼šCI&#x2F;CD</li>
</ol>
<p><strong>å¾®æœåŠ¡ä¸æ˜¯ SOA çš„å˜ä½“æˆ–è¡ç”Ÿå“</strong></p>
<ul>
<li>æ‘’å¼ƒçº¦å®šå’Œè§„å®š</li>
<li>åˆ†å¸ƒå¼æœåŠ¡çš„é—®é¢˜æ²¡æœ‰ç»Ÿä¸€çš„è§£å†³æ–¹æ¡ˆï¼Œå…«ä»™è¿‡æµ·å„æ˜¾ç¥é€š</li>
</ul>
<p>æœ‰ä»€ä¹ˆé—®é¢˜ã€å¼•ä»€ä¹ˆå·¥å…·<br>SpringCloud èƒ¶æ°´å¼çš„å·¥å…·é›†ï¼Œè¿›ä¸€æ­¥å±è”½äº†æºè‡ªäºå…·ä½“å·¥å…·ã€æ¡†æ¶çš„å¤æ‚æ€§ï¼Œé™ä½äº†åœ¨ä¸åŒå·¥å…·ã€æ¡†æ¶ä¹‹é—´åˆ‡æ¢çš„æˆæœ¬</p>
<h2 id="åå¾®æœåŠ¡æ—¶ä»£"><a href="#åå¾®æœåŠ¡æ—¶ä»£" class="headerlink" title="åå¾®æœåŠ¡æ—¶ä»£"></a>åå¾®æœåŠ¡æ—¶ä»£</h2><blockquote>
<p><strong>åå¾®æœåŠ¡æ—¶ä»£ï¼ˆCloud Nativeï¼‰</strong><br>ä»è½¯ä»¶å±‚é¢ç‹¬åŠ›åº”å¯¹å¾®æœåŠ¡æ¶æ„é—®é¢˜ï¼Œå‘å±•åˆ°è½¯ã€ç¡¬ä¸€ä½“ï¼ŒåˆåŠ›åº”å¯¹æ¶æ„é—®é¢˜çš„æ—¶ä»£ï¼Œæ­¤å³ä¸ºâ€œåå¾®æœåŠ¡æ—¶ä»£â€ã€‚</p>
</blockquote>
<p>æ³¨å†Œå‘ç°ã€è·Ÿè¸ªæ²»ç†ã€è´Ÿè½½å‡è¡¡ã€ä¼ è¾“é€šä¿¡è¿™äº›é—®é¢˜ä¸€å®šéœ€è¦è½¯ä»¶ç³»ç»Ÿæ¥è§£å†³å—ï¼Ÿ<br>å¯ä»¥è€ƒè™‘é€šè¿‡åŸºç¡€è®¾æ–½æ¥è§£å†³ï¼Œè¢«ä¸šç•Œå¹¿æ³›è®¤å¯ã€æ™®éé‡‡ç”¨çš„é€šè¿‡è™šæ‹ŸåŒ–åŸºç¡€è®¾æ–½å»è§£å†³åˆ†å¸ƒå¼æ¶æ„é—®é¢˜çš„å¼€ç«¯ï¼Œåº”è¯¥è¦ä» 2017 å¹´<strong>Kubernetes</strong> èµ¢å¾—å®¹å™¨æˆ˜äº‰çš„èƒœåˆ©å¼€å§‹ç®—èµ·ã€‚<br>åŒä¸€ä¸ªåˆ†å¸ƒå¼æœåŠ¡çš„é—®é¢˜åœ¨ä¼ ç»Ÿ Spring Cloud ä¸­æä¾›çš„åº”ç”¨å±‚é¢çš„è§£å†³æ–¹æ¡ˆä¸åœ¨ Kubernetes ä¸­æä¾›çš„åŸºç¡€è®¾æ–½å±‚é¢çš„è§£å†³æ–¹æ¡ˆï¼š</p>
<table>
<thead>
<tr>
<th></th>
<th>Kubernetes</th>
<th>Spring Cloud</th>
</tr>
</thead>
<tbody><tr>
<td>å¼¹æ€§ä¼¸ç¼©</td>
<td>Autoscaling</td>
<td>N&#x2F;A</td>
</tr>
<tr>
<td>æœåŠ¡å‘ç°</td>
<td>KubeDNS &#x2F; CoreDNS</td>
<td>Spring Cloud Eureka</td>
</tr>
<tr>
<td>é…ç½®ä¸­å¿ƒ</td>
<td>ConfigMap &#x2F; Secret</td>
<td>Spring Cloud Config</td>
</tr>
<tr>
<td>æœåŠ¡ç½‘å…³</td>
<td>Ingress Controller</td>
<td>Spring Cloud Zuul</td>
</tr>
<tr>
<td>è´Ÿè½½å‡è¡¡</td>
<td>Load Balancer</td>
<td>Spring Cloud Ribbon</td>
</tr>
<tr>
<td>æœåŠ¡å®‰å…¨</td>
<td>RBAC API</td>
<td>Spring Cloud Security</td>
</tr>
<tr>
<td>è·Ÿè¸ªç›‘æ§</td>
<td>Metrics API &#x2F; Dashboard</td>
<td>Spring Cloud Turbine</td>
</tr>
<tr>
<td>é™çº§ç†”æ–­</td>
<td>N&#x2F;A</td>
<td>Spring Cloud Hystrix</td>
</tr>
<tr>
<td>åŸºç¡€è®¾æ–½ç®¡ç†ç²’åº¦ç²—æ—·ï¼Œåªèƒ½åˆ°å®¹å™¨å±‚é¢ï¼Œå¯¹å•ä¸ªè¿œç¨‹æœåŠ¡å°±å¾ˆéš¾æœ‰æ•ˆç®¡æ§ã€‚å¯¹äºè¿™ä¸€ç±»çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯<strong>æœåŠ¡ç½‘æ ¼</strong>ï¼ˆ18å¹´ç«èµ·æ¥ï¼‰ã€‚å…·ä½“å«ä¹‰æ˜¯ç”±ç³»ç»Ÿè‡ªåŠ¨åœ¨æœåŠ¡å®¹å™¨ï¼ˆé€šå¸¸æ˜¯æŒ‡ Kubernetes çš„ Podï¼‰ä¸­æ³¨å…¥ä¸€ä¸ªé€šä¿¡ä»£ç†æœåŠ¡å™¨ï¼Œç›¸å½“äºé‚£ä¸ªæŒæ–—ï¼Œä»¥ç±»ä¼¼ç½‘ç»œå®‰å…¨é‡Œä¸­é—´äººæ”»å‡»çš„æ–¹å¼è¿›è¡Œæµé‡åŠ«æŒï¼Œåœ¨åº”ç”¨æ¯«æ— æ„ŸçŸ¥çš„æƒ…å†µä¸‹ï¼Œæ‚„ç„¶æ¥ç®¡åº”ç”¨æ‰€æœ‰å¯¹å¤–é€šä¿¡ã€‚æœåŠ¡ç½‘æ ¼æœ€ç»ˆä¼šå–ä»£Spring Cloudå…¨å®¶æ¡¶å¤§éƒ¨åˆ†ç»„ä»¶çš„èƒ½åŠ›ã€‚</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>ä¸šåŠ¡ã€æŠ€æœ¯å®Œå…¨åˆ†ç¦»ã€è¿œç¨‹å’Œæœ¬åœ°å®Œå…¨é€æ˜ã€‚</p>
<h2 id="æ— æœåŠ¡æ—¶ä»£"><a href="#æ— æœåŠ¡æ—¶ä»£" class="headerlink" title="æ— æœåŠ¡æ—¶ä»£"></a>æ— æœåŠ¡æ—¶ä»£</h2><blockquote>
<p><strong>æ— æœåŠ¡æ¶æ„ï¼ˆServerlessï¼‰</strong><br>å¦‚æœè¯´å¾®æœåŠ¡æ¶æ„æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿè¿™æ¡è·¯çš„æè‡´ï¼Œé‚£æ— æœåŠ¡æ¶æ„ï¼Œä¹Ÿè®¸å°±æ˜¯â€œä¸åˆ†å¸ƒå¼â€çš„äº‘ç«¯ç³»ç»Ÿè¿™æ¡è·¯çš„èµ·ç‚¹ã€‚</p>
</blockquote>
<p>2012å¹´æå‡ºï¼Œä»¥â€œç®€å•â€ä¸ºä¸»è¦å–ç‚¹çš„ï¼Œå®ƒåªæ¶‰åŠä¸¤å—å†…å®¹ï¼šåç«¯è®¾æ–½ï¼ˆBackendï¼‰å’Œå‡½æ•°ï¼ˆFunctionï¼‰ã€‚</p>
<ul>
<li><strong>åç«¯è®¾æ–½</strong>ï¼šæŒ‡æ•°æ®åº“ã€æ¶ˆæ¯é˜Ÿåˆ—ã€æ—¥å¿—ã€å­˜å‚¨ï¼Œç­‰ç­‰è¿™ä¸€ç±»ç”¨äºæ”¯æ’‘ä¸šåŠ¡é€»è¾‘è¿è¡Œï¼Œä½†æœ¬èº«æ— ä¸šåŠ¡å«ä¹‰çš„æŠ€æœ¯ç»„ä»¶ï¼Œè¿™äº›åç«¯è®¾æ–½éƒ½è¿è¡Œåœ¨äº‘ä¸­ï¼Œæ— æœåŠ¡ä¸­ç§°å…¶ä¸ºâ€œåç«¯å³æœåŠ¡â€ï¼ˆBackend as a Serviceï¼ŒBaaSï¼‰ã€‚</li>
<li><strong>å‡½æ•°</strong>ï¼šæŒ‡ä¸šåŠ¡é€»è¾‘ä»£ç ï¼Œè¿™é‡Œå‡½æ•°çš„æ¦‚å¿µä¸ç²’åº¦ï¼Œéƒ½å·²ç»å¾ˆæ¥è¿‘äºç¨‹åºç¼–ç è§’åº¦çš„å‡½æ•°äº†ï¼Œå…¶åŒºåˆ«æ˜¯æ— æœåŠ¡ä¸­çš„å‡½æ•°è¿è¡Œåœ¨äº‘ç«¯ï¼Œä¸å¿…è€ƒè™‘ç®—åŠ›é—®é¢˜ï¼Œä¸å¿…è€ƒè™‘å®¹é‡è§„åˆ’ï¼Œæ— æœåŠ¡ä¸­ç§°å…¶ä¸ºâ€œå‡½æ•°å³æœåŠ¡â€ï¼ˆFunction as a Serviceï¼ŒFaaSï¼‰ã€‚</li>
</ul>
<p>å¦‚æœè¯´å¾®æœåŠ¡æ¶æ„æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿè¿™æ¡è·¯å½“å‰æ‰€èƒ½åšåˆ°çš„æè‡´ï¼Œé‚£æ— æœåŠ¡æ¶æ„ï¼Œä¹Ÿè®¸å°±æ˜¯â€œä¸åˆ†å¸ƒå¼â€çš„äº‘ç«¯ç³»ç»Ÿè¿™æ¡è·¯çš„èµ·ç‚¹ã€‚</p>
<h1 id="æ¶æ„å¸ˆçš„è§†è§’"><a href="#æ¶æ„å¸ˆçš„è§†è§’" class="headerlink" title="æ¶æ„å¸ˆçš„è§†è§’"></a>æ¶æ„å¸ˆçš„è§†è§’</h1><h2 id="è®¿é—®è¿œç¨‹æœåŠ¡"><a href="#è®¿é—®è¿œç¨‹æœåŠ¡" class="headerlink" title="è®¿é—®è¿œç¨‹æœåŠ¡"></a>è®¿é—®è¿œç¨‹æœåŠ¡</h2><p><strong>è¿œç¨‹æœåŠ¡</strong>å°†è®¡ç®—æœºç¨‹åºçš„å·¥ä½œèŒƒå›´ä»å•æœºæ‰©å±•åˆ°ç½‘ç»œï¼Œä»æœ¬åœ°å»¶ä¼¸è‡³è¿œç¨‹ï¼Œæ˜¯æ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿçš„é¦–è¦åŸºç¡€</p>
<h3 id="è¿œç¨‹æœåŠ¡è°ƒç”¨"><a href="#è¿œç¨‹æœåŠ¡è°ƒç”¨" class="headerlink" title="è¿œç¨‹æœåŠ¡è°ƒç”¨"></a>è¿œç¨‹æœåŠ¡è°ƒç”¨</h3><p>Remote Procedure Callï¼ŒRPCï¼Œæœ€å¼€å§‹ï¼Œå°±æ˜¯<strong>ä¸ºäº†è®©è®¡ç®—æœºèƒ½å¤Ÿè·Ÿè°ƒç”¨æœ¬åœ°æ–¹æ³•ä¸€æ ·å»è°ƒç”¨è¿œç¨‹æ–¹æ³•</strong>ã€‚</p>
<p>è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰çš„å¸¸ç”¨æ–¹æ³•ï¼š</p>
<ul>
<li>ç®¡é“ï¼šé€šè¿‡ç®¡é“åœ¨è¿›ç¨‹é—´ä¼ é€’å°‘é‡çš„å­—ç¬¦æµæˆ–å­—èŠ‚æµ</li>
<li>ä¿¡å·ï¼šé€šçŸ¥ç›®æ ‡è¿›ç¨‹æœ‰äº‹ä»¶å‘ç”Ÿï¼Œæ¯”å¦‚kill</li>
<li>ä¿¡å·é‡ï¼šæ“ä½œç³»ç»Ÿçš„ç‰¹æ®Šå˜é‡</li>
<li>æ¶ˆæ¯é˜Ÿåˆ—ï¼šç”¨äºè¿›ç¨‹é—´æ•°æ®é‡è¾ƒå¤šçš„é€šä¿¡</li>
<li>å…±äº«å†…å­˜ï¼šå¤šä¸ªè¿›ç¨‹è®¿é—®åŒä¸€å—å…¬å…±çš„å†…å­˜ç©ºé—´ï¼Œæ•ˆç‡æœ€é«˜</li>
<li>å¥—æ¥å­—æ¥å£ï¼šå¯ç”¨äºä¸åŒæœºå™¨ä¹‹é—´çš„è¿›ç¨‹é€šä¿¡</li>
</ul>
<h4 id="é€šä¿¡çš„æˆæœ¬"><a href="#é€šä¿¡çš„æˆæœ¬" class="headerlink" title="é€šä¿¡çš„æˆæœ¬"></a>é€šä¿¡çš„æˆæœ¬</h4><p>RPCå°±æ˜¯IPCçš„ç‰¹ä¾‹ï¼Œæ—©æœŸé€æ˜çš„è°ƒç”¨å½¢å¼é€ æˆç¨‹åºå‘˜è¯¯ä»¥ä¸º<strong>é€šä¿¡æ— æˆæœ¬</strong><br>åç»­æå‡ºäº†è¿™ç§é€æ˜è°ƒç”¨å½¢å¼æ˜¯æ–¹å‘æ€§é”™è¯¯ï¼ŒRPCä¸åŒäºIPCï¼Œå®ƒæ˜¯ä¸€ç§é«˜å±‚æ¬¡çš„ç‰¹å¾ã€‚<br>20ä¸–çºª80å¹´ä»£ï¼Œä¸–ç•Œä¸Šç¬¬ä¸€ä¸ªåŸºäºRPCçš„å•†ä¸šåº”ç”¨Courierã€‚<br><strong>è¿œç¨‹æœåŠ¡è°ƒç”¨</strong>æ˜¯æŒ‡ä½äºäº’ä¸é‡åˆçš„å†…å­˜åœ°å€ç©ºé—´ä¸­çš„ä¸¤ä¸ªç¨‹åºï¼Œåœ¨è¯­è¨€å±‚é¢ä¸Šï¼Œä»¥åŒæ­¥çš„æ–¹å¼ä½¿ç”¨å¸¦å®½æœ‰é™çš„ä¿¡é“æ¥ä¼ è¾“ç¨‹åºæ§åˆ¶ä¿¡æ¯ã€‚</p>
<h4 id="ä¸‰ä¸ªåŸºæœ¬é—®é¢˜"><a href="#ä¸‰ä¸ªåŸºæœ¬é—®é¢˜" class="headerlink" title="ä¸‰ä¸ªåŸºæœ¬é—®é¢˜"></a>ä¸‰ä¸ªåŸºæœ¬é—®é¢˜</h4><p>RPCåè®®ä¸»è¦å°±æ˜¯è§£å†³ä¸‰ä¸ªåŸºæœ¬é—®é¢˜ï¼š</p>
<ul>
<li>å¦‚ä½•è¡¨ç¤ºæ•°æ®ï¼šè¦æœ‰åºåˆ—åŒ–åè®®æŠŠæ•°æ®è½¬åŒ–ä¸ºä¸­ç«‹çš„æ•°æ®æµæ ¼å¼</li>
<li>å¦‚ä½•ä¼ é€’æ•°æ®ï¼šåº”ç”¨å±‚åè®®ï¼ŒWire Potocol</li>
<li>å¦‚ä½•è¡¨ç¤ºæ–¹æ³•ï¼šæœ‰è·¨è¯­è¨€çš„ç»Ÿä¸€æ ‡å‡†å»æ‰¾æ–¹æ³•</li>
</ul>
<h4 id="ç»Ÿä¸€çš„RPC"><a href="#ç»Ÿä¸€çš„RPC" class="headerlink" title="ç»Ÿä¸€çš„RPC"></a>ç»Ÿä¸€çš„RPC</h4><ul>
<li>CORBAï¼šå¤ªç½—å—¦ï¼Œå†™ä¸€ä¸ªå¯¹è±¡è¯·æ±‚ä»£ç†å¤§æ¦‚è¦ 200 è¡Œä»£ç ï¼Œå…¶ä¸­å¤§æ¦‚æœ‰ 170 è¡Œéƒ½æ˜¯çº¯ç²¹æ— ç”¨çš„åºŸè¯</li>
<li>W3C Web Serviceï¼šé‡‡ç”¨äº† XML ä½œä¸ºè¿œç¨‹è¿‡ç¨‹è°ƒç”¨çš„åºåˆ—åŒ–ã€æ¥å£æè¿°ã€æœåŠ¡å‘ç°ç­‰æ‰€æœ‰ç¼–ç çš„è½½ä½“ï¼Œå½“æ—¶ XML æ˜¯è®¡ç®—æœºå·¥ä¸šæœ€æ–°çš„é“¶å¼¹ï¼Œåªè¦æ˜¯å®šä¹‰ä¸º XML çš„ä¸œè¥¿å‡ ä¹å°±éƒ½è¢«è®¤ä¸ºæ˜¯å¥½çš„ï¼Œé£å¤´ä¸€æ—¶æ— ä¸¤ã€‚æ€§èƒ½æœ‰é—®é¢˜ï¼Œè€Œä¸”è´ªå©ªï¼Œæœ‰ä¸€å †åè®®<br>ç®€å•ã€æ™®é€‚ã€é«˜æ€§èƒ½è¿™ä¸‰ç‚¹ï¼Œä¼¼ä¹çœŸçš„éš¾ä»¥åŒæ—¶æ»¡è¶³</li>
</ul>
<h4 id="åˆ†è£‚çš„RPC"><a href="#åˆ†è£‚çš„RPC" class="headerlink" title="åˆ†è£‚çš„RPC"></a>åˆ†è£‚çš„RPC</h4><ul>
<li>é¢å‘å¯¹è±¡ï¼šRMIã€.NET Remotingã€CORBA å’Œ DCOM</li>
<li>æ€§èƒ½ï¼šgRPCã€Thriftã€‚ä¸€æ˜¯ä¸“æœ‰åºåˆ—åŒ–å™¨ï¼ŒäºŒæ˜¯ä¼ è¾“åè®®æ–¹é¢ï¼ŒgRPC æ˜¯åŸºäº HTTP&#x2F;2 çš„ï¼Œæ”¯æŒå¤šè·¯å¤ç”¨å’Œ Header å‹ç¼©ï¼ŒThrift åˆ™ç›´æ¥åŸºäºä¼ è¾“å±‚çš„ TCP åè®®æ¥å®ç°ï¼Œçœå»äº†é¢å¤–åº”ç”¨å±‚åè®®çš„å¼€é”€</li>
<li>ç®€åŒ–ï¼šJSON-RPCï¼Œç‰ºç‰²äº†åŠŸèƒ½å’Œæ•ˆç‡ï¼Œæ¢æ¥çš„æ˜¯åè®®çš„ç®€å•è½»ä¾¿ï¼Œæ¥å£ä¸æ ¼å¼éƒ½æ›´ä¸ºé€šç”¨</li>
</ul>
<p>ç›®å‰é€æ¸æœç€æ’ä»¶åŒ–çš„èƒ½åŠ›æ”¯æŒï¼Œæ¯”å¦‚Dubboï¼Œä¼ è¾“åè®®ã€åºåˆ—åŒ–å™¨éƒ½å¯ä»¥è°ƒæ•´ã€‚</p>
<h3 id="RESTè®¾è®¡é£æ ¼"><a href="#RESTè®¾è®¡é£æ ¼" class="headerlink" title="RESTè®¾è®¡é£æ ¼"></a>RESTè®¾è®¡é£æ ¼</h3><p>Â <strong>REST å¹¶ä¸æ˜¯ä¸€ç§è¿œç¨‹æœåŠ¡è°ƒç”¨åè®®ï¼Œä¹Ÿä¸æ˜¯ä¸€ç§åè®®ï¼Œæ˜¯ä¸€ç§é£æ ¼</strong></p>
<h4 id="ç†è§£REST"><a href="#ç†è§£REST" class="headerlink" title="ç†è§£REST"></a>ç†è§£REST</h4><p>â€œRESTâ€ï¼ˆ<strong>Re</strong>presentationalÂ <strong>S</strong>tateÂ <strong>T</strong>ransferï¼‰å®é™…ä¸Šæ˜¯â€œHTTâ€ï¼ˆ<strong>H</strong>yper<strong>t</strong>extÂ <strong>T</strong>ransferï¼‰çš„è¿›ä¸€æ­¥æŠ½è±¡ï¼Œä¸¤è€…å°±å¦‚åŒæ¥å£ä¸å®ç°ç±»çš„å…³ç³»ä¸€èˆ¬ã€‚è¶…æ–‡æœ¬å³èƒ½å¤Ÿè¿›è¡Œåˆ†æ”¯åˆ¤æ–­å’Œå·®å¼‚å“åº”çš„æ–‡æœ¬ã€‚</p>
<p>ä¸€ä¸ªé˜…è¯»æ–‡ç« çš„ä¾‹å­æ¥çœ‹RESTï¼š</p>
<ul>
<li>èµ„æºï¼šè¿™ä¸ªæ–‡ç« å°±æ˜¯èµ„æº</li>
<li>è¡¨å¾ï¼šæ–‡ç« çš„æ ¼å¼å°±æ˜¯è¡¨å¾</li>
<li>çŠ¶æ€ï¼šæˆ‘è¦çœ‹ä¸‹ä¸€ç¯‡ï¼Œå¯¹äºæœåŠ¡å™¨åˆ†ä¸ºæœ‰çŠ¶æ€ã€æ— çŠ¶æ€ï¼Œä¸»è¦çœ‹å®ƒè¦ä¸è¦è®°ä½ç°åœ¨çš„</li>
<li>è½¬ç§»ï¼šæœåŠ¡å™¨é€šè¿‡æŸç§æ–¹å¼è½¬ç§»çŠ¶æ€</li>
</ul>
<p>ç›¸å…³æ¦‚å¿µåå­—ï¼š</p>
<ul>
<li>ç»Ÿä¸€æ¥å£ï¼šURLæ˜¯èµ„æºï¼ŒHTTPåè®®ç»Ÿä¸€æ¥å£ï¼Œå…¶ä¸­åŸºæœ¬æ“ä½œï¼Œè§¦å‘è¡¨å¾çŠ¶æ€è½¬ç§»</li>
<li>è¶…æ–‡æœ¬é©±åŠ¨ï¼šä»»ä½•ç½‘ç«™å¯¼èˆªè¡Œä¸ºéƒ½æ˜¯ç”±æœåŠ¡å™¨å‘å‡ºçš„è¯·æ±‚å“åº”ä¿¡æ¯ï¼ˆè¶…æ–‡æœ¬ï¼‰é©±åŠ¨çš„</li>
<li>è‡ªæè¿°ä¿¡æ¯ï¼šæ¶ˆæ¯ç±»å‹å’Œå¤„ç½®æ–¹æ³•ï¼Œæ¯”å¦‚äº’è”ç½‘åª’ä½“ç±»å‹ã€UTF-8æ ¼å¼</li>
</ul>
<h4 id="RESTfulçš„ç³»ç»Ÿ"><a href="#RESTfulçš„ç³»ç»Ÿ" class="headerlink" title="RESTfulçš„ç³»ç»Ÿ"></a>RESTfulçš„ç³»ç»Ÿ</h4><p>å…­å¤§è®¾è®¡åŸåˆ™ï¼š</p>
<ul>
<li>æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯åˆ†ç¦»ï¼šå‰ç«¯æŠ€æœ¯å‘å±•</li>
<li>æ— çŠ¶æ€ï¼šæœåŠ¡å™¨ä¸è¦è´Ÿè´£ç»´æŠ¤çŠ¶æ€ï¼Œå¤§å¤šæ•°è¾¾ä¸åˆ°</li>
<li>å¯ç¼“å­˜ï¼šé€šè®¯ä¼ é€’è€…æŠŠéƒ¨åˆ†åº”ç”¨ç¼“å­˜èµ·æ¥</li>
<li>åˆ†å±‚ç³»ç»Ÿï¼šå®¢æˆ·ç«¯ä¸€èˆ¬ä¸éœ€è¦çŸ¥é“æ˜¯å¦ç›´æ¥è¿æ¥åˆ°äº†æœ€ç»ˆçš„æœåŠ¡å™¨ï¼ŒæŠ‘æˆ–è¿æ¥åˆ°è·¯å¾„ä¸Šçš„ä¸­é—´æœåŠ¡å™¨ï¼Œæ¯”å¦‚CDN</li>
<li>ç»Ÿä¸€æ¥å£ï¼šç»Ÿä¸€æ¥å£çš„æ–¹å¼ï¼Œç³»ç»Ÿåº”èƒ½åšåˆ°æ¯æ¬¡è¯·æ±‚ä¸­éƒ½åŒ…å«èµ„æºçš„ IDï¼Œæ‰€æœ‰æ“ä½œå‡é€šè¿‡èµ„æº ID æ¥è¿›è¡Œï¼›å»ºè®®æ¯ä¸ªèµ„æºéƒ½åº”è¯¥æ˜¯è‡ªæè¿°çš„æ¶ˆæ¯ï¼›å»ºè®®é€šè¿‡è¶…æ–‡æœ¬æ¥é©±åŠ¨åº”ç”¨çŠ¶æ€çš„è½¬ç§»</li>
<li>æŒ‰éœ€ä»£ç ï¼šå¯é€‰åŸåˆ™ï¼Œå°†å¯æ‰§è¡Œçš„è½¯ä»¶ç¨‹åºä»æœåŠ¡å™¨å‘é€åˆ°å®¢æˆ·ç«¯çš„æŠ€æœ¯</li>
</ul>
<p>REST çš„åŸºæœ¬æ€æƒ³æ˜¯é¢å‘èµ„æºæ¥æŠ½è±¡é—®é¢˜ï¼Œå®ƒä¸æ­¤å‰æµè¡Œçš„ç¼–ç¨‹æ€æƒ³â€”â€”é¢å‘è¿‡ç¨‹çš„ç¼–ç¨‹åœ¨æŠ½è±¡ä¸»ä½“ä¸Šæœ‰æœ¬è´¨çš„å·®åˆ«ã€‚åœ¨ REST æå‡ºä»¥å‰ï¼Œäººä»¬è®¾è®¡åˆ†å¸ƒå¼ç³»ç»ŸæœåŠ¡çš„å”¯ä¸€æ–¹æ¡ˆå°±åªæœ‰ RPCï¼ŒRPC æ˜¯å°†æœ¬åœ°çš„æ–¹æ³•è°ƒç”¨æ€è·¯è¿ç§»åˆ°è¿œç¨‹æ–¹æ³•è°ƒç”¨ä¸Šï¼Œå¼€å‘è€…æ˜¯å›´ç»•ç€â€œè¿œç¨‹æ–¹æ³•â€å»è®¾è®¡ä¸¤ä¸ªç³»ç»Ÿé—´äº¤äº’çš„ï¼Œè­¬å¦‚ CORBAã€RMIã€DCOMï¼Œç­‰ç­‰ã€‚æœåŠ¡çš„æ¯ä¸ªæ–¹æ³•éƒ½æ˜¯å®Œå…¨ç‹¬ç«‹çš„ï¼ŒæœåŠ¡ä½¿ç”¨è€…å¿…é¡»é€ä¸ªå­¦ä¹ æ‰èƒ½æ­£ç¡®åœ°ä½¿ç”¨å®ƒä»¬ã€‚</p>
<p>REST æå‡ºä»¥èµ„æºä¸ºä¸»ä½“è¿›è¡ŒæœåŠ¡è®¾è®¡çš„é£æ ¼ï¼Œèƒ½ä¸ºå®ƒå¸¦æ¥ä¸å°‘å¥½å¤„ï¼š</p>
<ul>
<li>é™ä½æœåŠ¡æ¥å£çš„å­¦ä¹ æˆæœ¬ï¼šç»Ÿä¸€æ¥å£ï¼Œå…¨éƒ¨æ˜ å°„åˆ°HTTP</li>
<li>èµ„æºå¤©ç„¶å…·æœ‰é›†åˆä¸å±‚æ¬¡ç»“æ„ï¼šèµ„æºæœ‰å±‚æ¬¡å…³ç³»ï¼Œç¬¦åˆäººçš„ç›´è§‰</li>
<li>RESTç»‘å®šäºHTTPåè®®ï¼šHTTP æœ¬æ¥å°±æ˜¯é¢å‘èµ„æºè€Œè®¾è®¡çš„ç½‘ç»œåè®®</li>
</ul>
<p>åœ¨äº’è”ç½‘ä¸­ï¼Œé¢å‘èµ„æºæ¥è¿›è¡Œç½‘ç»œä¼ è¾“æ˜¯è¿™ä¸‰åå¹´æ¥ HTTP åè®®ç²¾å¿ƒåŸ¹å…»å‡ºæ¥çš„ç”¨æˆ·ä¹ æƒ¯ï¼Œå¦‚æœå¼€å‘è€…èƒ½å¤Ÿé€‚åº” REST ä¸å¤ªç¬¦åˆäººç±»æ€ç»´ä¹ æƒ¯çš„æŠ½è±¡æ–¹å¼ï¼Œé‚£ REST é€šå¸¸èƒ½å¤Ÿæ›´å¥½åœ°åŒ¹é…åœ¨ HTTP åŸºç¡€ä¸Šæ„å»ºçš„äº’è”ç½‘ï¼Œåœ¨æ•ˆç‡ä¸æ‰©å±•æ€§æ–¹é¢ä¼šæœ‰å¯è§‚çš„æ”¶ç›Šã€‚</p>
<h4 id="RMMæˆç†Ÿåº¦"><a href="#RMMæˆç†Ÿåº¦" class="headerlink" title="RMMæˆç†Ÿåº¦"></a>RMMæˆç†Ÿåº¦</h4><p>å¦‚ä½•è¯„ä»·æœåŠ¡æ˜¯å¦ RESTfulï¼Œåˆ†ä¸º0åˆ°3çº§ï¼š</p>
<ol start="0">
<li>The Swamp ofÂ <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Plain_Old_XML">Plain Old XML</a>ï¼šå®Œå…¨ä¸ RESTã€‚å¦å¤–ï¼Œå…³äº Plain Old XML è¿™è¯´æ³•ï¼ŒSOAP è¡¨ç¤º<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%84%9F%E8%A7%89%E6%9C%89%E8%A2%AB%E5%86%92%E7%8A%AF%E5%88%B0">æ„Ÿè§‰æœ‰è¢«å†’çŠ¯åˆ°</a>ã€‚</li>
<li>Resourcesï¼šå¼€å§‹å¼•å…¥èµ„æºçš„æ¦‚å¿µã€‚</li>
<li>HTTP Verbsï¼šå¼•å…¥ç»Ÿä¸€æ¥å£ï¼Œæ˜ å°„åˆ° HTTP åè®®çš„æ–¹æ³•ä¸Šã€‚</li>
<li>Hypermedia Controlsï¼šè¶…åª’ä½“æ§åˆ¶åœ¨æœ¬æ–‡é‡Œé¢çš„è¯´æ³•æ˜¯â€œè¶…æ–‡æœ¬é©±åŠ¨â€ï¼Œåœ¨ Fielding è®ºæ–‡é‡Œçš„è¯´æ³•æ˜¯â€œHypertext As The Engine Of Application Stateï¼ŒHATEOASâ€ï¼Œå…¶å®éƒ½æ˜¯æŒ‡åŒä¸€ä»¶äº‹æƒ…ã€‚é™¤äº†ç¬¬ä¸€ä¸ªè¯·æ±‚æ˜¯ç”±ä½ åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥æ‰€é©±åŠ¨ä¹‹å¤–ï¼Œå…¶ä»–çš„è¯·æ±‚éƒ½åº”è¯¥èƒ½å¤Ÿè‡ªå·±æè¿°æ¸…æ¥šåç»­å¯èƒ½å‘ç”Ÿçš„çŠ¶æ€è½¬ç§»ï¼Œç”±è¶…æ–‡æœ¬è‡ªèº«æ¥é©±åŠ¨ã€‚</li>
</ol>
<h4 id="ä¸è¶³ä¸äº‰è®®"><a href="#ä¸è¶³ä¸äº‰è®®" class="headerlink" title="ä¸è¶³ä¸äº‰è®®"></a>ä¸è¶³ä¸äº‰è®®</h4><ul>
<li>é¢å‘è¿‡ç¨‹ç¼–ç¨‹æ—¶ï¼Œä¸ºä»€ä¹ˆè¦ä»¥ç®—æ³•å’Œå¤„ç†è¿‡ç¨‹ä¸ºä¸­å¿ƒï¼Œè¾“å…¥æ•°æ®ï¼Œè¾“å‡ºç»“æœï¼Ÿå½“ç„¶æ˜¯ä¸ºäº†ç¬¦åˆè®¡ç®—æœºä¸–ç•Œä¸­ä¸»æµçš„äº¤äº’æ–¹å¼ã€‚</li>
<li>é¢å‘å¯¹è±¡ç¼–ç¨‹æ—¶ï¼Œä¸ºä»€ä¹ˆè¦å°†æ•°æ®å’Œè¡Œä¸ºç»Ÿä¸€èµ·æ¥ã€å°è£…æˆå¯¹è±¡ï¼Ÿå½“ç„¶æ˜¯ä¸ºäº†ç¬¦åˆç°å®ä¸–ç•Œçš„ä¸»æµçš„äº¤äº’æ–¹å¼ã€‚</li>
<li>é¢å‘èµ„æºç¼–ç¨‹æ—¶ï¼Œä¸ºä»€ä¹ˆè¦å°†æ•°æ®ï¼ˆèµ„æºï¼‰ä½œä¸ºæŠ½è±¡çš„ä¸»ä½“ï¼ŒæŠŠè¡Œä¸ºçœ‹ä½œæ˜¯ç»Ÿä¸€çš„æ¥å£ï¼Ÿå½“ç„¶æ˜¯ä¸ºäº†ç¬¦åˆç½‘ç»œä¸–ç•Œçš„ä¸»æµçš„äº¤äº’æ–¹å¼ã€‚</li>
</ul>
<h2 id="äº‹åŠ¡å¤„ç†"><a href="#äº‹åŠ¡å¤„ç†" class="headerlink" title="äº‹åŠ¡å¤„ç†"></a>äº‹åŠ¡å¤„ç†</h2><p>æ•°æ®åº“çš„ç»å…¸ç†è®ºï¼š</p>
<ul>
<li><strong>åŸå­æ€§</strong>ï¼ˆ<strong>A</strong>tomicï¼‰ï¼šåœ¨åŒä¸€é¡¹ä¸šåŠ¡å¤„ç†è¿‡ç¨‹ä¸­ï¼Œäº‹åŠ¡ä¿è¯äº†å¯¹å¤šä¸ªæ•°æ®çš„ä¿®æ”¹ï¼Œè¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶è¢«æ’¤é”€ã€‚</li>
<li><strong>ä¸€è‡´æ€§</strong>ï¼ˆ<strong>C</strong>onsistencyï¼‰ï¼šæ•°æ®éƒ½æ˜¯ç¬¦åˆæœŸæœ›çš„ï¼Œä¸”ç›¸äº’å…³è”çš„æ•°æ®ä¹‹é—´ä¸ä¼šäº§ç”ŸçŸ›ç›¾</li>
<li><strong>éš”ç¦»æ€§</strong>ï¼ˆ<strong>I</strong>solationï¼‰ï¼šåœ¨ä¸åŒçš„ä¸šåŠ¡å¤„ç†è¿‡ç¨‹ä¸­ï¼Œäº‹åŠ¡ä¿è¯äº†å„è‡ªä¸šåŠ¡æ­£åœ¨è¯»ã€å†™çš„æ•°æ®äº’ç›¸ç‹¬ç«‹ï¼Œä¸ä¼šå½¼æ­¤å½±å“ã€‚</li>
<li><strong>æŒä¹…æ€§</strong>ï¼ˆ<strong>D</strong>urabilityï¼‰ï¼šäº‹åŠ¡åº”å½“ä¿è¯æ‰€æœ‰æˆåŠŸè¢«æäº¤çš„æ•°æ®ä¿®æ”¹éƒ½èƒ½å¤Ÿæ­£ç¡®åœ°è¢«æŒä¹…åŒ–ï¼Œä¸ä¸¢å¤±æ•°æ®ã€‚</li>
</ul>
<p>å…¶å®ACIDå¹¶ä¸æ­£äº¤ï¼ŒAã€Iã€Sæ˜¯æ‰‹æ®µï¼ŒCæ˜¯ç›®çš„ã€‚</p>
<p>å†…éƒ¨ä¸€è‡´æ€§ï¼šåŒä¸€ä¸ªæ•°æ®æº<br>å¤–éƒ¨ä¸€è‡´æ€§ï¼šå¤šä¸ªä¸åŒçš„æ•°æ®æº</p>
<p>å¤–éƒ¨ä¸€è‡´æ€§å°±å¾ˆéš¾é€šè¿‡AIDè§£å†³äº†ï¼Œå°†Cä»äºŒå…ƒè½¬å˜ä¸ºå¤šå…ƒå±æ€§</p>
<h3 id="æœ¬åœ°äº‹åŠ¡"><a href="#æœ¬åœ°äº‹åŠ¡" class="headerlink" title="æœ¬åœ°äº‹åŠ¡"></a>æœ¬åœ°äº‹åŠ¡</h3><p><strong>æœ¬åœ°äº‹åŠ¡</strong>æ˜¯æŒ‡ä»…æ“ä½œå•ä¸€äº‹åŠ¡èµ„æºçš„ã€ä¸éœ€è¦å…¨å±€äº‹åŠ¡ç®¡ç†å™¨è¿›è¡Œåè°ƒçš„äº‹åŠ¡ã€‚é€‚ç”¨äºå•ä¸ªæœåŠ¡ä½¿ç”¨å•ä¸ªæ•°æ®æºçš„åœºæ™¯ã€‚<br>ç›´æ¥ä¾èµ–äºæ•°æ®æºæœ¬èº«çš„äº‹åŠ¡èƒ½åŠ›æ¥å·¥ä½œã€‚</p>
<h4 id="å®ç°åŸå­æ€§å’ŒæŒä¹…æ€§"><a href="#å®ç°åŸå­æ€§å’ŒæŒä¹…æ€§" class="headerlink" title="å®ç°åŸå­æ€§å’ŒæŒä¹…æ€§"></a>å®ç°åŸå­æ€§å’ŒæŒä¹…æ€§</h4><p>Commit Loggingæ–¹æ³•</p>
<ul>
<li>æœ€å¤§å›°éš¾ï¼šâ€œå†™å…¥ç£ç›˜â€è¿™ä¸ªæ“ä½œå¹¶ä¸æ˜¯åŸå­çš„ï¼Œä¸ä»…æœ‰â€œå†™å…¥â€ä¸â€œæœªå†™å…¥â€çŠ¶æ€ï¼Œè¿˜å®¢è§‚åœ°å­˜åœ¨ç€â€œæ­£åœ¨å†™â€çš„ä¸­é—´çŠ¶æ€ã€‚</li>
<li>å®ç°æ–¹æ³•ï¼šä¸ç›´æ¥è¯¥ï¼Œè€Œä¸”å†™åˆ°æ—¥å¿—é‡Œï¼Œæ—¥å¿—å†è¿›è¡ŒæŒä¹…åŒ–ï¼Œå³Commit Loggingâ€ï¼ˆæäº¤æ—¥å¿—ï¼‰æ–¹æ³•</li>
<li>å·¨å¤§ç¼ºé™·ï¼šçœŸå®ä¿®æ”¹éƒ½å¿…é¡»å‘ç”Ÿåœ¨äº‹åŠ¡æäº¤ä»¥åï¼Œå¯¹æå‡æ•°æ®åº“çš„æ€§èƒ½ååˆ†ä¸åˆ©ã€‚</li>
</ul>
<p>Write-Aheadæ–¹æ³•ï¼ˆå…è®¸åœ¨äº‹åŠ¡æäº¤ä¹‹å‰ï¼Œæå‰å†™å…¥å˜åŠ¨æ•°æ®ï¼‰<br>å°†ä½•æ—¶å†™å…¥å˜åŠ¨æ•°æ®ï¼ŒæŒ‰ç…§äº‹åŠ¡æäº¤æ—¶ç‚¹ä¸ºç•Œï¼Œåˆ’åˆ†ä¸º FORCE å’Œ STEAL ä¸¤ç±»æƒ…å†µã€‚</p>
<ul>
<li>FORCEï¼šæäº¤ä¹‹åå¿…é¡»åŒæ—¶å†™å…¥ï¼Œä¸å¼ºåˆ¶åŒæ—¶å°±æ˜¯NO-FORCE</li>
<li>STEALï¼šæäº¤å‰ï¼Œå…è®¸å˜åŠ¨æ•°æ®æå‰å†™å…¥ï¼Œä¸å…è®¸æ˜¯NO-STEAL</li>
</ul>
<p>Commit Loggingå…è®¸ NO-FORCEï¼Œä½†ä¸å…è®¸ STEALã€‚<br>Write-Ahead Logging å…è®¸ NO-FORCEï¼Œä¹Ÿå…è®¸ STEALã€‚å¢åŠ äº†Undo Logï¼Œè¡¨æ˜ä¿®æ”¹æƒ…å†µï¼Œä¾¿äºå›æ»šã€‚<br>Undo Logï¼šå›æ»šæ—¥å¿—&#x2F; Redo Logï¼šé‡åšæ—¥å¿—ã€‚</p>
<p>Write-Ahead Loggingä¸‰é˜¶æ®µæ“ä½œï¼š</p>
<ul>
<li><strong>åˆ†æé˜¶æ®µ</strong>ï¼šä»æœ€åä¸€æ¬¡æ£€æŸ¥ç‚¹æ‰«æï¼Œç»„æˆé›†åˆ</li>
<li><strong>é‡åšé˜¶æ®µ</strong>ï¼šä¾æ®åˆ†æé˜¶æ®µä¸­äº§ç”Ÿçš„å¾…æ¢å¤çš„äº‹åŠ¡é›†åˆæ¥é‡æ¼”å†å²</li>
<li><strong>å›æ»šé˜¶æ®µ</strong>ï¼šå¤„ç†ç»è¿‡åˆ†æã€é‡åšé˜¶æ®µåå‰©ä½™çš„æ¢å¤äº‹åŠ¡é›†åˆ</li>
</ul>
<h4 id="å®ç°éš”ç¦»æ€§"><a href="#å®ç°éš”ç¦»æ€§" class="headerlink" title="å®ç°éš”ç¦»æ€§"></a>å®ç°éš”ç¦»æ€§</h4><p>å¹¶å‘ä¸‹å®ç°ä¸²è¡Œçš„æ•°æ®è®¿é—®â€”â€”åŠ é”ï¼Œå…·ä½“åˆæœ‰ä¸‰ç§é”ï¼š</p>
<ul>
<li><strong>å†™é”</strong>ï¼ˆWrite Lockï¼Œä¹Ÿå«ä½œæ’ä»–é”ï¼ŒeXclusive Lockï¼Œç®€å†™ä¸º X-Lockï¼‰ï¼šå¦‚æœæ•°æ®æœ‰åŠ å†™é”ï¼Œå°±åªæœ‰æŒæœ‰å†™é”çš„äº‹åŠ¡æ‰èƒ½å¯¹æ•°æ®è¿›è¡Œå†™å…¥æ“ä½œï¼Œæ•°æ®åŠ æŒç€å†™é”æ—¶ï¼Œå…¶ä»–äº‹åŠ¡ä¸èƒ½å†™å…¥æ•°æ®ï¼Œä¹Ÿä¸èƒ½æ–½åŠ è¯»é”ã€‚</li>
<li><strong>è¯»é”</strong>ï¼ˆRead Lockï¼Œä¹Ÿå«ä½œå…±äº«é”ï¼ŒShared Lockï¼Œç®€å†™ä¸º S-Lockï¼‰ï¼šå¤šä¸ªäº‹åŠ¡å¯ä»¥å¯¹åŒä¸€ä¸ªæ•°æ®æ·»åŠ å¤šä¸ªè¯»é”ï¼Œæ•°æ®è¢«åŠ ä¸Šè¯»é”åå°±ä¸èƒ½å†è¢«åŠ ä¸Šå†™é”ï¼Œæ‰€ä»¥å…¶ä»–äº‹åŠ¡ä¸èƒ½å¯¹è¯¥æ•°æ®è¿›è¡Œå†™å…¥ï¼Œä½†ä»ç„¶å¯ä»¥è¯»å–ã€‚å¯¹äºæŒæœ‰è¯»é”çš„äº‹åŠ¡ï¼Œå¦‚æœè¯¥æ•°æ®åªæœ‰å®ƒè‡ªå·±ä¸€ä¸ªäº‹åŠ¡åŠ äº†è¯»é”ï¼Œå…è®¸ç›´æ¥å°†å…¶å‡çº§ä¸ºå†™é”ï¼Œç„¶åå†™å…¥æ•°æ®ã€‚</li>
<li><strong>èŒƒå›´é”</strong>ï¼ˆRange Lockï¼‰ï¼šå¯¹äºæŸä¸ªèŒƒå›´ç›´æ¥åŠ æ’ä»–é”ï¼Œåœ¨è¿™ä¸ªèŒƒå›´å†…çš„æ•°æ®ä¸èƒ½è¢«å†™å…¥ã€‚å¦‚ä¸‹è¯­å¥æ˜¯å…¸å‹çš„åŠ èŒƒå›´é”çš„ä¾‹å­ï¼š</li>
</ul>
<p>äº‹ç‰©çš„éš”ç¦»çº§åˆ«ï¼š</p>
<ul>
<li>å¯ä¸²è¡ŒåŒ–ï¼šå¯¹äº‹åŠ¡æ‰€æœ‰è¯»ã€å†™çš„æ•°æ®å…¨éƒ½åŠ ä¸Šè¯»é”ã€å†™é”å’ŒèŒƒå›´é”</li>
<li>å¯é‡å¤è¯»ï¼šå¯¹äº‹åŠ¡æ‰€æ¶‰åŠçš„æ•°æ®åŠ è¯»é”å’Œå†™é”ï¼Œä¸”ä¸€ç›´æŒæœ‰è‡³äº‹åŠ¡ç»“æŸï¼Œä½†ä¸å†åŠ èŒƒå›´é”ã€‚<strong>å¹»è¯»</strong>ï¼šä¸¤æ¬¡è¯»çš„èŒƒå›´ä¸ä¸€æ ·</li>
<li>è¯»å·²æäº¤ï¼šå¯¹äº‹åŠ¡æ¶‰åŠçš„æ•°æ®åŠ çš„å†™é”ä¼šä¸€ç›´æŒç»­åˆ°äº‹åŠ¡ç»“æŸï¼Œä½†åŠ çš„è¯»é”åœ¨æŸ¥è¯¢æ“ä½œå®Œæˆåå°±é©¬ä¸Šä¼šé‡Šæ”¾ã€‚<strong>ä¸å¯é‡å¤è¯»</strong>ï¼šåŒä¸€è¡ŒæŸ¥ä¸¤æ¬¡ä¸ä¸€æ ·</li>
<li>è¯»æœªæäº¤ï¼šå¯¹äº‹åŠ¡æ¶‰åŠçš„æ•°æ®åªåŠ å†™é”ï¼Œä¼šä¸€ç›´æŒç»­åˆ°äº‹åŠ¡ç»“æŸï¼Œä½†å®Œå…¨ä¸åŠ è¯»é”ã€‚<strong>è„è¯»</strong>ï¼šä¸€ä¸ªäº‹åŠ¡è¯»å–åˆ°äº†å¦ä¸€ä¸ªäº‹åŠ¡æœªæäº¤çš„æ•°æ®</li>
</ul>
<p>éš”ç¦»æ€§çš„å¦ä¸€ç§å®ç°æ–¹æ¡ˆï¼šæ— é”ä¼˜åŒ–æ–¹æ¡ˆMVCCï¼Œå¯¹æ•°æ®åº“çš„ä»»ä½•ä¿®æ”¹éƒ½ä¸ä¼šç›´æ¥è¦†ç›–ä¹‹å‰çš„æ•°æ®ï¼Œè€Œæ˜¯äº§ç”Ÿä¸€ä¸ªæ–°ç‰ˆå‰¯æœ¬ä¸è€ç‰ˆæœ¬å…±å­˜ï¼Œä»¥æ­¤è¾¾åˆ°è¯»å–æ—¶å¯ä»¥å®Œå…¨ä¸åŠ é”çš„ç›®çš„ã€‚å…·ä½“çš„è§„åˆ™ï¼š</p>
<ul>
<li>æ’å…¥æ•°æ®æ—¶ï¼šCREATE_VERSION è®°å½•æ’å…¥æ•°æ®çš„äº‹åŠ¡ IDï¼ŒDELETE_VERSION ä¸ºç©ºã€‚</li>
<li>åˆ é™¤æ•°æ®æ—¶ï¼šDELETE_VERSION è®°å½•åˆ é™¤æ•°æ®çš„äº‹åŠ¡ IDï¼ŒCREATE_VERSION ä¸ºç©ºã€‚</li>
<li>ä¿®æ”¹æ•°æ®æ—¶ï¼šå°†ä¿®æ”¹æ•°æ®è§†ä¸ºâ€œåˆ é™¤æ—§æ•°æ®ï¼Œæ’å…¥æ–°æ•°æ®â€çš„ç»„åˆï¼Œå³å…ˆå°†åŸæœ‰æ•°æ®å¤åˆ¶ä¸€ä»½ï¼ŒåŸæœ‰æ•°æ®çš„ DELETE_VERSION è®°å½•ä¿®æ”¹æ•°æ®çš„äº‹åŠ¡ IDï¼ŒCREATE_VERSION ä¸ºç©ºã€‚å¤åˆ¶å‡ºæ¥çš„æ–°æ•°æ®çš„ CREATE_VERSION è®°å½•ä¿®æ”¹æ•°æ®çš„äº‹åŠ¡ IDï¼ŒDELETE_VERSION ä¸ºç©ºã€‚</li>
</ul>
<p>æ ¹æ®éš”ç¦»çº§åˆ«æ¥å†³å®šåˆ°åº•åº”è¯¥è¯»å–å“ªä¸ªç‰ˆæœ¬çš„æ•°æ®ï¼š</p>
<ul>
<li>éš”ç¦»çº§åˆ«æ˜¯<code>å¯é‡å¤è¯»</code>ï¼šæ€»æ˜¯è¯»å– CREATE_VERSION å°äºæˆ–ç­‰äºå½“å‰äº‹åŠ¡ ID çš„è®°å½•ï¼Œåœ¨è¿™ä¸ªå‰æä¸‹ï¼Œå¦‚æœæ•°æ®ä»æœ‰å¤šä¸ªç‰ˆæœ¬ï¼Œåˆ™å–æœ€æ–°ï¼ˆäº‹åŠ¡ ID æœ€å¤§ï¼‰çš„ã€‚</li>
<li>éš”ç¦»çº§åˆ«æ˜¯<code>è¯»å·²æäº¤</code>ï¼šæ€»æ˜¯å–æœ€æ–°çš„ç‰ˆæœ¬å³å¯ï¼Œå³æœ€è¿‘è¢« Commit çš„é‚£ä¸ªç‰ˆæœ¬çš„æ•°æ®è®°å½•ã€‚</li>
</ul>
<p>å¦å¤–ä¸¤ä¸ªéš”ç¦»çº§åˆ«éƒ½æ²¡æœ‰å¿…è¦ç”¨åˆ° MVCCï¼Œå› ä¸º<code>è¯»æœªæäº¤</code>ç›´æ¥ä¿®æ”¹åŸå§‹æ•°æ®å³å¯ï¼Œå…¶ä»–äº‹åŠ¡æŸ¥çœ‹æ•°æ®çš„æ—¶å€™ç«‹åˆ»å¯ä»¥çœ‹åˆ°ï¼Œæ ¹æœ¬æ— é¡»ç‰ˆæœ¬å­—æ®µã€‚<code>å¯ä¸²è¡ŒåŒ–</code>æœ¬æ¥çš„è¯­ä¹‰å°±æ˜¯è¦é˜»å¡å…¶ä»–äº‹åŠ¡çš„è¯»å–æ“ä½œï¼Œè€Œ MVCC æ˜¯åšè¯»å–æ—¶æ— é”ä¼˜åŒ–çš„ï¼Œè‡ªç„¶å°±ä¸ä¼šæ”¾åˆ°ä¸€èµ·ç”¨ã€‚</p>
<p>MVCC æ˜¯åªé’ˆå¯¹â€œè¯»+å†™â€åœºæ™¯çš„ä¼˜åŒ–ï¼Œå¦‚æœæ˜¯ä¸¤ä¸ªäº‹åŠ¡åŒæ—¶ä¿®æ”¹æ•°æ®ï¼Œå³â€œå†™+å†™â€çš„æƒ…å†µï¼Œé‚£å°±æ²¡æœ‰å¤šå°‘ä¼˜åŒ–çš„ç©ºé—´äº†ï¼Œæ­¤æ—¶åŠ é”å‡ ä¹æ˜¯å”¯ä¸€å¯è¡Œçš„è§£å†³æ–¹æ¡ˆï¼Œç¨å¾®æœ‰ç‚¹è®¨è®ºä½™åœ°çš„æ˜¯åŠ é”çš„ç­–ç•¥æ˜¯â€œä¹è§‚åŠ é”â€ï¼ˆOptimistic Lockingï¼‰è¿˜æ˜¯â€œæ‚²è§‚åŠ é”â€ï¼ˆPessimistic Lockingï¼‰ã€‚å‰é¢ç¬”è€…ä»‹ç»çš„åŠ é”éƒ½å±äºæ‚²è§‚åŠ é”ç­–ç•¥ï¼Œå³è®¤ä¸ºå¦‚æœä¸å…ˆåšåŠ é”å†è®¿é—®æ•°æ®ï¼Œå°±è‚¯å®šä¼šå‡ºç°é—®é¢˜ã€‚ç›¸å¯¹åœ°ï¼Œä¹è§‚åŠ é”ç­–ç•¥è®¤ä¸ºäº‹åŠ¡ä¹‹é—´æ•°æ®å­˜åœ¨ç«äº‰æ˜¯å¶ç„¶æƒ…å†µï¼Œæ²¡æœ‰ç«äº‰æ‰æ˜¯æ™®éæƒ…å†µï¼Œè¿™æ ·å°±ä¸åº”è¯¥åœ¨ä¸€å¼€å§‹å°±åŠ é”ï¼Œè€Œæ˜¯åº”å½“åœ¨å‡ºç°ç«äº‰æ—¶å†æ‰¾è¡¥æ•‘æªæ–½ã€‚</p>
<h3 id="å…¨å±€äº‹åŠ¡"><a href="#å…¨å±€äº‹åŠ¡" class="headerlink" title="å…¨å±€äº‹åŠ¡"></a>å…¨å±€äº‹åŠ¡</h3><p><strong>å…¨å±€äº‹åŠ¡</strong>ï¼šä¸€ç§é€‚ç”¨äºå•ä¸ªæœåŠ¡ä½¿ç”¨å¤šä¸ªæ•°æ®æºåœºæ™¯çš„äº‹åŠ¡è§£å†³æ–¹æ¡ˆã€‚<br><strong>åˆ†å¸ƒå¼äº‹åŠ¡</strong>ï¼šå¤šæœåŠ¡å¤šæ•°æ®æºçš„äº‹åŠ¡ã€‚</p>
<p>1991å¹´ï¼ŒXAæå‡ºï¼ŒåŒ…å«å…¨å±€äº‹åŠ¡ç®¡ç†å™¨ã€å±€éƒ¨èµ„æºç®¡ç†å™¨ï¼Œä¸€ä¸ªç”¨äºåè°ƒå…¨å±€äº‹åŠ¡ï¼Œä¸€ä¸ªç”¨äºé©±åŠ¨æœ¬åœ°äº‹åŠ¡ã€‚</p>
<p>XAå¹¶ä¸æ˜¯Javaçš„æŠ€æœ¯è§„èŒƒï¼Œè€Œä¸”ä¸€å¥—è¯­è¨€æ— å…³çš„é€šç”¨è§„èŒƒã€‚Javaæ˜¯å®ç°æ˜¯JTAã€‚<br>XA å°†äº‹åŠ¡æäº¤æ‹†åˆ†æˆä¸ºä¸¤é˜¶æ®µè¿‡ç¨‹ï¼š</p>
<ul>
<li>å‡†å¤‡é˜¶æ®µï¼šåè°ƒè€…è¯¢é—®äº‹åŠ¡çš„æ‰€æœ‰å‚ä¸è€…æ˜¯å¦å‡†å¤‡å¥½æäº¤ï¼Œå‚ä¸è€…å¦‚æœå·²ç»å‡†å¤‡å¥½æäº¤åˆ™å›å¤ Preparedï¼Œå¦åˆ™å›å¤ Non-Preparedã€‚å¯¹äºæ•°æ®åº“æ¥è¯´ï¼Œå‡†å¤‡æ“ä½œæ˜¯åœ¨é‡åšæ—¥å¿—ä¸­è®°å½•å…¨éƒ¨äº‹åŠ¡æäº¤æ“ä½œæ‰€è¦åšçš„å†…å®¹ï¼Œå®ƒä¸æœ¬åœ°äº‹åŠ¡ä¸­çœŸæ­£æäº¤çš„åŒºåˆ«åªæ˜¯æš‚ä¸å†™å…¥æœ€åä¸€æ¡ Commit Record è€Œå·²ï¼Œè¿™æ„å‘³ç€åœ¨åšå®Œæ•°æ®æŒä¹…åŒ–åå¹¶ä¸ç«‹å³é‡Šæ”¾éš”ç¦»æ€§ï¼Œå³ä»ç»§ç»­æŒæœ‰é”ï¼Œç»´æŒæ•°æ®å¯¹å…¶ä»–éäº‹åŠ¡å†…è§‚å¯Ÿè€…çš„éš”ç¦»çŠ¶æ€ã€‚</li>
<li>æäº¤é˜¶æ®µï¼šåè°ƒè€…å¦‚æœåœ¨ä¸Šä¸€é˜¶æ®µæ”¶åˆ°æ‰€æœ‰äº‹åŠ¡å‚ä¸è€…å›å¤çš„ Prepared æ¶ˆæ¯ï¼Œåˆ™å…ˆè‡ªå·±åœ¨æœ¬åœ°æŒä¹…åŒ–äº‹åŠ¡çŠ¶æ€ä¸º Commitï¼Œåœ¨æ­¤æ“ä½œå®Œæˆåå‘æ‰€æœ‰å‚ä¸è€…å‘é€ Commit æŒ‡ä»¤ï¼Œæ‰€æœ‰å‚ä¸è€…ç«‹å³æ‰§è¡Œæäº¤æ“ä½œï¼›å¦åˆ™ï¼Œä»»æ„ä¸€ä¸ªå‚ä¸è€…å›å¤äº† Non-Prepared æ¶ˆæ¯ï¼Œæˆ–ä»»æ„ä¸€ä¸ªå‚ä¸è€…è¶…æ—¶æœªå›å¤ï¼Œåè°ƒè€…å°†è‡ªå·±çš„äº‹åŠ¡çŠ¶æ€æŒä¹…åŒ–ä¸º Abort ä¹‹åï¼Œå‘æ‰€æœ‰å‚ä¸è€…å‘é€ Abort æŒ‡ä»¤ï¼Œå‚ä¸è€…ç«‹å³æ‰§è¡Œå›æ»šæ“ä½œã€‚å¯¹äºæ•°æ®åº“æ¥è¯´ï¼Œè¿™ä¸ªé˜¶æ®µçš„æäº¤æ“ä½œåº”æ˜¯å¾ˆè½»é‡çš„ï¼Œä»…ä»…æ˜¯æŒä¹…åŒ–ä¸€æ¡ Commit Record è€Œå·²ï¼Œé€šå¸¸èƒ½å¤Ÿå¿«é€Ÿå®Œæˆï¼Œåªæœ‰æ”¶åˆ° Abort æŒ‡ä»¤æ—¶ï¼Œæ‰éœ€è¦æ ¹æ®å›æ»šæ—¥å¿—æ¸…ç†å·²æäº¤çš„æ•°æ®ï¼Œè¿™å¯èƒ½æ˜¯ç›¸å¯¹é‡è´Ÿè½½çš„æ“ä½œã€‚</li>
</ul>
<p>XAæ˜¯<strong>ä¸¤é˜¶æ®µæäº¤åè®®</strong>ï¼Œå®ƒçš„æˆåŠŸè¿˜æœ‰ä¸¤ä¸ªå‰æœŸï¼š</p>
<ul>
<li>ç½‘ç»œåœ¨æäº¤é˜¶æ®µæ˜¯å¯é çš„ï¼Œä¸ä¼šä¸¢æ¶ˆæ¯ï¼Œä¸ä¼šæœ‰é”™æ¶ˆæ¯</li>
<li>ç½‘ç»œåˆ†åŒºã€æœºå™¨å´©æºƒå¯¼è‡´å¤±è”çš„èŠ‚ç‚¹æœ€ç»ˆèƒ½æ¢å¤ï¼Œä¸ä¼šæ°¸ä¹…å¤±è”<br><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/1750745377838.png"><br>ä¸¤é˜¶æ®µæäº¤çš„æ˜¾è‘—é—®é¢˜ï¼š</li>
<li>å•ç‚¹é—®é¢˜ï¼šåè°ƒè€…æ•…éšœï¼Œå‚ä¸è€…ä¸€ç›´ç­‰å¾…</li>
<li>æ€§èƒ½é—®é¢˜ï¼šä¸¤æ¬¡æœåŠ¡è°ƒç”¨ï¼Œä¸‰æ¬¡æ•°æ®æŒä¹…åŒ–ï¼ˆå†™Redologã€åè°ƒè€…çŠ¶æ€æŒä¹…åŒ–ã€æäº¤é˜¶æ®µå†™Commit Recordï¼‰</li>
<li>ä¸€è‡´æ€§é£é™©ï¼šç½‘ç»œä¸ç¨³å®šã€å®•æœºæ¢å¤èƒ½åŠ›</li>
</ul>
<p>ä¸ºäº†è§£å†³å•ç‚¹é—®é¢˜å’Œå‡†å¤‡é˜¶æ®µçš„æ€§èƒ½é—®é¢˜ï¼Œå‘å±•å‡º<strong>ä¸‰é˜¶æ®µæäº¤</strong>ï¼Œå‡†å¤‡é˜¶æ®µå†ç»†åˆ†ï¼Œå…·ä½“åŒ…æ‹¬ï¼š</p>
<ul>
<li>CanCommité˜¶æ®µï¼šè®©å‚ä¸è€…è¯„ä¼°æ˜¯å¦æœ‰å¯èƒ½é¡ºåˆ©å®Œæˆ</li>
<li>PreCommité˜¶æ®µï¼šå¼€å§‹å†™é‡åšæ—¥å¿—</li>
<li>DoCommité˜¶æ®µï¼šè¿›è¡Œå†™Commit Record</li>
</ul>
<p>ä¸éœ€è¦å›æ»šçš„åœºæ™¯ä¸‹ï¼Œä¸‰é˜¶æ®µæ›´å·®ï¼Œéœ€è¦å›æ»šçš„åœºæ™¯ä¸‹ï¼Œä¸‰é˜¶æ®µæ›´ä¼˜ã€‚å¦å¤–å¦‚æœåè°ƒè€…å®•æœºï¼Œé»˜è®¤è®©å‚ä¸è€…æäº¤äº‹åŠ¡ã€‚åŒæ ·ä¹Ÿæœ‰ä¸€è‡´æ€§é—®é¢˜ã€‚</p>
<p><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/1750746104506.png"></p>
<h3 id="å…±äº«äº‹åŠ¡"><a href="#å…±äº«äº‹åŠ¡" class="headerlink" title="å…±äº«äº‹åŠ¡"></a>å…±äº«äº‹åŠ¡</h3><p><strong>å…±äº«äº‹åŠ¡</strong>ï¼šå¤šä¸ªæœåŠ¡å…±ç”¨åŒä¸€ä¸ªæ•°æ®æºã€‚</p>
<p>ç”±äºæ•°æ®åº“è¿æ¥çš„åŸºç¡€æ˜¯ç½‘ç»œè¿æ¥ï¼Œå®ƒæ˜¯ä¸ IP åœ°å€å’Œç«¯å£å·ç»‘å®šçš„ï¼Œå­—é¢æ„ä¹‰ä¸Šçš„â€œä¸åŒæœåŠ¡èŠ‚ç‚¹å…±äº«æ•°æ®åº“è¿æ¥â€å¾ˆéš¾åšåˆ°ï¼Œæ‰€ä»¥ä¸ºäº†å®ç°å…±äº«äº‹åŠ¡ï¼Œå°±å¿…é¡»æ–°å¢ä¸€ä¸ªâ€œäº¤æ˜“æœåŠ¡å™¨â€çš„ä¸­é—´è§’è‰²ã€‚è½¬åŒ–ä¸ºäº†æœ¬åœ°äº‹åŠ¡</p>
<p>ä¼ªéœ€æ±‚ï¼Œå› ä¸ºå¾€å¾€éƒ½æ˜¯æ•°æ®åº“å‹åŠ›æœ€å¤§ï¼Œéœ€è¦æ‹“å±•ã€‚æœ‰ä¸€ç§å¸¸è§çš„å˜ç§å½¢å¼å°±æ˜¯ï¼šä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨æ¥ä»£æ›¿äº¤æ˜“æœåŠ¡å™¨ã€‚</p>
<h3 id="åˆ†å¸ƒå¼äº‹åŠ¡"><a href="#åˆ†å¸ƒå¼äº‹åŠ¡" class="headerlink" title="åˆ†å¸ƒå¼äº‹åŠ¡"></a>åˆ†å¸ƒå¼äº‹åŠ¡</h3><p><strong>åˆ†å¸ƒå¼äº‹åŠ¡</strong>ï¼šå¤šä¸ªæœåŠ¡åŒæ—¶è®¿é—®å¤šä¸ªæ•°æ®æºçš„äº‹åŠ¡å¤„ç†æœºåˆ¶</p>
<h4 id="CAPä¸ACID"><a href="#CAPä¸ACID" class="headerlink" title="CAPä¸ACID"></a>CAPä¸ACID</h4><p>2000å¹´è¯æ˜äº†CAPçŒœæƒ³ï¼Œæˆä¸ºè‘—åçš„å®šç†ï¼Œä¸‰ä¸ªç‰¹æ€§æœ€å¤šåªèƒ½æ»¡è¶³å…¶ä¸­ä¸¤ä¸ªï¼š</p>
<ul>
<li><strong>ä¸€è‡´æ€§</strong>ï¼ˆ<strong>C</strong>onsistencyï¼‰ï¼šä»£è¡¨æ•°æ®åœ¨ä»»ä½•æ—¶åˆ»ã€ä»»ä½•åˆ†å¸ƒå¼èŠ‚ç‚¹ä¸­æ‰€çœ‹åˆ°çš„éƒ½æ˜¯ç¬¦åˆé¢„æœŸçš„ã€‚ä¸€è‡´æ€§åœ¨åˆ†å¸ƒå¼ç ”ç©¶ä¸­æ˜¯æœ‰ä¸¥è‚ƒå®šä¹‰ã€æœ‰å¤šç§ç»†åˆ†ç±»å‹çš„æ¦‚å¿µï¼Œä»¥åè®¨è®ºåˆ†å¸ƒå¼å…±è¯†ç®—æ³•æ—¶ï¼Œæˆ‘ä»¬è¿˜ä¼šå†æåˆ°ä¸€è‡´æ€§ï¼Œé‚£ç§é¢å‘å‰¯æœ¬å¤åˆ¶çš„ä¸€è‡´æ€§ä¸è¿™é‡Œé¢å‘æ•°æ®åº“çŠ¶æ€çš„ä¸€è‡´æ€§ä¸¥æ ¼æ¥è¯´å¹¶ä¸å®Œå…¨ç­‰åŒï¼Œå…·ä½“å·®åˆ«æˆ‘ä»¬å°†åœ¨åç»­åˆ†å¸ƒå¼å…±è¯†ç®—æ³•ä¸­å†ä½œæ¢è®¨ã€‚</li>
<li><strong>å¯ç”¨æ€§</strong>ï¼ˆ<strong>A</strong>vailabilityï¼‰ï¼šä»£è¡¨ç³»ç»Ÿä¸é—´æ–­åœ°æä¾›æœåŠ¡çš„èƒ½åŠ›ï¼Œç†è§£å¯ç”¨æ€§è¦å…ˆç†è§£ä¸å…¶å¯†åˆ‡ç›¸å…³ä¸¤ä¸ªæŒ‡æ ‡ï¼šå¯é æ€§ï¼ˆReliabilityï¼‰å’Œå¯ç»´æŠ¤æ€§ï¼ˆServiceabilityï¼‰ã€‚</li>
<li><strong>åˆ†åŒºå®¹å¿æ€§</strong>ï¼ˆ<strong>P</strong>artition Toleranceï¼‰ï¼šä»£è¡¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­éƒ¨åˆ†èŠ‚ç‚¹å› ç½‘ç»œåŸå› è€Œå½¼æ­¤å¤±è”åï¼Œå³ä¸å…¶ä»–èŠ‚ç‚¹å½¢æˆâ€œç½‘ç»œåˆ†åŒºâ€æ—¶ï¼Œç³»ç»Ÿä»èƒ½æ­£ç¡®åœ°æä¾›æœåŠ¡çš„èƒ½åŠ›ã€‚</li>
</ul>
<p>ä¸å¯å…¼å¾—çš„å½±å“åˆ†æï¼š</p>
<ul>
<li><strong>å¦‚æœæ”¾å¼ƒåˆ†åŒºå®¹å¿æ€§</strong>ï¼ˆCA without Pï¼‰ï¼šèŠ‚ç‚¹ä¹‹é—´é€šä¿¡æ°¸è¿œæ˜¯å¯é çš„ã€‚æ°¸è¿œå¯é çš„é€šä¿¡åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¿…å®šä¸æˆç«‹çš„ã€‚Oracle RACé€šè¿‡å…±äº«æ­¤åˆ¤æ¥é¿å…å‡ºç°ç½‘ç»œåˆ†åŒºã€‚</li>
<li><strong>å¦‚æœæ”¾å¼ƒå¯ç”¨æ€§</strong>ï¼ˆCP without Aï¼‰ï¼šä¸€æ—¦ç½‘ç»œå‘ç”Ÿåˆ†åŒºï¼ŒèŠ‚ç‚¹ä¹‹é—´çš„ä¿¡æ¯åŒæ­¥æ—¶é—´å¯ä»¥æ— é™åˆ¶åœ°å»¶é•¿ã€‚åœ¨ç°å®ä¸­ï¼Œé€‰æ‹©æ”¾å¼ƒå¯ç”¨æ€§çš„ CP ç³»ç»Ÿæƒ…å†µä¸€èˆ¬ç”¨äºå¯¹æ•°æ®è´¨é‡è¦æ±‚å¾ˆé«˜çš„åœºåˆä¸­ã€‚HBaseä¹Ÿæ˜¯CPç³»ç»Ÿã€‚</li>
<li><strong>å¦‚æœæ”¾å¼ƒä¸€è‡´æ€§</strong>ï¼ˆAP without Cï¼‰ï¼šç›®å‰æ˜¯è®¾è®¡åˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸»æµé€‰æ‹©ï¼Œå› ä¸º P æ˜¯åˆ†å¸ƒå¼ç½‘ç»œçš„å¤©ç„¶å±æ€§ï¼Œä½ å†ä¸æƒ³è¦ä¹Ÿæ— æ³•ä¸¢å¼ƒï¼›è€Œ A é€šå¸¸æ˜¯å»ºè®¾åˆ†å¸ƒå¼çš„ç›®çš„ã€‚å¤§å¤šæ•° NoSQL åº“å’Œæ”¯æŒåˆ†å¸ƒå¼çš„ç¼“å­˜æ¡†æ¶éƒ½æ˜¯ AP ç³»ç»Ÿï¼Œæ¯”å¦‚Redisã€‚</li>
</ul>
<p>åœ¨ CAPã€ACID ä¸­è®¨è®ºçš„ä¸€è‡´æ€§ç§°ä¸º<strong>å¼ºä¸€è‡´æ€§</strong>ï¼Œæœ‰æ—¶ä¹Ÿç§°ä¸º<strong>çº¿æ€§ä¸€è‡´æ€§</strong>ã€‚ç‰ºç‰²äº† C çš„ AP ç³»ç»Ÿåˆè¦å°½å¯èƒ½è·å¾—æ­£ç¡®çš„ç»“æœçš„è¡Œä¸ºç§°ä¸ºè¿½æ±‚<strong>å¼±ä¸€è‡´æ€§</strong>ã€‚å¦‚æœæ•°æ®åœ¨ä¸€æ®µæ—¶é—´ä¹‹å†…æ²¡æœ‰è¢«å¦å¤–çš„æ“ä½œæ‰€æ›´æ”¹ï¼Œé‚£å®ƒæœ€ç»ˆå°†ä¼šè¾¾åˆ°ä¸å¼ºä¸€è‡´æ€§è¿‡ç¨‹ç›¸åŒçš„ç»“æœï¼Œå³<strong>æœ€ç»ˆä¸€è‡´æ€§</strong>ã€‚åˆšæ€§äº‹åŠ¡&#x2F;æŸ”æ€§äº‹åŠ¡ã€‚</p>
<h4 id="å¯é äº‹ä»¶é˜Ÿåˆ—"><a href="#å¯é äº‹ä»¶é˜Ÿåˆ—" class="headerlink" title="å¯é äº‹ä»¶é˜Ÿåˆ—"></a>å¯é äº‹ä»¶é˜Ÿåˆ—</h4><p>BASE åˆ†åˆ«æ˜¯åŸºæœ¬å¯ç”¨æ€§ï¼ˆ<strong>B</strong>asicallyÂ <strong>A</strong>vailableï¼‰ã€æŸ”æ€§äº‹åŠ¡ï¼ˆ<strong>S</strong>oft Stateï¼‰å’Œæœ€ç»ˆä¸€è‡´æ€§ï¼ˆ<strong>E</strong>ventually Consistentï¼‰çš„ç¼©å†™ã€‚å…¶å®å°±æ˜¯é æŒç»­é‡è¯•æ¥ä¿éšœå¯é æ€§ï¼Œä¹Ÿå«åšæœ€å¤§åŠªåŠ›äº¤ä»˜ã€‚</p>
<h4 id="TCCäº‹åŠ¡"><a href="#TCCäº‹åŠ¡" class="headerlink" title="TCCäº‹åŠ¡"></a>TCCäº‹åŠ¡</h4><p>2007å¹´æå‡ºï¼ŒTry Confirm Cancel<br>å¯é æ¶ˆæ¯é˜Ÿåˆ—ç®€å•ã€ç›¸å¯¹å¯é ï¼Œä½†æ˜¯æ²¡æœ‰ä»»ä½•éš”ç¦»æ€§ã€‚<br>ä½¿ç”¨åœºæ™¯ï¼šå¦‚æœä¸šåŠ¡éœ€è¦éš”ç¦»ï¼Œé‚£æ¶æ„å¸ˆé€šå¸¸å°±åº”è¯¥é‡ç‚¹è€ƒè™‘ TCC æ–¹æ¡ˆï¼Œè¯¥æ–¹æ¡ˆå¤©ç”Ÿé€‚åˆç”¨äºéœ€è¦å¼ºéš”ç¦»æ€§çš„åˆ†å¸ƒå¼äº‹åŠ¡ä¸­ã€‚<br>æ•´ä½“åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š</p>
<ul>
<li><strong>Try</strong>ï¼šå°è¯•æ‰§è¡Œé˜¶æ®µï¼Œå®Œæˆæ‰€æœ‰ä¸šåŠ¡å¯æ‰§è¡Œæ€§çš„æ£€æŸ¥ï¼ˆä¿éšœä¸€è‡´æ€§ï¼‰ï¼Œå¹¶ä¸”é¢„ç•™å¥½å…¨éƒ¨éœ€ç”¨åˆ°çš„ä¸šåŠ¡èµ„æºï¼ˆä¿éšœéš”ç¦»æ€§ï¼‰ã€‚</li>
<li><strong>Confirm</strong>ï¼šç¡®è®¤æ‰§è¡Œé˜¶æ®µï¼Œä¸è¿›è¡Œä»»ä½•ä¸šåŠ¡æ£€æŸ¥ï¼Œç›´æ¥ä½¿ç”¨ Try é˜¶æ®µå‡†å¤‡çš„èµ„æºæ¥å®Œæˆä¸šåŠ¡å¤„ç†ã€‚Confirm é˜¶æ®µå¯èƒ½ä¼šé‡å¤æ‰§è¡Œï¼Œå› æ­¤æœ¬é˜¶æ®µæ‰€æ‰§è¡Œçš„æ“ä½œéœ€è¦å…·å¤‡å¹‚ç­‰æ€§ã€‚</li>
<li><strong>Cancel</strong>ï¼šå–æ¶ˆæ‰§è¡Œé˜¶æ®µï¼Œé‡Šæ”¾ Try é˜¶æ®µé¢„ç•™çš„ä¸šåŠ¡èµ„æºã€‚Cancel é˜¶æ®µå¯èƒ½ä¼šé‡å¤æ‰§è¡Œï¼Œä¹Ÿéœ€è¦æ»¡è¶³å¹‚ç­‰æ€§ã€‚</li>
</ul>
<p>TCC å…¶å®æœ‰ç‚¹ç±»ä¼¼ 2PC çš„å‡†å¤‡é˜¶æ®µå’Œæäº¤é˜¶æ®µï¼Œä½† TCC æ˜¯ä½äºç”¨æˆ·ä»£ç å±‚é¢ï¼Œè€Œä¸æ˜¯åœ¨åŸºç¡€è®¾æ–½å±‚é¢ï¼Œè¿™ä¸ºå®ƒçš„å®ç°å¸¦æ¥äº†è¾ƒé«˜çš„çµæ´»æ€§ï¼Œå¯ä»¥æ ¹æ®éœ€è¦è®¾è®¡èµ„æºé”å®šçš„ç²’åº¦ã€‚TCC åœ¨ä¸šåŠ¡æ‰§è¡Œæ—¶åªæ“ä½œé¢„ç•™èµ„æºï¼Œå‡ ä¹ä¸ä¼šæ¶‰åŠé”å’Œèµ„æºçš„äº‰ç”¨ï¼Œå…·æœ‰å¾ˆé«˜çš„æ€§èƒ½æ½œåŠ›ã€‚<br>ä¸šåŠ¡ä¾µå…¥æ€§å¼ºï¼Œä¸€èˆ¬é€šè¿‡åˆ†å¸ƒå¼äº‹åŠ¡ä¸­é—´ä»¶æ¥å®Œæˆã€‚</p>
<h4 id="SAGAäº‹åŠ¡"><a href="#SAGAäº‹åŠ¡" class="headerlink" title="SAGAäº‹åŠ¡"></a>SAGAäº‹åŠ¡</h4><p>1987å¹´æå‡ºï¼ŒæŠŠä¸€ä¸ªå¤§äº‹åŠ¡åˆ†è§£ä¸ºå¯ä»¥äº¤é”™è¿è¡Œçš„ä¸€ç³»åˆ—å­äº‹åŠ¡é›†åˆã€‚<br>ç›®çš„ï¼šé¿å…å¤§äº‹åŠ¡é•¿æ—¶é—´é”å®šæ•°æ®åº“çš„èµ„æºï¼Œåæ¥æ‰å‘å±•æˆå°†ä¸€ä¸ªåˆ†å¸ƒå¼ç¯å¢ƒä¸­çš„å¤§äº‹åŠ¡åˆ†è§£ä¸ºä¸€ç³»åˆ—æœ¬åœ°äº‹åŠ¡çš„è®¾è®¡æ¨¡å¼ã€‚SAGA ç”±ä¸¤éƒ¨åˆ†æ“ä½œç»„æˆã€‚</p>
<ul>
<li>å¤§äº‹åŠ¡æ‹†åˆ†è‹¥å¹²ä¸ªå°äº‹åŠ¡ï¼Œå°†æ•´ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡ T åˆ†è§£ä¸º n ä¸ªå­äº‹åŠ¡ï¼Œå‘½åä¸º T1ï¼ŒT2ï¼Œâ€¦ï¼ŒTiï¼Œâ€¦ï¼ŒTnã€‚æ¯ä¸ªå­äº‹åŠ¡éƒ½åº”è¯¥æ˜¯æˆ–è€…èƒ½è¢«è§†ä¸ºæ˜¯åŸå­è¡Œä¸ºã€‚å¦‚æœåˆ†å¸ƒå¼äº‹åŠ¡èƒ½å¤Ÿæ­£å¸¸æäº¤ï¼Œå…¶å¯¹æ•°æ®çš„å½±å“ï¼ˆæœ€ç»ˆä¸€è‡´æ€§ï¼‰åº”ä¸è¿ç»­æŒ‰é¡ºåºæˆåŠŸæäº¤ Tiç­‰ä»·ã€‚</li>
<li>ä¸ºæ¯ä¸€ä¸ªå­äº‹åŠ¡è®¾è®¡å¯¹åº”çš„è¡¥å¿åŠ¨ä½œï¼Œå‘½åä¸º C1ï¼ŒC2ï¼Œâ€¦ï¼ŒCiï¼Œâ€¦ï¼ŒCnã€‚Tiä¸ Ciå¿…é¡»æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š<ul>
<li>Tiä¸ Ciéƒ½å…·å¤‡å¹‚ç­‰æ€§ã€‚</li>
<li>Tiä¸ Ciæ»¡è¶³äº¤æ¢å¾‹ï¼ˆCommutativeï¼‰ï¼Œå³å…ˆæ‰§è¡Œ Tiè¿˜æ˜¯å…ˆæ‰§è¡Œ Ciï¼Œå…¶æ•ˆæœéƒ½æ˜¯ä¸€æ ·çš„ã€‚</li>
<li>Ciå¿…é¡»èƒ½æˆåŠŸæäº¤ï¼Œå³ä¸è€ƒè™‘ Ciæœ¬èº«æäº¤å¤±è´¥è¢«å›æ»šçš„æƒ…å½¢ï¼Œå¦‚å‡ºç°å°±å¿…é¡»æŒç»­é‡è¯•ç›´è‡³æˆåŠŸï¼Œæˆ–è€…è¦äººå·¥ä»‹å…¥ã€‚</li>
</ul>
</li>
</ul>
<p>ä¸¤ç§æ¢å¤ç­–ç•¥ï¼š</p>
<ul>
<li><p><strong>æ­£å‘æ¢å¤</strong>ï¼ˆForward Recoveryï¼‰ï¼šå¦‚æœ Tiäº‹åŠ¡æäº¤å¤±è´¥ï¼Œåˆ™ä¸€ç›´å¯¹ Tiè¿›è¡Œé‡è¯•ï¼Œç›´è‡³æˆåŠŸä¸ºæ­¢ï¼ˆæœ€å¤§åŠªåŠ›äº¤ä»˜ï¼‰ã€‚è¿™ç§æ¢å¤æ–¹å¼ä¸éœ€è¦è¡¥å¿ï¼Œé€‚ç”¨äºäº‹åŠ¡æœ€ç»ˆéƒ½è¦æˆåŠŸçš„åœºæ™¯ï¼Œè­¬å¦‚åœ¨åˆ«äººçš„é“¶è¡Œè´¦å·ä¸­æ‰£äº†æ¬¾ï¼Œå°±ä¸€å®šè¦ç»™åˆ«äººå‘è´§ã€‚æ­£å‘æ¢å¤çš„æ‰§è¡Œæ¨¡å¼ä¸ºï¼šT1ï¼ŒT2ï¼Œâ€¦ï¼ŒTiï¼ˆå¤±è´¥ï¼‰ï¼ŒTiï¼ˆé‡è¯•ï¼‰â€¦ï¼ŒTi+1ï¼Œâ€¦ï¼ŒTnã€‚</p>
</li>
<li><p><strong>åå‘æ¢å¤</strong>ï¼ˆBackward Recoveryï¼‰ï¼šå¦‚æœ Tiäº‹åŠ¡æäº¤å¤±è´¥ï¼Œåˆ™ä¸€ç›´æ‰§è¡Œ Ciå¯¹ Tiè¿›è¡Œè¡¥å¿ï¼Œç›´è‡³æˆåŠŸä¸ºæ­¢ï¼ˆæœ€å¤§åŠªåŠ›äº¤ä»˜ï¼‰ã€‚è¿™é‡Œè¦æ±‚ Ciå¿…é¡»ï¼ˆåœ¨æŒç»­é‡è¯•åï¼‰æ‰§è¡ŒæˆåŠŸã€‚åå‘æ¢å¤çš„æ‰§è¡Œæ¨¡å¼ä¸ºï¼šT1ï¼ŒT2ï¼Œâ€¦ï¼ŒTiï¼ˆå¤±è´¥ï¼‰ï¼ŒCiï¼ˆè¡¥å¿ï¼‰ï¼Œâ€¦ï¼ŒC2ï¼ŒC1ã€‚</p>
<ol>
<li>Sagaä¸éœ€è¦ä¸ºèµ„æºè®¾è®¡å†»ç»“çŠ¶æ€ã€‚</li>
<li>å¿…é¡»ä¿è¯æ‰€æœ‰å­äº‹åŠ¡éƒ½å¾—ä»¥æäº¤æˆ–è€…è¡¥å¿</li>
</ol>
</li>
</ul>
<p>è¿˜æœ‰ATäº‹åŠ¡ï¼Œä¹Ÿæ˜¯åŸºäºæ•°æ®è¡¥å¿æ¥ä»£æ›¿å›æ»šçš„æ€è·¯</p>
<h2 id="é€æ˜å¤šçº§åˆ†æµç³»ç»Ÿ"><a href="#é€æ˜å¤šçº§åˆ†æµç³»ç»Ÿ" class="headerlink" title="é€æ˜å¤šçº§åˆ†æµç³»ç»Ÿ"></a>é€æ˜å¤šçº§åˆ†æµç³»ç»Ÿ</h2><p>å¯¹ç³»ç»Ÿè¿›è¡Œæµé‡è§„åˆ’æ—¶ï¼Œæœ‰ä¸¤æ¡æ™®é€‚ã€ç®€å•çš„åŸåˆ™æŒ‡å¯¼è®¾è®¡ï¼š</p>
<ul>
<li>å°½å¯èƒ½å‡å°‘å•ç‚¹éƒ¨ä»¶</li>
<li>å¥¥å¡å§†å‰ƒé¡»åˆ€åŸåˆ™ï¼Œæ»¡è¶³éœ€æ±‚çš„æƒ…å†µä¸‹ï¼Œæœ€ç®€å•çš„ç³»ç»Ÿå°±æ˜¯æœ€å¥½çš„ç³»ç»Ÿ</li>
</ul>
<h3 id="å®¢æˆ·ç«¯ç¼“å­˜"><a href="#å®¢æˆ·ç«¯ç¼“å­˜" class="headerlink" title="å®¢æˆ·ç«¯ç¼“å­˜"></a>å®¢æˆ·ç«¯ç¼“å­˜</h3><blockquote>
<p><strong>å®¢æˆ·ç«¯ç¼“å­˜ï¼ˆClient Cacheï¼‰</strong><br>HTTP åè®®çš„æ— çŠ¶æ€æ€§å†³å®šäº†å®ƒå¿…é¡»ä¾é å®¢æˆ·ç«¯ç¼“å­˜æ¥è§£å†³ç½‘ç»œä¼ è¾“æ•ˆç‡ä¸Šçš„ç¼ºé™·ã€‚</p>
</blockquote>
<p>HTTPè®¾è®¡ä¹‹åˆæ— çŠ¶æ€ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½è¦æºå¸¦é‡å¤æ•°æ®ï¼Œç½‘ç»œæ€§èƒ½ä¼šé™ä½ã€‚é’ˆå¯¹è¿™ä¸ªé—®é¢˜å¼•å…¥å®¢æˆ·ç«¯ç¼“å­˜ï¼Œé€æ­¥å½¢æˆäº†â€œçŠ¶æ€ç¼“å­˜â€œâ€å¼ºåˆ¶ç¼“å­˜â€œâ€åå•†ç¼“å­˜â€œçš„æœºåˆ¶ã€‚</p>
<h4 id="å¼ºåˆ¶ç¼“å­˜"><a href="#å¼ºåˆ¶ç¼“å­˜" class="headerlink" title="å¼ºåˆ¶ç¼“å­˜"></a>å¼ºåˆ¶ç¼“å­˜</h4><p>å¼ºåˆ¶ç¼“å­˜ï¼šå‡è®¾åœ¨æŸä¸ªæ—¶ç‚¹åˆ°æ¥ä»¥å‰ï¼Œè­¬å¦‚æ”¶åˆ°å“åº”åçš„ 10 åˆ†é’Ÿå†…ï¼Œèµ„æºçš„å†…å®¹å’ŒçŠ¶æ€ä¸€å®šä¸ä¼šè¢«æ”¹å˜ï¼Œå› æ­¤å®¢æˆ·ç«¯å¯ä»¥æ— é¡»ç»è¿‡ä»»ä½•è¯·æ±‚ï¼Œåœ¨è¯¥æ—¶ç‚¹å‰ä¸€ç›´æŒæœ‰å’Œä½¿ç”¨è¯¥èµ„æºçš„æœ¬åœ°ç¼“å­˜å‰¯æœ¬ã€‚<br>ä¸¤ç±»å®ç°ï¼š</p>
<ul>
<li>Expiresï¼šÂ HTTP&#x2F;1.0 åè®®ä¸­å¼€å§‹æä¾›çš„ Headerï¼Œåé¢è·Ÿéšä¸€ä¸ªæˆªè‡³æ—¶é—´å‚æ•°ã€‚å­˜åœ¨é—®é¢˜<ol>
<li>å—é™äºå®¢æˆ·ç«¯æœ¬åœ°æ—¶é—´ï¼Œå®¢æˆ·ç«¯ä¿®æ”¹æœ¬åœ°æ—¶é—´</li>
<li>æ— æ³•å¤„ç†æ¶‰åŠåˆ°ç”¨æˆ·èº«ä»½çš„ç§æœ‰èµ„æºï¼Œè¢«å…¶å®ƒä»£ç†æœåŠ¡å™¨ç¼“å­˜</li>
<li>æ— æ³•æè¿°ä¸ç¼“å­˜çš„è¯­ä¹‰</li>
</ol>
</li>
<li>Cache-Controlï¼šHTTP&#x2F;1.1 åè®®ä¸­å®šä¹‰çš„å¼ºåˆ¶ç¼“å­˜ Headerï¼Œä¸¤ä¸ªåŒæ—¶å­˜åœ¨ï¼Œä»¥å®ƒä¸ºå‡†</li>
</ul>
<h4 id="åå•†ç¼“å­˜"><a href="#åå•†ç¼“å­˜" class="headerlink" title="åå•†ç¼“å­˜"></a>åå•†ç¼“å­˜</h4><p>åå•†ç¼“å­˜ï¼šåŸºäºå˜åŒ–æ£€æµ‹çš„ç¼“å­˜æœºåˆ¶ï¼Œåœ¨ä¸€è‡´æ€§ä¸Šä¼šæœ‰æ¯”å¼ºåˆ¶ç¼“å­˜æ›´å¥½çš„è¡¨ç°ï¼Œä½†éœ€è¦ä¸€æ¬¡å˜åŒ–æ£€æµ‹çš„äº¤äº’å¼€é”€ï¼Œæ€§èƒ½ä¸Šå°±ä¼šç•¥å·®ä¸€äº›ã€‚ä¸¤ç§å˜åŠ¨æ£€æŸ¥æœºåˆ¶ï¼Œåˆ†åˆ«æ˜¯æ ¹æ®èµ„æºçš„ä¿®æ”¹æ—¶é—´è¿›è¡Œæ£€æŸ¥ï¼Œä»¥åŠæ ¹æ®èµ„æºå”¯ä¸€æ ‡è¯†æ˜¯å¦å‘ç”Ÿå˜åŒ–æ¥è¿›è¡Œæ£€æŸ¥ï¼Œå®ƒä»¬éƒ½æ˜¯é ä¸€ç»„æˆå¯¹å‡ºç°çš„è¯·æ±‚ã€å“åº” Header æ¥å®ç°çš„ï¼š</p>
<ul>
<li><strong>Last-Modified å’Œ If-Modified-Since</strong>ï¼šLast-Modified æ˜¯æœåŠ¡å™¨çš„å“åº” Headerï¼Œç”¨äºå‘Šè¯‰å®¢æˆ·ç«¯è¿™ä¸ªèµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´ã€‚å¯¹äºå¸¦æœ‰è¿™ä¸ª Header çš„èµ„æºï¼Œå½“å®¢æˆ·ç«¯éœ€è¦å†æ¬¡è¯·æ±‚æ—¶ï¼Œä¼šé€šè¿‡ If-Modified-Since æŠŠä¹‹å‰æ”¶åˆ°çš„èµ„æºæœ€åä¿®æ”¹æ—¶é—´å‘é€å›æœåŠ¡ç«¯ã€‚</li>
<li><strong>Etag å’Œ If-None-Match</strong>ï¼šEtag æ˜¯æœåŠ¡å™¨çš„å“åº” Headerï¼Œç”¨äºå‘Šè¯‰å®¢æˆ·ç«¯è¿™ä¸ªèµ„æºçš„å”¯ä¸€æ ‡è¯†ã€‚å¯¹äºå¸¦æœ‰è¿™ä¸ª Header çš„èµ„æºï¼Œå½“å®¢æˆ·ç«¯éœ€è¦å†æ¬¡è¯·æ±‚æ—¶ï¼Œä¼šé€šè¿‡ If-None-Match æŠŠä¹‹å‰æ”¶åˆ°çš„èµ„æºå”¯ä¸€æ ‡è¯†å‘é€å›æœåŠ¡ç«¯ã€‚</li>
</ul>
<p>Etag æ˜¯ HTTP ä¸­ä¸€è‡´æ€§æœ€å¼ºçš„ç¼“å­˜æœºåˆ¶ï¼Œå´åˆæ˜¯ HTTP ä¸­æ€§èƒ½æœ€å·®çš„ç¼“å­˜æœºåˆ¶</p>
<p>å¯¹äºå¤šç±»èµ„æºï¼ŒHTTP åè®®è®¾è®¡äº†ä»¥ Accept*å¼€å¤´çš„ä¸€å¥—è¯·æ±‚ Header å’Œå¯¹åº”çš„ä»¥ Content-*å¼€å¤´çš„å“åº” Headerï¼Œè¿™äº› Headers è¢«ç§°ä¸º HTTP çš„å†…å®¹åå•†æœºåˆ¶ã€‚</p>
<h3 id="åŸŸåè§£æ"><a href="#åŸŸåè§£æ" class="headerlink" title="åŸŸåè§£æ"></a>åŸŸåè§£æ</h3><p>DNSçš„è§£ææ­¥éª¤ï¼š</p>
<ol>
<li>å®¢æˆ·ç«¯å…ˆæ£€æŸ¥æœ¬åœ°DNSç¼“å­˜ï¼ŒDNSä¼šæœ‰TTLæ£€æŸ¥æœ‰æ•ˆæƒ…å†µã€‚</li>
<li>å®¢æˆ·ç«¯æŠŠåœ°å€å‘ç»™æœ¬åœ°DNSï¼Œå¯ä»¥æ‰‹å·¥é…ç½®ï¼Œä¹Ÿå¯ä»¥DHCPåˆ†é…</li>
<li>æœ¬åœ°DNSæ”¶åˆ°è¯·æ±‚åï¼Œä¾æ¬¡æŸ¥è¯¢åœ°å€è®°å½•<ul>
<li><strong>æƒå¨åŸŸåæœåŠ¡å™¨</strong>ï¼šè´Ÿè´£ç¿»è¯‘ç‰¹å®šåŸŸåçš„ DNS æœåŠ¡å™¨</li>
<li><strong>æ ¹åŸŸåæœåŠ¡å™¨</strong>ï¼šå›ºå®šçš„ã€æ— éœ€æŸ¥è¯¢çš„é¡¶çº§åŸŸåæœåŠ¡å™¨</li>
</ul>
</li>
<li>ä¸å­˜åœ¨ä»»ä½•æƒå¨åŸŸåæœåŠ¡å™¨ï¼Œæ‰¾åˆ°æ ¹ï¼Œæ ¹å†åˆ°æƒå¨æœåŠ¡å™¨</li>
<li>é€šè¿‡æƒå¨æœåŠ¡å™¨æ‰¾åŸŸåçš„åœ°å€è®°å½•ï¼Œä¸ä¸€å®šæ˜¯IPï¼Œæœ‰åå¤šç§</li>
</ol>
<p>å¯ä»¥æ ¹æ®åœ°åŒºã€æœåŠ¡å•†ç­‰å› ç´ ç¡®å®šè¿”å›è®°å½•ï¼Œæ‰¾åˆ°æœ€åˆé€‚çš„æ•°æ®ä¸­å¿ƒ</p>
<ul>
<li>æ€§èƒ½é—®é¢˜ï¼šDNSé¢„å–ï¼Œå¦‚æœæœ‰ä½¿ç”¨éœ€æ±‚å°±é¢„è§£é‡Š</li>
<li>åŠ«æŒé—®é¢˜ï¼šHTTPDCNï¼ŒåŸºäºHTTPSçš„æŸ¥è¯¢æœåŠ¡å™¨ï¼Œç»•è¿‡ä¼ ç»ŸDNS</li>
</ul>
<h3 id="ä¼ è¾“é“¾è·¯"><a href="#ä¼ è¾“é“¾è·¯" class="headerlink" title="ä¼ è¾“é“¾è·¯"></a>ä¼ è¾“é“¾è·¯</h3><p>ç¨‹åºå‘å‡ºçš„è¯·æ±‚èƒ½å¦ä¸åº”ç”¨å±‚ã€ä¼ è¾“å±‚åè®®æå€¡çš„æ–¹å¼ç›¸åŒ¹é…ï¼Œå¯¹ä¼ è¾“çš„æ•ˆç‡ä¹Ÿä¼šæœ‰æå¤§å½±å“ã€‚</p>
<h4 id="è¿æ¥æ•°ä¼˜åŒ–"><a href="#è¿æ¥æ•°ä¼˜åŒ–" class="headerlink" title="è¿æ¥æ•°ä¼˜åŒ–"></a>è¿æ¥æ•°ä¼˜åŒ–</h4><p>HTTP over TCP è¿™ç§æ­é…æœªå¿…åˆé€‚ï¼ŒTCPæœ‰ä¸‰æ¬¡æ¡æ‰‹è¿˜æœ‰æ…¢å¯åŠ¨ï¼Œå»ºç«‹é“¾æ¥æ—¶é€Ÿåº¦æœ€ä½ï¼Œåé¢æ‰ç¨³å®šï¼Œåœ¨é•¿æ—¶é—´çš„å°ºåº¦ä¸‹ï¼Œè¿æ¥æ‰ä¸æ˜¯ç“¶é¢ˆã€‚<br>å› æ­¤å¼€å±•å‡å°‘è¯·æ±‚æ•°é‡ã€å¢åŠ è¿æ¥æ•°é‡å»ä¼˜åŒ–ã€‚</p>
<p>èŠ‚çœTCPè¿æ¥ä¹Ÿæœ‰å¾ˆå¤šå‰¯ä½œç”¨ï¼Œæ¯”å¦‚ä¼ è¾“å®¹é‡è†¨èƒ€ã€å¤§å›¾ç‰‡ç­‰é—®é¢˜ã€‚å› æ­¤è¡ç”Ÿè¿æ¥å¤ç”¨æŠ€æœ¯ï¼Œå³â€œkeep aliveæœºåˆ¶â€</p>
<p><strong>æŒä¹…è¿æ¥</strong>ï¼šè®©å®¢æˆ·ç«¯å¯¹åŒä¸€ä¸ªåŸŸåé•¿æœŸæŒæœ‰ä¸€ä¸ªæˆ–å¤šä¸ªä¸ä¼šç”¨å®Œå³æ–­çš„ TCP è¿æ¥ã€‚åœ¨å®¢æˆ·ç«¯ç»´æŠ¤ä¸€ä¸ª FIFO é˜Ÿåˆ—ï¼Œæ¯æ¬¡å–å®Œæ•°æ®ä¹‹åä¸€æ®µæ—¶é—´å†…ä¸è‡ªåŠ¨æ–­å¼€è¿æ¥ï¼Œä»¥ä¾¿è·å–ä¸‹ä¸€ä¸ªèµ„æºæ—¶ç›´æ¥å¤ç”¨ï¼Œé¿å…åˆ›å»º TCP è¿æ¥çš„æˆæœ¬ã€‚</p>
<p>è¿™æ ·åˆä¼šæœ‰é˜»å¡ç­‰å¾…é—®é¢˜ï¼Œ2014å¹´åˆæå‡ºäº†â€œHTTPç®¡é“â€å¤ç”¨æŠ€æœ¯ï¼Œè®©å®¢æˆ·ç«¯ä¸€æ¬¡å°†æ‰€æœ‰è¦è¯·æ±‚çš„èµ„æºåå•å…¨éƒ¨å‘ç»™æœåŠ¡ç«¯ï¼Œç”±æœåŠ¡ç«¯æ¥å®‰æ’è¿”å›é¡ºåºï¼Œç®¡ç†ä¼ è¾“é˜Ÿåˆ—ã€‚æœåŠ¡ç«¯èƒ½å¤Ÿè¾ƒä¸ºå‡†ç¡®åœ°è¯„ä¼°èµ„æºæ¶ˆè€—æƒ…å†µï¼Œè¿›è€Œèƒ½å¤Ÿæ›´ç´§å‡‘åœ°å®‰æ’èµ„æºä¼ è¾“ï¼Œä¿è¯é˜Ÿåˆ—ä¸­ä¸¤é¡¹å·¥ä½œä¹‹é—´å°½é‡å‡å°‘ç©ºéš™ï¼Œç”šè‡³åšåˆ°å¹¶è¡ŒåŒ–ä¼ è¾“ï¼Œä»è€Œæå‡é“¾è·¯ä¼ è¾“çš„æ•ˆç‡ã€‚<br>åè°ƒå¤æ‚ï¼Œæ¨å¹¿ä¸å¤ªæˆåŠŸã€‚</p>
<p>HTTP&#x2F;2è§£å†³ï¼Œç”¨å¸§æ¥ä½œä¸ºä¿¡æ¯å•ä½ï¼ŒHTTP&#x2F;2å¤šè·¯å¤ç”¨æŠ€æœ¯ã€‚</p>
<h4 id="ä¼ è¾“å‹ç¼©"><a href="#ä¼ è¾“å‹ç¼©" class="headerlink" title="ä¼ è¾“å‹ç¼©"></a>ä¼ è¾“å‹ç¼©</h4><p>HTTPæ”¯æŒgzipï¼Œæœ€å¼€å§‹æ˜¯é™æ€é¢„å‹ç¼©ï¼Œçœ‹å®¢æˆ·ç«¯çš„æ¥å—æƒ…å†µè¿”å›ï¼Œåæ¥æ˜¯å³æ—¶å‹ç¼©ï¼Œä¸ç­‰èµ„æºå‹ç¼©å®Œæˆã€‚<br>æŒä¹…é“¾æ¥å’Œå³æ—¶å‹ç¼©åªèƒ½äºŒé€‰å…¶ä¸€<br>HTTP&#x2F;1.1å¢åŠ åˆ†å—ä¼ è¾“ç¼–ç çš„èµ„æºç»“æŸåˆ¤æ–­æœºåˆ¶ï¼Œå½»åº•è§£å†³äº† Content-Length ä¸æŒä¹…é“¾æ¥çš„å†²çªé—®é¢˜ã€‚</p>
<h4 id="å¿«é€ŸUDPç½‘ç»œè¿æ¥"><a href="#å¿«é€ŸUDPç½‘ç»œè¿æ¥" class="headerlink" title="å¿«é€ŸUDPç½‘ç»œè¿æ¥"></a>å¿«é€ŸUDPç½‘ç»œè¿æ¥</h4><p>HTTP&#x2F;3 è®¾è®¡é‡ç‚¹ï¼š HTTP over UDPï¼Œå«åšQUICï¼šå…¶ä¸ä»…èƒ½æ»¡è¶³ HTTP ä¼ è¾“åè®®ï¼Œæ—¥åè¿˜èƒ½æ”¯æŒ SMTPã€DNSã€SSHã€Telnetã€NTP ç­‰å¤šç§å…¶ä»–ä¸Šå±‚åè®®ã€‚</p>
<ul>
<li>QUICå¯é æ€§å®Œå…¨ç”±è‡ªå·±æ¥å®ç°ï¼Œèƒ½å¯¹æ¯ä¸ªæµèƒ½åšå•ç‹¬çš„æ§åˆ¶ï¼Œå¦‚æœåœ¨ä¸€ä¸ªæµä¸­å‘ç”Ÿé”™è¯¯ï¼Œåè®®æ ˆä»ç„¶å¯ä»¥ç‹¬ç«‹åœ°ç»§ç»­ä¸ºå…¶ä»–æµæä¾›æœåŠ¡ã€‚</li>
<li>QUIC æå‡ºäº†è¿æ¥æ ‡è¯†ç¬¦çš„æ¦‚å¿µï¼Œè¯¥æ ‡è¯†ç¬¦å¯ä»¥å”¯ä¸€åœ°æ ‡è¯†å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„è¿æ¥ï¼Œè€Œæ— é¡»ä¾é  IP åœ°å€ã€‚è¿™æ ·ï¼Œåˆ‡æ¢ç½‘ç»œåï¼Œåªéœ€å‘æœåŠ¡ç«¯å‘é€ä¸€ä¸ªåŒ…å«æ­¤æ ‡è¯†ç¬¦çš„æ•°æ®åŒ…å³å¯é‡ç”¨æ—¢æœ‰çš„è¿æ¥ï¼Œå› ä¸ºå³ä½¿ç”¨æˆ·çš„ IP åœ°å€å‘ç”Ÿå˜åŒ–ï¼ŒåŸå§‹è¿æ¥è¿æ¥æ ‡è¯†ç¬¦ä¾ç„¶æ˜¯æœ‰æ•ˆçš„ã€‚</li>
</ul>
<p>Google åœ¨ Chromium çš„ç½‘ç»œåè®®æ ˆä¸­åŒæ—¶å¯ç”¨äº† QUIC å’Œä¼ ç»Ÿ TCP è¿æ¥ï¼Œå¹¶åœ¨ QUIC è¿æ¥å¤±è´¥æ—¶ä»¥é›¶å»¶è¿Ÿå›é€€åˆ° TCP è¿æ¥ï¼Œå°½å¯èƒ½è®©ç”¨æˆ·æ— æ„ŸçŸ¥åœ°é€æ­¥åœ°æ‰©å¤§ QUIC çš„ä½¿ç”¨é¢ã€‚</p>
<h3 id="å†…å®¹åˆ†å‘ç½‘ç»œ"><a href="#å†…å®¹åˆ†å‘ç½‘ç»œ" class="headerlink" title="å†…å®¹åˆ†å‘ç½‘ç»œ"></a>å†…å®¹åˆ†å‘ç½‘ç»œ</h3><p>å½±å“äº’è”ç½‘ç³»ç»Ÿé€Ÿåº¦çš„å››ç‚¹å› ç´ ï¼š</p>
<ol>
<li>ç½‘ç«™æœåŠ¡å™¨æ¥å…¥ç½‘ç»œè¿è¥å•†çš„å‡ºå£å¸¦å®½</li>
<li>ç”¨æˆ·å®¢æˆ·ç«¯æ¥å…¥ç½‘ç»œè¿è¥å•†çš„é“¾è·¯æ‰€èƒ½æä¾›çš„å…¥å£å¸¦å®½ã€‚</li>
<li>ä»ç½‘ç«™åˆ°ç”¨æˆ·ä¹‹é—´ç»è¿‡çš„ä¸åŒè¿è¥å•†ä¹‹é—´äº’è”èŠ‚ç‚¹çš„å¸¦å®½</li>
<li>ä»ç½‘ç«™åˆ°ç”¨æˆ·ä¹‹é—´çš„ç‰©ç†é“¾è·¯ä¼ è¾“æ—¶å»¶</li>
</ol>
<p> CDNå¯ä»¥æ˜¾è‘—æ”¹å–„1ã€3ã€4çš„é—®é¢˜</p>
<h4 id="è·¯ç”±è§£æ"><a href="#è·¯ç”±è§£æ" class="headerlink" title="è·¯ç”±è§£æ"></a>è·¯ç”±è§£æ</h4><p>æ²¡æœ‰å†…å®¹åˆ†å‘ç½‘ç»œå‚ä¸çš„è§£æè¿‡ç¨‹ï¼š<br><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/1750989315200.png"><br>æœ‰å†…å®¹åˆ†å‘ç½‘ç»œçš„è§£æè¿‡ç¨‹ï¼š<br><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/1750989558268.png"></p>
<h4 id="å†…å®¹åˆ†å‘"><a href="#å†…å®¹åˆ†å‘" class="headerlink" title="å†…å®¹åˆ†å‘"></a>å†…å®¹åˆ†å‘</h4><p>CDN è·å–æºç«™èµ„æºçš„è¿‡ç¨‹è¢«ç§°ä¸ºâ€œå†…å®¹åˆ†å‘â€ï¼Œâ€œå†…å®¹åˆ†å‘ç½‘ç»œâ€çš„åå­—æ­£æ˜¯ç”±æ­¤è€Œæ¥ï¼Œæœ‰ä¸¤ç§åˆ†å‘æ–¹å¼ï¼š</p>
<ul>
<li>ä¸»åŠ¨åˆ†å‘ï¼šæºç«™ä¸»åŠ¨å‘èµ·ï¼Œå°†å†…å®¹ä»æºç«™æˆ–è€…å…¶ä»–èµ„æºåº“æ¨é€åˆ°ç”¨æˆ·è¾¹ç¼˜çš„å„ä¸ª CDN ç¼“å­˜èŠ‚ç‚¹ä¸Šã€‚å¯ä»¥é‡‡ç”¨ä»»ä½•ä¼ è¾“æ–¹å¼ã€æ¨é€ç­–ç•¥ã€‚åŒåä¸€è¿™ç§å°±ä¼šä¸»åŠ¨åˆ†å‘</li>
<li>è¢«åŠ¨å›æºï¼šç”±ç”¨æˆ·è®¿é—®æ‰€è§¦å‘å…¨è‡ªåŠ¨ã€åŒå‘é€æ˜çš„èµ„æºç¼“å­˜è¿‡ç¨‹ã€‚å½“æŸä¸ªèµ„æºé¦–æ¬¡è¢«ç”¨æˆ·è¯·æ±‚çš„æ—¶å€™ï¼ŒCDN ç¼“å­˜èŠ‚ç‚¹å‘ç°è‡ªå·±æ²¡æœ‰è¯¥èµ„æºï¼Œå°±ä¼šå®æ—¶ä»æºç«™ä¸­è·å–ï¼Œè¿™æ—¶èµ„æºçš„å“åº”æ—¶é—´å¯ç²—ç•¥è®¤ä¸ºæ˜¯èµ„æºä»æºç«™åˆ° CDN ç¼“å­˜èŠ‚ç‚¹çš„æ—¶é—´ï¼Œå†åŠ ä¸Šèµ„æºä» CDN å‘é€åˆ°ç”¨æˆ·çš„æ—¶é—´ä¹‹å’Œã€‚å°å‹ç«™ç‚¹ä¸€èˆ¬æ˜¯è¿™æ ·ã€‚</li>
</ul>
<h4 id="CDNåº”ç”¨"><a href="#CDNåº”ç”¨" class="headerlink" title="CDNåº”ç”¨"></a>CDNåº”ç”¨</h4><ul>
<li>åŠ é€Ÿé™æ€èµ„æº</li>
<li>å®‰å…¨é˜²å¾¡ï¼šæºç«™åªå¯¹CDNæä¾›æœåŠ¡ï¼ŒCDHå¯¹å¤–ç•Œæä¾›æœåŠ¡ï¼Œé˜²å¾¡DDosæ”»å‡»å¾ˆæœ‰æ•ˆ</li>
<li>åè®®å‡çº§ï¼šå¯¹å¤–æä¾›çš„åè®®å‡çº§</li>
<li>çŠ¶æ€ç¼“å­˜ï¼šå¯ä»¥ç¼“å­˜æºç«™çš„çŠ¶æ€</li>
<li>ä¿®æ”¹èµ„æºï¼šè¿”å›èµ„æºç»™ç”¨æˆ·å¾—æ—¶å€™å¯ä»¥ä¿®æ”¹å†…å®¹ï¼Œæ¯”å¦‚å‹ç¼©ã€æ¯”å¦‚è·¨åŸŸ</li>
<li>è®¿é—®æ§åˆ¶ï¼šå®ç°é»‘ç™½åå•åŠŸèƒ½</li>
<li>æ³¨å…¥åŠŸèƒ½ï¼šä¸è¯¥æºç«™ä»£ç ï¼Œæ³¨å…¥å„ç§åŠŸèƒ½</li>
<li>ç»•è¿‡ç½‘ç»œæªæ–½</li>
</ul>
<h3 id="è´Ÿè½½å‡è¡¡"><a href="#è´Ÿè½½å‡è¡¡" class="headerlink" title="è´Ÿè½½å‡è¡¡"></a>è´Ÿè½½å‡è¡¡</h3><blockquote>
<p><strong>è´Ÿè½½å‡è¡¡ï¼ˆLoad Balancingï¼‰</strong><br>è°ƒåº¦åæ–¹çš„å¤šå°æœºå™¨ï¼Œä»¥ç»Ÿä¸€çš„æ¥å£å¯¹å¤–æä¾›æœåŠ¡ï¼Œæ‰¿æ‹…æ­¤èŒè´£çš„æŠ€æœ¯ç»„ä»¶è¢«ç§°ä¸ºâ€œè´Ÿè½½å‡è¡¡â€ã€‚</p>
</blockquote>
<p>è´Ÿè½½å‡è¡¡å¾€å¾€æ˜¯å¤šçº§çš„ï¼Œç»„è¦èšç„¦äºç½‘ç»œè¯·æ±‚è¿›å…¥æ•°æ®ä¸­å¿ƒå…¥å£ä¹‹åçš„å…¶å®ƒå±‚çº§çš„è´Ÿè½½å‡è¡¡ã€‚</p>
<ul>
<li>å››å±‚è´Ÿè½½å‡è¡¡çš„ä¼˜åŠ¿æ˜¯æ€§èƒ½é«˜ï¼Œä¸ƒå±‚è´Ÿè½½å‡è¡¡çš„ä¼˜åŠ¿æ˜¯åŠŸèƒ½å¼ºã€‚</li>
<li>åšå¤šçº§æ··åˆè´Ÿè½½å‡è¡¡ï¼Œé€šå¸¸åº”æ˜¯ä½å±‚çš„è´Ÿè½½å‡è¡¡åœ¨å‰ï¼Œé«˜å±‚çš„è´Ÿè½½å‡è¡¡åœ¨å</li>
</ul>
<p>å››å±‚è´Ÿè½½å‡è¡¡ï¼šç»Ÿç§°ï¼Œèƒƒç—›ç»´æŒç€ä¸€ä¸ªTCPè¿æ¥ï¼Œä¸æ˜¯è¯´åªå·¥ä½œåœ¨ç¬¬å››å±‚ã€‚åªè¦å·¥ä½œåœ¨äºŒå±‚ã€ä¸‰å±‚ï¼Œå•çº¯åªå¤„ç†ç¬¬å››å±‚çš„æ•°æ®æ— æ³•åšåˆ°è´Ÿè½½å‡è¡¡çš„è½¬å‘ï¼Œå› ä¸ºä¸Šå››å±‚æ˜¯ä¸»æœºå±‚ï¼Œå·²ç»åˆ°äº†ç›®æ ‡ä¸»æœºäº†ï¼Œè°ˆä¸ä¸Šè½¬å‘ï¼Œæœ€å¤šå°±æ˜¯ä»£ç†ã€‚</p>
<table>
<thead>
<tr>
<th></th>
<th>å±‚</th>
<th>æ•°æ®å•å…ƒ</th>
<th>åŠŸèƒ½</th>
</tr>
</thead>
<tbody><tr>
<td>7</td>
<td>åº”ç”¨å±‚</td>
<td>æ•°æ®</td>
<td>æä¾›ä¸ºåº”ç”¨è½¯ä»¶æä¾›æœåŠ¡çš„æ¥å£ï¼Œç”¨äºä¸å…¶ä»–åº”ç”¨è½¯ä»¶ä¹‹é—´çš„é€šä¿¡ã€‚å…¸å‹åè®®ï¼šHTTPã€HTTPSã€FTPã€Telnetã€SSHã€SMTPã€POP3 ç­‰</td>
</tr>
<tr>
<td>6</td>
<td>è¡¨è¾¾å±‚</td>
<td>æ•°æ®</td>
<td>æŠŠæ•°æ®è½¬æ¢ä¸ºèƒ½ä¸æ¥æ”¶è€…çš„ç³»ç»Ÿæ ¼å¼å…¼å®¹å¹¶é€‚åˆä¼ è¾“çš„æ ¼å¼ã€‚</td>
</tr>
<tr>
<td>5</td>
<td>ä¼šè¯å±‚</td>
<td>æ•°æ®</td>
<td>è´Ÿè´£åœ¨æ•°æ®ä¼ è¾“ä¸­è®¾ç½®å’Œç»´æŠ¤è®¡ç®—æœºç½‘ç»œä¸­ä¸¤å°è®¡ç®—æœºä¹‹é—´çš„é€šä¿¡è¿æ¥ã€‚</td>
</tr>
<tr>
<td>4</td>
<td>ä¼ è¾“å±‚</td>
<td>æ•°æ®æ®µ</td>
<td>æŠŠä¼ è¾“è¡¨å¤´åŠ è‡³æ•°æ®ä»¥å½¢æˆæ•°æ®åŒ…ã€‚ä¼ è¾“è¡¨å¤´åŒ…å«äº†æ‰€ä½¿ç”¨çš„åè®®ç­‰å‘é€ä¿¡æ¯ã€‚å…¸å‹åè®®ï¼šTCPã€UDPã€RDPã€SCTPã€FCP ç­‰</td>
</tr>
<tr>
<td>3</td>
<td>ç½‘ç»œå±‚</td>
<td>æ•°æ®åŒ…</td>
<td>å†³å®šæ•°æ®çš„ä¼ è¾“è·¯å¾„é€‰æ‹©å’Œè½¬å‘ï¼Œå°†ç½‘ç»œè¡¨å¤´é™„åŠ è‡³æ•°æ®æ®µåä»¥å½¢æˆæŠ¥æ–‡ï¼ˆå³æ•°æ®åŒ…ï¼‰ã€‚å…¸å‹åè®®ï¼šIPv4&#x2F;IPv6ã€IGMPã€ICMPã€EGPã€RIP ç­‰</td>
</tr>
<tr>
<td>2</td>
<td>æ•°æ®é“¾è·¯å±‚</td>
<td>æ•°æ®å¸§</td>
<td>è´Ÿè´£ç‚¹å¯¹ç‚¹çš„ç½‘ç»œå¯»å€ã€é”™è¯¯ä¾¦æµ‹å’Œçº é”™ã€‚å½“è¡¨å¤´å’Œè¡¨å°¾è¢«é™„åŠ è‡³æ•°æ®åŒ…åï¼Œå°±å½¢æˆæ•°æ®å¸§ï¼ˆFrameï¼‰ã€‚å…¸å‹åè®®ï¼šWiFiï¼ˆ802.11ï¼‰ã€Ethernetï¼ˆ802.3ï¼‰ã€PPP ç­‰ã€‚</td>
</tr>
<tr>
<td>1</td>
<td>ç‰©ç†å±‚</td>
<td>æ¯”ç‰¹æµ</td>
<td>åœ¨ç‰©ç†ç½‘ç»œä¸Šä¼ é€æ•°æ®å¸§ï¼Œå®ƒè´Ÿè´£ç®¡ç†ç”µè„‘é€šä¿¡è®¾å¤‡å’Œç½‘ç»œåª’ä½“ä¹‹é—´çš„äº’é€šã€‚åŒ…æ‹¬äº†é’ˆè„šã€ç”µå‹ã€çº¿ç¼†è§„èŒƒã€é›†çº¿å™¨ã€ä¸­ç»§å™¨ã€ç½‘å¡ã€ä¸»æœºæ¥å£å¡ç­‰ã€‚</td>
</tr>
</tbody></table>
<h4 id="æ•°æ®é“¾è·¯å±‚è´Ÿè½½å‡è¡¡"><a href="#æ•°æ®é“¾è·¯å±‚è´Ÿè½½å‡è¡¡" class="headerlink" title="æ•°æ®é“¾è·¯å±‚è´Ÿè½½å‡è¡¡"></a>æ•°æ®é“¾è·¯å±‚è´Ÿè½½å‡è¡¡</h4><p>æ•°æ®é“¾è·¯å±‚ä¼ è¾“ï¼šæ•°æ®å¸§ã€‚</p>
<p>æ•°æ®å¸§ä¸­æœ‰MACæºåœ°å€ã€MACç›®æ ‡åœ°å€ã€‚<strong>æ•°æ®é“¾è·¯å±‚è´Ÿè½½å‡è¡¡ï¼Œæ ¸å¿ƒå°±æ˜¯ä¿®æ”¹è¯·æ±‚æ•°æ®å¸§ä¸­çš„MACç›®æ ‡åœ°å€ï¼Œè½¬å‘åˆ°å¯¹åº”æœåŠ¡å™¨çš„ç½‘å¡ä¸Šã€‚</strong></p>
<p>ä½¿ç”¨è¿™ç§è´Ÿè½½å‡è¡¡æ¨¡å¼æ—¶ï¼Œéœ€è¦æŠŠçœŸå®ç‰©ç†æœåŠ¡å™¨é›†ç¾¤æ‰€æœ‰æœºå™¨çš„<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Virtual_IP_address">è™šæ‹Ÿ IP åœ°å€</a>ï¼ˆVirtual IP Addressï¼ŒVIPï¼‰é…ç½®æˆä¸è´Ÿè½½å‡è¡¡å™¨çš„è™šæ‹Ÿ IP ä¸€æ ·</p>
<p>![](&#x2F;images&#x2F;å‡¤å‡°æ¶æ„&#x2F;Pasted image 20250627111727.png)<br>æ•´ä¸ªè¯·æ±‚ã€è½¬å‘ã€å“åº”çš„é“¾è·¯å½¢æˆä¸€ä¸ªâ€œä¸‰è§’å…³ç³»â€ï¼Œæ‰€ä»¥è¿™ç§è´Ÿè½½å‡è¡¡æ¨¡å¼ä¹Ÿå¸¸è¢«å¾ˆå½¢è±¡åœ°ç§°ä¸ºâ€œä¸‰è§’ä¼ è¾“æ¨¡å¼â€ï¼ˆDirect Server Returnï¼ŒDSRï¼‰</p>
<h4 id="ç½‘ç»œå±‚è´Ÿè½½å‡è¡¡"><a href="#ç½‘ç»œå±‚è´Ÿè½½å‡è¡¡" class="headerlink" title="ç½‘ç»œå±‚è´Ÿè½½å‡è¡¡"></a>ç½‘ç»œå±‚è´Ÿè½½å‡è¡¡</h4><p>ç½‘ç»œå±‚ä¼ è¾“ï¼šåˆ†ç»„æ•°æ®åŒ…ã€‚</p>
<p>åˆ†ç»„æ•°æ®åŒ…ä¸­åŒ…å«æºIPå’Œç›®çš„IPï¼Œä¹Ÿæ˜¯åŒæ ·çš„æ€è·¯ï¼Œ<strong>é€šè¿‡æ”¹å˜IPåœ°å€æ¥å®ç°æ•°æ®åŒ…çš„è½¬å‘</strong>ã€‚</p>
<ul>
<li><strong>IPéš§é“ä¼ è¾“</strong>ï¼šæ–°å»ºæ•°æ®åŒ…ï¼ŒæŠŠåŸæ¥çš„åšä¸ºæ–°æ•°æ®åŒ…çš„Payloadï¼Œæ–°åŒ…ä¸­å†™å…¥ç›®æ ‡IPï¼ŒæœåŠ¡å™¨æ”¶åˆ°åŒ…åï¼Œè¿›è¡Œæ‹†åŒ…ï¼Œæ˜¯â€œå¥—å¨ƒå¼â€çš„ä¼ è¾“ã€‚æ•ˆç‡ä½ï¼Œä¾ç„¶è¿˜æ˜¯ä¸‰è§’ä¼ è¾“ï¼Œå¯ä»¥è·¨è¶ŠVLANã€‚<br>![](&#x2F;images&#x2F;å‡¤å‡°æ¶æ„&#x2F;Pasted image 20250627140319.png)<br>ä¸€æ˜¯è¦æ±‚çœŸå®æœåŠ¡å™¨å¿…é¡»æ”¯æŒIPéš§é“åè®®ï¼ŒäºŒåå¿…é¡»é€šè¿‡ä¸“é—¨é…ç½®ï¼Œéƒ½æœ‰ç›¸åŒçš„è™šæ‹ŸIPï¼Œéœ€è¦ç³»ç»Ÿç®¡ç†å‘˜ä»‹å…¥ã€‚</li>
<li><strong>NATï¼ˆç½‘ç»œåœ°å€è½¬æ¢ï¼‰</strong>ï¼šæ”¹å˜ç›®æ ‡æ•°æ®åŒ…ï¼Œä¸éœ€è¦æ‹†åŒ…ã€‚ä¿®æ”¹äº†ä¹‹åï¼Œå®¢æˆ·ç«¯ä¸å¯èƒ½è®¤è¯†è¯¥IPï¼Œè¿˜å¾—å¿…é¡»å†è¿”å›åˆ°è´Ÿè½½å‡è¡¡ã€‚<br>![](&#x2F;images&#x2F;å‡¤å‡°æ¶æ„&#x2F;Pasted image 20250627140927.png)<br>æµé‡å‹åŠ›æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œä¼šæœ‰æ€§èƒ½æŸå¤±</li>
<li><strong>SNAT</strong>ï¼šåœ¨è½¬å‘æ—¶å€™ï¼Œä¸ä»…ä¿®æ”¹ç›®æ ‡çš„IPï¼ŒæºIPä¹Ÿä¸€èµ·æ”¹ï¼Œæ”¹æˆå‡è¡¡å™¨è‡ªå·±çš„IPã€‚å¥½å¤„å°±æ˜¯ä¸é…ç½‘å…³å°±å¯ä»¥æ­£å¸¸ä¸‰å±‚è·¯ç”±åˆ°è´Ÿè½½å‡è¡¡å•†ï¼Œç¼ºç‚¹æ˜¯æ‰€æœ‰æµé‡éƒ½æ¥è‡ªè´Ÿè½½å‡è¡¡å™¨ï¼Œæœ‰ä¸€äº›éœ€è¦æ ¹æ®ç›®æ ‡IPæ§åˆ¶çš„çº¦ä¸ºé€»è¾‘æ— æ³•è¿›è¡Œã€‚</li>
</ul>
<h4 id="åº”ç”¨å±‚è´Ÿè½½å‡è¡¡"><a href="#åº”ç”¨å±‚è´Ÿè½½å‡è¡¡" class="headerlink" title="åº”ç”¨å±‚è´Ÿè½½å‡è¡¡"></a>åº”ç”¨å±‚è´Ÿè½½å‡è¡¡</h4><p>å››å±‚è´Ÿè½½å‡è¡¡å·¥ä½œæ¨¡å¼ï¼Œæœ¬è´¨è¿˜æ˜¯è½¬å‘ï¼›<br>å››å±‚ä»¥ä¸Šçš„è´Ÿè½½å‡è¡¡ï¼Œåªèƒ½è¿›è¡Œä»£ç†ã€‚<br>![](&#x2F;images&#x2F;å‡¤å‡°æ¶æ„&#x2F;Pasted image 20250627142731.png)</p>
<p>ä»£ç†ï¼Œæ ¹æ®â€å“ªä¸€æ–¹èƒ½æ„ŸçŸ¥åˆ°â€œçš„åŸåˆ™ï¼Œåˆ†æ­£å‘ä»£ç†ã€åå‘ä»£ç†ã€é€æ˜ä»£ç†ã€‚</p>
<ul>
<li>æ­£å‘ä»£ç†ï¼šåœ¨å®¢æˆ·ç«¯è®¾ç½®çš„ï¼Œæ­£å‘ä»£ç†æœåŠ¡ï¼ŒVPN</li>
<li>åå‘ä»£ç†ï¼šåœ¨æœåŠ¡å™¨è®¾ç½®çš„ï¼Œå¯¹å®¢æˆ·ç«¯é€æ˜</li>
<li>é€æ˜ä»£ç†ï¼šå¯¹åŒæ–¹éƒ½é€æ˜ï¼Œæ¯”å¦‚æ¶è®¾åœ¨è·¯ç”±å™¨ä¸Šçš„é€æ˜ç¿»å¢™ä»£ç†ã€‚</li>
</ul>
<p>ä¸ƒå±‚è´Ÿè½½å‡è¡¡å™¨å±äºåå‘ä»£ç†ï¼Œç½‘ç»œæ€§èƒ½è‚¯å®šæ¯”ä¸è¿‡å››å±‚å‡è¡¡å™¨ã€‚ç”±äºå®ƒè‡³å°‘å¤šä¸€è½®TCPæ¡æ‰‹ã€‚ä¸»è¦çš„åº”ç”¨å°±æ˜¯åˆ©ç”¨å®ƒåœ¨åº”ç”¨å±‚é€šä¿¡çš„ä¼˜åŠ¿ï¼Œè¿›è¡Œå†³ç­–ã€‚ä¸ƒå±‚ä»£ç†çš„åŠŸèƒ½ï¼š</p>
<ul>
<li>CDNç¼“å­˜</li>
<li>æ™ºèƒ½åŒ–è·¯ç”±</li>
<li>å®‰å…¨é˜²å¾¡</li>
<li>é“¾è·¯æ²»ç†</li>
</ul>
<h4 id="å‡è¡¡ç­–ç•¥ä¸å®ç°"><a href="#å‡è¡¡ç­–ç•¥ä¸å®ç°" class="headerlink" title="å‡è¡¡ç­–ç•¥ä¸å®ç°"></a>å‡è¡¡ç­–ç•¥ä¸å®ç°</h4><p>è´Ÿè½½å‡è¡¡çš„ä¸¤å¤§èŒè´£æ˜¯â€œé€‰æ‹©è°æ¥å¤„ç†ç”¨æˆ·è¯·æ±‚â€å’Œâ€œå°†ç”¨æˆ·è¯·æ±‚è½¬å‘è¿‡å»â€ï¼Œè½¬å‘å‰é¢å·²ç»ä»‹ç»ï¼Œå¤„ç†ç­–ç•¥å¦‚ä¸‹ï¼š</p>
<ul>
<li>è½®è¯¢å‡è¡¡ï¼šä»1åˆ°Nå¹³å‡åˆ†é…</li>
<li>æƒé‡è½®è¯¢å‡è¡¡ï¼šåˆ†æƒé‡åˆ†é…</li>
<li>éšæœºå‡è¡¡ï¼šéšæœºåˆ†é…ç»™å¤šä¸ªæœåŠ¡å™¨</li>
<li>ä¸€è‡´æ€§å“ˆå¸Œå‡è¡¡ï¼šç®—æ³•ä¿è¯åŒä¸€ä¸ªç‰¹å¾å€¼ä¸€å®šè½åœ¨ç›¸åŒçš„æœåŠ¡å™¨ä¸Š</li>
<li>å“åº”é€Ÿåº¦å‡è¡¡ï¼šå‘æœåŠ¡å™¨å‘å‡ºæ¢æµ‹è¯·æ±‚ï¼Œå“ªä¸ªå—ç»™å“ªä¸ª</li>
<li>æœ€å°‘è¿æ¥æ•°å‡è¡¡ï¼šå¯¹æ¯ä¸€å°æœåŠ¡å™¨éƒ½æœ‰æ•°æ®è®°å½•ï¼Œåˆ†ç»™è¿æ¥æ•°æœ€å°çš„æœåŠ¡å™¨ã€‚</li>
</ul>
<p>æŒ‰ç…§å®ç°å…·ä½“å¯ä»¥åˆ†ä¸ºè½¯è´Ÿè½½å’Œç¡¬è´Ÿè½½ï¼š</p>
<ul>
<li>è½¯è´Ÿè½½ï¼šæ“ä½œç³»ç»Ÿï¼ˆLVSï¼‰ã€åº”ç”¨ç¨‹åºï¼ˆNginxã€HAproxyï¼‰</li>
<li>ç¡¬è´Ÿè½½ï¼šF5ã€A10</li>
</ul>
<h3 id="æœåŠ¡ç«¯ç¼“å­˜"><a href="#æœåŠ¡ç«¯ç¼“å­˜" class="headerlink" title="æœåŠ¡ç«¯ç¼“å­˜"></a>æœåŠ¡ç«¯ç¼“å­˜</h3><p>å¼•å…¥ç¼“å­˜çš„ä¸¤å¤§ç†ç”±ï¼š</p>
<ol>
<li>ä¸ºç¼“è§£CPUå‹åŠ›è€Œåšç¼“å­˜ï¼šæŠŠåŸæ¥å®æ—¶è®¡ç®—çš„å†…å®¹æå‰ç®—å¥½ï¼ŒèŠ‚çœCPUç®—åŠ›</li>
<li>ä¸ºç¼“è§£I&#x2F;Oå‹åŠ›è€Œåšç¼“å­˜ï¼šç½‘ç»œã€ç£ç›˜æ…¢ä»‹è´¨å˜ä¸ºå†…å­˜è¿™ç±»å¿«ä»‹è´¨</li>
</ol>
<p>ç¼“å­˜ï¼Œç©ºé—´æ¢æ—¶é—´ï¼Œå‡ºå‘ç‚¹å°±æ˜¯ç¼“è§£CPUå’ŒI&#x2F;Oçš„å‹åŠ›ã€‚</p>
<h4 id="ç¼“å­˜å±æ€§"><a href="#ç¼“å­˜å±æ€§" class="headerlink" title="ç¼“å­˜å±æ€§"></a>ç¼“å­˜å±æ€§</h4><p>è®¾è®¡ç¼“å­˜è‡³å°‘è€ƒè™‘å››ä¸ªç»´åº¦ï¼š</p>
<ul>
<li><strong>ååé‡</strong>ï¼šç¼“å­˜çš„ååé‡ä½¿ç”¨ OPS å€¼ï¼ˆæ¯ç§’æ“ä½œæ•°ï¼ŒOperations per Secondï¼Œops&#x2F;sï¼‰æ¥è¡¡é‡ï¼Œåæ˜ äº†å¯¹ç¼“å­˜è¿›è¡Œ<strong>å¹¶å‘</strong>è¯»ã€å†™æ“ä½œçš„æ•ˆç‡ï¼Œå³ç¼“å­˜æœ¬èº«çš„å·¥ä½œæ•ˆç‡é«˜ä½ã€‚</li>
<li><strong>å‘½ä¸­ç‡</strong>ï¼šç¼“å­˜çš„å‘½ä¸­ç‡å³æˆåŠŸä»ç¼“å­˜ä¸­è¿”å›ç»“æœæ¬¡æ•°ä¸æ€»è¯·æ±‚æ¬¡æ•°çš„æ¯”å€¼ï¼Œåæ˜ äº†å¼•å…¥ç¼“å­˜çš„ä»·å€¼é«˜ä½ï¼Œå‘½ä¸­ç‡è¶Šä½ï¼Œå¼•å…¥ç¼“å­˜çš„æ”¶ç›Šè¶Šå°ï¼Œä»·å€¼è¶Šä½ã€‚</li>
<li><strong>æ‰©å±•åŠŸèƒ½</strong>ï¼šç¼“å­˜é™¤äº†åŸºæœ¬è¯»å†™åŠŸèƒ½å¤–ï¼Œè¿˜æä¾›å“ªäº›é¢å¤–çš„ç®¡ç†åŠŸèƒ½ï¼Œè­¬å¦‚æœ€å¤§å®¹é‡ã€å¤±æ•ˆæ—¶é—´ã€å¤±æ•ˆäº‹ä»¶ã€å‘½ä¸­ç‡ç»Ÿè®¡ï¼Œç­‰ç­‰ã€‚</li>
<li><strong>åˆ†å¸ƒå¼æ”¯æŒ</strong>ï¼šç¼“å­˜å¯åˆ†ä¸ºâ€œè¿›ç¨‹å†…ç¼“å­˜â€å’Œâ€œåˆ†å¸ƒå¼ç¼“å­˜â€ä¸¤å¤§ç±»ï¼Œå‰è€…åªä¸ºèŠ‚ç‚¹æœ¬èº«æä¾›æœåŠ¡ï¼Œæ— ç½‘ç»œè®¿é—®æ“ä½œï¼Œé€Ÿåº¦å¿«ä½†ç¼“å­˜çš„æ•°æ®ä¸èƒ½åœ¨å„ä¸ªæœåŠ¡èŠ‚ç‚¹ä¸­å…±äº«ï¼Œåè€…åˆ™ç›¸å</li>
</ul>
<h5 id="ååé‡"><a href="#ååé‡" class="headerlink" title="ååé‡"></a>ååé‡</h5><p>JDK 8 æ”¹è¿›ä¹‹åçš„ ConcurrentHashMap åŸºæœ¬ä¸Šå°±æ˜¯ä½ èƒ½æ‰¾åˆ°çš„ååé‡æœ€é«˜çš„ç¼“å­˜å®¹å™¨</p>
<p>å¯¹è¯»å†™æ“ä½œçš„çŠ¶æ€ç»´æŠ¤ï¼Œæœ‰ä¸¤ç§æ€è·¯ï¼š</p>
<ul>
<li>åŒæ­¥å¤„ç†ï¼ŒGuava Cacheï¼Œåœ¨è®¿é—®æ•°æ®æ—¶ä¸€å¹¶å®Œæˆç¼“å­˜æ·˜æ±°ã€ç»Ÿè®¡ã€å¤±æ•ˆç­‰çŠ¶æ€å˜æ›´æ“ä½œï¼Œé€šè¿‡åˆ†æ®µåŠ é”ä¼˜åŒ–å‡å°‘ç«äº‰ã€‚</li>
<li>å¼‚æ­¥å¤„ç†ï¼ŒCaffeineï¼Œå°†å¯¹æ•°æ®çš„è¯»ã€å†™è¿‡ç¨‹çœ‹ä½œæ˜¯æ—¥å¿—ï¼ˆå³å¯¹æ•°æ®çš„æ“ä½œæŒ‡ä»¤ï¼‰çš„æäº¤è¿‡ç¨‹ã€‚</li>
</ul>
<h5 id="å‘½ä¸­ç‡ä¸æ·˜æ±°ç­–ç•¥"><a href="#å‘½ä¸­ç‡ä¸æ·˜æ±°ç­–ç•¥" class="headerlink" title="å‘½ä¸­ç‡ä¸æ·˜æ±°ç­–ç•¥"></a>å‘½ä¸­ç‡ä¸æ·˜æ±°ç­–ç•¥</h5><p><strong>æ·˜æ±°ç­–ç•¥</strong>ï¼šç¼“å­˜å¦‚ä½•è‡ªåŠ¨åœ°å®ç°æ·˜æ±°ä½ä»·å€¼ç›®æ ‡ï¼Œæœ€åŸºç¡€çš„æ·˜æ±°ç­–ç•¥å®ç°æ–¹æ¡ˆæœ‰ä»¥ä¸‹ä¸‰ç§ï¼š</p>
<ul>
<li>FIFOï¼šä¼˜å…ˆæ·˜æ±°æœ€æ—©è¿›å…¥è¢«ç¼“å­˜çš„æ•°æ®</li>
<li>LRUï¼šä¼˜å…ˆæ·˜æ±°æœ€ä¹…æœªè¢«ä½¿ç”¨è®¿é—®è¿‡çš„æ•°æ®ï¼ŒHashMap+Linkedlistå®ç°ï¼Œçƒ­ç‚¹æœ‰ç‚¹æ—¶é—´æ²¡è®¿é—®è¿‡ï¼Œå¯èƒ½ä¹Ÿä¼šè¢«æ·˜æ±°</li>
<li>LFUï¼šä¼˜å…ˆæ·˜æ±°æœ€ä¸ç»å¸¸ä½¿ç”¨çš„æ•°æ®ï¼Œè®¿é—®è®¡æ•°ï¼Œè§£å†³æƒ¹ç‚¹é—®é¢˜ï¼Œä½†æ˜¯éœ€è¦é¢å¤–ç»´æŠ¤è®¡æ•°å™¨<ul>
<li><strong>TinyLFU</strong>ï¼šä¸ºäº†ç¼“è§£ LFU æ¯æ¬¡è®¿é—®éƒ½è¦ä¿®æ”¹è®¡æ•°å™¨æ‰€å¸¦æ¥çš„æ€§èƒ½è´Ÿæ‹…ï¼Œç”¨ç›¸å¯¹å°å¾—å¤šçš„è®°å½•é¢‘ç‡å’Œç©ºé—´æ¥è¿‘ä¼¼åœ°æ‰¾å‡ºç¼“å­˜ä¸­çš„ä½ä»·å€¼æ•°æ®</li>
<li><strong>W-TinyLFU</strong>ï¼šåº”å¯¹ç¨€ç–çªå‘è®¿é—®</li>
</ul>
</li>
</ul>
<h5 id="æ‰©å±•åŠŸèƒ½"><a href="#æ‰©å±•åŠŸèƒ½" class="headerlink" title="æ‰©å±•åŠŸèƒ½"></a>æ‰©å±•åŠŸèƒ½</h5><p>ä¸“ä¸šçš„ç¼“å­˜å¾€å¾€è¿˜ä¼šæä¾›å¾ˆå¤šé¢å¤–çš„åŠŸèƒ½ï¼š</p>
<ul>
<li>åŠ è½½å™¨ï¼šè®©ç¼“å­˜ä»åªèƒ½è¢«åŠ¨å­˜å‚¨å¤–éƒ¨æ”¾å…¥çš„æ•°æ®ï¼Œå˜ä¸ºèƒ½å¤Ÿä¸»åŠ¨é€šè¿‡åŠ è½½å™¨å»åŠ è½½æŒ‡å®š Key å€¼çš„æ•°æ®ï¼ŒåŠ è½½å™¨ä¹Ÿæ˜¯å®ç°è‡ªåŠ¨åˆ·æ–°åŠŸèƒ½çš„åŸºç¡€å‰æã€‚</li>
<li>æ·˜æ±°ç­–ç•¥ï¼šæ”¯æŒç”¨æˆ·è‡ªå·±æ ¹æ®éœ€è¦é€‰æ‹©ä¸åŒçš„æ·˜æ±°ç­–ç•¥ã€‚</li>
<li>å¤±æ•ˆç­–ç•¥ï¼šè¦æ±‚ç¼“å­˜çš„æ•°æ®åœ¨ä¸€å®šæ—¶é—´åè‡ªåŠ¨å¤±æ•ˆæˆ–è€…è‡ªåŠ¨åˆ·æ–°ã€‚</li>
<li>äº‹ä»¶é€šçŸ¥ï¼šæä¾›ä¸€äº›äº‹ä»¶ç›‘å¬å™¨</li>
<li>å¹¶å‘çº§åˆ«ï¼šå¯¹äºé€šè¿‡åˆ†æ®µåŠ é”æ¥å®ç°çš„ç¼“å­˜ï¼ˆä»¥ Guava Cache ä¸ºä»£è¡¨ï¼‰ï¼Œå¾€å¾€ä¼šæä¾›å¹¶å‘çº§åˆ«çš„è®¾ç½®ã€‚</li>
<li>å®¹é‡æ§åˆ¶ï¼šç¼“å­˜é€šå¸¸éƒ½æ”¯æŒæŒ‡å®šåˆå§‹å®¹é‡å’Œæœ€å¤§å®¹é‡ï¼Œåˆå§‹å®¹é‡ç›®çš„æ˜¯å‡å°‘æ‰©å®¹é¢‘ç‡</li>
<li>æŒä¹…åŒ–ï¼šæ”¯æŒå°†ç¼“å­˜çš„å†…å®¹å­˜å‚¨åˆ°æ•°æ®åº“æˆ–è€…ç£ç›˜ä¸­</li>
</ul>
<h5 id="åˆ†å¸ƒå¼ç¼“å­˜"><a href="#åˆ†å¸ƒå¼ç¼“å­˜" class="headerlink" title="åˆ†å¸ƒå¼ç¼“å­˜"></a>åˆ†å¸ƒå¼ç¼“å­˜</h5><ul>
<li>å¤åˆ¶å¼ç¼“å­˜ï¼šç”šå°‘æ›´æ–°ä½†é¢‘ç¹è¯»å–çš„æ•°æ®ã€‚ç¼“å­˜ä¸­æ‰€æœ‰æ•°æ®åœ¨åˆ†å¸ƒå¼é›†ç¾¤çš„æ¯ä¸ªèŠ‚ç‚¹é‡Œé¢éƒ½å­˜åœ¨æœ‰ä¸€ä»½å‰¯æœ¬ï¼Œè¯»å–æ•°æ®æ—¶æ— é¡»ç½‘ç»œè®¿é—®ï¼Œç›´æ¥ä»å½“å‰èŠ‚ç‚¹çš„è¿›ç¨‹å†…å­˜ä¸­è¿”å›ï¼Œç†è®ºä¸Šå¯ä»¥åšåˆ°ä¸è¿›ç¨‹å†…ç¼“å­˜ä¸€æ ·é«˜çš„è¯»å–æ€§èƒ½</li>
<li>é›†ä¸­å¼ç¼“å­˜ï¼šæ›´æ–°å’Œè¯»å–éƒ½è¾ƒä¸ºé¢‘ç¹çš„æ•°æ®ã€‚Redisæˆä¸ºäº†åˆ†å¸ƒå¼ç¼“å­˜çš„å®è´¨ä¸Šçš„é¦–é€‰ï¼Œå‡ ä¹åˆ°äº†ä¸å¿…ç®¡è¯»å–ã€å†™å…¥å“ªç§æ“ä½œæ›´é¢‘ç¹ï¼Œéƒ½å¯ä»¥æ— è„‘ä¸Š Redis çš„ç¨‹åº¦ã€‚</li>
</ul>
<p>ä¸€è‡´æ€§æ–¹é¢ï¼Œä¸€èˆ¬ä¹Ÿä¸ä¼šè¿½æ±‚å¼ºä¸€è‡´æ€§çš„æ•°æ®ä½¿ç”¨ç¼“å­˜æ¥å¤„ç†ã€‚æ¯”å¦‚Rediså°±æ˜¯å…¸å‹çš„APå¼ï¼Œä¸ä¿è¯å¼ºä¸€è‡´æ€§ã€‚</p>
<p>Â ZooKeeperã€Doozerdã€Etcdæ˜¯èƒ½å¤Ÿä¿è¯å¼ºä¸€è‡´æ€§çš„åˆ†å¸ƒå¼åè°ƒæ¡†æ¶ï¼Œå…¶å¸¸ä¸ Redis å’Œå…¶ä»–åˆ†å¸ƒå¼ç¼“å­˜æ­é…å·¥ä½œï¼Œç”¨æ¥å®ç°å…¶ä¸­çš„é€šçŸ¥ã€åè°ƒã€é˜Ÿåˆ—ã€åˆ†å¸ƒå¼é”ç­‰åŠŸèƒ½ã€‚</p>
<p>åˆ†å¸ƒå¼ç¼“å­˜å’Œè¿›ç¨‹å†…ç¼“å­˜å„æœ‰æ‰€é•¿ï¼Œå¯ä»¥æ­é…å½¢æˆé€æ˜å¤šçº§ç¼“å­˜<br>![](&#x2F;images&#x2F;å‡¤å‡°æ¶æ„&#x2F;Pasted image 20250630144540.png)</p>
<h4 id="ç¼“å­˜é£é™©"><a href="#ç¼“å­˜é£é™©" class="headerlink" title="ç¼“å­˜é£é™©"></a>ç¼“å­˜é£é™©</h4><ul>
<li><strong>ç¼“å­˜ç©¿é€</strong>ï¼šæŸ¥è¯¢ä¸å­˜åœ¨æ•°æ®ï¼Œæœ‰ä¸¤ç§åŠæ³•ï¼Œä¸€æ˜¯æœ¬èº«æ— æ³•é¿å…çš„ï¼Œè¿”å›ç©ºå€¼ï¼ŒäºŒæ˜¯æ¶æ„æ”»å‡»çš„ï¼Œè®¾ç½®å¸ƒéš†è¿‡æ»¤å™¨ï¼Œæœ€å°ä»£ä»·åˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨é›†åˆ</li>
<li><strong>ç¼“å­˜å‡»ç©¿</strong>ï¼šå•ä¸ªçƒ­ç‚¹æ•°æ®å¤±æ•ˆï¼Œå¯¼è‡´å…¶éƒ½åˆ°çœŸå®çš„æ•°æ®æºé‡ã€‚æœ‰ä¸¤ç§åŠæ³•ï¼Œä¸€æ˜¯ä»¥è¯·æ±‚è¯¥æ•°æ®çš„ Key å€¼ä¸ºé”ï¼Œä½¿å¾—åªæœ‰ç¬¬ä¸€ä¸ªè¯·æ±‚å¯ä»¥æµå…¥åˆ°çœŸå®çš„æ•°æ®æºä¸­ï¼›äºŒæ˜¯ä»£ç ç®¡ç†çƒ­ç‚¹æ•°æ®ï¼Œè‡ªåŠ¨ç®¡ç†</li>
<li><strong>ç¼“å­˜é›ªå´©</strong>ï¼šå¤§æ‰¹æ•°æ®åœ¨çŸ­æ—¶é—´å†…ä¸€èµ·å¤±æ•ˆï¼Œå¯¼è‡´å‹åŠ›æ®å¢ã€‚æœ‰ä¸‰ç§åŠæ³•ï¼šä¸€æ˜¯æå‡å¯ç”¨æ€§ï¼›äºŒæ˜¯å¤šçº§é€æ˜ç¼“å­˜ï¼Œåˆ†æ•£è¿‡æœŸæ—¶é—´ï¼›ä¸‰æ˜¯ç”Ÿå­˜æœŸæ”¹æˆéšæœºæ—¶é—´ã€‚</li>
<li><strong>ç¼“å­˜æ±¡æŸ“</strong>ï¼šç¼“å­˜æ•°æ®ä¸çœŸå®æ•°æ®ä¸ä¸€è‡´ã€‚åº”è¯¥éµå¾ªæ›´æ–°ç¼“å­˜è§„èŒƒï¼Œæ¯”å¦‚Cache Asideæ¨¡å¼ï¼Œå…ˆè¯»ç¼“å­˜ï¼Œæ²¡æœ‰è¯»æºï¼Œæ”¾å…¥å†å“åº”ï¼Œå†™æ—¶å…ˆå†™æ•°æ®æºï¼Œç„¶åå¤±æ•ˆç¼“å­˜ã€‚ä¸€å®šæ˜¯<strong>å…ˆæ•°æ®æºåç¼“å­˜</strong>ã€‚</li>
</ul>
<h2 id="æ¶æ„å®‰å…¨æ€§"><a href="#æ¶æ„å®‰å…¨æ€§" class="headerlink" title="æ¶æ„å®‰å…¨æ€§"></a>æ¶æ„å®‰å…¨æ€§</h2><h3 id="è®¤è¯"><a href="#è®¤è¯" class="headerlink" title="è®¤è¯"></a>è®¤è¯</h3><blockquote>
<p><strong>è®¤è¯ï¼ˆAuthenticationï¼‰</strong><br>ç³»ç»Ÿå¦‚ä½•æ­£ç¡®åˆ†è¾¨å‡ºæ“ä½œç”¨æˆ·çš„çœŸå®èº«ä»½ï¼Ÿ</p>
</blockquote>
<p>ä»£ç è®¤è¯çš„ç ”ç©¶å‘å±•æ–¹å‘å·²ç»å¾ˆå›ºå®šï¼ŒåŸºæœ¬ä¸Šéƒ½ç»Ÿä¸€åˆ°è¯ä¹¦ç­¾åä¸Šï¼Œæœ¬ä¹¦ä¸»è¦ç ”ç©¶ç”¨æˆ·è®¤è¯ã€‚</p>
<h4 id="è®¤è¯çš„æ ‡å‡†"><a href="#è®¤è¯çš„æ ‡å‡†" class="headerlink" title="è®¤è¯çš„æ ‡å‡†"></a>è®¤è¯çš„æ ‡å‡†</h4><p>ä¸»æµçš„ä¸‰ç§è®¤è¯æ–¹å¼</p>
<ul>
<li>é€šä¿¡ä¿¡é“ä¸Šçš„è®¤è¯ï¼šä¼ è¾“å¾—æ—¶å€™è¯æ˜ä½ æ˜¯è°ï¼ˆSSL&#x2F;TSLè®¤è¯ï¼‰</li>
<li>é€šä¿¡åè®®ä¸Šçš„è®¤è¯ï¼šè¯·æ±‚æˆ‘èµ„æºå‰è¯æ˜ä½ æ˜¯è°ï¼ˆHTTPè®¤è¯ï¼‰</li>
<li>é€šä¿¡å†…å®¹ä¸Šçš„è®¤è¯ï¼šä½¿ç”¨æˆ‘æœåŠ¡å™¨è¯æ˜ä½ æ˜¯è°ï¼ˆWebå†…å®¹è®¤è¯ï¼‰</li>
</ul>
<h5 id="HTTPè®¤è¯"><a href="#HTTPè®¤è¯" class="headerlink" title="HTTPè®¤è¯"></a>HTTPè®¤è¯</h5><p>HTTP è®¤è¯æ¡†æ¶æå‡ºè®¤è¯æ–¹æ¡ˆæ˜¯å¸Œæœ›èƒ½æŠŠè®¤è¯â€œè¦äº§ç”Ÿèº«ä»½å‡­è¯â€çš„ç›®çš„ä¸â€œå…·ä½“å¦‚ä½•äº§ç”Ÿå‡­è¯â€çš„å®ç°åˆ†ç¦»å¼€æ¥ã€‚</p>
<p><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/1751337254849.png"></p>
<h5 id="Webè®¤è¯"><a href="#Webè®¤è¯" class="headerlink" title="Webè®¤è¯"></a>Webè®¤è¯</h5><p>é‡‡ç”¨HTTPè®¤è¯çš„æ¯”ä¾‹å¾ˆä½ï¼Œå› ä¸ºHTTPæœ¬è´¨æ—¶ä¼ è¾“èµ„æºï¼Œåªèƒ½é¢å‘ä¼ è¾“åè®®è®¾è®¡è®¤è¯æ¡†æ¶ã€‚</p>
<p><strong>Webè®¤è¯</strong>ï¼šç”±ç³»ç»Ÿæœ¬èº«çš„åŠŸèƒ½å®Œæˆï¼Œå®ç°å½¢å¼ä¸Šç™»å½•è¡¨å•å äº†ä¸»æµï¼Œå› æ­¤ä¹Ÿè¢«ç§°ä¸ºâ€œè¡¨å•è®¤è¯â€</p>
<p>WebAuthnæ³¨å†Œæµç¨‹ï¼š<br><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/1751339849482.png"></p>
<h4 id="è®¤è¯çš„å®ç°"><a href="#è®¤è¯çš„å®ç°" class="headerlink" title="è®¤è¯çš„å®ç°"></a>è®¤è¯çš„å®ç°</h4><p>åœ¨ä»Šæ—¶ä»Šæ—¥ï¼Œå®é™…æ´»è·ƒäº Java å®‰å…¨é¢†åŸŸçš„æ˜¯ä¸¤ä¸ªç§æœ‰çš„å®‰å…¨æ¡†æ¶ï¼šApache Shiro å’Œ Spring Security</p>
<ul>
<li>Shiroï¼šä¾¿æ·æ˜“ç”¨</li>
<li>Securityï¼šå¤æ‚å¼ºå¤§<br>åŒ…å«åŠŸèƒ½ï¼šè®¤è¯ã€å®‰å…¨ä¸Šä¸‹æ–‡ã€æˆæƒã€å¯†ç çš„å­˜å‚¨ä¸éªŒè¯ã€‚</li>
</ul>
<h3 id="æˆæƒ"><a href="#æˆæƒ" class="headerlink" title="æˆæƒ"></a>æˆæƒ</h3><blockquote>
<p><strong>æˆæƒï¼ˆ Authorizationï¼‰</strong><br>ç³»ç»Ÿå¦‚ä½•æ§åˆ¶ä¸€ä¸ªç”¨æˆ·è¯¥çœ‹åˆ°å“ªäº›æ•°æ®ã€èƒ½æ“ä½œå“ªäº›åŠŸèƒ½ï¼Ÿ</p>
</blockquote>
<p>4Aï¼ˆAuthenticationã€Authorizationã€Auditã€Accountï¼‰ï¼Œå®‰å…¨é¢†åŸŸçš„æˆæƒå…·ä½“æ¶‰åŠä¸¤ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li><strong>æˆæƒè¿‡ç¨‹å¯é </strong>ï¼šå¤šæ–¹æˆæƒåè®®ï¼šOAuth2ã€SAML2.0</li>
<li><strong>æˆæƒç»“æœå¯æ§</strong>ï¼šè‡ªä¸»è®¿é—®æ§åˆ¶DACã€åŸºäºå±æ€§è®¿é—®æ§åˆ¶ABACã€åŸºäºè§’è‰²è®¿é—®æ§åˆ¶RBAC</li>
</ul>
<h4 id="RBAC"><a href="#RBAC" class="headerlink" title="RBAC"></a>RBAC</h4><p>æ‰€æœ‰çš„è®¿é—®æ§åˆ¶æ¨¡å‹ï¼Œå®è´¨ä¸Šéƒ½æ˜¯åœ¨è§£å†³åŒä¸€ä¸ªé—®é¢˜ï¼šâ€œ<strong>è°</strong>ï¼ˆUserï¼‰æ‹¥æœ‰ä»€ä¹ˆ<strong>æƒé™</strong>ï¼ˆAuthorityï¼‰å»<strong>æ“ä½œ</strong>ï¼ˆOperationï¼‰å“ªäº›<strong>èµ„æº</strong>ï¼ˆResourceï¼‰â€ã€‚</p>
<p>RBAC å°†æƒé™ä»ç”¨æˆ·èº«ä¸Šå‰¥ç¦»ï¼Œæ”¹ä¸ºç»‘å®šåˆ°â€œ<strong>è§’è‰²</strong>â€ï¼ˆRoleï¼‰ä¸Šï¼Œå°†æƒé™æ§åˆ¶å˜ä¸ºå¯¹â€œ<strong>è§’è‰²</strong>æ‹¥æœ‰æ“ä½œå“ªäº›<strong>èµ„æº</strong>çš„<strong>è®¸å¯</strong>â€è¿™ä¸ªé€»è¾‘è¡¨è¾¾å¼çš„å€¼æ˜¯å¦ä¸ºçœŸçš„æ±‚è§£è¿‡ç¨‹ã€‚</p>
<p><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/1751445826794.png"></p>
<p>å¤©ç„¶æ»¡è¶³â€œæœ€å°ç‰¹æƒåŸåˆ™â€ï¼Œå…è®¸è§’è‰²ä¹‹é—´å®šä¹‰å…³è”ä¸çº¦æŸï¼ˆç»§æ‰¿å…³ç³»ï¼‰ã€ä¸åŒè§’è‰²ä¹‹é—´ä¹Ÿå¯ä»¥å…·æœ‰äº’æ–¥æ€§ã€‚</p>
<h4 id="OAuth2"><a href="#OAuth2" class="headerlink" title="OAuth2"></a>OAuth2</h4><p>Â OAuth2 æ˜¯<strong>é¢å‘äºè§£å†³ç¬¬ä¸‰æ–¹åº”ç”¨</strong>ï¼ˆThird-Party Applicationï¼‰çš„è®¤è¯æˆæƒåè®®ã€‚<br>Â å…³é”®æœ¯è¯­ï¼š<br>Â - ç¬¬ä¸‰æ–¹åº”ç”¨ï¼šéœ€è¦å¾—åˆ°æˆæƒè®¿é—®æˆ‘èµ„æºçš„é‚£ä¸ªåº”ç”¨<br>Â - æˆæƒæœåŠ¡å™¨ï¼šèƒ½å¤Ÿæ ¹æ®æˆ‘çš„æ„æ„¿æä¾›æˆæƒçš„æœåŠ¡å™¨<br>Â - èµ„æºæœåŠ¡å™¨ï¼šèƒ½å¤Ÿæä¾›ç¬¬ä¸‰æ–¹åº”ç”¨æ‰€éœ€èµ„æºçš„æœåŠ¡å™¨<br>Â - èµ„æºæ‰€æœ‰è€…ï¼šæ‹¥æœ‰æˆæƒæƒé™çš„äººï¼Œå³æ­¤åœºæ™¯ä¸­çš„â€œæˆ‘â€ã€‚<br>Â - æ“ä½œä»£ç†ï¼šæŒ‡ç”¨æˆ·ç”¨æ¥è®¿é—®æœåŠ¡å™¨çš„å·¥å…·</p>
<p>OAuth2 ä¸€å…±æå‡ºäº†å››ç§ä¸åŒçš„æˆæƒæ–¹å¼</p>
<ol>
<li>æˆæƒç æ¨¡å¼ï¼šæœ€ä¸¥è°¨ï¼Œè€ƒè™‘äº†æ‰€æœ‰æ•æ„Ÿä¿¡æ¯æ³„éœ²çš„é¢„é˜²å’Œåæœ</li>
<li>éšå¼æˆæƒæ¨¡å¼ï¼šç•¥æ‰äº†é€šè¿‡æˆæƒç æ¢å–ä»¤ç‰Œçš„æ­¥éª¤ï¼Œæ•´ä¸ªæˆæƒè¿‡ç¨‹éƒ½ä¸éœ€è¦æœåŠ¡ç«¯æ”¯æŒ</li>
<li>å¯†ç æ¨¡å¼ï¼šè®¤è¯å’Œæˆæƒå°±è¢«æ•´åˆæˆäº†åŒä¸€ä¸ªè¿‡ç¨‹</li>
<li>å®¢æˆ·ç«¯æ¨¡å¼ï¼šæ²¡æœ‰äº†â€œç¬¬äºŒæ–¹â€çš„å­˜åœ¨</li>
</ol>
<h3 id="å‡­è¯"><a href="#å‡­è¯" class="headerlink" title="å‡­è¯"></a>å‡­è¯</h3><blockquote>
<p><strong>å‡­è¯ï¼ˆCredentialsï¼‰</strong><br>ç³»ç»Ÿå¦‚ä½•ä¿è¯å®ƒä¸ç”¨æˆ·ä¹‹é—´çš„æ‰¿è¯ºæ˜¯åŒæ–¹å½“æ—¶çœŸå®æ„å›¾çš„ä½“ç°ï¼Œæ˜¯å‡†ç¡®ã€å®Œæ•´ä¸”ä¸å¯æŠµèµ–çš„ï¼Ÿ</p>
</blockquote>
<p>å…±äº«çŠ¶æ€ä¿¡æ¯åœ¨æœåŠ¡ç«¯è¿˜æ˜¯å®¢æˆ·ç«¯ï¼Œåˆ†åŒ–ä¸ºCookiesã€Sessionä»¥åŠJWTã€‚</p>
<h4 id="Cookie-Session"><a href="#Cookie-Session" class="headerlink" title="Cookie-Session"></a>Cookie-Session</h4><p>Â HTTP åè®®æ— çŠ¶æ€ï¼Œæœ€æœ‰æ‚–äºå¸¸è§çš„ç½‘ç»œåº”ç”¨åœºæ™¯å°±æ˜¯è®¤è¯æˆæƒã€‚<br>Â RFC 6265è§„èŒƒå®šä¹‰äº†HTTPçŠ¶æ€ç®¡ç†æœºåˆ¶ï¼Œåœ¨åè®®ç§å¢åŠ äº†Set-CookieæŒ‡ä»¤ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œç³»ç»Ÿä¼šæŠŠçŠ¶æ€ä¿¡æ¯ä¿å­˜åœ¨æœåŠ¡ç«¯ï¼Œåœ¨Cookieé‡Œåªä¼ è¾“ä¸€ä¸ªæ— æ„ä¹‰çš„å­—ç¬¦ä¸²ï¼Œä»¥sessionidä¸ºåã€‚<br>Â Cookie-Session ä¹Ÿæ˜¯æœ€ä¼ ç»Ÿçš„ï¼Œç”±æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯è”åŠ¨æ¥å®Œæˆçš„çŠ¶æ€ç®¡ç†æœºåˆ¶ã€‚</p>
<p>å½“æœåŠ¡å™¨æ°´å¹³æ‹“å±•æ—¶ï¼Œè®¾è®¡è€…å¿…é¡»åœ¨CAPä¸­é€‰æ‹©ç‰ºç‰²</p>
<p><strong>åˆ†å¸ƒå¼ä¸‹çš„è®¤è¯æˆæƒé—®é¢˜ï¼Œä¸ä¸€å®šåªèƒ½ä¾é å…±äº«ä¿¡æ¯å®ç°</strong><br>JWT ä»¤ç‰Œä¸ Cookie-Session å¹¶ä¸æ˜¯å®Œå…¨å¯¹ç­‰çš„è§£å†³æ–¹æ¡ˆï¼Œå®ƒåªç”¨æ¥å¤„ç†è®¤è¯æˆæƒé—®é¢˜ï¼Œå……å…¶é‡èƒ½æºå¸¦å°‘é‡éæ•æ„Ÿçš„ä¿¡æ¯ï¼Œåªæ˜¯ Cookie-Session åœ¨è®¤è¯æˆæƒé—®é¢˜ä¸Šçš„æ›¿ä»£å“</p>
<h4 id="JWT"><a href="#JWT" class="headerlink" title="JWT"></a>JWT</h4><p>å½“æœåŠ¡å™¨å­˜åœ¨å¤šä¸ªï¼Œå®¢æˆ·ç«¯åªæœ‰ä¸€ä¸ªæ—¶ï¼ŒæŠŠçŠ¶æ€ä¿¡æ¯å­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼Œæ¯æ¬¡éšç€è¯·æ±‚å‘å›æœåŠ¡å™¨å»ã€‚æ ‡å‡†ç­”æ¡ˆå°±æ˜¯JWTã€‚<br>æœ€å¸¸è§çš„ä½¿ç”¨æ–¹å¼æ˜¯é™„åœ¨åä¸º Authorization çš„ Header å‘é€ç»™æœåŠ¡ç«¯</p>
<p>JWTä»¤ç‰Œä»¥JSONç»“æ„å­˜å‚¨ï¼Œåˆ†ä¸‰ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li>ä»¤ç‰Œå¤´ï¼šå±•ç¤ºä»¤ç‰Œç±»å‹å’Œç­¾åç®—æ³•</li>
<li>è´Ÿè½½ï¼šçœŸæ­£éœ€è¦å‘æœåŠ¡ç«¯ä¼ é€’çš„ä¿¡æ¯ï¼Œå‘Šè¯‰æœåŠ¡å™¨ç”¨æˆ·æ˜¯è°ï¼Œæ‹¥æœ‰ä»€ä¹ˆæƒé™</li>
<li>ç­¾åï¼šä½¿ç”¨åœ¨å¯¹è±¡å¤´ä¸­å…¬å¼€çš„ç‰¹å®šç­¾åç®—æ³•ï¼Œé€šè¿‡ç‰¹å®šçš„å¯†é’¥å¯¹å‰é¢ä¸¤éƒ¨åˆ†å†…å®¹è¿›è¡ŒåŠ å¯†è®¡ç®—ï¼Œä¿è¯ä¿¡æ¯å¯ä¿¡ã€‚<br>JWTçš„ç¼ºç‚¹ï¼š</li>
<li>ä»¤ç‰Œéš¾ä»¥ä¸»åŠ¨å¤±æ•ˆ</li>
<li>ç›¸å¯¹æ›´å®¹æ˜“é­å—é‡æ”¾æ”»å‡»</li>
<li>åªèƒ½æºå¸¦ç›¸å½“æœ‰é™çš„æ•°æ®</li>
<li>å¿…é¡»è€ƒè™‘ä»¤ç‰Œåœ¨å®¢æˆ·ç«¯å¦‚ä½•å­˜å‚¨</li>
<li>æ— çŠ¶æ€ä¸ä¹Ÿæ€»æ˜¯å¥½çš„</li>
</ul>
<h3 id="ä¿å¯†"><a href="#ä¿å¯†" class="headerlink" title="ä¿å¯†"></a>ä¿å¯†</h3><blockquote>
<p><strong>ä¿å¯†ï¼ˆConfidentialityï¼‰</strong><br>ç³»ç»Ÿå¦‚ä½•ä¿è¯æ•æ„Ÿæ•°æ®æ— æ³•è¢«åŒ…æ‹¬ç³»ç»Ÿç®¡ç†å‘˜åœ¨å†…çš„å†…å¤–éƒ¨äººå‘˜æ‰€çªƒå–ã€æ»¥ç”¨ï¼Ÿ</p>
</blockquote>
<p>åŠ å¯†å’Œè§£å¯†çš„ç»Ÿç§°<br>æŒ‰ç…§ç¼“è§£å¯ä»¥åˆ†ä¸ºâ€œç«¯çš„ä¿å¯†â€å’Œâ€œé“¾è·¯çš„ä¿å¯†â€ä¸¤ç±»</p>
<h4 id="ä¿å¯†çš„å¼ºåº¦"><a href="#ä¿å¯†çš„å¼ºåº¦" class="headerlink" title="ä¿å¯†çš„å¼ºåº¦"></a>ä¿å¯†çš„å¼ºåº¦</h4><p>åˆ†çº§å¼€å±•ä¿¡æ¯ä¿å¯†ã€‚ä»¥ç”¨æˆ·ç™»å½•ä¸ºä¾‹ï¼Œä¾‹ä¸¾äº†å‡ ç§ä¸åŒå¼ºåº¦çš„ä¿å¯†æ‰‹æ®µï¼š</p>
<ul>
<li>æ‘˜è¦ä»£æ›¿æ˜æ–‡ï¼šæ— æ³•é˜²æ­¢å¼±å¯†ç è¢«å½©è™¹è¡¨æ”»å‡»</li>
<li>åŠ ç›å†å“ˆå¸Œï¼šä¸èƒ½é˜²æ­¢åŠ å¯†è¢«ç›‘å¬ã€å†’è®¤ç­‰é—®é¢˜</li>
<li>ç‰©ç†è®¾å¤‡Uç›¾ï¼šå¼€è¾Ÿç‹¬ç«‹äºç½‘ç»œçš„ä¿¡æ¯é€šé“</li>
</ul>
<h4 id="å®¢æˆ·ç«¯åŠ å¯†"><a href="#å®¢æˆ·ç«¯åŠ å¯†" class="headerlink" title="å®¢æˆ·ç«¯åŠ å¯†"></a>å®¢æˆ·ç«¯åŠ å¯†</h4><p>çœŸæ­£é˜²å¾¡æ€§çš„å¯†ç åŠ å¯†å­˜å‚¨ç¡®å®åº”è¯¥åœ¨æœåŠ¡ç«¯ä¸­è¿›è¡Œ</p>
<h4 id="å¯†ç å­˜å‚¨å’ŒéªŒè¯"><a href="#å¯†ç å­˜å‚¨å’ŒéªŒè¯" class="headerlink" title="å¯†ç å­˜å‚¨å’ŒéªŒè¯"></a>å¯†ç å­˜å‚¨å’ŒéªŒè¯</h4><p>ä»‹ç»å¯¹ä¸€ä¸ªæ™®é€šå®‰å…¨å¼ºåº¦çš„ä¿¡æ¯ç³»ç»Ÿï¼Œå¯†ç å¦‚ä½•ä»å®¢æˆ·ç«¯ä¼ è¾“åˆ°æœåŠ¡ç«¯ï¼Œç„¶åå­˜å‚¨è¿›æ•°æ®åº“çš„å…¨è¿‡ç¨‹ã€‚</p>
<ol>
<li>è¾“å…¥æ˜æ–‡å¯†ç </li>
<li>ç®€å•å“ˆå¸Œæ‘˜è¦</li>
<li>åŠ ç›å¤„ç†</li>
<li>å¼•å…¥æ…¢å“ˆå¸Œå‡½æ•°</li>
<li>å¼•å…¥éšæœºç›å€¼</li>
<li>å°†åŠ¨æ€ç›å€¼æ··å…¥å®¢æˆ·ç«¯ä¼ æ¥çš„å“ˆå¸Œå€¼å†åšä¸€æ¬¡å“ˆå¸Œ</li>
</ol>
<h3 id="ä¼ è¾“"><a href="#ä¼ è¾“" class="headerlink" title="ä¼ è¾“"></a>ä¼ è¾“</h3><blockquote>
<p><strong>ä¼ è¾“ï¼ˆTransport Securityï¼‰</strong><br>ç³»ç»Ÿå¦‚ä½•ä¿è¯é€šè¿‡ç½‘ç»œä¼ è¾“çš„ä¿¡æ¯æ— æ³•è¢«ç¬¬ä¸‰æ–¹çªƒå¬ã€ç¯¡æ”¹å’Œå†’å……ï¼Ÿ</p>
</blockquote>
<h4 id="æ‘˜è¦ã€åŠ å¯†ä¸ç­¾å"><a href="#æ‘˜è¦ã€åŠ å¯†ä¸ç­¾å" class="headerlink" title="æ‘˜è¦ã€åŠ å¯†ä¸ç­¾å"></a>æ‘˜è¦ã€åŠ å¯†ä¸ç­¾å</h4><p>æ‘˜è¦ç§°ä¹‹ä¸ºæ•°å­—æ‘˜è¦ï¼ˆDigital Digestï¼‰æˆ–æ•°å­—æŒ‡çº¹ï¼ˆDigital Fingerprintï¼‰ã€‚JWT ä»¤ç‰Œä¸­é»˜è®¤çš„ç­¾åä¿¡æ¯æ˜¯å¯¹ä»¤ç‰Œå¤´ã€è´Ÿè½½å’Œå¯†é’¥ä¸‰è€…é€šè¿‡ä»¤ç‰Œå¤´ä¸­æŒ‡å®šçš„å“ˆå¸Œç®—æ³•ï¼ˆHMAC SHA256ï¼‰è®¡ç®—å‡ºæ¥çš„æ‘˜è¦å€¼</p>
<p>ç†æƒ³å’Œå“ˆå¸Œç®—æ³•æœ‰æ˜“å˜æ€§ã€ä¸å¯é€†æ€§ä¸¤å¤§ç‰¹ç‚¹ã€‚æ‘˜è¦çš„æ„ä¹‰æ˜¯åœ¨æºä¿¡æ¯ä¸æ³„æ¼çš„å‰æä¸‹è¾¨åˆ«å…¶çœŸä¼ªã€‚æ‘˜è¦ä¹Ÿä¼šç”¨æ¥åšåŠ å¯†å’Œç­¾åã€‚</p>
<ul>
<li><p>ä¸åŠ å¯†çš„åŒºåˆ«ï¼ŒåŠ å¯†æ˜¯å¯é€†çš„ã€‚ç°ä»£å¯†ç å­¦ä¸ä¾é æœºå¯†æ€§ï¼ŒåŠ è§£å¯†ç®—æ³•éƒ½æ˜¯å®Œå…¨å…¬å¼€çš„ï¼Œå®‰å…¨å»ºç«‹åœ¨ç‰¹å®šé—®é¢˜çš„è®¡ç®—å¤æ‚åº¦ä¹‹ä¸Šï¼Œå…·ä½“æ˜¯æŒ‡ç®—æ³•æ ¹æ®è¾“å…¥ç«¯è®¡ç®—è¾“å‡ºç»“æœè€—è´¹çš„ç®—åŠ›èµ„æºå¾ˆå°ï¼Œä½†æ ¹æ®è¾“å‡ºç«¯çš„ç»“æœåè¿‡æ¥æ¨ç®—åŸæœ¬çš„è¾“å…¥ï¼Œè€—è´¹çš„ç®—åŠ›å°±æå…¶åºå¤§ã€‚</p>
</li>
<li><p>åœ¨ç­¾åæ–¹é¢ï¼Œç°åœ¨ä¸€èˆ¬ä¼šç»“åˆæ‘˜è¦ä¸éå¯¹ç§°åŠ å¯†çš„ä¼˜ç‚¹ï¼Œä»¥å¯¹æ‘˜è¦ç»“æœåšåŠ å¯†çš„å½¢å¼æ¥ä¿è¯ç­¾åçš„é€‚ç”¨æ€§ã€‚ç”±äºå¯¹ä»»ä½•é•¿åº¦çš„è¾“å…¥æºåšæ‘˜è¦ä¹‹åéƒ½èƒ½å¾—åˆ°å›ºå®šé•¿åº¦çš„ç»“æœï¼Œæ‰€ä»¥åªè¦å¯¹æ‘˜è¦çš„ç»“æœè¿›è¡Œç­¾åï¼Œå³ç›¸å½“äºå¯¹æ•´ä¸ªè¾“å…¥æºè¿›è¡Œäº†èƒŒä¹¦ï¼Œä¿è¯ä¸€æ—¦å†…å®¹é­åˆ°ç¯¡æ”¹ï¼Œæ‘˜è¦ç»“æœå°±ä¼šå˜åŒ–ï¼Œç­¾åä¹Ÿå°±é©¬ä¸Šå¤±æ•ˆäº†ã€‚</p>
</li>
</ul>
<p> <img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/1751785359667.png"></p>
<h4 id="æ•°å­—è¯ä¹¦"><a href="#æ•°å­—è¯ä¹¦" class="headerlink" title="æ•°å­—è¯ä¹¦"></a>æ•°å­—è¯ä¹¦</h4><p>æ— æ³•ä»¥â€œç­¾åâ€çš„æ‰‹æ®µæ¥è¾¾æˆä¿¡ä»»æ—¶â€”â€”å…¬å¼€å¯†é’¥åŸºç¡€è®¾æ–½PKIï¼Œå€ŸåŠ©æ•°å­—è¯ä¹¦è®¤è¯ä¸­å¿ƒCAå°†ç”¨æˆ·å’Œå…¬å¼€å¯†é’¥è¿æ¥ã€‚<br>PKIæ˜¯è´Ÿè´£å‘æ”¾å’Œç®¡ç†æ•°å­—è¯ä¹¦çš„æƒå¨æœºæ„</p>
<p>è¯ä¹¦ï¼ˆCertificateï¼‰ï¼Œè¯ä¹¦æ˜¯æƒå¨ CA ä¸­å¿ƒå¯¹ç‰¹å®šå…¬é’¥ä¿¡æ¯çš„ä¸€ç§å…¬è¯è½½ä½“ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºæ˜¯æƒå¨ CA å¯¹ç‰¹å®šå…¬é’¥æœªè¢«ç¯¡æ”¹çš„ç­¾åèƒŒä¹¦ã€‚è¯ä¹¦æœ‰å…·ä½“æ ‡å‡†å’ŒåŒ…å«çš„ä¿¡æ¯é¡¹</p>
<h4 id="ä¼ è¾“å®‰å…¨å±‚"><a href="#ä¼ è¾“å®‰å…¨å±‚" class="headerlink" title="ä¼ è¾“å®‰å…¨å±‚"></a>ä¼ è¾“å®‰å…¨å±‚</h4><p>è¿™é‡Œä»‹ç»äº†TLSé€šä¿¡çš„ä¿éšœè¿‡ç¨‹ã€‚</p>
<h3 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h3><p>æå€¡çš„åšæ³•æ˜¯æŠŠæ ¡éªŒè¡Œä¸ºä»åˆ†å±‚ä¸­å‰¥ç¦»å‡ºæ¥ï¼Œä¸æ˜¯åœ¨å“ªä¸€å±‚åšï¼Œè€Œæ˜¯åœ¨ Bean ä¸Šåšã€‚å³ Java Bean Validationã€‚</p>
<h1 id="åˆ†å¸ƒå¼çš„åŸºçŸ³"><a href="#åˆ†å¸ƒå¼çš„åŸºçŸ³" class="headerlink" title="åˆ†å¸ƒå¼çš„åŸºçŸ³"></a>åˆ†å¸ƒå¼çš„åŸºçŸ³</h1><h2 id="åˆ†å¸ƒå¼å…±è¯†ç®—æ³•"><a href="#åˆ†å¸ƒå¼å…±è¯†ç®—æ³•" class="headerlink" title="åˆ†å¸ƒå¼å…±è¯†ç®—æ³•"></a>åˆ†å¸ƒå¼å…±è¯†ç®—æ³•</h2><p>å¦‚ä½•é‡è¦æ•°æ®çš„å¯é æ€§ï¼ˆå¤šå°æœºå™¨æ•°æ®ä¸€è‡´ï¼‰ã€å¯ç”¨æ€§ï¼ˆå¤šå°æœºå™¨æ•°æ®å¯è®¿é—®ï¼‰</p>
<p>â“å¦‚æœä½ æœ‰ä¸€ä»½ä¼šéšæ—¶å˜åŠ¨çš„æ•°æ®ï¼Œè¦ç¡®ä¿å®ƒæ­£ç¡®åœ°å­˜å‚¨äºç½‘ç»œä¸­çš„å‡ å°ä¸åŒæœºå™¨ä¹‹ä¸Šï¼Œä½ ä¼šæ€ä¹ˆåšï¼Ÿ</p>
<ul>
<li>å°†åŒæ­¥è§†ä¸ºäº‹åŠ¡æ€§æ“ä½œï¼š2PCã€3PCå®ç°ï¼Œå®ŒæˆåŒæ­¥æ“ä½œ</li>
<li>ä¸»ä»å…¨åŒæ­¥å¤åˆ¶ï¼ˆ<strong>çŠ¶æ€è½¬ç§»</strong>ï¼‰ï¼šMysqlï¼Œç­‰å¾…æ‰€æœ‰ Slave èŠ‚ç‚¹çš„ Binlog éƒ½å®Œæˆå†™å…¥åï¼ŒMaster èŠ‚ç‚¹çš„äº‹åŠ¡æ‰è¿›è¡Œæäº¤</li>
</ul>
<p>å¯é æ€§ä¸å¯ç”¨æ€§çŸ›ç›¾ï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿé‡Œä¸»æµçš„æ•°æ®å¤åˆ¶æ–¹æ³•æ˜¯ä»¥<strong>æ“ä½œè½¬ç§»ï¼ˆOperation Transferï¼‰</strong> ä¸ºåŸºç¡€ï¼Œç±»ä¼¼äºçŠ¶æ€æœºï¼Œæå‡ºçŠ¶æ€æœºå¤åˆ¶ã€‚</p>
<p><strong>Quorumæœºåˆ¶</strong>ï¼šä¸€æ—¦ç³»ç»Ÿä¸­è¿‡åŠæ•°çš„èŠ‚ç‚¹ä¸­å®Œæˆäº†çŠ¶æ€çš„è½¬æ¢ï¼Œå°±è®¤ä¸ºæ•°æ®çš„å˜åŒ–å·²ç»è¢«æ­£ç¡®åœ°å­˜å‚¨åœ¨ç³»ç»Ÿå½“ä¸­ï¼Œè¿™æ ·å°±å¯ä»¥å®¹å¿å°‘æ•°ï¼ˆé€šå¸¸æ˜¯ä¸è¶…è¿‡åŠæ•°ï¼‰çš„èŠ‚ç‚¹å¤±è”ï¼Œä½¿å¾—å¢åŠ æœºå™¨æ•°é‡å¯¹ç³»ç»Ÿæ•´ä½“çš„å¯ç”¨æ€§å˜æˆæ˜¯æœ‰ç›Šçš„ã€‚</p>
<p><strong>åå•†å…±è¯†ç®—æ³•</strong>ï¼šéœ€è¦è®¾è®¡å‡ºä¸€ç§ç®—æ³•ï¼Œèƒ½å¤Ÿè®©åˆ†å¸ƒå¼ç³»ç»Ÿå†…éƒ¨æš‚æ—¶å®¹å¿å­˜åœ¨ä¸åŒçš„çŠ¶æ€ï¼Œä½†æœ€ç»ˆèƒ½å¤Ÿä¿è¯å¤§å¤šæ•°èŠ‚ç‚¹çš„çŠ¶æ€è¾¾æˆä¸€è‡´ï¼›åŒæ—¶ï¼Œèƒ½å¤Ÿè®©åˆ†å¸ƒå¼ç³»ç»Ÿåœ¨å¤–éƒ¨çœ‹æ¥å§‹ç»ˆè¡¨ç°å‡ºæ•´ä½“ä¸€è‡´çš„ç»“æœã€‚</p>
<p>Tipsï¼šå…±è¯†æ˜¯è¾¾æˆä¸€è‡´æ€§çš„æ–¹æ³•å’Œè¿‡ç¨‹ï¼Œä¸€è‡´æ€§æ˜¯æ•°æ®ä¸åŒå‰¯æœ¬ä¹‹é—´çš„å·®å¼‚</p>
<h3 id="Paxos"><a href="#Paxos" class="headerlink" title="Paxos"></a>Paxos</h3><blockquote>
<p><strong>Distributed Consensus Algorithm</strong><br>ä¸–ç•Œä¸Šåªæœ‰ä¸€ç§å…±è¯†åè®®ï¼Œå°±æ˜¯ Paxosï¼Œå…¶ä»–æ‰€æœ‰å…±è¯†ç®—æ³•éƒ½æ˜¯ Paxos çš„é€€åŒ–ç‰ˆæœ¬ã€‚</p>
</blockquote>
<p>Leslie Lamportæå‡ºPaxoxï¼Œä¸€ç§åŸºäºæ¶ˆæ¯ä¼ é€’çš„åå•†å…±è¯†ç®—æ³•</p>
<h4 id="Paxosçš„è¯ç”Ÿ"><a href="#Paxosçš„è¯ç”Ÿ" class="headerlink" title="Paxosçš„è¯ç”Ÿ"></a>Paxosçš„è¯ç”Ÿ</h4><p>è™šæ„äº†â€œPaxosâ€å¸Œè…ŠåŸé‚¦ï¼Œè¦åˆ¶å®šæ³•å¾‹ï¼Œéœ€è¦é å…¼èŒè®®ä¼šæ¥å®Œæˆï¼Œæ— æ³•ä¿è¯æ‰€æœ‰åŸé‚¦å±…æ°‘éƒ½èƒ½å¤ŸåŠæ—¶åœ°äº†è§£æ–°çš„æ³•å¾‹ææ¡ˆã€ä¹Ÿæ— æ³•ä¿è¯å±…æ°‘ä¼šåŠæ—¶ä¸ºææ¡ˆæŠ•ç¥¨ã€‚</p>
<p>ç›®æ ‡ï¼šè®©åŸé‚¦èƒ½å¤Ÿåœ¨æ¯ä¸€ä½å±…æ°‘éƒ½ä¸æ‰¿è¯ºä¸€å®šä¼šåŠæ—¶å‚ä¸çš„æƒ…å†µä¸‹ï¼Œä¾ç„¶å¯ä»¥æŒ‰ç…§å°‘æ•°æœä»å¤šæ•°çš„åŸåˆ™ï¼Œæœ€ç»ˆè¾¾æˆä¸€è‡´æ„è§ã€‚ï¼ˆä¸è€ƒè™‘é”™ä¼ ï¼‰</p>
<h4 id="ç®—æ³•æµç¨‹"><a href="#ç®—æ³•æµç¨‹" class="headerlink" title="ç®—æ³•æµç¨‹"></a>ç®—æ³•æµç¨‹</h4><ul>
<li><strong>ææ¡ˆèŠ‚ç‚¹</strong>ï¼šç§°ä¸º Proposerï¼Œæå‡ºå¯¹æŸä¸ªå€¼è¿›è¡Œè®¾ç½®æ“ä½œçš„èŠ‚ç‚¹ï¼Œè®¾ç½®å€¼è¿™ä¸ªè¡Œä¸ºå°±è¢«ç§°ä¹‹ä¸º<strong>ææ¡ˆ</strong>ï¼ˆProposalï¼‰ï¼Œå€¼ä¸€æ—¦è®¾ç½®æˆåŠŸï¼Œå°±æ˜¯ä¸ä¼šä¸¢å¤±ä¹Ÿä¸å¯å˜çš„ã€‚è¯·æ³¨æ„ï¼ŒPaxos æ˜¯å…¸å‹çš„åŸºäºæ“ä½œè½¬ç§»æ¨¡å‹è€ŒéçŠ¶æ€è½¬ç§»æ¨¡å‹æ¥è®¾è®¡çš„ç®—æ³•ï¼Œè¿™é‡Œçš„â€œè®¾ç½®å€¼â€ä¸è¦ç±»æ¯”æˆç¨‹åºä¸­å˜é‡èµ‹å€¼æ“ä½œï¼Œåº”è¯¥ç±»æ¯”æˆæ—¥å¿—è®°å½•æ“ä½œï¼Œåœ¨åé¢ä»‹ç»çš„ Raft ç®—æ³•ä¸­å°±ç›´æ¥æŠŠâ€œææ¡ˆâ€å«ä½œâ€œæ—¥å¿—â€äº†ã€‚</li>
<li><strong>å†³ç­–èŠ‚ç‚¹</strong>ï¼šç§°ä¸º Acceptorï¼Œæ˜¯åº”ç­”ææ¡ˆçš„èŠ‚ç‚¹ï¼Œå†³å®šè¯¥ææ¡ˆæ˜¯å¦å¯è¢«æŠ•ç¥¨ã€æ˜¯å¦å¯è¢«æ¥å—ã€‚ææ¡ˆä¸€æ—¦å¾—åˆ°è¿‡åŠæ•°å†³ç­–èŠ‚ç‚¹çš„æ¥å—ï¼Œå³ç§°è¯¥ææ¡ˆè¢«<strong>æ‰¹å‡†</strong>ï¼ˆAcceptï¼‰ï¼Œææ¡ˆè¢«æ‰¹å‡†å³æ„å‘³ç€è¯¥å€¼ä¸èƒ½å†è¢«æ›´æ”¹ï¼Œä¹Ÿä¸ä¼šä¸¢å¤±ï¼Œä¸”æœ€ç»ˆæ‰€æœ‰èŠ‚ç‚¹éƒ½ä¼šæ¥å—è¯¥å®ƒã€‚</li>
<li><strong>è®°å½•èŠ‚ç‚¹</strong>ï¼šè¢«ç§°ä¸º Learnerï¼Œä¸å‚ä¸ææ¡ˆï¼Œä¹Ÿä¸å‚ä¸å†³ç­–ï¼Œåªæ˜¯å•çº¯åœ°ä»ææ¡ˆã€å†³ç­–èŠ‚ç‚¹ä¸­å­¦ä¹ å·²ç»è¾¾æˆå…±è¯†çš„ææ¡ˆï¼Œè­¬å¦‚å°‘æ•°æ´¾èŠ‚ç‚¹ä»ç½‘ç»œåˆ†åŒºä¸­æ¢å¤æ—¶ï¼Œå°†ä¼šè¿›å…¥è¿™ç§çŠ¶æ€ã€‚</li>
</ul>
<p><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/c9c77ab9-785d-4a81-b812-b4eb1b7dad20.png">ï¼ˆéœ€è¦åå¤çœ‹ï¼‰</p>
<h3 id="Multi-Paxos"><a href="#Multi-Paxos" class="headerlink" title="Multi Paxos"></a>Multi Paxos</h3><p><strong>æ ¸å¿ƒæ”¹è¿›</strong>ï¼š</p>
<ul>
<li>å¢åŠ äº†â€œé€‰ä¸»â€çš„è¿‡ç¨‹ï¼Œææ¡ˆèŠ‚ç‚¹ä¼šé€šè¿‡å®šæ—¶è½®è¯¢ï¼ˆå¿ƒè·³ï¼‰ï¼Œç¡®å®šå½“å‰ç½‘ç»œä¸­çš„æ‰€æœ‰èŠ‚ç‚¹é‡Œæ˜¯å¦å­˜åœ¨æœ‰ä¸€ä¸ªä¸»ææ¡ˆèŠ‚ç‚¹ï¼Œä¸€æ—¦æ²¡æœ‰å‘ç°ä¸»èŠ‚ç‚¹å­˜åœ¨ï¼ŒèŠ‚ç‚¹å°±ä¼šåœ¨å¿ƒè·³è¶…æ—¶åä½¿ç”¨ Basic Paxos ä¸­å®šä¹‰çš„å‡†å¤‡ã€æ‰¹å‡†çš„ä¸¤è½®ç½‘ç»œäº¤äº’è¿‡ç¨‹ï¼Œå‘æ‰€æœ‰å…¶ä»–èŠ‚ç‚¹å¹¿æ’­è‡ªå·±å¸Œæœ›ç«é€‰ä¸»èŠ‚ç‚¹çš„è¯·æ±‚ï¼Œå¸Œæœ›æ•´ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿå¯¹â€œç”±æˆ‘ä½œä¸ºä¸»èŠ‚ç‚¹â€è¿™ä»¶äº‹æƒ…åå•†è¾¾æˆä¸€è‡´å…±è¯†ï¼Œå¦‚æœå¾—åˆ°äº†å†³ç­–èŠ‚ç‚¹ä¸­å¤šæ•°æ´¾çš„æ‰¹å‡†ï¼Œä¾¿å®£å‘Šç«é€‰æˆåŠŸã€‚</li>
<li>é€šä¿—ç†è§£ä¸ºé€‰ä¸»è¿‡åï¼Œå°±ä¸ä¼šå†æœ‰å…¶ä»–èŠ‚ç‚¹ä¸å®ƒç«äº‰ï¼Œç›¸å½“äºæ˜¯å¤„äºæ— å¹¶å‘çš„ç¯å¢ƒå½“ä¸­è¿›è¡Œçš„æœ‰åºæ“ä½œï¼Œæ‰€ä»¥æ­¤æ—¶ç³»ç»Ÿä¸­è¦å¯¹æŸä¸ªå€¼è¾¾æˆä¸€è‡´ï¼Œåªéœ€è¦è¿›è¡Œä¸€æ¬¡æ‰¹å‡†çš„äº¤äº’å³å¯ï¼Œ</li>
</ul>
<p><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/213d39e5-7f0b-4a89-b39a-27ab3920a36e.png"><br>â€œåˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¦‚ä½•å¯¹æŸä¸ªå€¼è¾¾æˆä¸€è‡´â€ è½¬åŒ–ä¸ºå¦‚ä¸‹ä¸‰ä¸ªå­é—®é¢˜ï¼š</p>
<ul>
<li>å¦‚ä½•é€‰ä¸»</li>
<li>å¦‚ä½•æŠŠæ•°æ®å¤åˆ¶åˆ°å„ä¸ªèŠ‚ç‚¹ä¸Š</li>
<li>å¦‚ä½•ä¿è¯è¿‡ç¨‹æ˜¯å®‰å…¨çš„<br><strong>Raft ç®—æ³•</strong> ï¼šå°±æ˜¯è¿™ç§è§£é¢˜æ€è·¯ï¼Œ Etcdã€LogCabinã€Consul ç­‰é‡è¦åˆ†å¸ƒå¼ç¨‹åºçš„å®ç°åŸºç¡€</li>
</ul>
<h3 id="Gossip-åè®®"><a href="#Gossip-åè®®" class="headerlink" title="Gossip åè®®"></a>Gossip åè®®</h3><p>åˆ†å¸ƒå¼å…±è¯†åè®®ï¼š</p>
<ul>
<li>å¼ºä¸€è‡´æ€§ï¼šPaxosã€Raftã€ZAB ç­‰åˆ†å¸ƒå¼ç®—æ³•ï¼ˆä»ç³»ç»Ÿå¤–éƒ¨çœ‹æ¥ï¼Œä¸ä¸€è‡´çš„æƒ…å†µå¹¶ä¸ä¼šè¢«è§‚å¯Ÿåˆ°ï¼Œæ‰€ä»¥æ•´ä½“ä¸Šçœ‹ç³»ç»Ÿæ˜¯å¼ºä¸€è‡´æ€§çš„ï¼‰</li>
<li>æœ€ç»ˆä¸€è‡´æ€§ï¼šGossip åè®®ï¼Œä¸ä¸€è‡´çš„çŠ¶æ€æœ‰å¯èƒ½ä¼šåœ¨ä¸€å®šæ—¶é—´å†…è¢«å¤–éƒ¨ç›´æ¥è§‚å¯Ÿåˆ°</li>
</ul>
<p>åŒºå—é“¾ã€DNSä¸­æ‰€æœ‰ä½¿ç”¨åˆ°ã€‚<br><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250725003457545.png"></p>
<p>æ­¥éª¤ï¼š</p>
<ul>
<li>å¦‚æœæœ‰æŸä¸€é¡¹ä¿¡æ¯éœ€è¦åœ¨æ•´ä¸ªç½‘ç»œä¸­æ‰€æœ‰èŠ‚ç‚¹ä¸­ä¼ æ’­ï¼Œé‚£ä»ä¿¡æ¯æºå¼€å§‹ï¼Œé€‰æ‹©ä¸€ä¸ªå›ºå®šçš„ä¼ æ’­å‘¨æœŸï¼ˆè­¬å¦‚ 1 ç§’ï¼‰ï¼Œéšæœºé€‰æ‹©å®ƒç›¸è¿æ¥çš„ k ä¸ªèŠ‚ç‚¹ï¼ˆç§°ä¸º Fan-Outï¼‰æ¥ä¼ æ’­æ¶ˆæ¯ã€‚</li>
<li>æ¯ä¸€ä¸ªèŠ‚ç‚¹æ”¶åˆ°æ¶ˆæ¯åï¼Œå¦‚æœè¿™ä¸ªæ¶ˆæ¯æ˜¯å®ƒä¹‹å‰æ²¡æœ‰æ”¶åˆ°è¿‡çš„ï¼Œå°†åœ¨ä¸‹ä¸€ä¸ªå‘¨æœŸå†…ï¼Œé€‰æ‹©é™¤äº†å‘é€æ¶ˆæ¯ç»™å®ƒçš„é‚£ä¸ªèŠ‚ç‚¹å¤–çš„å…¶ä»–ç›¸é‚» k ä¸ªèŠ‚ç‚¹å‘é€ç›¸åŒçš„æ¶ˆæ¯ï¼Œç›´åˆ°æœ€ç»ˆç½‘ç»œä¸­æ‰€æœ‰èŠ‚ç‚¹éƒ½æ”¶åˆ°äº†æ¶ˆæ¯ï¼Œå°½ç®¡è¿™ä¸ªè¿‡ç¨‹éœ€è¦ä¸€å®šæ—¶é—´ï¼Œä½†æ˜¯ç†è®ºä¸Šæœ€ç»ˆç½‘ç»œçš„æ‰€æœ‰èŠ‚ç‚¹éƒ½ä¼šæ‹¥æœ‰ç›¸åŒçš„æ¶ˆæ¯ã€‚<br>ç¼ºç‚¹ï¼šä¸€æ˜¯ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™èƒ½å…¨éƒ¨ä¸€è‡´ï¼ŒäºŒæ˜¯å¯èƒ½é‡å¤å¯èƒ½å–æ¶ˆï¼Œå¢åŠ ç½‘ç»œå‹åŠ›<br>å¯¹åº”åˆè®¾è®¡äº†ä¸¤ç§å¯èƒ½çš„ä¼ æ’­æ¨¡å¼ï¼šåç†µï¼ˆAnti-Entropyï¼‰å’Œä¼ è°£ï¼ˆRumor-Mongeringï¼‰</li>
</ul>
<h2 id="ä»ç±»åº“åˆ°æœåŠ¡"><a href="#ä»ç±»åº“åˆ°æœåŠ¡" class="headerlink" title="ä»ç±»åº“åˆ°æœåŠ¡"></a>ä»ç±»åº“åˆ°æœåŠ¡</h2><ul>
<li>ç±»åº“ï¼šåœ¨ç¼–è¯‘æœŸé™æ€é“¾æ¥åˆ°ç¨‹åºä¸­çš„ï¼Œé€šè¿‡è°ƒç”¨æœ¬åœ°æ–¹æ³•æ¥ä½¿ç”¨å…¶ä¸­çš„åŠŸèƒ½</li>
<li>æœåŠ¡ï¼šè¿›ç¨‹å¤–ç»„ä»¶ï¼Œé€šè¿‡è°ƒç”¨è¿œç¨‹æ–¹æ³•æ¥ä½¿ç”¨å…¶ä¸­çš„åŠŸèƒ½</li>
</ul>
<p>é‡‡ç”¨æœåŠ¡æ¥æ„å»ºç¨‹åºï¼Œè·å¾—çš„æ”¶ç›Šæ˜¯è½¯ä»¶ç³»ç»Ÿâ€œæ•´ä½“â€ä¸â€œéƒ¨åˆ†â€åœ¨ç‰©ç†å±‚é¢çš„çœŸæ­£éš”ç¦»ï¼Œä½†æ˜¯ä¹Ÿå¸¦æ¥äº†å¤æ‚åº¦å’Œæ€§èƒ½é—®é¢˜ï¼š</p>
<ul>
<li><strong>æœåŠ¡å‘ç°</strong>ï¼šå¯¹æ¶ˆè´¹è€…æ¥è¯´ï¼Œå¤–éƒ¨çš„æœåŠ¡ç”±è°æä¾›ï¼Ÿå…·ä½“åœ¨ä»€ä¹ˆç½‘ç»œä½ç½®ï¼Ÿ</li>
<li><strong>æœåŠ¡çš„ç½‘å…³è·¯ç”±</strong>ï¼šå¯¹ç”Ÿäº§è€…æ¥è¯´ï¼Œå†…éƒ¨å“ªäº›æœåŠ¡éœ€è¦æš´éœ²ï¼Ÿå“ªäº›åº”å½“éšè—ï¼Ÿåº”å½“ä»¥ä½•ç§å½¢å¼æš´éœ²æœåŠ¡ï¼Ÿä»¥ä»€ä¹ˆè§„åˆ™åœ¨é›†ç¾¤ä¸­åˆ†é…è¯·æ±‚ï¼Ÿ</li>
<li><strong>æœåŠ¡çš„è´Ÿè½½å‡è¡¡</strong>å¯¹è°ƒç”¨è¿‡ç¨‹æ¥è¯´ï¼Œå¦‚ä½•ä¿è¯æ¯ä¸ªè¿œç¨‹æœåŠ¡éƒ½æ¥æ”¶åˆ°ç›¸å¯¹å¹³å‡çš„æµé‡ï¼Œè·å¾—å°½å¯èƒ½é«˜çš„æœåŠ¡è´¨é‡ä¸å¯é æ€§ï¼Ÿ</li>
</ul>
<h3 id="æœåŠ¡å‘ç°çš„æ„ä¹‰"><a href="#æœåŠ¡å‘ç°çš„æ„ä¹‰" class="headerlink" title="æœåŠ¡å‘ç°çš„æ„ä¹‰"></a>æœåŠ¡å‘ç°çš„æ„ä¹‰</h3><p>è¿œç¨‹æœåŠ¡è°ƒç”¨åæ ‡ï¼šæƒé™å®šåã€ç«¯å£å·ã€æœåŠ¡æ ‡è¯†</p>
<ul>
<li>å…¨é™å®šåï¼šç½‘ç»œä¸­æŸå°ä¸»æœºçš„ç²¾ç¡®ä½ç½®</li>
<li>ç«¯å£å·ï¼šä¸»æœºä¸ŠæŸä¸€ä¸ªæä¾›äº† TCP&#x2F;UDP ç½‘ç»œæœåŠ¡çš„ç¨‹åº</li>
<li>æœåŠ¡æ ‡è¯†ï¼šè¯¥ç¨‹åºæ‰€æä¾›çš„æŸä¸ªå…·ä½“çš„æ–¹æ³•å…¥å£ã€‚ä¸åº”ç”¨å±‚åè®®ç›¸å…³ï¼Œå…·æœ‰å¤šæ ·æ€§ã€‚</li>
</ul>
<p>æœåŠ¡å‘ç°çš„ä¸¤ç§ç†è§£ï¼š</p>
<ul>
<li>UDDIç™¾ç§‘å…¨ä¹¦å¼çš„æœåŠ¡å‘ç°ï¼šå•¥éƒ½åœ¨ç®¡è¾–èŒƒå›´å†…</li>
<li>â€œé—¨ç‰Œå·ç å¼â€çš„æœåŠ¡å‘ç°ï¼ˆ<strong>ä¸»æµ</strong>ï¼‰ï¼šåªæ»¡è¶³ä»æŸä¸ªä»£è¡¨æœåŠ¡æä¾›è€…çš„å…¨é™å®šååˆ°æœåŠ¡å®é™…ä¸»æœº IP åœ°å€çš„ç¿»è¯‘è½¬æ¢</li>
</ul>
<p>æ¼”è¿›è¿‡ç¨‹ï¼šDNS+è´Ÿè½½å‡è¡¡â€”â€”&gt;Zookeeperâ€”â€”&gt;Eurekaâ€”â€”&gt;åŸºç¡€è®¾æ–½</p>
<h3 id="å¯ç”¨å’Œå¯é "><a href="#å¯ç”¨å’Œå¯é " class="headerlink" title="å¯ç”¨å’Œå¯é "></a>å¯ç”¨å’Œå¯é </h3><p>æœåŠ¡å‘ç°çš„å¿…é¡»è¿‡ç¨‹ï¼š</p>
<ul>
<li><strong>æœåŠ¡æ³¨å†Œ</strong>ï¼šå½“æœåŠ¡å¯åŠ¨çš„æ—¶å€™ï¼Œå®ƒåº”è¯¥é€šè¿‡æŸäº›å½¢å¼å°†è‡ªå·±çš„åæ ‡ä¿¡æ¯é€šçŸ¥åˆ°æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œè¿™ä¸ªè¿‡ç¨‹å¯èƒ½ç”±åº”ç”¨ç¨‹åºæœ¬èº«æ¥å®Œæˆï¼Œç§°ä¸ºè‡ªæ³¨å†Œæ¨¡å¼</li>
<li><strong>æœåŠ¡ç»´æŠ¤</strong>ï¼šä¿è¯æ‰€ç»´æŠ¤çš„æœåŠ¡åˆ—è¡¨çš„æ­£ç¡®æ€§ï¼Œä»¥é¿å…å‘ŠçŸ¥æ¶ˆè´¹è€…æœåŠ¡çš„åæ ‡åï¼Œå¾—åˆ°çš„æœåŠ¡å´ä¸èƒ½ä½¿ç”¨çš„å°´å°¬æƒ…å†µã€‚</li>
<li><strong>æœåŠ¡å‘ç°</strong>ï¼šæŠŠä¸€ä¸ªç¬¦å·ï¼ˆè­¬å¦‚ Eureka ä¸­çš„ ServiceIDã€Nacos ä¸­çš„æœåŠ¡åã€æˆ–è€…é€šç”¨çš„ FQDNï¼‰è½¬æ¢ä¸ºæœåŠ¡å®é™…åæ ‡çš„è¿‡ç¨‹</li>
</ul>
<p>æ¦‚å¿µæ¨¡å‹ä¸­çš„æœåŠ¡å‘ç°ï¼š<br><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250726023346666.png"></p>
<p>çœŸå®ç³»ç»Ÿä¸­çš„æœåŠ¡å‘ç°ï¼š<br><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250726023704759.png"></p>
<p>ä¸åŒæ¡†æ¶CAPçš„é€‰æ‹©ï¼š</p>
<ul>
<li>Eureka çš„é€‰æ‹©æ˜¯ä¼˜å…ˆä¿è¯é«˜å¯ç”¨æ€§ï¼Œç›¸å¯¹ç‰ºç‰²ç³»ç»Ÿä¸­æœåŠ¡çŠ¶æ€çš„ä¸€è‡´æ€§ã€‚ï¼ˆé€šè¿‡ Ribbon å’Œ Hystrix æ¨¡å—é…åˆæ¥å…œåº•ï¼Œå®ç°æ•…éšœè½¬ç§»ï¼ˆFailoverï¼‰æˆ–è€…å¿«é€Ÿå¤±è´¥ï¼ˆFailfastï¼‰ï¼‰</li>
<li>Consul çš„é€‰æ‹©æ˜¯ä¼˜å…ˆä¿è¯é«˜å¯é æ€§ï¼Œç›¸å¯¹ç‰ºç‰²ç³»ç»ŸæœåŠ¡å‘ç°çš„å¯ç”¨æ€§ã€‚ï¼ˆRaftç®—æ³•ã€Gossipï¼‰</li>
</ul>
<h3 id="æ³¨å†Œä¸­å¿ƒå®ç°"><a href="#æ³¨å†Œä¸­å¿ƒå®ç°" class="headerlink" title="æ³¨å†Œä¸­å¿ƒå®ç°"></a>æ³¨å†Œä¸­å¿ƒå®ç°</h3><p>æœ‰ä¸‰ç±»å·¥å…·&#x2F;ç»„ä»¶ï¼š</p>
<ul>
<li>åœ¨åˆ†å¸ƒå¼ K&#x2F;V å­˜å‚¨æ¡†æ¶ä¸Šè‡ªå·±å¼€å‘çš„æœåŠ¡å‘ç°ï¼ˆæä¾›äº†åˆ†å¸ƒå¼ç¯å¢ƒä¸‹è¯»å†™æ“ä½œçš„å…±è¯†ç®—æ³•ï¼Œéƒ½æ˜¯CPï¼‰</li>
<li>ä»¥åŸºç¡€è®¾æ–½ï¼ˆä¸»è¦æ˜¯æŒ‡ DNS æœåŠ¡å™¨ï¼‰æ¥å®ç°æœåŠ¡å‘ç°ï¼Œè¿™ç±»çš„ä»£è¡¨æ˜¯ SkyDNSã€CoreDNSã€‚</li>
<li>ä¸“é—¨ç”¨äºæœåŠ¡å‘ç°çš„æ¡†æ¶å’Œå·¥å…·ï¼Œè¿™ç±»çš„ä»£è¡¨æ˜¯ Eurekaã€Consul å’Œ Nacosã€‚</li>
</ul>
<h3 id="ç½‘å…³è·¯ç”±"><a href="#ç½‘å…³è·¯ç”±" class="headerlink" title="ç½‘å…³è·¯ç”±"></a>ç½‘å…³è·¯ç”±</h3><p>å•ä½“æ¶æ„ï¼šä¸ºå„ä¸ªå•ä½“ç³»ç»Ÿçš„å‰¯æœ¬åˆ†å‘æµé‡çš„è´Ÿè½½å‡è¡¡å™¨å®è´¨ä¸Šæ‰¿æ‹…äº†å†…éƒ¨æœåŠ¡ä¸å¤–éƒ¨è¯·æ±‚ä¹‹é—´çš„ç½‘å…³è§’è‰²ã€‚</p>
<p>å¾®æœåŠ¡ç¯å¢ƒï¼šå¾®æœåŠ¡æ¶æ„ä¸‹ï¼Œæ¯ä¸ªæœåŠ¡èŠ‚ç‚¹éƒ½å¯èƒ½ç”±ä¸åŒå›¢é˜Ÿè´Ÿè´£ï¼Œéƒ½æœ‰ç€è‡ªå·±ç‹¬ç«‹çš„ã€äº’ä¸ç›¸åŒçš„æ¥å£ï¼Œå¦‚æœæœåŠ¡é›†ç¾¤ç¼ºå°‘ä¸€ä¸ªç»Ÿä¸€å¯¹å¤–äº¤äº’çš„ä»£ç†äººè§’è‰²ï¼Œé‚£å¤–éƒ¨çš„æœåŠ¡æ¶ˆè´¹è€…å°±å¿…é¡»çŸ¥é“æ‰€æœ‰å¾®æœåŠ¡èŠ‚ç‚¹åœ¨é›†ç¾¤ä¸­çš„ç²¾ç¡®åæ ‡</p>
<p><strong>å¾®æœåŠ¡ç½‘å…³</strong>ï¼ˆâ€œæœåŠ¡ç½‘å…³â€æˆ–è€…â€œAPI ç½‘å…³â€ï¼‰çš„é¦–è¦èŒè´£å°±æ˜¯ä½œä¸ºç»Ÿä¸€çš„å‡ºå£å¯¹å¤–æä¾›æœåŠ¡ï¼Œå°†å¤–éƒ¨è®¿é—®ç½‘å…³åœ°å€çš„æµé‡ï¼Œæ ¹æ®é€‚å½“çš„è§„åˆ™è·¯ç”±åˆ°å†…éƒ¨é›†ç¾¤ä¸­æ­£ç¡®çš„æœåŠ¡èŠ‚ç‚¹ä¹‹ä¸Šã€‚</p>
<p>ç½‘å…³ &#x3D; è·¯ç”±å™¨ï¼ˆåŸºç¡€èŒèƒ½ï¼‰ + è¿‡æ»¤å™¨ï¼ˆå¯é€‰èŒèƒ½ï¼‰</p>
<ul>
<li>è·¯ç”±å™¨ï¼šâ€œç½‘ç»œåè®®å±‚æ¬¡â€å’Œâ€œæ€§èƒ½ä¸å¯ç”¨æ€§â€<ul>
<li>å››å±‚æµé‡è½¬å‘ä¸ä¸ƒå±‚æµé‡ä»£ç†ï¼Œæœ¬è´¨å’Œè´Ÿè½½å‡è¡¡å™¨å·®ä¸å¤šï¼ˆä»ç›®çš„è§’åº¦çœ‹ï¼Œè´Ÿè½½å‡è¡¡å™¨ä¸æœåŠ¡ç½‘å…³ä¼šæœ‰ä¸€äº›åŒºåˆ«ï¼Œå…·ä½“åœ¨äºå‰è€…æ˜¯ä¸ºäº†æ ¹æ®å‡è¡¡ç®—æ³•å¯¹æµé‡è¿›è¡Œå¹³å‡åœ°è·¯ç”±ï¼Œåè€…æ˜¯ä¸ºäº†æ ¹æ®æµé‡ä¸­çš„æŸç§ç‰¹å¾è¿›è¡Œæ­£ç¡®åœ°è·¯ç”±ã€‚ï¼‰</li>
<li>ç½‘å…³çš„æ€§èƒ½ä¸å®ƒçš„å·¥ä½œæ¨¡å¼å’Œè‡ªèº«å®ç°ç®—æ³•éƒ½æœ‰å…³ç³»ï¼Œä½†æ¯«æ— ç–‘é—®å·¥ä½œæ¨¡å¼æ˜¯æœ€å…³é”®çš„å› ç´ ï¼Œå¦‚æœèƒ½å¤Ÿé‡‡ç”¨ DSR ä¸‰è§’ä¼ è¾“æ¨¡å¼ï¼ŒåŸç†ä¸Šå°±å†³å®šäº†æ€§èƒ½ä¸€å®šä¼šæ¯”ä»£ç†æ¨¡å¼æ¥çš„å¼º</li>
</ul>
</li>
</ul>
<h3 id="ç½‘å…³IOæ¨¡å‹"><a href="#ç½‘å…³IOæ¨¡å‹" class="headerlink" title="ç½‘å…³IOæ¨¡å‹"></a>ç½‘å…³IOæ¨¡å‹</h3><p>ç½‘ç»œ I&#x2F;O çš„å‡ºå…¥å£å°±æ˜¯ Socket çš„è¯»å’Œå†™</p>
<p>å½“å‘ç”Ÿä¸€æ¬¡ç½‘ç»œè¯·æ±‚å‘ç”Ÿåï¼Œå°†ä¼šæŒ‰é¡ºåºç»å†â€œç­‰å¾…æ•°æ®ä»è¿œç¨‹ä¸»æœºåˆ°è¾¾ç¼“å†²åŒºâ€å’Œâ€œå°†æ•°æ®ä»ç¼“å†²åŒºæ‹·è´åˆ°åº”ç”¨ç¨‹åºåœ°å€ç©ºé—´â€ä¸¤ä¸ªé˜¶æ®µï¼Œæ ¹æ®å®ç°è¿™ä¸¤ä¸ªé˜¶æ®µçš„ä¸åŒæ–¹æ³•ï¼Œäººä»¬æŠŠç½‘ç»œ I&#x2F;O æ¨¡å‹æ€»ç»“ä¸ºä¸¤ç±»ã€äº”ç§æ¨¡å‹ï¼š</p>
<ul>
<li>ä¸¤ç±»æ˜¯æŒ‡<strong>åŒæ­¥ I&#x2F;O</strong>ä¸<strong>å¼‚æ­¥ I&#x2F;O</strong></li>
<li>äº”ç§æ˜¯æŒ‡åœ¨åŒæ­¥ IO ä¸­åˆåˆ†æœ‰åˆ’åˆ†å‡º<strong>é˜»å¡ I&#x2F;O</strong>ã€<strong>éé˜»å¡ I&#x2F;O</strong>ã€<strong>å¤šè·¯å¤ç”¨ I&#x2F;O</strong>å’Œ<strong>ä¿¡å·é©±åŠ¨ I&#x2F;O</strong>å››ç§ç»†åˆ†æ¨¡å‹ã€‚</li>
</ul>
<p>åŒæ­¥ï¼šè°ƒç”¨ç«¯å‘å‡ºè¯·æ±‚ä¹‹åï¼Œå¾—åˆ°ç»“æœä¹‹å‰å¿…é¡»ä¸€ç›´ç­‰å¾…ï¼›<br>å¼‚æ­¥ï¼šå‘å‡ºè°ƒç”¨è¯·æ±‚ä¹‹åå°†ç«‹å³è¿”å›ï¼Œä¸ä¼šé©¬ä¸Šå¾—åˆ°å¤„ç†ç»“æœï¼Œç»“æœå°†é€šè¿‡çŠ¶æ€å˜åŒ–å’Œå›è°ƒæ¥é€šçŸ¥è°ƒç”¨è€…ã€‚<br>é˜»å¡å’Œéé˜»å¡ï¼šé’ˆå¯¹è¯·æ±‚å¤„ç†è¿‡ç¨‹ï¼ŒæŒ‡æ”¶åˆ°è°ƒç”¨è¯·æ±‚ä¹‹åï¼Œè¿”å›ç»“æœä¹‹å‰ï¼Œå½“å‰å¤„ç†çº¿ç¨‹æ˜¯å¦ä¼šè¢«æŒ‚èµ·ã€‚</p>
<ul>
<li><strong>å¼‚æ­¥ I&#x2F;O</strong>ï¼šè®¢ç›’é¥­ï¼Œåšå¥½é€šçŸ¥æˆ‘ï¼Œä¸€å®šæ˜¯éé˜»å¡</li>
<li><strong>åŒæ­¥ I&#x2F;O</strong>ï¼šå»é£Ÿå ‚æ‰“é¥­<ul>
<li><strong>é˜»å¡ I&#x2F;O</strong>ï¼šå‘ç°é¥­è¿˜æ²¡åšå¥½ï¼Œä½ ä¹Ÿå¹²ä¸äº†åˆ«çš„ï¼Œåªèƒ½æ‰“ä¸ªçŒç¡ï¼ˆçº¿ç¨‹ä¼‘çœ ï¼‰</li>
<li><strong>éé˜»å¡ I&#x2F;O</strong>ï¼šä½ å»åˆ°é¥­å ‚ï¼Œå‘ç°é¥­è¿˜æ²¡åšå¥½ï¼Œä½ å°±å›å»äº†ï¼Œç„¶åæ¯éš” 3 åˆ†é’Ÿæ¥ä¸€æ¬¡é¥­å ‚çœ‹é¥­åšå¥½äº†æ²¡ï¼Œç›´åˆ°é¥­åšå¥½</li>
<li><strong>å¤šè·¯å¤ç”¨ I&#x2F;O</strong>ï¼šå¯ä»¥åœ¨åŒä¸€æ¡é˜»å¡çº¿ç¨‹ä¸Šå¤„ç†å¤šä¸ªä¸åŒç«¯å£çš„ç›‘å¬ã€‚ä»£è¡¨æ•´ä¸ªå®¿èˆå»é¥­å ‚æ‰“é¥­ï¼Œå»åˆ°é¥­å ‚ï¼Œå‘ç°é¥­è¿˜æ²¡åšå¥½ï¼Œè¿˜æ˜¯ç»§ç»­æ‰“çŒç¡ï¼Œä½†å“ªä¸ªèˆå‹çš„é¥­å¥½äº†ï¼Œä½ å°±é©¬ä¸ŠæŠŠé‚£ä»½é¥­é€å›å»ã€‚å¯ä»¥ç»†åˆ† selectã€epollã€kqueue</li>
<li><strong>ä¿¡å·é©±åŠ¨ I&#x2F;O</strong>ï¼šä½ å»åˆ°é¥­å ‚ï¼Œå‘ç°é¥­è¿˜æ²¡åšå¥½ï¼Œä½†ä½ è·Ÿå¨å¸ˆç†Ÿï¼Œè·Ÿä»–è¯´é¥­åšå¥½äº†å«ä½ ï¼Œç„¶åå›å»è¯¥å¹²å˜›å¹²å˜›ï¼Œç­‰æ”¶åˆ°å¨å¸ˆé€šçŸ¥åï¼Œä½ æŠŠé¥­ä»é¥­å ‚æ‹¿å›å®¿èˆã€‚è¿™é‡Œå¨å¸ˆçš„é€šçŸ¥å°±æ˜¯é‚£ä¸ªâ€œä¿¡å·â€œã€‚</li>
</ul>
</li>
</ul>
<p>å¼‚æ­¥ I&#x2F;O æ¨¡å‹æ˜¯æœ€æ–¹ä¾¿çš„ï¼Œä½†æ˜¯ç›®å‰ä¸æ˜¯å¾ˆå®Œå–„ï¼Œå½“ä¸‹ä»¥å¤šè·¯å¤ç”¨ I&#x2F;O æ¨¡å‹æ¨¡å¼ä¸ºä¸»ã€‚</p>
<p>ç½‘å…³çš„å¯ç”¨æ€§ï¼š</p>
<ul>
<li>ç½‘å…³åº”å°½å¯èƒ½è½»é‡ï¼Œè¿‡åº¦å¢åŠ ç½‘å…³çš„èŒè´£æ˜¯å±é™©çš„</li>
<li>åº”è¯¥å°½å¯èƒ½é€‰æ‹©è¾ƒæˆç†Ÿçš„äº§å“å®ç°</li>
<li>è™‘åœ¨ç½‘å…³ä¹‹å‰éƒ¨ç½²è´Ÿè½½å‡è¡¡å™¨</li>
</ul>
<p>BFFç½‘å…³ï¼šåº”è¯¥é’ˆå¯¹ä¸åŒçš„å‰ç«¯ï¼Œèšåˆä¸åŒçš„æœåŠ¡ï¼Œæä¾›ä¸åŒçš„æ¥å£å’Œç½‘ç»œè®¿é—®åè®®æ”¯æŒã€‚</p>
<h3 id="å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡"><a href="#å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡" class="headerlink" title="å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡"></a>å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡</h3><h3 id="å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡å™¨"><a href="#å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡å™¨" class="headerlink" title="å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡å™¨"></a>å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡å™¨</h3><p><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250730050927848.png"><br>æœåŠ¡ç«¯è´Ÿè½½å‡è¡¡å™¨&#x2F;å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡å™¨</p>
<p>å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡å™¨çš„å¥½å¤„ï¼š</p>
<ul>
<li>å‡è¡¡å™¨ä¸æœåŠ¡ä¹‹é—´ä¿¡æ¯äº¤æ¢æ˜¯è¿›ç¨‹å†…çš„æ–¹æ³•è°ƒç”¨ï¼Œä¸å­˜åœ¨ä»»ä½•é¢å¤–çš„ç½‘ç»œå¼€é”€ã€‚</li>
<li>ä¸ä¾èµ–é›†ç¾¤è¾¹ç¼˜çš„è®¾æ–½ï¼Œæ‰€æœ‰å†…éƒ¨æµé‡éƒ½ä»…åœ¨æœåŠ¡é›†ç¾¤çš„å†…éƒ¨å¾ªç¯<br>ç¼ºç‚¹ï¼š</li>
<li>å®ƒä¸æœåŠ¡è¿è¡ŒäºåŒä¸€ä¸ªè¿›ç¨‹ä¹‹å†…ï¼Œæ„å‘³ç€å®ƒçš„é€‰å‹å—åˆ°æœåŠ¡æ‰€ä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€çš„é™åˆ¶</li>
<li>kä»ä¸ªä½“æœåŠ¡æ¥çœ‹ï¼Œç”±äºæ˜¯å…±ç”¨ä¸€ä¸ªè¿›ç¨‹ï¼Œå‡è¡¡å™¨çš„ç¨³å®šæ€§ä¼šç›´æ¥å½±å“æ•´ä¸ªæœåŠ¡è¿›ç¨‹çš„ç¨³å®šæ€§</li>
</ul>
<p>å®¢æˆ·ç«¯å‡è¡¡å™¨ä¸­æœ€å…·ä»£è¡¨æ€§çš„äº§å“æ˜¯ Netflix Ribbon å’Œ Spring Cloud Load Balancer</p>
<h3 id="ä»£ç†è´Ÿè½½å‡è¡¡å™¨"><a href="#ä»£ç†è´Ÿè½½å‡è¡¡å™¨" class="headerlink" title="ä»£ç†è´Ÿè½½å‡è¡¡å™¨"></a>ä»£ç†è´Ÿè½½å‡è¡¡å™¨</h3><p>æœ€è¿‘ä¸¤ä¸‰å¹´ï¼ŒæœåŠ¡ç½‘æ ¼ï¼ˆService Meshï¼‰å¼€å§‹é€æ¸ç››è¡Œï¼Œæå‡ºäº†ä»£ç†å‡è¡¡å™¨</p>
<p><strong>ä»£ç†å‡è¡¡å™¨</strong>ï¼šå¯¹æ­¤å‰çš„å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡å™¨çš„æ”¹è¿›æ˜¯å°†åŸæœ¬åµŒå…¥åœ¨æœåŠ¡è¿›ç¨‹ä¸­çš„å‡è¡¡å™¨æå–å‡ºæ¥ï¼Œä½œä¸ºä¸€ä¸ªè¿›ç¨‹ä¹‹å¤–ï¼ŒåŒä¸€ Pod ä¹‹å†…çš„ç‰¹æ®ŠæœåŠ¡ã€‚<br><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250731002326833.png"><br>ä»£ç†å‡è¡¡å™¨çš„ä¼˜åŠ¿ï¼š</p>
<ul>
<li>ä¸å†å—ç¼–ç¨‹è¯­è¨€çš„é™åˆ¶</li>
<li>åœ¨æœåŠ¡æ‹“æ‰‘æ„ŸçŸ¥æ–¹é¢ä»£ç†å‡è¡¡å™¨ä¹Ÿè¦æ›´æœ‰ä¼˜åŠ¿</li>
<li>åœ¨å®‰å…¨æ€§ã€å¯è§‚æµ‹æ€§ä¸Šï¼Œç”±äºè¾¹è½¦ä»£ç†éƒ½æ˜¯ä¸€è‡´çš„å®ç°ï¼Œæœ‰åˆ©äºåœ¨æœåŠ¡é—´å»ºç«‹åŒå‘ TLS é€šä¿¡ï¼Œä¹Ÿæœ‰åˆ©äºå¯¹æ•´ä¸ªè°ƒç”¨é“¾è·¯ç»™å‡ºæ›´è¯¦ç»†çš„ç»Ÿè®¡ä¿¡æ¯ã€‚</li>
</ul>
<p>ç›®å‰è¿˜ä¸å¤ªæˆç†Ÿï¼Œä½†æœªæ¥ä¼šæ˜¯å¾®æœåŠ¡ä¸»æµçš„é€šè®¯æ–¹å¼ã€‚</p>
<h3 id="åœ°åŸŸå’ŒåŒºåŸŸ"><a href="#åœ°åŸŸå’ŒåŒºåŸŸ" class="headerlink" title="åœ°åŸŸå’ŒåŒºåŸŸ"></a>åœ°åŸŸå’ŒåŒºåŸŸ</h3><ul>
<li><strong>Region</strong>ï¼šåœ°åŸŸï¼Œè­¬å¦‚ååŒ—ã€ä¸œåŒ—ã€åä¸œã€åå—ï¼Œè¿™äº›éƒ½æ˜¯åœ°åŸŸèŒƒå›´ã€‚ä¸åŒåœ°åŸŸä¹‹é—´æ˜¯æ²¡æœ‰å†…ç½‘è¿æ¥çš„ï¼Œæ‰€æœ‰æµé‡éƒ½åªèƒ½ç»è¿‡å…¬ä¼—äº’è”ç½‘ç›¸è¿ï¼Œå¦‚æœå¾®æœåŠ¡çš„æµé‡è·¨è¶Šäº†åœ°åŸŸï¼Œå®é™…å°±è·Ÿè°ƒç”¨å¤–éƒ¨æœåŠ¡å•†æä¾›çš„äº’è”ç½‘æœåŠ¡æ²¡æœ‰ä»»ä½•å·®åˆ«äº†ã€‚</li>
<li><strong>Zone</strong>ï¼šåŒºåŸŸï¼Œåœ°ç†ä¸Šä½äºåŒä¸€åœ°åŸŸå†…ï¼Œä½†ç”µåŠ›å’Œç½‘ç»œæ˜¯äº’ç›¸ç‹¬ç«‹çš„ç‰©ç†åŒºåŸŸï¼Œè­¬å¦‚åœ¨åä¸œçš„ä¸Šæµ·ã€æ­å·ã€è‹å·çš„ä¸åŒæœºæˆ¿å°±æ˜¯åŒä¸€ä¸ªåœ°åŸŸçš„å‡ ä¸ªå¯ç”¨åŒºåŸŸã€‚åŒä¸€ä¸ªåœ°åŸŸçš„å¯ç”¨åŒºåŸŸä¹‹é—´å…·æœ‰å†…ç½‘è¿æ¥ï¼Œæµé‡ä¸å ç”¨å…¬ç½‘å¸¦å®½ï¼Œå› æ­¤åŒºåŸŸæ˜¯å¾®æœåŠ¡é›†ç¾¤å†…æµé‡èƒ½å¤Ÿè§¦åŠçš„æœ€å¤§èŒƒå›´ã€‚<ul>
<li>é«˜å¯ç”¨å³å¤šåŒºåŸŸéƒ¨ç½²</li>
<li>ä½å»¶è¿Ÿå³åŒåŒºåŸŸéƒ¨ç½²<br>å¯¹äºæ²¡æœ‰ä½¿ç”¨äº‘è®¡ç®—è®¾æ–½çš„ç³»ç»Ÿï¼Œä¸æ¶‰åŠåœ°åŸŸã€åŒºåŸŸçš„æ¦‚å¿µã€‚</li>
</ul>
</li>
</ul>
<h2 id="æµé‡æ²»ç†"><a href="#æµé‡æ²»ç†" class="headerlink" title="æµé‡æ²»ç†"></a>æµé‡æ²»ç†</h2><p>éšç€æ‹†åˆ†å‡ºçš„æœåŠ¡è¶Šæ¥è¶Šå¤šï¼Œä¹Ÿä¼šæœ‰ä¸¤ä¸ªé—®é¢˜çš„å›°æ‰°ï¼š</p>
<ul>
<li>æŸä¸€ä¸ªæœåŠ¡å´©æºƒï¼Œå¯¼è‡´é›ªå´©æ•ˆåº”</li>
<li>æœåŠ¡æ²¡æœ‰å´©æºƒï¼Œä½†æ˜¯å¤§éƒ¨åˆ†è¯·æ±‚éƒ½è¶…æ—¶æ— æ³•æ²»ç†</li>
</ul>
<h3 id="æœåŠ¡å®¹é”™"><a href="#æœåŠ¡å®¹é”™" class="headerlink" title="æœåŠ¡å®¹é”™"></a>æœåŠ¡å®¹é”™</h3><p>å®¹é”™æ€§è®¾è®¡ï¼šæ— æ³•å¦¥åçš„æ„å»ºå¾®æœåŠ¡çš„æŒ‡å¯¼æ€§åŸåˆ™</p>
<h3 id="å®¹é”™ç­–ç•¥"><a href="#å®¹é”™ç­–ç•¥" class="headerlink" title="å®¹é”™ç­–ç•¥"></a>å®¹é”™ç­–ç•¥</h3><p>å¸¸è§çš„å®¹é”™ç­–ç•¥ï¼š</p>
<table>
<thead>
<tr>
<th>å®¹é”™ç­–ç•¥</th>
<th>ä¼˜ç‚¹</th>
<th>ç¼ºç‚¹</th>
<th>åº”ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody><tr>
<td><strong>æ•…éšœè½¬ç§»</strong></td>
<td>ç³»ç»Ÿè‡ªåŠ¨å¤„ç†ï¼Œè°ƒç”¨è€…å¯¹å¤±è´¥çš„ä¿¡æ¯ä¸å¯è§</td>
<td>å¢åŠ è°ƒç”¨æ—¶é—´ï¼Œé¢å¤–çš„èµ„æºå¼€é”€</td>
<td>è°ƒç”¨å¹‚ç­‰æœåŠ¡  å¯¹è°ƒç”¨æ—¶é—´ä¸æ•æ„Ÿçš„åœºæ™¯</td>
</tr>
<tr>
<td><strong>å¿«é€Ÿå¤±è´¥</strong></td>
<td>è°ƒç”¨è€…æœ‰å¯¹å¤±è´¥çš„å¤„ç†å®Œå…¨æ§åˆ¶æƒï¼Œä¸ä¾èµ–æœåŠ¡çš„å¹‚ç­‰æ€§</td>
<td>è°ƒç”¨è€…å¿…é¡»æ­£ç¡®å¤„ç†å¤±è´¥é€»è¾‘ï¼Œå¦‚æœä¸€å‘³åªæ˜¯å¯¹å¤–æŠ›å¼‚å¸¸ï¼Œå®¹æ˜“å¼•èµ·é›ªå´©</td>
<td>è°ƒç”¨éå¹‚ç­‰çš„æœåŠ¡ï¼Œè¶…æ—¶é˜ˆå€¼è¾ƒä½çš„åœºæ™¯</td>
</tr>
<tr>
<td><strong>å®‰å…¨å¤±è´¥</strong></td>
<td>ä¸å½±å“ä¸»è·¯é€»è¾‘</td>
<td>åªé€‚ç”¨äºæ—è·¯è°ƒç”¨</td>
<td>è°ƒç”¨é“¾ä¸­çš„æ—è·¯æœåŠ¡</td>
</tr>
<tr>
<td><strong>æ²‰é»˜å¤±è´¥</strong></td>
<td>æ§åˆ¶é”™è¯¯ä¸å½±å“å…¨å±€</td>
<td>å‡ºé”™çš„åœ°æ–¹å°†åœ¨ä¸€æ®µæ—¶é—´å†…ä¸å¯ç”¨</td>
<td>é¢‘ç¹è¶…æ—¶çš„æœåŠ¡</td>
</tr>
<tr>
<td><strong>æ•…éšœæ¢å¤</strong></td>
<td>è°ƒç”¨å¤±è´¥åè‡ªåŠ¨é‡è¯•ï¼Œä¹Ÿä¸å½±å“ä¸»è·¯é€»è¾‘</td>
<td>é‡è¯•ä»»åŠ¡å¯èƒ½äº§ç”Ÿå †ç§¯ï¼Œé‡è¯•ä»ç„¶å¯èƒ½å¤±è´¥</td>
<td>è°ƒç”¨é“¾ä¸­çš„æ—è·¯æœåŠ¡  å¯¹å®æ—¶æ€§è¦æ±‚ä¸é«˜çš„ä¸»è·¯é€»è¾‘ä¹Ÿå¯ä»¥ä½¿ç”¨</td>
</tr>
<tr>
<td><strong>å¹¶è¡Œè°ƒç”¨</strong></td>
<td>å°½å¯èƒ½åœ¨æœ€çŸ­æ—¶é—´å†…è·å¾—æœ€é«˜çš„æˆåŠŸç‡</td>
<td>é¢å¤–æ¶ˆè€—æœºå™¨èµ„æºï¼Œå¤§éƒ¨åˆ†è°ƒç”¨å¯èƒ½éƒ½æ˜¯æ— ç”¨åŠŸ</td>
<td>èµ„æºå……è¶³ä¸”å¯¹å¤±è´¥å®¹å¿åº¦ä½çš„åœºæ™¯</td>
</tr>
<tr>
<td><strong>å¹¿æ’­è°ƒç”¨</strong></td>
<td>æ”¯æŒåŒæ—¶å¯¹æ‰¹é‡çš„æœåŠ¡æä¾›è€…å‘èµ·è°ƒç”¨</td>
<td>èµ„æºæ¶ˆè€—å¤§ï¼Œå¤±è´¥æ¦‚ç‡é«˜</td>
<td>åªé€‚ç”¨äºæ‰¹é‡æ“ä½œçš„åœºæ™¯</td>
</tr>
</tbody></table>
<h3 id="å®¹é”™è®¾è®¡æ¨¡å¼"><a href="#å®¹é”™è®¾è®¡æ¨¡å¼" class="headerlink" title="å®¹é”™è®¾è®¡æ¨¡å¼"></a>å®¹é”™è®¾è®¡æ¨¡å¼</h3><p><strong>æ–­è·¯å™¨</strong>ï¼šé€šè¿‡ä»£ç†ï¼ˆæ–­è·¯å™¨å¯¹è±¡ï¼‰æ¥ä¸€å¯¹ä¸€åœ°ï¼ˆä¸€ä¸ªè¿œç¨‹æœåŠ¡å¯¹åº”ä¸€ä¸ªæ–­è·¯å™¨å¯¹è±¡ï¼‰æ¥ç®¡æœåŠ¡è°ƒç”¨è€…çš„è¿œç¨‹è¯·æ±‚ã€‚æ–­è·¯å™¨ä¼šæŒç»­ç›‘æ§å¹¶ç»Ÿè®¡æœåŠ¡è¿”å›çš„æˆåŠŸã€å¤±è´¥ã€è¶…æ—¶ã€æ‹’ç»ç­‰å„ç§ç»“æœï¼Œå½“å‡ºç°æ•…éšœï¼ˆå¤±è´¥ã€è¶…æ—¶ã€æ‹’ç»ï¼‰çš„æ¬¡æ•°è¾¾åˆ°æ–­è·¯å™¨çš„é˜ˆå€¼æ—¶ï¼Œå®ƒçŠ¶æ€å°±è‡ªåŠ¨å˜ä¸ºâ€œOPENâ€ï¼Œåç»­æ­¤æ–­è·¯å™¨ä»£ç†çš„è¿œç¨‹è®¿é—®éƒ½å°†ç›´æ¥è¿”å›è°ƒç”¨å¤±è´¥ï¼Œè€Œä¸ä¼šå‘å‡ºçœŸæ­£çš„è¿œç¨‹æœåŠ¡è¯·æ±‚ã€‚<br><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/29141bb3-e5b4-447b-8629-470d9d559350.png"></p>
<p>æ–­è·¯å™¨æœåŠ¡ç†”æ–­ï¼Œä¸Šæœ‰ç³»ç»ŸæœåŠ¡é™çº§</p>
<h3 id="èˆ±å£éš”ç¦»æ¨¡å¼"><a href="#èˆ±å£éš”ç¦»æ¨¡å¼" class="headerlink" title="èˆ±å£éš”ç¦»æ¨¡å¼"></a>èˆ±å£éš”ç¦»æ¨¡å¼</h3><p>æœåŠ¡éš”ç¦»çš„æ„ä¹‰ï¼šä¸ºäº†ä¸è®©æŸä¸€ä¸ªè¿œç¨‹æœåŠ¡çš„å±€éƒ¨å¤±è´¥æ¼”å˜æˆå…¨å±€æ€§çš„å½±å“ï¼Œå°±å¿…é¡»è®¾ç½®æŸç§æ­¢æŸæ–¹æ¡ˆ</p>
<ul>
<li>å±€éƒ¨çº¿ç¨‹æ± ï¼šèƒ½å¤Ÿéš”ç¦»å½±å“ï¼Œä½†å­˜åœ¨é—®é¢˜ã€‚æ ¹æ® Netflix å®˜æ–¹ç»™å‡ºçš„æ•°æ®ï¼Œä¸€æ—¦å¯ç”¨ Hystrix çº¿ç¨‹æ± æ¥è¿›è¡ŒæœåŠ¡éš”ç¦»ï¼Œå¤§æ¦‚ä¼šä¸ºæ¯æ¬¡æœåŠ¡è°ƒç”¨å¢åŠ çº¦ 3 æ¯«ç§’è‡³ 10 æ¯«ç§’çš„å»¶æ—¶ï¼Œå¦‚æœè°ƒç”¨é“¾ä¸­æœ‰ 20 æ¬¡è¿œç¨‹æœåŠ¡è°ƒç”¨ï¼Œé‚£æ¯æ¬¡è¯·æ±‚å°±è¦å¤šä»˜å‡º 60 æ¯«ç§’è‡³ 200 æ¯«ç§’çš„ä»£ä»·æ¥æ¢å–æœåŠ¡éš”ç¦»çš„å®‰å…¨ä¿éšœã€‚</li>
<li>ä¿¡å·é‡æœºåˆ¶ï¼šåªä¸ºæ¯ä¸ªè¿œç¨‹æœåŠ¡ç»´æŠ¤ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„è®¡æ•°å™¨å³å¯ã€‚å•çº¯ç»´æŠ¤ä¸€ä¸ªä½œä¸ºè®¡æ•°å™¨çš„ä¿¡å·é‡çš„æ€§èƒ½æŸè€—ï¼Œç›¸å¯¹äºå±€éƒ¨çº¿ç¨‹æ± æ¥è¯´å‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚</li>
</ul>
<h3 id="é‡è¯•æ¨¡å¼"><a href="#é‡è¯•æ¨¡å¼" class="headerlink" title="é‡è¯•æ¨¡å¼"></a>é‡è¯•æ¨¡å¼</h3><p>æ•…éšœè½¬ç§»ã€æ•…éšœæ¢å¤</p>
<p>é‡è¯•æ¨¡å¼åº”è¯¥æ»¡è¶³ä»¥ä¸‹å‡ ä¸ªå‰ææ¡ä»¶ï¼š</p>
<ul>
<li>ä»…åœ¨ä¸»è·¯é€»è¾‘çš„å…³é”®æœåŠ¡ä¸Šè¿›è¡ŒåŒæ­¥çš„é‡è¯•</li>
<li>å¯¹ç”±ç¬æ—¶æ•…éšœå¯¼è‡´çš„å¤±è´¥è¿›è¡Œé‡è¯•</li>
<li>ä»…å¯¹å…·å¤‡å¹‚ç­‰æ€§çš„æœåŠ¡è¿›è¡Œé‡è¯•</li>
<li>é‡è¯•å¿…é¡»æœ‰æ˜ç¡®çš„ç»ˆæ­¢æ¡ä»¶ï¼Œå¸¸ç”¨çš„ç»ˆæ­¢æ¡ä»¶æœ‰ä¸¤ç§ï¼Œè¶…æ—¶ç»ˆæ­¢ã€æ¬¡æ•°ç»ˆæ­¢</li>
</ul>
<h3 id="æµé‡æ§åˆ¶"><a href="#æµé‡æ§åˆ¶" class="headerlink" title="æµé‡æ§åˆ¶"></a>æµé‡æ§åˆ¶</h3><p>ä¸€ä¸ªå¥å£®çš„ç³»ç»Ÿéœ€è¦åšåˆ°æ°å½“çš„æµé‡æ§åˆ¶ï¼Œéœ€è¦å¦¥å–„è§£å†³ä»¥ä¸‹ä¸‰ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>ä¾æ®ä»€ä¹ˆé™æµï¼šè¦ä¸è¦åšï¼Œè¦åšå“ªäº›ï¼Œåšåˆ°ä»€ä¹ˆç¨‹åº¦</li>
<li>å…·ä½“å¦‚ä½•é™æµï¼šæŒæ¡å¸¸ç”¨çš„æœåŠ¡é™æµç®—æ³•å’Œè®¾è®¡æ¨¡å¼</li>
<li>è¶…é¢æµé‡å¦‚ä½•å¤„ç†ï¼šå¦å®šå¼é™æµ&#x2F;é˜»å¡å¼é™æµ</li>
</ul>
<h3 id="æµé‡ç»Ÿè®¡æŒ‡æ ‡"><a href="#æµé‡ç»Ÿè®¡æŒ‡æ ‡" class="headerlink" title="æµé‡ç»Ÿè®¡æŒ‡æ ‡"></a>æµé‡ç»Ÿè®¡æŒ‡æ ‡</h3><ul>
<li><strong>æ¯ç§’äº‹åŠ¡æ•°</strong>ï¼ˆTransactions per Secondï¼ŒTPSï¼‰ï¼šTPSæ˜¯è¡¡é‡ä¿¡æ¯ç³»ç»Ÿååé‡çš„æœ€ç»ˆæ ‡å‡†ã€‚</li>
<li><strong>æ¯ç§’è¯·æ±‚æ•°</strong>ï¼ˆHits per Secondï¼ŒHPSï¼‰ï¼šHPS æ˜¯æŒ‡æ¯ç§’ä»å®¢æˆ·ç«¯å‘å‘æœåŠ¡ç«¯çš„è¯·æ±‚æ•°ã€‚å¦‚æœåªè¦ä¸€ä¸ªè¯·æ±‚å°±èƒ½å®Œæˆä¸€ç¬”ä¸šåŠ¡ï¼Œé‚£ HPS ä¸ TPS æ˜¯ç­‰ä»·çš„ã€‚</li>
<li><strong>æ¯ç§’æŸ¥è¯¢æ•°</strong>ï¼ˆQueries per Secondï¼ŒQPSï¼‰ï¼šQPS æ˜¯æŒ‡ä¸€å°æœåŠ¡å™¨èƒ½å¤Ÿå“åº”çš„æŸ¥è¯¢æ¬¡æ•°ã€‚å¦‚æœåªæœ‰ä¸€å°æœåŠ¡å™¨æ¥åº”ç­”è¯·æ±‚ï¼Œé‚£ QPS å’Œ HPS æ˜¯ç­‰ä»·çš„ã€‚</li>
</ul>
<p>ä¸»æµç³»ç»Ÿå¤§å¤šå€¾å‘ä½¿ç”¨ HPS ä½œä¸ºé¦–é€‰çš„é™æµæŒ‡æ ‡ã€‚ä½†é™æµæŒ‡æ ‡å¹¶ä¸å­˜åœ¨ä»»ä½•å¿…é¡»éµå¾ªçš„æƒå¨æ³•åˆ™ï¼Œæ ¹æ®ç³»ç»Ÿçš„å®é™…éœ€è¦ï¼Œå“ªæ€•å®Œå…¨ä¸é€‰æ‹©åŸºäºè°ƒç”¨è®¡æ•°çš„æŒ‡æ ‡éƒ½æ˜¯æœ‰å¯èƒ½çš„ã€‚</p>
<h3 id="é™æµè®¾è®¡æ¨¡å¼"><a href="#é™æµè®¾è®¡æ¨¡å¼" class="headerlink" title="é™æµè®¾è®¡æ¨¡å¼"></a>é™æµè®¾è®¡æ¨¡å¼</h3><ul>
<li>æµé‡è®¡æ•°å™¨ï¼šè®¾ç½®ä¸€ä¸ªè®¡æ•°å™¨æ¥è¿›è¡Œé™æµï¼Œä½†æ˜¯æœ‰é—®é¢˜ï¼Œæµé‡è®¡æ•°å™¨çš„ç¼ºé™·æ ¹æºåœ¨äºå®ƒåªæ˜¯é’ˆå¯¹æ—¶é—´ç‚¹è¿›è¡Œç¦»æ•£çš„ç»Ÿè®¡ã€‚</li>
<li>æ»‘åŠ¨çª—å£ç®—æ³•ï¼šå¯ä»¥ä¿è¯ä»»æ„æ—¶é—´ç‰‡æ®µå†…ï¼Œåªéœ€ç»è¿‡ç®€å•çš„è°ƒç”¨è®¡æ•°æ¯”è¾ƒï¼Œå°±èƒ½æ§åˆ¶ä½è¯·æ±‚æ¬¡æ•°ä¸€å®šä¸ä¼šè¶…è¿‡é™æµçš„é˜ˆå€¼ï¼Œåœ¨å•æœºé™æµæˆ–è€…åˆ†å¸ƒå¼æœåŠ¡å•ç‚¹ç½‘å…³ä¸­çš„é™æµä¸­å¾ˆå¸¸ç”¨ã€‚<br><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250731055039601.png"></li>
<li>æ¼æ¡¶æ¨¡å¼ï¼šä¸€ä¸ªä»¥è¯·æ±‚å¯¹è±¡ä½œä¸ºå…ƒç´ çš„å…ˆå…¥å…ˆå‡ºé˜Ÿåˆ—ï¼ˆFIFO Queueï¼‰ï¼Œé˜Ÿåˆ—é•¿åº¦å°±ç›¸å½“äºæ¼æ¡¶çš„å¤§å°ï¼Œå½“é˜Ÿåˆ—å·²æ»¡æ—¶ä¾¿æ‹’ç»æ–°çš„è¯·æ±‚è¿›å…¥ã€‚æ¼æ¡¶å®ç°èµ·æ¥å¾ˆå®¹æ˜“ï¼Œå›°éš¾åœ¨äºå¦‚ä½•ç¡®å®šæ¼æ¡¶çš„ä¸¤ä¸ªå‚æ•°ï¼šæ¡¶çš„å¤§å°å’Œæ°´çš„æµå‡ºé€Ÿç‡ã€‚</li>
<li>ä»¤ç‰Œæ¡¶æ¨¡å¼ï¼šæ¼æ¡¶æ˜¯ä»æ°´æ± é‡Œå¾€ç³»ç»Ÿå‡ºæ°´ï¼Œä»¤ç‰Œæ¡¶åˆ™æ˜¯ç³»ç»Ÿå¾€æ’é˜Ÿæœºä¸­æ”¾å…¥ä»¤ç‰Œã€‚é™åˆ¶ç³»ç»Ÿåœ¨ X ç§’å†…æœ€å¤§è¯·æ±‚æ¬¡æ•°ä¸è¶…è¿‡ Yï¼Œé‚£å°±æ¯é—´éš” X&#x2F;Y æ—¶é—´å°±å¾€æ¡¶ä¸­æ”¾ä¸€ä¸ªä»¤ç‰Œï¼Œå½“æœ‰è¯·æ±‚è¿›æ¥æ—¶ï¼Œé¦–å…ˆè¦ä»æ¡¶ä¸­å–å¾—ä¸€ä¸ªå‡†å…¥çš„ä»¤ç‰Œï¼Œç„¶åæ‰èƒ½è¿›å…¥ç³»ç»Ÿå¤„ç†ã€‚</li>
<li>åˆ†å¸ƒå¼é™æµï¼šå‰é¢éƒ½æ˜¯å•æœºé™æµï¼Œç²¾ç»†æ§åˆ¶åˆ†å¸ƒå¼é›†ç¾¤ä¸­æ¯ä¸ªæœåŠ¡æ¶ˆè€—é‡çš„é™æµç®—æ³•ç§°ä¸ºåˆ†å¸ƒå¼é™æµã€‚æ ¸å¿ƒå·®åˆ«åœ¨äºå¦‚ä½•ç®¡ç†é™æµçš„ç»Ÿè®¡æŒ‡æ ‡</li>
</ul>
<h2 id="å¯é é€šè®¯"><a href="#å¯é é€šè®¯" class="headerlink" title="å¯é é€šè®¯"></a>å¯é é€šè®¯</h2><h3 id="é›¶ä¿¡ä»»ç½‘ç»œ"><a href="#é›¶ä¿¡ä»»ç½‘ç»œ" class="headerlink" title="é›¶ä¿¡ä»»ç½‘ç»œ"></a>é›¶ä¿¡ä»»ç½‘ç»œ</h3><p>åŸºäºè¾¹ç•Œçš„å®‰å…¨æ¨¡å‹ï¼šæŠŠç½‘ç»œåˆ’åˆ†ä¸ºä¸åŒçš„åŒºåŸŸï¼Œä¸åŒçš„åŒºåŸŸå¯¹åº”äºä¸åŒé£é™©çº§åˆ«å’Œå…è®¸è®¿é—®çš„ç½‘ç»œèµ„æºæƒé™ï¼Œå°†å®‰å…¨é˜²æŠ¤æªæ–½é›†ä¸­éƒ¨ç½²åœ¨å„ä¸ªåŒºåŸŸçš„è¾¹ç•Œä¹‹ä¸Šï¼Œé‡ç‚¹å…³æ³¨è·¨åŒºåŸŸçš„ç½‘ç»œæµé‡ã€‚</p>
<p>2010å¹´æå‡ºäº†<strong>é›¶ä¿¡ä»»å®‰å…¨æ¨¡å‹</strong>çš„æ¦‚å¿µã€‚<br>ä¸­å¿ƒæ€æƒ³ï¼šä¸åº”å½“ä»¥æŸç§å›ºæœ‰ç‰¹å¾æ¥è‡ªåŠ¨ä¿¡ä»»ä»»ä½•æµé‡ï¼Œé™¤éæ˜ç¡®å¾—åˆ°äº†èƒ½ä»£è¡¨è¯·æ±‚æ¥æºï¼ˆä¸ä¸€å®šæ˜¯äººï¼Œæ›´å¯èƒ½æ˜¯å¦ä¸€ä¸ªæœåŠ¡ï¼‰çš„èº«ä»½å‡­è¯ï¼Œå¦åˆ™ä¸€å¾‹ä¸ä¼šæœ‰é»˜è®¤çš„ä¿¡ä»»å…³ç³»ã€‚</p>
<table>
<thead>
<tr>
<th>ä¼ ç»Ÿã€è¾¹ç•Œå®‰å…¨æ¨¡å‹</th>
<th>äº‘åŸç”Ÿã€é›¶ä¿¡ä»»å®‰å…¨æ¨¡å‹</th>
<th>å…·ä½“éœ€æ±‚</th>
</tr>
</thead>
<tbody><tr>
<td>åŸºäºé˜²ç«å¢™ç­‰è®¾æ–½ï¼Œè®¤ä¸ºè¾¹ç•Œå†…å¯ä¿¡</td>
<td>æœåŠ¡åˆ°æœåŠ¡é€šä¿¡éœ€è®¤è¯ï¼Œç¯å¢ƒå†…çš„æœåŠ¡ä¹‹é—´é»˜è®¤æ²¡æœ‰ä¿¡ä»»</td>
<td>ä¿æŠ¤ç½‘ç»œè¾¹ç•Œï¼ˆä»ç„¶æœ‰æ•ˆï¼‰ï¼›æœåŠ¡ä¹‹é—´é»˜è®¤æ²¡æœ‰äº’ä¿¡</td>
</tr>
<tr>
<td>ç”¨äºç‰¹å®šçš„ IP å’Œç¡¬ä»¶ï¼ˆæœºå™¨ï¼‰</td>
<td>èµ„æºåˆ©ç”¨ç‡ã€é‡ç”¨ã€å…±äº«æ›´å¥½ï¼ŒåŒ…æ‹¬ IP å’Œç¡¬ä»¶</td>
<td>å—ä¿¡ä»»çš„æœºå™¨è¿è¡Œæ¥æºå·²çŸ¥çš„ä»£ç </td>
</tr>
<tr>
<td>åŸºäº IP çš„èº«ä»½</td>
<td>åŸºäºæœåŠ¡çš„èº«ä»½</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td>æœåŠ¡è¿è¡Œåœ¨å·²çŸ¥çš„ã€å¯é¢„æœŸçš„æœåŠ¡å™¨ä¸Š</td>
<td>æœåŠ¡å¯è¿è¡Œåœ¨ç¯å¢ƒä¸­çš„ä»»ä½•åœ°æ–¹ï¼ŒåŒ…æ‹¬ç§æœ‰äº‘&#x2F;å…¬æœ‰äº‘æ··åˆéƒ¨ç½²</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td>å®‰å…¨ç›¸å…³çš„éœ€æ±‚ç”±åº”ç”¨æ¥å®ç°ï¼Œæ¯ä¸ªåº”ç”¨å•ç‹¬å®ç°</td>
<td>ç”±åŸºç¡€è®¾æ–½æ¥å®ç°ï¼ŒåŸºç¡€è®¾æ–½ä¸­é›†æˆäº†å…±äº«çš„å®‰å…¨æ€§è¦æ±‚ã€‚</td>
<td>é›†ä¸­ç­–ç•¥å®æ–½ç‚¹ï¼ˆChoke Pointsï¼‰ï¼Œä¸€è‡´åœ°åº”ç”¨åˆ°æ‰€æœ‰æœåŠ¡</td>
</tr>
<tr>
<td>å¯¹æœåŠ¡å¦‚ä½•æ„å»ºã€è¯„å®¡ã€å®æ–½çš„å®‰å…¨éœ€æ±‚çš„çº¦æŸåŠ›è¾ƒå¼±</td>
<td>å®‰å…¨ç›¸å…³çš„éœ€æ±‚ä¸€è‡´åœ°åº”ç”¨åˆ°æ‰€æœ‰æœåŠ¡</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td>å®‰å…¨ç»„ä»¶çš„å¯è§‚æµ‹æ€§è¾ƒå¼±</td>
<td>æœ‰å®‰å…¨ç­–ç•¥åŠå…¶æ˜¯å¦ç”Ÿæ•ˆçš„å…¨å±€è§†å›¾</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td>å‘å¸ƒä¸æ ‡å‡†ï¼Œå‘å¸ƒé¢‘ç‡è¾ƒä½</td>
<td>æ ‡å‡†åŒ–çš„æ„å»ºå’Œå‘å¸ƒæµç¨‹ï¼Œæ¯ä¸ªå¾®æœåŠ¡å˜æ›´ç‹¬ç«‹ï¼Œå˜æ›´æ›´é¢‘ç¹</td>
<td>ç®€å•ã€è‡ªåŠ¨ã€æ ‡å‡†åŒ–çš„å˜æ›´å‘å¸ƒæµç¨‹</td>
</tr>
<tr>
<td>å·¥ä½œè´Ÿè½½é€šå¸¸ä½œä¸ºè™šæ‹Ÿæœºéƒ¨ç½²æˆ–éƒ¨ç½²åˆ°ç‰©ç†ä¸»æœºï¼Œå¹¶ä½¿ç”¨ç‰©ç†æœºæˆ–ç®¡ç†ç¨‹åºè¿›è¡Œéš”ç¦»</td>
<td>å°è£…çš„å·¥ä½œè´Ÿè½½åŠå…¶è¿›ç¨‹åœ¨å…±äº«çš„æ“ä½œç³»ç»Ÿä¸­è¿è¡Œï¼Œå¹¶æœ‰ç®¡ç†å¹³å°æä¾›çš„æŸç§æœºåˆ¶æ¥è¿›è¡Œéš”ç¦»</td>
<td>åœ¨å…±äº«çš„æ“ä½œç³»ç»Ÿçš„å·¥ä½œè´Ÿè½½ä¹‹é—´è¿›è¡Œéš”ç¦»</td>
</tr>
<tr>
<td>é›¶ä¿¡ä»»ç½‘ç»œçš„ä¸»è¦è§‚ç‚¹ï¼š</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<ul>
<li>é›¶ä¿¡ä»»ç½‘ç»œä¸ç­‰åŒäºæ”¾å¼ƒåœ¨è¾¹ç•Œä¸Šçš„ä¿æŠ¤è®¾æ–½</li>
<li>èº«ä»½åªæ¥æºäºæœåŠ¡</li>
<li>æœåŠ¡ä¹‹é—´ä¹Ÿæ²¡æœ‰å›ºæœ‰çš„ä¿¡ä»»å…³ç³»</li>
<li>é›†ä¸­ã€å…±äº«çš„å®‰å…¨ç­–ç•¥å®æ–½ç‚¹</li>
</ul>
<p>å¦‚ä½•æ„å»ºé›¶ä¿¡ä»»ç½‘ç»œå®‰å…¨æ˜¯ä¸€ä¸ªéå¸¸å¤§è€Œä¸”æ¯”è¾ƒå‰æ²¿çš„è¯é¢˜</p>
<h3 id="æœåŠ¡å®‰å…¨"><a href="#æœåŠ¡å®‰å…¨" class="headerlink" title="æœåŠ¡å®‰å…¨"></a>æœåŠ¡å®‰å…¨</h3><p>åŸºäºæƒå¨å…¬è¯äººï¼ˆPKIï¼‰å»ºç«‹ä¿¡ä»»</p>
<ul>
<li><strong>å•å‘ TLS è®¤è¯</strong>ï¼šåªéœ€è¦æœåŠ¡ç«¯æä¾›è¯ä¹¦ï¼Œå®¢æˆ·ç«¯é€šè¿‡æœåŠ¡ç«¯è¯ä¹¦éªŒè¯æœåŠ¡å™¨çš„èº«ä»½ï¼Œä½†æœåŠ¡å™¨å¹¶ä¸éªŒè¯å®¢æˆ·ç«¯çš„èº«ä»½ã€‚å•å‘ TLS ç”¨äºå…¬å¼€çš„æœåŠ¡ï¼Œå³ä»»ä½•å®¢æˆ·ç«¯éƒ½è¢«å…è®¸è¿æ¥åˆ°æœåŠ¡è¿›è¡Œè®¿é—®ï¼Œå®ƒä¿æŠ¤çš„é‡ç‚¹æ˜¯å®¢æˆ·ç«¯å…é­å†’ç‰ŒæœåŠ¡å™¨çš„æ¬ºéª—ã€‚</li>
<li><strong>åŒå‘ TLS è®¤è¯</strong>ï¼šå®¢æˆ·ç«¯ã€æœåŠ¡ç«¯åŒæ–¹éƒ½è¦æä¾›è¯ä¹¦ï¼ŒåŒæ–¹å„è‡ªé€šè¿‡å¯¹æ–¹æä¾›çš„è¯ä¹¦æ¥éªŒè¯å¯¹æ–¹çš„èº«ä»½ã€‚åŒå‘ TLS ç”¨äºç§å¯†çš„æœåŠ¡ï¼Œå³æœåŠ¡åªå…è®¸ç‰¹å®šèº«ä»½çš„å®¢æˆ·ç«¯è®¿é—®ï¼Œå®ƒé™¤äº†ä¿æŠ¤å®¢æˆ·ç«¯ä¸è¿æ¥åˆ°å†’ç‰ŒæœåŠ¡å™¨å¤–ï¼Œä¹Ÿä¿æŠ¤æœåŠ¡ç«¯ä¸é­åˆ°éæ³•ç”¨æˆ·çš„è¶Šæƒè®¿é—®ã€‚</li>
</ul>
<p>æ ¹æ®è®¤è¯å¯¹è±¡åˆ†ä¸º<strong>æœåŠ¡è®¤è¯</strong>å’Œ<strong>è¯·æ±‚è®¤è¯</strong></p>
<ul>
<li>æœåŠ¡è®¤è¯ï¼šIstioâ€”â€”mTLSè®¤è¯ï¼›Spring Cloudâ€”â€”Â OAuth 2</li>
<li>ç”¨æˆ·è®¤è¯ï¼šIstioâ€”â€”JWKSï¼›Spring Cloudâ€”â€”JWT</li>
</ul>
<p>æˆæƒï¼šIstioâ€”â€”å®Œå¤‡çš„å·¥å…·ï¼›Spring Cloudâ€”â€”Spring Security</p>
<h2 id="å¯è§‚æµ‹æ€§"><a href="#å¯è§‚æµ‹æ€§" class="headerlink" title="å¯è§‚æµ‹æ€§"></a>å¯è§‚æµ‹æ€§</h2><p>å¯è§‚æµ‹æ€§å¯ä»¥åˆ†è§£ä¸ºä¸‰ä¸ªå…·ä½“æ–¹å‘ï¼šäº‹ä»¶æ—¥å¿—ã€é“¾è·¯è¿½è¸ªã€èšåˆåº¦é‡<br><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250731092727827.png"></p>
<ul>
<li><strong>æ—¥å¿—</strong>ï¼šæ—¥å¿—çš„èŒè´£æ˜¯è®°å½•ç¦»æ•£äº‹ä»¶ï¼Œé€šè¿‡è¿™äº›è®°å½•äº‹ååˆ†æå‡ºç¨‹åºçš„è¡Œä¸ºï¼Œè­¬å¦‚æ›¾ç»è°ƒç”¨è¿‡ä»€ä¹ˆæ–¹æ³•ï¼Œæ›¾ç»æ“ä½œè¿‡å“ªäº›æ•°æ®ï¼Œç­‰ç­‰ã€‚</li>
<li><strong>è¿½è¸ª</strong>ï¼šå•ä½“ç³»ç»Ÿæ—¶ä»£è¿½è¸ªçš„èŒƒç•´åŸºæœ¬åªå±€é™äºæ ˆè¿½è¸ªï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„è¿½è¸ªåœ¨å›½å†…å¸¸è¢«ç§°ä¸ºâ€œå…¨é“¾è·¯è¿½è¸ªâ€ï¼Œè¿½è¸ªçš„ä¸»è¦ç›®çš„æ˜¯æ’æŸ¥æ•…éšœï¼Œå¦‚åˆ†æè°ƒç”¨é“¾çš„å“ªä¸€éƒ¨åˆ†ã€å“ªä¸ªæ–¹æ³•å‡ºç°é”™è¯¯æˆ–é˜»å¡ï¼Œè¾“å…¥è¾“å‡ºæ˜¯å¦ç¬¦åˆé¢„æœŸï¼Œç­‰ç­‰ã€‚</li>
<li><strong>åº¦é‡</strong>ï¼šåº¦é‡æ˜¯æŒ‡å¯¹ç³»ç»Ÿä¸­æŸä¸€ç±»ä¿¡æ¯çš„ç»Ÿè®¡èšåˆã€‚</li>
</ul>
<p>å·¥ä¸šç•Œçš„æƒ…å†µï¼š</p>
<ul>
<li><strong>æ—¥å¿—</strong>ï¼šå¤§å¤šè¢«ç»Ÿä¸€åˆ° Elastic Stackï¼ˆELKï¼‰æŠ€æœ¯æ ˆä¸Šï¼Œå¦‚æœè¯´æœªæ¥è¿˜èƒ½å‡ºç°ä»€ä¹ˆå˜åŒ–çš„è¯ï¼Œä¹Ÿå°±æ˜¯å…¶ä¸­çš„ Logstash èƒ½çœ‹åˆ°æœ‰è¢« Fluentd å–ä»£çš„è¶‹åŠ¿ï¼Œè®© ELK å˜æˆ EFKï¼Œä½†æ•´å¥— Elastic Stack æŠ€æœ¯æ ˆçš„åœ°ä½å·²æ˜¯ç›¸å½“ç¨³å›ºã€‚</li>
<li><strong>åº¦é‡</strong>ï¼šPrometheus ä¹Ÿå‡»è´¥äº†åº¦é‡é¢†åŸŸé‡Œä»¥ Zabbix ä¸ºä»£è¡¨çš„ä¼—å¤šå‰è¾ˆï¼Œå³å°†æˆä¸ºäº‘åŸç”Ÿæ—¶ä»£åº¦é‡ç›‘æ§çš„äº‹å®æ ‡å‡†</li>
<li><strong>è¿½è¸ª</strong>ï¼šè¿½è¸ªæ˜¯ä¸å…·ä½“ç½‘ç»œåè®®ã€ç¨‹åºè¯­è¨€å¯†åˆ‡ç›¸å…³çš„ï¼Œè¿‘å¹´æ¥å„ç§é“¾è·¯è¿½è¸ªäº§å“å±‚å‡ºä¸ç©·ï¼Œå¸‚é¢ä¸Šä¸»æµçš„å·¥å…·æ—¢æœ‰åƒ Datadog è¿™æ ·çš„ä¸€æ½å­å•†ä¸šæ–¹æ¡ˆï¼Œä¹Ÿæœ‰ AWS X-Ray å’Œ Google Stackdriver Trace è¿™æ ·çš„äº‘è®¡ç®—å‚å•†äº§å“ï¼Œè¿˜æœ‰åƒ SkyWalkingã€Zipkinã€Jaeger è¿™æ ·æ¥è‡ªå¼€æºç¤¾åŒºçš„ä¼˜ç§€äº§å“ã€‚</li>
</ul>
<h3 id="äº‹ä»¶æ—¥å¿—"><a href="#äº‹ä»¶æ—¥å¿—" class="headerlink" title="äº‹ä»¶æ—¥å¿—"></a>äº‹ä»¶æ—¥å¿—</h3><p>æ—¥å¿—å¤„ç†çš„è¿‡ç¨‹<br><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250731095813194.jpg"><br>ä»¥æœ€æˆç†Ÿçš„ Elastic Stack æŠ€æœ¯æ ˆä¸ºä¾‹å­ï¼Œä»‹ç»è¯¥é“¾æ¡æ¯ä¸ªæ­¥éª¤çš„ç›®çš„ä¸æ–¹æ³•ã€‚</p>
<h4 id="è¾“å‡º"><a href="#è¾“å‡º" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h4><p>æ—¥å¿—ä¸­ä¸åº”å½“å‡ºç°çš„ï¼š<strong>é¿å…æ‰“å°æ•æ„Ÿä¿¡æ¯</strong>ã€<strong>é¿å…å¼•ç”¨æ…¢æ“ä½œ</strong>ã€<strong>é¿å…æ‰“å°è¿½è¸ªè¯Šæ–­ä¿¡æ¯</strong>ï¼›åº”è¯¥è¦å‡ºç°çš„ï¼š<strong>å¤„ç†è¯·æ±‚æ—¶çš„ TraceID</strong>ã€<strong>ç³»ç»Ÿè¿è¡Œè¿‡ç¨‹ä¸­çš„å…³é”®äº‹ä»¶</strong>ã€<strong>å¯åŠ¨æ—¶è¾“å‡ºé…ç½®ä¿¡æ¯</strong>ã€‚</p>
<h4 id="æ”¶é›†ä¸ç¼“å†²"><a href="#æ”¶é›†ä¸ç¼“å†²" class="headerlink" title="æ”¶é›†ä¸ç¼“å†²"></a>æ”¶é›†ä¸ç¼“å†²</h4><p>æœ€åˆï¼ŒELK ä¸­æ—¥å¿—æ”¶é›†ä¸ä¸‹ä¸€èŠ‚è¦è®²çš„åŠ å·¥èšåˆçš„èŒè´£éƒ½æ˜¯ç”± Logstash æ¥æ‰¿æ‹…çš„ï¼Œä½†ä½œä¸ºæ¯ä¸ªèŠ‚ç‚¹éƒ½è¦éƒ¨ç½²çš„æ—¥å¿—æ”¶é›†å™¨å°±æ˜¾å¾—å¤ªè¿‡è´Ÿé‡äº†ã€‚åæ¥ï¼ŒElastic.co å…¬å¸å°†æ‰€æœ‰éœ€è¦åœ¨æœåŠ¡èŠ‚ç‚¹ä¸­å¤„ç†çš„å·¥ä½œæ•´ç†æˆä»¥Libbeatä¸ºæ ¸å¿ƒçš„Beats æ¡†æ¶ã€‚</p>
<p>æ—¥å¿—æ”¶é›†å™¨ä¸ä»…è¦ä¿è¯èƒ½è¦†ç›–å…¨éƒ¨æ•°æ®æ¥æºï¼Œè¿˜è¦å°½åŠ›ä¿è¯æ—¥å¿—æ•°æ®çš„è¿ç»­æ€§ï¼Œè¿™å…¶å®å¹¶ä¸å®¹æ˜“åšåˆ°ã€‚</p>
<p>ä¸å¿…è¿½æ±‚ELKä¸ç”Ÿäº§æ—¥å¿—å®Œå…¨ä¸€è‡´ï¼Œåªè¿½æ±‚åœ¨ä»£ä»·å¯æ‰¿å—çš„èŒƒå›´å†…ä¿è¯å°½å¯èƒ½åœ°ä¿è¯è¾ƒé«˜çš„æ•°æ®è´¨é‡ã€‚ä¸€ç§æœ€å¸¸ç”¨çš„ç¼“è§£å‹åŠ›çš„åšæ³•æ˜¯å°†æ—¥å¿—æ¥æ”¶è€…ä» Logstash å’Œ Elasticsearch è½¬ç§»è‡³æŠ—å‹èƒ½åŠ›æ›´å¼ºçš„é˜Ÿåˆ—ç¼“å­˜ï¼Œè­¬å¦‚åœ¨ Logstash ä¹‹å‰æ¶è®¾ä¸€ä¸ª Kafka æˆ–è€… Redis ä½œä¸ºç¼“å†²å±‚ï¼Œé¢å¯¹çªå‘æµé‡ï¼ŒLogstash æˆ– Elasticsearch å¤„ç†èƒ½åŠ›å‡ºç°ç“¶é¢ˆæ—¶è‡ªåŠ¨å‰Šå³°å¡«è°·ï¼Œç”šè‡³å½“å®ƒä»¬çŸ­æ—¶é—´åœé¡¿ï¼Œä¹Ÿä¸ä¼šä¸¢å¤±æ—¥å¿—æ•°æ®ã€‚</p>
<h4 id="åŠ å·¥ä¸èšåˆ"><a href="#åŠ å·¥ä¸èšåˆ" class="headerlink" title="åŠ å·¥ä¸èšåˆ"></a>åŠ å·¥ä¸èšåˆ</h4><p>Logstash çš„åŸºæœ¬èŒèƒ½æ˜¯æŠŠæ—¥å¿—è¡Œä¸­çš„éç»“æ„åŒ–æ•°æ®ï¼Œé€šè¿‡ Grok è¡¨è¾¾å¼è¯­æ³•è½¬æ¢ï¼Œä»¥ JSON æ ¼å¼è¾“å‡ºåˆ° Elasticsearch ä¸­ï¼ŒElasticsearch ä¾¿å¯é’ˆå¯¹ä¸åŒçš„æ•°æ®é¡¹æ¥å»ºç«‹ç´¢å¼•ï¼Œè¿›è¡Œæ¡ä»¶æŸ¥è¯¢ã€ç»Ÿè®¡ã€èšåˆç­‰æ“ä½œçš„äº†ã€‚</p>
<h4 id="å­˜å‚¨ä¸æŸ¥è¯¢"><a href="#å­˜å‚¨ä¸æŸ¥è¯¢" class="headerlink" title="å­˜å‚¨ä¸æŸ¥è¯¢"></a>å­˜å‚¨ä¸æŸ¥è¯¢</h4><p>Elasticsearch åœ¨æ—¥å¿—åˆ†æè¿™æ–¹é¢å®Œå…¨æ²¡æœ‰ä»€ä¹ˆå€¼å¾—ä¸€æçš„ç«äº‰è€…ï¼Œå‡ ä¹å°±æ˜¯è§£å†³æ­¤é—®é¢˜çš„å”¯ä¸€ç­”æ¡ˆã€‚</p>
<ul>
<li>ä»æ•°æ®ç‰¹å¾çš„è§’åº¦çœ‹ï¼Œæ—¥å¿—æ˜¯å…¸å‹çš„åŸºäºæ—¶é—´çš„æ•°æ®æµï¼Œæ—¥å¿—çš„æ•°æ®ç‰¹å¾å†³å®šäº†æ‰€æœ‰ç”¨äºæ—¥å¿—åˆ†æçš„ Elasticsearch éƒ½ä¼šä½¿ç”¨æ—¶é—´èŒƒå›´ä½œä¸ºç´¢å¼•</li>
<li>ä»æ•°æ®ä»·å€¼çš„è§’åº¦çœ‹ï¼Œæ—¥å¿—åŸºæœ¬ä¸Šåªä¼šä»¥æœ€è¿‘çš„æ•°æ®ä¸ºæ£€ç´¢ç›®æ ‡ï¼Œç‚¹å†³å®šäº†å¯ä»¥å¾ˆå®¹æ˜“åŒºåˆ†å‡ºå†·æ•°æ®å’Œçƒ­æ•°æ®ï¼Œè¿›è€Œå¯¹ä¸åŒæ•°æ®é‡‡ç”¨ä¸ä¸€æ ·çš„ç¡¬ä»¶ç­–ç•¥ã€‚</li>
<li>ä»æ•°æ®ä½¿ç”¨çš„è§’åº¦çœ‹ï¼Œåˆ†ææ—¥å¿—å¾ˆä¾èµ–å…¨æ–‡æ£€ç´¢å’Œå³å¸­æŸ¥è¯¢ï¼Œå¯¹å®æ—¶æ€§çš„è¦æ±‚æ˜¯å¤„äºå®æ—¶ä¸ç¦»çº¿ä¸¤è€…ä¹‹é—´çš„â€œè¿‘å®æ—¶â€ï¼Œä¹Ÿæ­£å¥½éƒ½æ˜¯ Elasticsearch çš„å¼ºé¡¹ã€‚</li>
</ul>
<p>Elasticsearch åªæä¾›äº† API å±‚é¢çš„æŸ¥è¯¢èƒ½åŠ›ï¼Œå®ƒé€šå¸¸æ­é…åŒæ ·å‡ºè‡ª Elastic.co å…¬å¸çš„ Kibana ä¸€èµ·ä½¿ç”¨ï¼Œå¯ä»¥å°† Kibana è§†ä¸º Elastic Stack çš„ GUI éƒ¨åˆ†ã€‚</p>
<h3 id="é“¾è·¯è¿½è¸ª"><a href="#é“¾è·¯è¿½è¸ª" class="headerlink" title="é“¾è·¯è¿½è¸ª"></a>é“¾è·¯è¿½è¸ª</h3><p>å¹¿ä¹‰ä¸Šè®²ï¼Œä¸€ä¸ªå®Œæ•´çš„åˆ†å¸ƒå¼è¿½è¸ªç³»ç»Ÿåº”è¯¥ç”±æ•°æ®æ”¶é›†ã€æ•°æ®å­˜å‚¨å’Œæ•°æ®å±•ç¤ºä¸‰ä¸ªç›¸å¯¹ç‹¬ç«‹çš„å­ç³»ç»Ÿæ„æˆï¼Œè€Œç‹­ä¹‰ä¸Šè®²çš„è¿½è¸ªåˆ™å°±åªæ˜¯ç‰¹æŒ‡é“¾è·¯è¿½è¸ªæ•°æ®çš„æ”¶é›†éƒ¨åˆ†ã€‚</p>
<h4 id="è¿½è¸ªä¸è·¨åº¦"><a href="#è¿½è¸ªä¸è·¨åº¦" class="headerlink" title="è¿½è¸ªä¸è·¨åº¦"></a>è¿½è¸ªä¸è·¨åº¦</h4><p>Dapper æå‡ºäº†â€œè¿½è¸ªâ€ä¸â€œè·¨åº¦â€ä¸¤ä¸ªæ¦‚å¿µï¼š<br><strong>è¿½è¸ª</strong>ï¼šä»å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚æŠµè¾¾ç³»ç»Ÿçš„è¾¹ç•Œå¼€å§‹ï¼Œè®°å½•è¯·æ±‚æµç»çš„æ¯ä¸€ä¸ªæœåŠ¡ï¼Œç›´åˆ°åˆ°å‘å®¢æˆ·ç«¯è¿”å›å“åº”ä¸ºæ­¢ï¼Œè¿™æ•´ä¸ªè¿‡ç¨‹å°±ç§°ä¸ºä¸€æ¬¡â€œè¿½è¸ªâ€<br><strong>è·¨åº¦</strong>ï¼šç”±äºæ¯æ¬¡ Trace éƒ½å¯èƒ½ä¼šè°ƒç”¨æ•°é‡ä¸å®šã€åæ ‡ä¸å®šçš„å¤šä¸ªæœåŠ¡ï¼Œä¸ºäº†èƒ½å¤Ÿè®°å½•å…·ä½“è°ƒç”¨äº†å“ªäº›æœåŠ¡ï¼Œä»¥åŠè°ƒç”¨çš„é¡ºåºã€å¼€å§‹æ—¶ç‚¹ã€æ‰§è¡Œæ—¶é•¿ç­‰ä¿¡æ¯ï¼Œæ¯æ¬¡å¼€å§‹è°ƒç”¨æœåŠ¡å‰éƒ½è¦å…ˆåŸ‹å…¥ä¸€ä¸ªè°ƒç”¨è®°å½•ï¼Œè¿™ä¸ªè®°å½•ç§°ä¸ºä¸€ä¸ªâ€œè·¨åº¦â€ã€</p>
<p>æ¯ä¸€æ¬¡ Trace å®é™…ä¸Šéƒ½æ˜¯ç”±è‹¥å¹²ä¸ªæœ‰é¡ºåºã€æœ‰å±‚çº§å…³ç³»çš„ Span æ‰€ç»„æˆä¸€é¢—â€œè¿½è¸ªæ ‘â€ï¼ˆTrace Treeï¼‰<br><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250731103715032.png"><br>é“¾è·¯è¿½è¸ªé¢ä¸´çš„æŒ‘æˆ˜ï¼š<strong>ä½æ€§èƒ½æŸè€—</strong>ã€<strong>å¯¹åº”ç”¨é€æ˜</strong>ã€<strong>éšåº”ç”¨æ‰©ç¼©</strong>ã€<strong>æŒç»­çš„ç›‘æ§</strong></p>
<h4 id="æ•°æ®æ”¶é›†"><a href="#æ•°æ®æ”¶é›†" class="headerlink" title="æ•°æ®æ”¶é›†"></a>æ•°æ®æ”¶é›†</h4><p>è¿½è¸ªç³»ç»Ÿæ ¹æ®æ•°æ®æ”¶é›†æ–¹å¼çš„å·®å¼‚ï¼Œå¯åˆ†ä¸ºä¸‰ç§ä¸»æµçš„å®ç°æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯<strong>åŸºäºæ—¥å¿—çš„è¿½è¸ª</strong>ï¼ˆLog-Based Tracingï¼‰ï¼Œ<strong>åŸºäºæœåŠ¡çš„è¿½è¸ª</strong>ï¼ˆService-Based Tracingï¼‰å’Œ<strong>åŸºäºè¾¹è½¦ä»£ç†çš„è¿½è¸ª</strong>ï¼ˆSidecar-Based Tracingï¼‰ï¼š</p>
<ul>
<li>åŸºäºæ—¥å¿—çš„è¿½è¸ªï¼šå°† Traceã€Span ç­‰ä¿¡æ¯ç›´æ¥è¾“å‡ºåˆ°åº”ç”¨æ—¥å¿—ä¸­ï¼Œç„¶åéšç€æ‰€æœ‰èŠ‚ç‚¹çš„æ—¥å¿—å½’é›†è¿‡ç¨‹æ±‡èšåˆ°ä¸€èµ·ï¼Œå†ä»å…¨å±€æ—¥å¿—ä¿¡æ¯ä¸­åæ¨å‡ºå®Œæ•´çš„è°ƒç”¨é“¾æ‹“æ‰‘å…³ç³»ã€‚ç¼ºç‚¹æ˜¯ç›´æ¥ä¾èµ–äºæ—¥å¿—å½’é›†è¿‡ç¨‹ï¼Œä»£è¡¨äº§å“æ˜¯ Spring Cloud Sleuth</li>
<li>åŸºäºæœåŠ¡çš„è¿½è¸ªï¼šé€šè¿‡æŸäº›æ‰‹æ®µç»™ç›®æ ‡åº”ç”¨æ³¨å…¥è¿½è¸ªæ¢é’ˆï¼ˆProbeï¼‰ï¼Œé’ˆå¯¹ Java åº”ç”¨ä¸€èˆ¬å°±æ˜¯é€šè¿‡ Java Agent æ³¨å…¥çš„ã€‚æ¢é’ˆåœ¨ç»“æ„ä¸Šå¯è§†ä¸ºä¸€ä¸ªå¯„ç”Ÿåœ¨ç›®æ ‡æœåŠ¡èº«ä¸Šçš„å°å‹å¾®æœåŠ¡ç³»ç»Ÿï¼Œå®ƒä¸€èˆ¬ä¼šæœ‰è‡ªå·±ä¸“ç”¨çš„æœåŠ¡æ³¨å†Œã€å¿ƒè·³æ£€æµ‹ç­‰åŠŸèƒ½ï¼Œæœ‰ä¸“é—¨çš„æ•°æ®æ”¶é›†åè®®ï¼ŒæŠŠä»ç›®æ ‡ç³»ç»Ÿä¸­ç›‘æ§å¾—åˆ°çš„æœåŠ¡è°ƒç”¨ä¿¡æ¯ï¼Œé€šè¿‡å¦ä¸€æ¬¡ç‹¬ç«‹çš„ HTTP æˆ–è€… RPC è¯·æ±‚å‘é€ç»™è¿½è¸ªç³»ç»Ÿã€‚æ¶ˆè€—èµ„æºï¼Œä¾µå…¥æ€§å¼ºã€‚ç›®å‰æœåŠ¡è¿½è¸ªçš„å…¶ä¸­ä¸€ä¸ªå‘å±•è¶‹åŠ¿æ˜¯è½»é‡åŒ–ï¼Œå›½äº§çš„ SkyWalking æ­£æ˜¯è¿™æ–¹é¢çš„ä½¼ä½¼è€…ã€‚</li>
<li>åŸºäºè¾¹è½¦ä»£ç†çš„è¿½è¸ªï¼šæœåŠ¡ç½‘æ ¼çš„ä¸“å±æ–¹æ¡ˆï¼Œå®ƒå¯¹åº”ç”¨å®Œå…¨é€æ˜ï¼Œæ— è®ºæ˜¯æ—¥å¿—è¿˜æ˜¯æœåŠ¡æœ¬èº«éƒ½ä¸ä¼šæœ‰ä»»ä½•å˜åŒ–ï¼›ç›®å‰è¿˜ä¸å¤Ÿæ™®åŠã€‚å æœ‰ç‡æœ€å¥½çš„è¾¹è½¦ä»£ç†ï¼šEnvoy</li>
</ul>
<h4 id="è¿½è¸ªè§„èŒƒåŒ–"><a href="#è¿½è¸ªè§„èŒƒåŒ–" class="headerlink" title="è¿½è¸ªè§„èŒƒåŒ–"></a>è¿½è¸ªè§„èŒƒåŒ–</h4><p>ä¸ºäº†æ¨è¿›è¿½è¸ªé¢†åŸŸçš„äº§å“çš„æ ‡å‡†åŒ–ï¼Œ2016 å¹´ 11 æœˆï¼ŒCNCF æŠ€æœ¯å§”å‘˜ä¼šæ¥å—äº† OpenTracing ä½œä¸ºåŸºé‡‘ä¼šç¬¬ä¸‰ä¸ªé¡¹ç›®ã€‚OpenTracing æ˜¯ä¸€å¥—ä¸å¹³å°æ— å…³ã€ä¸å‚å•†æ— å…³ã€ä¸è¯­è¨€æ— å…³çš„è¿½è¸ªåè®®è§„èŒƒï¼Œåªè¦éµå¾ª OpenTracing è§„èŒƒï¼Œä»»ä½•å…¬å¸çš„è¿½è¸ªæ¢é’ˆã€å­˜å‚¨ã€ç•Œé¢éƒ½å¯ä»¥éšæ—¶åˆ‡æ¢ï¼Œä¹Ÿå¯ä»¥ç›¸äº’æ­é…ä½¿ç”¨ã€‚</p>
<p>OpenTracing è§„èŒƒå…¬å¸ƒåï¼Œå‡ ä¹æ‰€æœ‰ä¸šç•Œæœ‰åçš„è¿½è¸ªç³»ç»Ÿï¼Œè­¬å¦‚ Zipkinã€Jaegerã€SkyWalking ç­‰éƒ½å¾ˆå¿«å®£å¸ƒæ”¯æŒ OpenTracingï¼ŒGoogle è‡ªå·±å´åœ¨æ­¤æ—¶å‡ºæ¥è¡¨ç¤ºåå¯¹ï¼Œå¹¶æå‡ºäº†ä¸ OpenTracing ç›®æ ‡ç±»ä¼¼çš„ OpenCensus è§„èŒƒï¼Œéšååˆå¾—åˆ°äº†å·¨å¤´ Microsoft çš„æ”¯æŒå’Œå‚ä¸ã€‚</p>
<p>OpenTracing å’Œ OpenCensus è¿…é€Ÿå½¢æˆäº†å¯è§‚æµ‹æ€§çš„ä¸¤å¤§é˜µè¥ï¼Œä¸€è¾¹æ˜¯åœ¨è¿™æ–¹é¢æ·±è€•å¤šå¹´çš„ä¼—å¤šè€ç‰Œ APM ç³»ç»Ÿå‚å•†ï¼Œå¦ä¸€è¾¹æ˜¯åˆ†å¸ƒå¼è¿½è¸ªæ¦‚å¿µçš„æå‡ºè€… Googleï¼Œä»¥åŠä¸ Google åŒæ ·åºå¤§çš„ Microsoftã€‚</p>
<p>2019å¹´å‘å¸ƒç»ˆæè§£å†³æ–¹æ¡ˆï¼šOpenTelemetryï¼Œç›®å‰è¿˜ä¸å¤ªæˆç†Ÿã€‚</p>
<h3 id="èšåˆåº¦é‡"><a href="#èšåˆåº¦é‡" class="headerlink" title="èšåˆåº¦é‡"></a>èšåˆåº¦é‡</h3><p>åº¦é‡ï¼ˆMetricsï¼‰çš„ç›®çš„æ˜¯æ­ç¤ºç³»ç»Ÿçš„æ€»ä½“è¿è¡ŒçŠ¶æ€ã€‚</p>
<p>åº¦é‡æ€»ä½“ä¸Šå¯åˆ†ä¸ºå®¢æˆ·ç«¯çš„æŒ‡æ ‡æ”¶é›†ã€æœåŠ¡ç«¯çš„å­˜å‚¨æŸ¥è¯¢ä»¥åŠç»ˆç«¯çš„ç›‘æ§é¢„è­¦ä¸‰ä¸ªç›¸å¯¹ç‹¬ç«‹çš„è¿‡ç¨‹</p>
<h3 id="æŒ‡æ ‡æ”¶é›†"><a href="#æŒ‡æ ‡æ”¶é›†" class="headerlink" title="æŒ‡æ ‡æ”¶é›†"></a>æŒ‡æ ‡æ”¶é›†</h3><p>â€œå¦‚ä½•å®šä¹‰æŒ‡æ ‡â€ä»¥åŠâ€œå¦‚ä½•å°†è¿™äº›æŒ‡æ ‡å‘Šè¯‰æœåŠ¡ç«¯â€</p>
<p>æŒ‡æ ‡çš„æ•°æ®ç±»å‹å¯æ•°ï¼š<strong>è®¡æ•°åº¦é‡å™¨</strong>ã€<strong>ç¬æ€åº¦é‡å™¨</strong>ã€<strong>ååç‡åº¦é‡å™¨</strong>ã€<strong>ç›´æ–¹å›¾åº¦é‡å™¨</strong>ã€<strong>é‡‡æ ·ç‚¹åˆ†ä½å›¾åº¦é‡å™¨</strong></p>
<p>å‘Šè¯‰æœåŠ¡ç«¯çš„æ–¹å¼ï¼š<strong>æ‹‰å–å¼é‡‡é›†</strong>ã€<strong>æ¨é€å¼é‡‡é›†</strong></p>
<p><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250731110627537.png"></p>
<p>è¿™æ˜¯ä¸€ä¸ªä½äº Prometheus Server å¤–éƒ¨çš„ç›¸å¯¹ç‹¬ç«‹çš„ä¸­ä»‹æ¨¡å—ï¼Œå°†å¤–éƒ¨æ¨é€æ¥çš„æŒ‡æ ‡æ”¾åˆ° Push Gateway ä¸­æš‚å­˜ï¼Œç„¶åå†ç­‰å€™ Prometheus Server ä» Push Gateway ä¸­å»æ‹‰å–ã€‚Prometheus è®¾è®¡ Push Gateway çš„æœ¬æ„æ˜¯ä¸ºäº†è§£å†³ Pull çš„ä¸€äº›å›ºæœ‰ç¼ºé™·ï¼Œè­¬å¦‚ç›®æ ‡ç³»ç»Ÿä½äºå†…ç½‘ï¼Œé€šè¿‡ NAT è®¿é—®å¤–ç½‘ï¼Œå¤–ç½‘çš„ Prometheus æ˜¯æ— æ³•ä¸»åŠ¨è¿æ¥ç›®æ ‡ç³»ç»Ÿçš„ï¼Œè¿™å°±åªèƒ½ç”±ç›®æ ‡ç³»ç»Ÿä¸»åŠ¨æ¨é€æ•°æ®ï¼›åˆè­¬å¦‚æŸäº›å°å‹çŸ­ç”Ÿå‘½å‘¨æœŸæœåŠ¡ï¼Œå¯èƒ½è¿˜ç­‰ä¸åŠ Prometheus æ¥æ‹‰å–ï¼ŒæœåŠ¡å°±å·²ç»ç»“æŸè¿è¡Œäº†ï¼Œå› æ­¤ä¹Ÿåªèƒ½ç”±æœåŠ¡è‡ªå·± Push æ¥ä¿è¯åº¦é‡çš„åŠæ—¶å’Œå‡†ç¡®ã€‚</p>
<p>Exporter æ˜¯ Prometheus æå‡ºçš„æ¦‚å¿µï¼Œå®ƒæ˜¯ç›®æ ‡åº”ç”¨çš„ä»£è¡¨ï¼Œæ—¢å¯ä»¥ç‹¬ç«‹è¿è¡Œï¼Œä¹Ÿå¯ä»¥ä¸åº”ç”¨è¿è¡Œåœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œåªè¦é›†æˆ Prometheus çš„ Client Library ä¾¿å¯ã€‚Exporter ä»¥ HTTP åè®®è¿”å›ç¬¦åˆ Prometheus æ ¼å¼è¦æ±‚çš„æ–‡æœ¬æ•°æ®ç»™ Prometheus æœåŠ¡å™¨ã€‚</p>
<h3 id="å­˜å‚¨æŸ¥è¯¢"><a href="#å­˜å‚¨æŸ¥è¯¢" class="headerlink" title="å­˜å‚¨æŸ¥è¯¢"></a>å­˜å‚¨æŸ¥è¯¢</h3><p>æ—¶åºæ•°æ®åº“ç”¨äºå­˜å‚¨è·Ÿéšæ—¶é—´è€Œå˜åŒ–çš„æ•°æ®ï¼Œå¹¶ä¸”ä»¥æ—¶é—´ï¼ˆæ—¶é—´ç‚¹æˆ–è€…æ—¶é—´åŒºé—´ï¼‰æ¥å»ºç«‹ç´¢å¼•çš„æ•°æ®åº“ã€‚</p>
<p>Prometheus æœåŠ¡ç«¯è‡ªå·±å°±å†…ç½®äº†ä¸€ä¸ªå¼ºå¤§æ—¶åºæ•°æ®åº“å®ç°ï¼Œè¯¥æ—¶åºæ•°æ®åº“æä¾›äº†åä¸º PromQL çš„æ•°æ®æŸ¥è¯¢è¯­è¨€ï¼Œèƒ½å¯¹æ—¶åºæ•°æ®è¿›è¡Œä¸°å¯Œçš„æŸ¥è¯¢ã€èšåˆä»¥åŠé€»è¾‘è¿ç®—ã€‚</p>
<h3 id="ç›‘æ§é¢„è­¦"><a href="#ç›‘æ§é¢„è­¦" class="headerlink" title="ç›‘æ§é¢„è­¦"></a>ç›‘æ§é¢„è­¦</h3><p>æŒ‡æ ‡åº¦é‡æ˜¯æ‰‹æ®µï¼Œæœ€ç»ˆç›®çš„æ˜¯åšåˆ†æå’Œé¢„è­¦ã€‚</p>
<p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œå¤§å¤šæ˜¯ Prometheus é…åˆ Grafana æ¥è¿›è¡Œå±•ç¤ºçš„ï¼Œè¿™æ˜¯ Prometheus å®˜æ–¹æ¨èçš„ç»„åˆæ–¹æ¡ˆï¼Œä½†è¯¥ç»„åˆä¹Ÿå¹¶éå”¯ä¸€é€‰æ‹©ï¼Œå¦‚æœè¦æ­é… Kibana ç”šè‡³ SkyWalkingæ¥ä½¿ç”¨ä¹Ÿéƒ½æ˜¯å®Œå…¨å¯è¡Œçš„ã€‚</p>
<p>Prometheus æä¾›äº†ä¸“é—¨ç”¨äºé¢„è­¦çš„ Alert Managerï¼Œå°† Alert Manager ä¸ Prometheus å…³è”åï¼Œå¯ä»¥è®¾ç½®æŸä¸ªæŒ‡æ ‡åœ¨å¤šé•¿æ—¶é—´å†…è¾¾åˆ°ä½•ç§æ¡ä»¶å°±ä¼šè§¦å‘é¢„è­¦çŠ¶æ€ï¼Œè§¦å‘é¢„è­¦åï¼Œæ ¹æ®è·¯ç”±ä¸­é…ç½®çš„æ¥æ”¶å™¨ï¼Œè­¬å¦‚é‚®ä»¶æ¥æ”¶å™¨ã€Slack æ¥æ”¶å™¨ã€å¾®ä¿¡æ¥æ”¶å™¨ã€æˆ–è€…æ›´é€šç”¨çš„WebHookæ¥æ”¶å™¨ç­‰æ¥è‡ªåŠ¨é€šçŸ¥ç”¨æˆ·ã€‚</p>
<h1 id="ä¸å¯å˜åŸºç¡€è®¾æ–½"><a href="#ä¸å¯å˜åŸºç¡€è®¾æ–½" class="headerlink" title="ä¸å¯å˜åŸºç¡€è®¾æ–½"></a>ä¸å¯å˜åŸºç¡€è®¾æ–½</h1><h2 id="ä»å¾®æœåŠ¡åˆ°äº‘åŸç”Ÿ"><a href="#ä»å¾®æœåŠ¡åˆ°äº‘åŸç”Ÿ" class="headerlink" title="ä»å¾®æœåŠ¡åˆ°äº‘åŸç”Ÿ"></a>ä»å¾®æœåŠ¡åˆ°äº‘åŸç”Ÿ</h2><p>åœ¨äº‘åŸç”ŸåŸºé‡‘ä¼šå®šä¹‰çš„â€œäº‘åŸç”Ÿâ€æ¦‚å¿µä¸­ï¼Œâ€œä¸å¯å˜åŸºç¡€è®¾æ–½â€æå‡åˆ°äº†ä¸å¾®æœåŠ¡å¹³çº§çš„é‡è¦ç¨‹åº¦ï¼Œæ­¤æ—¶å®ƒçš„å†…æ¶µå·²ä¸å†å±€é™äºæ–¹ä¾¿è¿ç»´ã€ç¨‹åºå‡çº§å’Œéƒ¨ç½²çš„æ‰‹æ®µï¼Œè€Œæ˜¯å‡åä¸ºå‘åº”ç”¨ä»£ç éšè—åˆ†å¸ƒå¼æ¶æ„å¤æ‚åº¦ã€è®©åˆ†å¸ƒå¼æ¶æ„å¾—ä»¥æˆä¸ºä¸€ç§å¯æ™®éæ¨å¹¿çš„æ™®é€‚æ¶æ„é£æ ¼çš„å¿…è¦å‰æã€‚</p>
<h2 id="è™šæ‹ŸåŒ–å®¹å™¨"><a href="#è™šæ‹ŸåŒ–å®¹å™¨" class="headerlink" title="è™šæ‹ŸåŒ–å®¹å™¨"></a>è™šæ‹ŸåŒ–å®¹å™¨</h2><p>å®¹å™¨æ˜¯äº‘è®¡ç®—ã€å¾®æœåŠ¡ç­‰è¯¸å¤šè½¯ä»¶ä¸šç•Œæ ¸å¿ƒæŠ€æœ¯çš„å…±åŒåŸºçŸ³ï¼Œå®¹å™¨çš„é¦–è¦ç›®æ ‡æ˜¯è®©è½¯ä»¶åˆ†å‘éƒ¨ç½²è¿‡ç¨‹ä»ä¼ ç»Ÿçš„å‘å¸ƒå®‰è£…åŒ…ã€é äººå·¥éƒ¨ç½²è½¬å˜ä¸ºç›´æ¥å‘å¸ƒå·²ç»éƒ¨ç½²å¥½çš„ã€åŒ…å«æ•´å¥—è¿è¡Œç¯å¢ƒçš„è™šæ‹ŸåŒ–é•œåƒã€‚</p>
<p>è®©è½¯ä»¶èƒ½å¤Ÿåœ¨ä»»ä½•ç¯å¢ƒã€ä»»ä½•ç‰©ç†æœºå™¨ä¸Šè¾¾åˆ°â€œä¸€æ¬¡ç¼–è¯‘ï¼Œéœ€è¦æœ‰ä»¥ä¸‹ä¸‰æ–¹é¢çš„å…¼å®¹æ€§æ¥å…±åŒä¿éšœï¼š</p>
<ul>
<li><strong>ISA å…¼å®¹</strong>ï¼šç›®æ ‡æœºå™¨æŒ‡ä»¤é›†å…¼å®¹æ€§ï¼Œè­¬å¦‚ ARM æ¶æ„çš„è®¡ç®—æœºæ— æ³•ç›´æ¥è¿è¡Œé¢å‘ x86 æ¶æ„ç¼–è¯‘çš„ç¨‹åº</li>
<li><strong>ABI å…¼å®¹</strong>ï¼šç›®æ ‡ç³»ç»Ÿæˆ–è€…ä¾èµ–åº“çš„äºŒè¿›åˆ¶å…¼å®¹æ€§ï¼Œè­¬å¦‚ Windows ç³»ç»Ÿç¯å¢ƒä¸­æ— æ³•ç›´æ¥è¿è¡Œ Linux çš„ç¨‹åºï¼Œåˆè­¬å¦‚ DirectX 12 çš„æ¸¸æˆæ— æ³•è¿è¡Œåœ¨ DirectX 9 ä¹‹ä¸Š</li>
<li><strong>ç¯å¢ƒå…¼å®¹</strong>ï¼šç›®æ ‡ç¯å¢ƒçš„å…¼å®¹æ€§ï¼Œè­¬å¦‚æ²¡æœ‰æ­£ç¡®è®¾ç½®çš„é…ç½®æ–‡ä»¶ã€ç¯å¢ƒå˜é‡ã€æ³¨å†Œä¸­å¿ƒã€æ•°æ®åº“åœ°å€ã€æ–‡ä»¶ç³»ç»Ÿçš„æƒé™ç­‰ç­‰ï¼Œä»»ä½•ä¸€ä¸ªç¯å¢ƒå› ç´ å‡ºç°é”™è¯¯ï¼Œéƒ½ä¼šè®©ä½ çš„ç¨‹åºæ— æ³•æ­£å¸¸è¿è¡Œã€‚</li>
</ul>
<p>è§£å†³ä»¥ä¸Šä¸‰é¡¹å…¼å®¹æ€§é—®é¢˜çš„è™šæ‹ŸåŒ–æŠ€æœ¯åˆ†ç±»ï¼š</p>
<ul>
<li><strong>æŒ‡ä»¤é›†è™šæ‹ŸåŒ–</strong>ï¼šé€šè¿‡è½¯ä»¶æ¥æ¨¡æ‹Ÿä¸åŒ ISA æ¶æ„çš„å¤„ç†å™¨å·¥ä½œè¿‡ç¨‹ï¼Œå°†è™šæ‹Ÿæœºå‘å‡ºçš„æŒ‡ä»¤è½¬æ¢ä¸ºç¬¦åˆæœ¬æœº ISA çš„æŒ‡ä»¤</li>
<li><strong>ç¡¬ä»¶æŠ½è±¡å±‚è™šæ‹ŸåŒ–</strong>ï¼šä»¥è½¯ä»¶æˆ–è€…ç›´æ¥é€šè¿‡ç¡¬ä»¶æ¥æ¨¡æ‹Ÿå¤„ç†å™¨ã€èŠ¯ç‰‡ç»„ã€å†…å­˜ã€ç£ç›˜æ§åˆ¶å™¨ã€æ˜¾å¡ç­‰è®¾å¤‡çš„å·¥ä½œè¿‡ç¨‹ã€‚</li>
<li><strong>æ“ä½œç³»ç»Ÿå±‚è™šæ‹ŸåŒ–</strong>ï¼šé‡‡ç”¨éš”ç¦»æ‰‹æ®µï¼Œä½¿å¾—ä¸åŒè¿›ç¨‹æ‹¥æœ‰ç‹¬ç«‹çš„ç³»ç»Ÿèµ„æºå’Œèµ„æºé…é¢ï¼Œçœ‹èµ·æ¥ä»¿ä½›æ˜¯ç‹¬äº«äº†æ•´ä¸ªæ“ä½œç³»ç»Ÿä¸€èˆ¬ï¼Œå…¶å®å°±æ˜¯å®¹å™¨åŒ–</li>
<li><strong>è¿è¡Œåº“è™šæ‹ŸåŒ–</strong>ï¼šä½¿ç”¨è½¯ä»¶ç¿»è¯‘çš„æ–¹æ³•æ¥æ¨¡æ‹Ÿç³»ç»Ÿï¼Œå®ƒä»¥ä¸€ä¸ªç‹¬ç«‹è¿›ç¨‹æ¥ä»£æ›¿æ“ä½œç³»ç»Ÿå†…æ ¸æ¥æä¾›ç›®æ ‡è½¯ä»¶è¿è¡Œæ‰€éœ€çš„å…¨éƒ¨èƒ½åŠ›</li>
<li><strong>è¯­è¨€è™šæ‹ŸåŒ–</strong>ï¼šç”±è™šæ‹Ÿæœºå°†é«˜çº§è¯­è¨€ç”Ÿæˆçš„ä¸­é—´ä»£ç è½¬æ¢ä¸ºç›®æ ‡æœºå™¨å¯ä»¥ç›´æ¥æ‰§è¡Œçš„æŒ‡ä»¤ï¼Œä»£è¡¨ä¸º Java çš„ JVM å’Œ.NET çš„ CLR</li>
</ul>
<h3 id="å®¹å™¨çš„å´›èµ·"><a href="#å®¹å™¨çš„å´›èµ·" class="headerlink" title="å®¹å™¨çš„å´›èµ·"></a>å®¹å™¨çš„å´›èµ·</h3><p>ä»¥å®¹å™¨å‘å±•å†å²ä¸ºçº¿ç´¢ï¼Œä»‹ç»å®¹å™¨æŠ€æœ¯åœ¨ä¸åŒå†å²é˜¶æ®µä¸­çš„ä¸»è¦å…³æ³¨ç‚¹ã€‚</p>
<h4 id="éš”ç¦»æ–‡ä»¶ï¼šchroot"><a href="#éš”ç¦»æ–‡ä»¶ï¼šchroot" class="headerlink" title="éš”ç¦»æ–‡ä»¶ï¼šchroot"></a>éš”ç¦»æ–‡ä»¶ï¼šchroot</h4><p>Â 1979å¹´ï¼Œç³»ç»Ÿæä¾›chrootå‘½ä»¤ï¼ŒåŠŸèƒ½ï¼šå½“æŸä¸ªè¿›ç¨‹ç»è¿‡<code>chroot</code>æ“ä½œä¹‹åï¼Œå®ƒçš„æ ¹ç›®å½•å°±ä¼šè¢«é”å®šåœ¨å‘½ä»¤å‚æ•°æ‰€æŒ‡å®šçš„ä½ç½®ï¼Œä»¥åå®ƒæˆ–è€…å®ƒçš„å­è¿›ç¨‹å°†ä¸èƒ½å†è®¿é—®å’Œæ“ä½œè¯¥ç›®å½•ä¹‹å¤–çš„å…¶ä»–æ–‡ä»¶ã€‚<br>Â 1991å¹´ï¼šç¬¬ä¸€ä¸ªç›‘æ§é»‘å®¢è¡ŒåŠ¨çš„èœœç½ç¨‹åºå°±æ˜¯ä½¿ç”¨<code>chroot</code>æ¥å®ç°çš„<br>Â 2000å¹´ï¼šå¼•å…¥<code>pivot_root</code>æŠ€æœ¯æ¥å®ç°æ–‡ä»¶éš”ç¦»<br>Â æ—¶è‡³ä»Šæ—¥ï¼Œ<code>chroot</code>å‘½ä»¤ä¾ç„¶æ´»è·ƒåœ¨ UNIX ç³»ç»Ÿä¸å‡ ä¹æ‰€æœ‰ä¸»æµçš„ Linux å‘è¡Œç‰ˆä¸­ï¼Œéƒ½å¹¶ä¸èƒ½æä¾›å®Œç¾çš„éš”ç¦»æ€§ã€‚æ–‡ä»¶éš”ç¦»æ€§æœ‰é™</p>
<h4 id="éš”ç¦»è®¿é—®ï¼šnamespaces"><a href="#éš”ç¦»è®¿é—®ï¼šnamespaces" class="headerlink" title="éš”ç¦»è®¿é—®ï¼šnamespaces"></a>éš”ç¦»è®¿é—®ï¼šnamespaces</h4><p>2002 å¹´ï¼ŒLinux Kernel 2.4.19 ç‰ˆå†…æ ¸å¼•å…¥äº†ä¸€ç§å…¨æ–°çš„éš”ç¦»æœºåˆ¶ï¼šLinux åç§°ç©ºé—´ï¼Œä¸€ç§ç”±å†…æ ¸ç›´æ¥æä¾›çš„å…¨å±€èµ„æºå°è£…ï¼Œæ˜¯å†…æ ¸é’ˆå¯¹è¿›ç¨‹è®¾è®¡çš„è®¿é—®éš”ç¦»æœºåˆ¶ã€‚<br>æœ€åˆçš„ç›®çš„ä¾ç„¶åªæ˜¯ä¸ºäº†éš”ç¦»æ–‡ä»¶ç³»ç»Ÿï¼Œåæ¥ï¼Œè¦æ±‚ç³»ç»Ÿéš”ç¦»å…¶ä»–è®¿é—®æ“ä½œçš„å‘¼å£°æ„ˆå‘å¼ºçƒˆ<br>2006å¹´ï¼Œå†…æ ¸é™†ç»­æ·»åŠ äº† UTSã€IPC ç­‰åç§°ç©ºé—´éš”ç¦»ï¼Œç›´åˆ°ç›®å‰æœ€æ–°çš„ Linux Kernel 5.6 ç‰ˆå†…æ ¸ä¸ºæ­¢ï¼ŒLinux åç§°ç©ºé—´æ”¯æŒå…«ç§èµ„æºçš„éš”ç¦»</p>
<h4 id="éš”ç¦»èµ„æºï¼šcgroups"><a href="#éš”ç¦»èµ„æºï¼šcgroups" class="headerlink" title="éš”ç¦»èµ„æºï¼šcgroups"></a>éš”ç¦»èµ„æºï¼šcgroups</h4><p>cgroupï¼šç”¨äºéš”ç¦»æˆ–è€…è¯´åˆ†é…å¹¶é™åˆ¶æŸä¸ªè¿›ç¨‹ç»„èƒ½å¤Ÿä½¿ç”¨çš„èµ„æºé…é¢ï¼Œèµ„æºé…é¢åŒ…æ‹¬å¤„ç†å™¨æ—¶é—´ã€å†…å­˜å¤§å°ã€ç£ç›˜ I&#x2F;O é€Ÿåº¦ï¼Œç­‰ç­‰</p>
<h4 id="å°è£…ç³»ç»Ÿï¼šLXC"><a href="#å°è£…ç³»ç»Ÿï¼šLXC" class="headerlink" title="å°è£…ç³»ç»Ÿï¼šLXC"></a>å°è£…ç³»ç»Ÿï¼šLXC</h4><p>2008 å¹´ Linux Kernel 2.6.24 å†…æ ¸åˆšåˆšå¼€å§‹æä¾›cgroupsçš„åŒä¸€æ—¶é—´ï¼Œå°±é©¬ä¸Šå‘å¸ƒäº†åä¸ºLinux å®¹å™¨<br>LXC çœ¼ä¸­çš„å®¹å™¨çš„å®šä¹‰ä¸ OpenVZ å’Œ Linux-VServer å¹¶æ— å·®åˆ«ï¼Œæ˜¯ä¸€ç§å°è£…<code>ç³»ç»Ÿ</code>çš„è½»é‡çº§è™šæ‹Ÿæœºï¼Œè€Œ Docker çœ¼ä¸­çš„å®¹å™¨çš„å®šä¹‰åˆ™æ˜¯ä¸€ç§å°è£…åº”ç”¨çš„æŠ€æœ¯æ‰‹æ®µã€‚</p>
<h4 id="å°è£…åº”ç”¨ï¼šDocker"><a href="#å°è£…åº”ç”¨ï¼šDocker" class="headerlink" title="å°è£…åº”ç”¨ï¼šDocker"></a>å°è£…åº”ç”¨ï¼šDocker</h4><p>2013 å¹´å®£å¸ƒå¼€æºçš„ Docker æ¯«æ— ç–‘é—®æ˜¯å®¹å™¨å‘å±•å†å²ä¸Šé‡Œç¨‹ç¢‘å¼çš„å‘æ˜ï¼Œç„¶è€Œ Docker çš„æˆåŠŸä¼¼ä¹æ²¡æœ‰å¤ªå¤šæŠ€æœ¯é©±åŠ¨çš„æˆåˆ†ã€‚LXCæ˜¯å°è£…ç³»ç»Ÿï¼ŒDockeræ˜¯å°è£…åº”ç”¨ã€‚<br>2014 å¹´ï¼ŒDocker å¼€æºäº†è‡ªå·±ç”¨ Golang å¼€å‘çš„libcontainerï¼Œèƒ½ç›´æ¥ä¸ç³»ç»Ÿå†…æ ¸æ‰“äº¤é“ï¼Œä¸å¿…ä¾èµ– LXC æ¥æä¾›å®¹å™¨åŒ–éš”ç¦»èƒ½åŠ›äº†ã€‚<br>2015 å¹´ï¼Œåœ¨ Docker çš„ä¸»å¯¼å’Œå€¡è®®ä¸‹ï¼Œå¤šå®¶å…¬å¸è”åˆåˆ¶å®šäº†â€œå¼€æ”¾å®¹å™¨äº¤äº’æ ‡å‡†â€ï¼ˆOpen Container Initiativeï¼ŒOCIï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªå…³äºå®¹å™¨æ ¼å¼å’Œè¿è¡Œæ—¶çš„è§„èŒƒæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«è¿è¡Œæ—¶æ ‡å‡†ï¼ˆruntime-spec ï¼‰ã€å®¹å™¨é•œåƒæ ‡å‡†ï¼ˆimage-specï¼‰å’Œé•œåƒåˆ†å‘æ ‡å‡†ï¼ˆdistribution-specï¼‰<br>2016 å¹´ï¼ŒDocker æŠŠ containerd æçŒ®ç»™äº† CNCF ç®¡ç†ï¼ŒrunC ä¸ containerd ä¸¤ä¸ªé¡¹ç›®çš„æèµ æ‰˜ç®¡ï¼Œå³å¸¦æœ‰ Docker å¯¹å¼€æºä¿¡å¿µçš„è¿½æ±‚ï¼Œä¹Ÿå¸¦æœ‰ Docker åœ¨ä¼—å¤šäº‘è®¡ç®—å¤§å‚å¤¹å‡»ä¸‹è‡ªæ•‘çš„æ— å¥ˆï¼Œè¿™ä¸¤ä¸ªé¡¹ç›®å°†æˆä¸ºæœªæ¥ Docker æ¶ˆäº¡å’Œå­˜ç»­çš„ä¼ç¬”</p>
<p><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250807190756431.png"></p>
<h4 id="å°è£…é›†ç¾¤ï¼šKubernetes"><a href="#å°è£…é›†ç¾¤ï¼šKubernetes" class="headerlink" title="å°è£…é›†ç¾¤ï¼šKubernetes"></a>å°è£…é›†ç¾¤ï¼šKubernetes</h4><ul>
<li>ä»¥ Docker ä¸ºä»£è¡¨çš„å®¹å™¨å¼•æ“å°†è½¯ä»¶çš„å‘å¸ƒæµç¨‹ä»åˆ†å‘äºŒè¿›åˆ¶å®‰è£…åŒ…è½¬å˜ä¸ºç›´æ¥åˆ†å‘è™šæ‹ŸåŒ–åçš„æ•´ä¸ªè¿è¡Œç¯å¢ƒï¼Œä»¤åº”ç”¨å¾—ä»¥å®ç°è·¨æœºå™¨çš„ç»¿è‰²éƒ¨ç½²ï¼›</li>
<li>ä»¥ Kubernetes ä¸ºä»£è¡¨çš„å®¹å™¨ç¼–æ’æ¡†æ¶ï¼Œå°±æ˜¯æŠŠå¤§å‹è½¯ä»¶ç³»ç»Ÿè¿è¡Œæ‰€ä¾èµ–çš„é›†ç¾¤ç¯å¢ƒä¹Ÿè¿›è¡Œäº†è™šæ‹ŸåŒ–ï¼Œä»¤é›†ç¾¤å¾—ä»¥å®ç°è·¨æ•°æ®ä¸­å¿ƒçš„ç»¿è‰²éƒ¨ç½²ï¼Œå¹¶èƒ½å¤Ÿæ ¹æ®å®é™…æƒ…å†µè‡ªåŠ¨æ‰©ç¼©ã€‚</li>
</ul>
<p>2015 å¹´ 7 æœˆï¼ŒKubernetes å‘å¸ƒäº†ç¬¬ä¸€ä¸ªæ­£å¼ç‰ˆæœ¬ 1.0 ç‰ˆï¼Œæ›´é‡è¦çš„äº‹ä»¶æ˜¯ Google å®£å¸ƒä¸ Linux åŸºé‡‘ä¼šå…±åŒç­¹å»ºäº‘åŸç”ŸåŸºé‡‘ä¼šï¼ˆCloud Native Computing Foundationï¼ŒCNCFï¼‰ï¼Œå¹¶ä¸”å°† Kubernetes æ‰˜ç®¡åˆ° CNCFï¼Œæˆä¸ºå…¶ç¬¬ä¸€ä¸ªé¡¹ç›®ã€‚éšåï¼ŒKubernetes ä»¥æ‘§æ¯æ‹‰æœ½ä¹‹åŠ¿è¦†ç­äº†å®¹å™¨ç¼–æ’é¢†åŸŸçš„å…¶ä»–ç«äº‰å¯¹æ‰‹</p>
<p><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250807191420768.png">2016 å¹´ï¼ŒKubernetes 1.5 ç‰ˆæœ¬å¼€å§‹å¼•å…¥â€œå®¹å™¨è¿è¡Œæ—¶æ¥å£â€ï¼ˆContainer Runtime Interfaceï¼ŒCRIï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªå®šä¹‰å®¹å™¨è¿è¡Œæ—¶åº”è¯¥å¦‚ä½•æ¥å…¥åˆ° kubelet çš„è§„èŒƒæ ‡å‡†ã€‚<br>2017 å¹´ï¼Œç”± Googleã€RedHatã€Intelã€SUSEã€IBM è”åˆå‘èµ·çš„CRI-Oï¼ˆContainer Runtime Interface Orchestratorï¼‰é¡¹ç›®å‘å¸ƒäº†é¦–ä¸ªæ­£å¼ç‰ˆæœ¬ã€‚<br>2018 å¹´ï¼Œç”± Docker æçŒ®ç»™ CNCF çš„ containerdï¼Œåœ¨ CNCF çš„ç²¾å¿ƒå­µåŒ–ä¸‹å‘å¸ƒäº† 1.1 ç‰ˆï¼Œ1.1 ç‰ˆä¸ 1.0 ç‰ˆçš„æœ€å¤§åŒºåˆ«æ˜¯æ­¤æ—¶å®ƒå·²å®Œç¾åœ°æ”¯æŒäº† CRI æ ‡å‡†ï¼Œè¿™æ„å‘³ç€åŸæœ¬ç”¨ä½œ CRI é€‚é…å™¨çš„ cri-containerd ä»æ­¤ä¸å†éœ€è¦ã€‚</p>
<h3 id="ä»¥å®¹å™¨æ„å»ºç³»ç»Ÿ"><a href="#ä»¥å®¹å™¨æ„å»ºç³»ç»Ÿ" class="headerlink" title="ä»¥å®¹å™¨æ„å»ºç³»ç»Ÿ"></a>ä»¥å®¹å™¨æ„å»ºç³»ç»Ÿ</h3><p>åˆ†å¸ƒå¼ç³»ç»Ÿé‡Œåº”ç”¨çš„æ¦‚å¿µå·²ä¸å†ç­‰åŒäºè¿›ç¨‹ï¼Œæ­¤æ—¶çš„åº”ç”¨éœ€è¦å¤šä¸ªè¿›ç¨‹å…±åŒåä½œï¼Œé€šè¿‡é›†ç¾¤çš„å½¢å¼å¯¹å¤–æä¾›æœåŠ¡ï¼Œä»¥è™šæ‹ŸåŒ–æ–¹æ³•å®ç°è¿™ä¸ªç›®æ ‡çš„è¿‡ç¨‹å°±è¢«ç§°ä¸ºå®¹å™¨ç¼–æ’ã€‚</p>
<h4 id="éš”ç¦»ä¸åä½œ"><a href="#éš”ç¦»ä¸åä½œ" class="headerlink" title="éš”ç¦»ä¸åä½œ"></a>éš”ç¦»ä¸åä½œ</h4><p>ä»k8sè®¾è®¡çš„å®ç°æ„å›¾å‡ºå‘äº†è§£k8s</p>
<p>Kubernetes æ—¶ä»£çš„ Pod æ•´åˆäº† Borg æ—¶ä»£çš„â€œProdâ€ï¼ˆProduction Task çš„ç¼©å†™ï¼‰ä¸â€œNon-Prodâ€çš„èŒèƒ½ã€‚</p>
<ol>
<li>ä¸¤ä¸ªåº”ç”¨å°è£…åœ¨ä¸€ä¸ªå®¹å™¨â€”â€”è¿èƒŒäº† Docker æå€¡çš„å•ä¸ªå®¹å™¨å°è£…å•è¿›ç¨‹åº”ç”¨çš„æœ€ä½³å®è·µã€‚</li>
<li>ä¸¤ä¸ªåº”ç”¨å°è£…åœ¨ä¸¤ä¸ªå®¹å™¨ï¼Œé€šè¿‡å…±äº«ç©ºé—´äº¤æ¢æ•°æ®â€”â€”åŒä¸€ä¸ªè¿›ç¨‹ç»„ä¸­çš„å¤šä¸ªè¿›ç¨‹å¤©ç„¶å°±å¯ä»¥å…±äº«ç€ç›¸åŒçš„è®¿é—®æƒé™ä¸èµ„æºé…é¢ï¼Œè¦æ‰¾åˆ°è¿›ç¨‹ç»„ï¼Œå³Podã€‚Podé»˜è®¤å…±äº«UTS ã€ç½‘ç»œã€IPCç­‰åç§°ç©ºé—´ï¼ŒPod è¿˜è¦å®ç°åŸå­æ€§è°ƒåº¦</li>
<li>å®¹å™¨éƒ½è¿è¡Œåœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Šâ€”â€”è¦ååŒè°ƒåº¦ï¼ŒPod æ˜¯éš”ç¦»ä¸è°ƒåº¦çš„åŸºæœ¬å•ä½</li>
</ol>
<p><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250807193153146.png"></p>
<p>K8så…³é”®èµ„æºæ¦‚å¿µ</p>
<ul>
<li><strong>å®¹å™¨</strong>ï¼ˆContainerï¼‰ï¼šå»¶ç»­äº†è‡ª Docker ä»¥æ¥ä¸€ä¸ªå®¹å™¨å°è£…ä¸€ä¸ªåº”ç”¨è¿›ç¨‹çš„ç†å¿µï¼Œæ˜¯é•œåƒç®¡ç†çš„æœ€å°å•ä½ã€‚</li>
<li><strong>ç”Ÿäº§ä»»åŠ¡</strong>ï¼ˆPodï¼‰ï¼šè¡¥å……äº†å®¹å™¨åŒ–åç¼ºå¤±çš„ä¸è¿›ç¨‹ç»„å¯¹åº”çš„â€œå®¹å™¨ç»„â€çš„æ¦‚å¿µï¼ŒPod ä¸­å®¹å™¨å…±äº« UTSã€IPCã€ç½‘ç»œç­‰åç§°ç©ºé—´ï¼Œæ˜¯èµ„æºè°ƒåº¦çš„æœ€å°å•ä½ã€‚</li>
<li><strong>èŠ‚ç‚¹</strong>ï¼ˆNodeï¼‰ï¼šå¯¹åº”äºé›†ç¾¤ä¸­çš„å•å°æœºå™¨ï¼Œè¿™é‡Œçš„æœºå™¨å³å¯ä»¥æ˜¯ç”Ÿäº§ç¯å¢ƒä¸­çš„ç‰©ç†æœºï¼Œä¹Ÿå¯ä»¥æ˜¯äº‘è®¡ç®—ç¯å¢ƒä¸­çš„è™šæ‹ŸèŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹æ˜¯å¤„ç†å™¨å’Œå†…å­˜ç­‰èµ„æºçš„èµ„æºæ± ï¼Œæ˜¯ç¡¬ä»¶å•å…ƒçš„æœ€å°å•ä½ã€‚</li>
<li><strong>é›†ç¾¤</strong>ï¼ˆClusterï¼‰ï¼šå¯¹åº”äºæ•´ä¸ªé›†ç¾¤ï¼ŒKubernetes æå€¡ç†å¿µæ˜¯é¢å‘é›†ç¾¤æ¥ç®¡ç†åº”ç”¨ã€‚å½“ä½ è¦éƒ¨ç½²åº”ç”¨çš„æ—¶å€™ï¼Œåªéœ€è¦é€šè¿‡å£°æ˜å¼ API å°†ä½ çš„æ„å›¾å†™æˆä¸€ä»½å…ƒæ•°æ®ï¼ˆManifestsï¼‰ï¼Œå°†å®ƒæäº¤ç»™é›†ç¾¤å³å¯ï¼Œè€Œæ— éœ€å…³å¿ƒå®ƒå…·ä½“åˆ†é…åˆ°å“ªä¸ªèŠ‚ç‚¹ï¼ˆå°½ç®¡é€šè¿‡æ ‡ç­¾é€‰æ‹©å™¨å®Œå…¨å¯ä»¥æ§åˆ¶å®ƒåˆ†é…åˆ°å“ªä¸ªèŠ‚ç‚¹ï¼Œä½†ä¸€èˆ¬ä¸éœ€è¦è¿™æ ·åšï¼‰ã€å¦‚ä½•å®ç° Pod é—´é€šä¿¡ã€å¦‚ä½•ä¿è¯éŸ§æ€§ä¸å¼¹æ€§ï¼Œç­‰ç­‰ï¼Œæ‰€ä»¥é›†ç¾¤æ˜¯å¤„ç†å…ƒæ•°æ®çš„æœ€å°å•ä½ã€‚</li>
<li><strong>é›†ç¾¤è”é‚¦</strong>ï¼ˆFederationï¼‰ï¼šå¯¹åº”äºå¤šä¸ªé›†ç¾¤ï¼Œé€šè¿‡è”é‚¦å¯ä»¥ç»Ÿä¸€ç®¡ç†å¤šä¸ª Kubernetes é›†ç¾¤ï¼Œè”é‚¦çš„ä¸€ç§å¸¸è§åº”ç”¨æ˜¯æ”¯æŒè·¨å¯ç”¨åŒºåŸŸå¤šæ´»ã€è·¨åœ°åŸŸå®¹ç¾çš„éœ€æ±‚</li>
</ul>
<h4 id="éŸ§æ€§ä¸å¼¹æ€§"><a href="#éŸ§æ€§ä¸å¼¹æ€§" class="headerlink" title="éŸ§æ€§ä¸å¼¹æ€§"></a>éŸ§æ€§ä¸å¼¹æ€§</h4><p>ä½œä¸ºç”¨æˆ·ï¼Œå½“ç„¶æœ€å¸Œæœ›å®¹å™¨ç¼–æ’ç³»ç»Ÿèƒ½è‡ªåŠ¨æŠŠæ‰€æœ‰æ„å¤–å› ç´ éƒ½æ¶ˆç­æ‰ï¼Œè®©ä»»ä½•æ¯ä¸€ä¸ªæœåŠ¡éƒ½æ°¸è¿œå¥åº·ï¼Œæ°¸ä¸å‡ºé”™ã€‚ä½†æ°¸ä¸å‡ºé”™çš„æœåŠ¡æ˜¯ä¸åˆ‡å®é™…çš„ï¼Œé‚£å°±åªèƒ½é€€è€Œæ±‚å…¶æ¬¡ï¼Œè®©ç¼–æ’ç³»ç»Ÿåœ¨è¿™äº›æœåŠ¡å‡ºç°é—®é¢˜ï¼Œè¿è¡ŒçŠ¶æ€ä¸æ­£ç¡®çš„æ—¶å€™ï¼Œèƒ½è‡ªåŠ¨å°†å®ƒä»¬è°ƒæ•´æˆæ­£ç¡®çš„çŠ¶æ€</p>
<p>å°†è¿™ç§æ§åˆ¶å›è·¯çš„æ€æƒ³è¿ç§»åº”ç”¨åˆ°å®¹å™¨ç¼–æ’ä¸Šï¼Œè‡ªç„¶ä¼šä¸º Kubernetes ä¸­çš„èµ„æºé™„åŠ ä¸Šäº†æœŸæœ›çŠ¶æ€ä¸å®é™…çŠ¶æ€ä¸¤é¡¹å±æ€§ã€‚</p>
<p>ä¸èµ„æºç›¸å¯¹åº”ï¼Œåªè¦æ˜¯å®é™…çŠ¶æ€æœ‰å¯èƒ½å‘ç”Ÿå˜åŒ–çš„èµ„æºå¯¹è±¡ï¼Œé€šå¸¸éƒ½ä¼šç”±å¯¹åº”çš„æ§åˆ¶å™¨è¿›è¡Œè¿½è¸ªï¼Œæ¯ä¸ªæ§åˆ¶å™¨è‡³å°‘ä¼šè¿½è¸ªä¸€ç§ç±»å‹çš„èµ„æºã€‚</p>
<p>å¦‚æœä½ å¸Œæœ›æ”¹å˜æŸä¸ªèµ„æºçš„æŸç§çŠ¶æ€ï¼Œåº”è¯¥å°†æœŸæœ›çŠ¶æ€å‘Šè¯‰ Kubernetesï¼Œè€Œä¸æ˜¯å»æ•™ Kubernetes å…·ä½“è¯¥å¦‚ä½•æ“ä½œã€‚</p>
<p>æ•…éšœæ¢å¤ã€æ»šåŠ¨æ›´æ–°ã€è‡ªåŠ¨æ‰©ç¼©è¿™äº›ç‰¹æ€§ï¼Œåœ¨äº‘åŸç”Ÿä¸­æ—¶ä»£é‡Œå¸¸è¢«æ¦‚æ‹¬æˆæœåŠ¡çš„å¼¹æ€§ï¼ˆElasticityï¼‰ä¸éŸ§æ€§ï¼ˆResilienceï¼‰ï¼ŒReplicaSetã€Deploymentã€Autoscaling çš„ç”¨æ³•ï¼Œä¹Ÿå±äºæ˜¯æ‰€æœ‰ Kubernetes æ•™æèµ„æ–™éƒ½ä¼šè®²åˆ°çš„â€œåŸºç¡€å¿…ä¿®è¯¾â€ã€‚</p>
<h3 id="ä»¥åº”ç”¨ä¸ºä¸­å¿ƒçš„å°è£…"><a href="#ä»¥åº”ç”¨ä¸ºä¸­å¿ƒçš„å°è£…" class="headerlink" title="ä»¥åº”ç”¨ä¸ºä¸­å¿ƒçš„å°è£…"></a>ä»¥åº”ç”¨ä¸ºä¸­å¿ƒçš„å°è£…</h3><p>Kubernetes è¢«èª‰ä¸ºäº‘åŸç”Ÿæ—¶ä»£çš„æ“ä½œç³»ç»Ÿï¼Œä½†æ˜¯ï¼Œä»æ˜“ç”¨è§’åº¦è®²ï¼Œå¦ç™½è¯´å·®è·è¿˜éå¸¸å¤§ï¼Œäº‘åŸç”ŸåŸºç¡€è®¾æ–½çš„å…¶ä¸­ä¸€ä¸ªé‡è¦ç›®æ ‡æ˜¯æ¥ç®¡æ‰ä¸šåŠ¡ç³»ç»Ÿå¤æ‚çš„éåŠŸèƒ½ç‰¹æ€§ï¼Œè®©ä¸šåŠ¡ç ”å‘ä¸è¿ç»´å·¥ä½œå˜å¾—è¶³å¤Ÿç®€å•ï¼Œä¸å—åˆ†å¸ƒå¼çš„ç‰µç»Šï¼Œç„¶è€Œ Kubernetes è¢«è¯Ÿç—…å¾—æœ€å¤šçš„å°±æ˜¯å¤æ‚ï¼Œè‡ªè¯ç”Ÿä¹‹æ—¥èµ·å°±ä»¥é™¡å³­çš„å­¦ä¹ æ›²çº¿è€Œé—»åã€‚</p>
<p>å®šä¹‰â€œä»¥åº”ç”¨ä¸ºä¸­å¿ƒçš„å°è£…â€ï¼Œæœ‰ä»¥ä¸‹å‡ ç§æ€è·¯ï¼š</p>
<ul>
<li>Kustomizeï¼šâ€œç”¨é…ç½®æ–‡ä»¶æ¥é…ç½®é…ç½®æ–‡ä»¶â€ï¼Œæ ¹æ®ç¯å¢ƒæ¥ç”Ÿæˆä¸åŒçš„éƒ¨ç½²é…ç½®ã€‚åªè¦å»ºç«‹å¤šä¸ª Kustomization æ–‡ä»¶ï¼Œå¼€å‘äººå‘˜å°±èƒ½ä»¥åŸºäºåŸºå‡†è¿›è¡Œæ´¾ç”Ÿï¼ˆBase and Overlayï¼‰çš„æ–¹å¼ï¼Œå¯¹ä¸åŒçš„æ¨¡å¼ï¼ˆè­¬å¦‚ç”Ÿäº§æ¨¡å¼ã€è°ƒè¯•æ¨¡å¼ï¼‰ã€ä¸åŒçš„é¡¹ç›®ï¼ˆåŒä¸€ä¸ªäº§å“å¯¹ä¸åŒå®¢æˆ·çš„å®¢åˆ¶åŒ–ï¼‰å®šåˆ¶å‡ºä¸åŒçš„èµ„æºæ•´åˆåŒ…ã€‚</li>
<li>Helm ä¸ Chartï¼šæ¨¡ä»¿ Linux åŒ…ç®¡ç†å™¨çš„æ€è·¯å»ç®¡ç† Kubernetes åº”ç”¨ï¼ŒHelm æ— æ³•å¾ˆå¥½åœ°ç®¡ç†è¿™ç§æœ‰çŠ¶æ€çš„ä¾èµ–å…³ç³»</li>
<li>Operator ä¸ CRDï¼šä¸€ç§å°è£…ã€éƒ¨ç½²å’Œç®¡ç† Kubernetes åº”ç”¨çš„æ–¹æ³•ï¼Œå°¤å…¶æ˜¯é’ˆå¯¹æœ€å¤æ‚çš„æœ‰çŠ¶æ€åº”ç”¨å»å°è£…è¿ç»´èƒ½åŠ›çš„è§£å†³æ–¹æ¡ˆï¼ŒOperator æ˜¯å¦‚ä½•è§£å†³é‚£äº› StatefulSet è¦†ç›–ä¸åˆ°çš„æœ‰çŠ¶æ€æœåŠ¡ç®¡ç†éœ€æ±‚çš„</li>
<li>å¼€æ”¾åº”ç”¨æ¨¡å‹ï¼šç”±ä¸€ç»„ç›¸äº’å…³è”ä½†åˆç¦»æ•£ç‹¬ç«‹çš„ç»„ä»¶æ„æˆï¼Œè¿™äº›ç»„ä»¶å®ä¾‹åŒ–åœ¨åˆé€‚çš„è¿è¡Œæ—¶ä¸Šï¼Œç”±é…ç½®æ¥æ§åˆ¶è¡Œä¸ºå¹¶å…±åŒåä½œæä¾›ç»Ÿä¸€çš„åŠŸèƒ½ï¼Œå¼€å‘äººå‘˜è´Ÿè´£ç®¡ç† Componentï¼›è¿ç»´äººå‘˜å°† Component ç»„åˆå¹¶ç»‘å®š Trait å˜æˆ Application Configurationï¼›å¹³å°äººå‘˜æˆ–åŸºç¡€è®¾æ–½æä¾›æ–¹è´Ÿè´£æä¾› OAM çš„è§£é‡Šèƒ½åŠ›</li>
</ul>
<h2 id="å®¹å™¨é—´ç½‘ç»œ"><a href="#å®¹å™¨é—´ç½‘ç»œ" class="headerlink" title="å®¹å™¨é—´ç½‘ç»œ"></a>å®¹å™¨é—´ç½‘ç»œ</h2><p>æœ¬èŠ‚ç‰¹æŒ‡â€œåŸºäº Linux ç³»ç»Ÿçš„ç½‘ç»œè™šæ‹ŸåŒ–æŠ€æœ¯æ¥å®ç°çš„å®¹å™¨é—´ç½‘ç»œé€šä¿¡â€</p>
<h3 id="Linux-ç½‘ç»œè™šæ‹ŸåŒ–"><a href="#Linux-ç½‘ç»œè™šæ‹ŸåŒ–" class="headerlink" title="Linux ç½‘ç»œè™šæ‹ŸåŒ–"></a>Linux ç½‘ç»œè™šæ‹ŸåŒ–</h3><h4 id="ç½‘ç»œé€šä¿¡æ¨¡å‹"><a href="#ç½‘ç»œé€šä¿¡æ¨¡å‹" class="headerlink" title="ç½‘ç»œé€šä¿¡æ¨¡å‹"></a>ç½‘ç»œé€šä¿¡æ¨¡å‹</h4><p>OSI ä¸ƒå±‚æ¨¡å‹â€”â€”&gt;Â TCP&#x2F;IP å››å±‚æ¨¡å‹<img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250808100735641.png"><br>ç½‘ç»œä¼ è¾“çš„é˜¶æ®µï¼š</p>
<ul>
<li><strong>Socket</strong>ï¼šåº”ç”¨å±‚çš„ç¨‹åºæ˜¯é€šè¿‡ Socket ç¼–ç¨‹æ¥å£æ¥å’Œå†…æ ¸ç©ºé—´çš„ç½‘ç»œåè®®æ ˆé€šä¿¡çš„ã€‚</li>
<li><strong>TCP&#x2F;UDP</strong>ï¼šä¼ è¾“å±‚åè®®æ—é‡Œæœ€é‡è¦çš„åè®®æ— ç–‘æ˜¯ä¼ è¾“æ§åˆ¶åè®®ï¼ˆTransmission Control Protocolï¼ŒTCPï¼‰å’Œç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆUser Datagram Protocolï¼ŒUDPï¼‰ä¸¤ç§</li>
<li><strong>IP</strong>ï¼šç½‘ç»œå±‚åè®®æœ€ä¸»è¦å°±æ˜¯ç½‘é™…åè®®ï¼ˆInternet Protocolï¼ŒIPï¼‰ï¼Œå…¶ä»–è¿˜æœ‰å› ç‰¹ç½‘ç»„ç®¡ç†åè®®ï¼ˆInternet Group Management Protocolï¼ŒIGMPï¼‰</li>
<li><strong>Device</strong>ï¼šç½‘ç»œè®¾å¤‡ï¼ˆDeviceï¼‰æ˜¯ç½‘ç»œè®¿é—®å±‚ä¸­é¢å‘ç³»ç»Ÿä¸€ä¾§çš„æ¥å£</li>
<li><strong>Driver</strong>ï¼šç½‘å¡é©±åŠ¨ç¨‹åºï¼ˆDriverï¼‰æ˜¯ç½‘ç»œè®¿é—®å±‚ä¸­é¢å‘ç¡¬ä»¶ä¸€ä¾§çš„æ¥å£</li>
</ul>
<h4 id="å¹²é¢„ç½‘ç»œé€šä¿¡"><a href="#å¹²é¢„ç½‘ç»œé€šä¿¡" class="headerlink" title="å¹²é¢„ç½‘ç»œé€šä¿¡"></a>å¹²é¢„ç½‘ç»œé€šä¿¡</h4><p>Â Linux Kernel 2.4 ç‰ˆå¼€å§‹ï¼Œå†…æ ¸å¼€æ”¾äº†ä¸€å¥—é€šç”¨çš„ã€å¯ä¾›ä»£ç å¹²é¢„æ•°æ®åœ¨åè®®æ ˆä¸­æµè½¬çš„è¿‡æ»¤å™¨æ¡†æ¶ã€‚</p>
<p>å›´ç»•ç½‘ç»œå±‚ï¼ˆIP åè®®ï¼‰çš„å‘¨å›´ï¼ŒåŸ‹ä¸‹äº†äº”ä¸ªé’©å­ï¼ˆHooksï¼‰ï¼Œæ¯å½“æœ‰æ•°æ®åŒ…æµåˆ°ç½‘ç»œå±‚ï¼Œç»è¿‡è¿™äº›é’©å­æ—¶ï¼Œå°±ä¼šè‡ªåŠ¨è§¦å‘ç”±å†…æ ¸æ¨¡å—æ³¨å†Œåœ¨è¿™é‡Œçš„å›è°ƒå‡½æ•°ï¼Œç¨‹åºä»£ç å°±èƒ½å¤Ÿé€šè¿‡å›è°ƒæ¥å¹²é¢„ Linux çš„ç½‘ç»œé€šä¿¡ã€‚</p>
<p><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250808102611840.png"><br>Netfilter å…è®¸åœ¨åŒä¸€ä¸ªé’©å­å¤„æ³¨å†Œå¤šä¸ªå›è°ƒå‡½æ•°ï¼Œå› æ­¤å‘é’©å­æ³¨å†Œå›è°ƒå‡½æ•°æ—¶å¿…é¡»æä¾›æ˜ç¡®çš„ä¼˜å…ˆçº§ï¼Œä»¥ä¾¿è§¦å‘æ—¶èƒ½æŒ‰ç…§ä¼˜å…ˆçº§ä»é«˜åˆ°ä½è¿›è¡Œæ¿€æ´»ã€‚</p>
<p>ä»¥ Netfilter ä¸ºåŸºç¡€çš„åº”ç”¨æœ‰å¾ˆå¤šï¼Œå…¶ä¸­ä½¿ç”¨æœ€å¹¿æ³›çš„æ¯«æ— ç–‘é—®è¦æ•° Xtables ç³»åˆ—å·¥å…·ï¼Œè­¬å¦‚iptablesã€ebtablesã€arptablesã€ip6tables ç­‰ç­‰</p>
<p>iptables ä¸ä»…ä»…æ˜¯ Linux ç³»ç»Ÿè‡ªå¸¦çš„ä¸€ä¸ªç½‘ç»œå·¥å…·ï¼Œå®ƒåœ¨å®¹å™¨é—´é€šä¿¡ä¸­æ‰®æ¼”ç›¸å½“é‡è¦çš„è§’è‰²ï¼Œè­¬å¦‚ Kubernetes ç”¨æ¥ç®¡ç† Service çš„ Endpoints çš„æ ¸å¿ƒç»„ä»¶ kube-proxyï¼Œå°±ä¾èµ– iptables æ¥å®Œæˆ ClusterIP åˆ° Pod çš„é€šä¿¡ï¼Œè¿™ç§é€šä¿¡çš„æœ¬è´¨å°±æ˜¯ä¸€ç§ NAT è®¿é—®</p>
<h4 id="è™šæ‹ŸåŒ–ç½‘ç»œè®¾å¤‡"><a href="#è™šæ‹ŸåŒ–ç½‘ç»œè®¾å¤‡" class="headerlink" title="è™šæ‹ŸåŒ–ç½‘ç»œè®¾å¤‡"></a>è™šæ‹ŸåŒ–ç½‘ç»œè®¾å¤‡</h4><p>ç›®å‰ä¸»æµçš„è™šæ‹Ÿç½‘å¡æ–¹æ¡ˆæœ‰tun&#x2F;tapå’Œvethä¸¤ç§ï¼š</p>
<ul>
<li><strong>tun&#x2F;tap</strong>ï¼š åœ¨æ—¶é—´ä¸Š tun&#x2F;tap å‡ºç°å¾—æ›´æ—©ï¼Œå®ƒæ˜¯ä¸€ç»„é€šç”¨çš„è™šæ‹Ÿé©±åŠ¨ç¨‹åºåŒ…ï¼Œé‡Œé¢åŒ…å«äº†ä¸¤ä¸ªè®¾å¤‡ï¼Œåˆ†åˆ«æ˜¯ç”¨äºç½‘ç»œæ•°æ®åŒ…å¤„ç†çš„è™šæ‹Ÿç½‘å¡é©±åŠ¨ï¼Œä»¥åŠç”¨äºå†…æ ¸ç©ºé—´ä¸ç”¨æˆ·ç©ºé—´äº¤äº’çš„å­—ç¬¦è®¾å¤‡ï¼ˆCharacter Devicesï¼Œè¿™é‡Œå…·ä½“æŒ‡&#x2F;dev&#x2F;net&#x2F;tunï¼‰é©±åŠ¨ã€‚Â tun&#x2F;tap æ–¹æ¡ˆæ¯”èµ· veth æ–¹æ¡ˆæœ‰æ›´å¹¿æ³›çš„é€‚ç”¨èŒƒå›´ã€‚<img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250808104458086.png"></li>
<li>ä¾›äº†ä¸“é—¨çš„è™šæ‹Ÿä»¥å¤ªç½‘ï¼ˆVirtual Ethernetï¼Œä¹ æƒ¯ç®€å†™åš vethï¼‰è®©ä¸¤ä¸ªéš”ç¦»çš„ç½‘ç»œåç§°ç©ºé—´ä¹‹é—´å¯ä»¥äº’ç›¸é€šä¿¡ã€‚ç›´æ¥æŠŠ veth æ¯”å–»æˆæ˜¯è™šæ‹Ÿç½‘å¡å…¶å®å¹¶ä¸ååˆ†å‡†ç¡®ï¼Œå¦‚æœè¦å’Œç‰©ç†è®¾å¤‡ç±»æ¯”ï¼Œå®ƒåº”è¯¥ç›¸å½“äºç”±äº¤å‰ç½‘çº¿è¿æ¥çš„ä¸€å¯¹ç‰©ç†ç½‘å¡ã€‚å®ƒæ˜¯ä¸€å¯¹è®¾å¤‡ï¼Œå¯¹å¤šä¸ªå®¹å™¨é—´é€šä¿¡ï¼Œå¦‚æœä»ç„¶å•çº¯åªç”¨ veth pair çš„è¯ï¼Œäº‹æƒ…å°±ä¼šå˜å¾—éå¸¸éº»çƒ¦ï¼Œè®©æ¯ä¸ªå®¹å™¨éƒ½ä¸ºä¸å®ƒé€šä¿¡çš„å…¶ä»–å®¹å™¨å»ºç«‹ä¸€å¯¹ä¸“ç”¨çš„ veth pair å¹¶ä¸å®é™…ï¼Œè¿™æ—¶å°±è¿«åˆ‡éœ€è¦æœ‰ä¸€å°è™šæ‹ŸåŒ–çš„äº¤æ¢æœºæ¥è§£å†³å¤šå®¹å™¨ä¹‹é—´çš„é€šä¿¡é—®é¢˜äº†<img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250808104452797.png"></li>
</ul>
<p>æ—¢ç„¶æœ‰äº†è™šæ‹Ÿç½‘å¡ï¼Œå¾ˆè‡ªç„¶ä¹Ÿä¼šè”æƒ³åˆ°è®©ç½‘å¡æ¥å…¥åˆ°äº¤æ¢æœºé‡Œï¼Œå®ç°å¤šä¸ªå®¹å™¨é—´çš„ç›¸äº’è¿æ¥ã€‚Linux Bridgeä¾¿æ˜¯ Linux ç³»ç»Ÿä¸‹çš„è™šæ‹ŸåŒ–äº¤æ¢æœº</p>
<p>Â Linux Bridge ä¸æ™®é€šäº¤æ¢æœºçš„åŒºåˆ«æ˜¯é™¤äº†æ˜¾å¼æ¥å…¥çš„è®¾å¤‡å¤–ï¼Œå®ƒè‡ªå·±ä¹Ÿæ— å¯åˆ†å‰²åœ°è¿æ¥ç€ä¸€å°æœ‰ç€å®Œæ•´ç½‘ç»œåè®®æ ˆçš„ Linux ä¸»æœºï¼Œå› ä¸º Linux Bridge æœ¬èº«è‚¯å®šæ˜¯åœ¨æŸå° Linux ä¸»æœºä¸Šåˆ›å»ºçš„ï¼Œå¯ä»¥çœ‹ä½œ Linux Bridge æœ‰ä¸€ä¸ªä¸è‡ªå·±åå­—ç›¸åŒçš„éšè—ç«¯å£ï¼Œéšå¼åœ°è¿æ¥äº†åˆ›å»ºå®ƒçš„é‚£å° Linux ä¸»æœºã€‚å› æ­¤ï¼ŒLinux Bridge å…è®¸ç»™è‡ªå·±è®¾ç½® IP åœ°å€ï¼Œæ¯”æ™®é€šäº¤æ¢æœºå¤šå‡ºä¸€ç§ç‰¹æ®Šçš„è½¬å‘æƒ…å†µã€‚<br>Â Linux Bridge æ„å»ºå• IP å®¹å™¨ç½‘ç»œ<br>Â <img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250808104956285.png"></p>
<p>ä¸‹ä¸€æ­¥å°±æ˜¯è¦ä½¿ç”¨è¿™äº›è®¾å¤‡ç»„æˆç½‘ç»œï¼Œå®¹å™¨åˆ†å¸ƒåœ¨ä¸åŒçš„ç‰©ç†ä¸»æœºä¸Šï¼Œæ¯ä¸€å°ç‰©ç†ä¸»æœºéƒ½æœ‰ç‰©ç†ç½‘ç»œç›¸äº’è”é€š</p>
<p>SDNï¼ˆSoftware Defined Networkï¼ŒSDNï¼‰ é‡Œä½äºä¸‹å±‚çš„ç‰©ç†ç½‘ç»œè¢«ç§°ä¸º Underlayï¼Œå®ƒç€é‡è§£å†³ç½‘ç»œçš„è¿é€šæ€§ä¸å¯ç®¡ç†æ€§ï¼Œä½äºä¸Šå±‚çš„é€»è¾‘ç½‘ç»œè¢«ç§°ä¸º Overlayï¼Œå®ƒç€é‡ä¸ºåº”ç”¨æä¾›ä¸è½¯ä»¶éœ€æ±‚ç›¸ç¬¦çš„ä¼ è¾“æœåŠ¡å’Œç½‘ç»œæ‹“æ‰‘ã€‚ç”±äºè·¨ä¸»æœºçš„å®¹å™¨é—´é€šä¿¡ï¼Œç”¨çš„å¤§å¤šæ˜¯ Overlay ç½‘ç»œï¼Œä»¥ VXLAN ä¸ºä¾‹å»ä»‹ç» Overlay ç½‘ç»œçš„åŸç†ã€‚</p>
<p>VLANçš„ç¼ºé™·ï¼š</p>
<ul>
<li>VLAN ID æœ€å¤šåªèƒ½æœ‰ 212&#x3D;4096 ç§å–å€¼ã€‚å½“äº‘è®¡ç®—æ•°æ®ä¸­å¿ƒå‡ºç°åï¼Œå³ä½¿ä¸è€ƒè™‘è™šæ‹ŸåŒ–çš„éœ€æ±‚ï¼Œå•æ˜¯éœ€è¦åˆ†é… IP çš„ç‰©ç†è®¾å¤‡éƒ½æœ‰å¯èƒ½æ•°ä»¥ä¸‡è®¡ç”šè‡³æ•°ä»¥åä¸‡è®¡ï¼Œè¿™æ · 4096 ä¸ª VLAN è‚¯å®šæ˜¯ä¸å¤Ÿç”¨çš„ã€‚ï¼ˆå‡ºæ–°è§„èŒƒï¼‰</li>
<li>VLAN æœ¬èº«æ˜¯ä¸ºäºŒå±‚ç½‘ç»œæ‰€è®¾è®¡çš„ï¼Œä½†æ˜¯åœ¨ä¸¤ä¸ªç‹¬ç«‹æ•°æ®ä¸­å¿ƒä¹‹é—´ï¼Œä¿¡æ¯åªèƒ½å¤Ÿé€šè¿‡ä¸‰å±‚ç½‘ç»œä¼ é€’ï¼ˆå®šä¹‰äº† VXLAN è§„èŒƒï¼‰</li>
</ul>
<p>VXLANï¼šåŸæœ¬åœ¨äºŒå±‚ä¼ è¾“çš„ä»¥å¤ªå¸§æ”¾åˆ°å››å±‚ UDP åè®®çš„æŠ¥æ–‡ä½“å†…ï¼ŒåŒæ—¶åŠ å…¥äº†è‡ªå·±å®šä¹‰çš„ VXLAN Headerï¼ŒVLAN IDå¯ä»¥å­˜å‚¨ 1677 ä¸‡ä¸ªä¸åŒçš„å–å€¼ï¼Œè®©äºŒå±‚ç½‘ç»œå¾—ä»¥åœ¨ä¸‰å±‚èŒƒå›´å†…è¿›è¡Œæ‰©å±•ï¼Œä¸å†å—æ•°æ®ä¸­å¿ƒé—´ä¼ è¾“çš„é™åˆ¶ã€‚</p>
<p>ä» Linux Kernel 3.7 ç‰ˆæœ¬èµ·ï¼ŒLinux ç³»ç»Ÿå°±å¼€å§‹æ”¯æŒ VXLANã€‚åˆ°äº† 3.12 ç‰ˆæœ¬ï¼ŒLinux å¯¹ VXLAN çš„æ”¯æŒå·²è¾¾åˆ°å®Œå…¨å®Œå¤‡çš„ç¨‹åº¦ï¼Œèƒ½å¤Ÿå¤„ç†å•æ’­å’Œç»„æ’­ï¼Œèƒ½å¤Ÿè¿è¡Œäº IPv4 å’Œ IPv6 ä¹‹ä¸Šï¼Œä¸€å° Linux ä¸»æœºç»è¿‡ç®€å•é…ç½®ä¹‹åï¼Œä¾¿å¯ä»¥æŠŠ Linux Bridge ä½œä¸º VTEP è®¾å¤‡ä½¿ç”¨ã€‚ä¸è¿‡ï¼ŒVXLAN ä¹Ÿå¸¦æ¥äº†é¢å¤–çš„å¤æ‚åº¦å’Œæ€§èƒ½å¼€é”€ï¼Œä¼ è¾“ã€æ€§èƒ½æ•ˆç‡çš„ä¸‹é™ã€‚</p>
<p>MACVLAN å€Ÿç”¨äº† VLAN å­æ¥å£çš„æ€è·¯ï¼Œå¹¶ä¸”åœ¨è¿™ä¸ªåŸºç¡€ä¸Šæ›´è¿›ä¸€æ­¥ï¼Œä¸ä»…å…è®¸å¯¹åŒä¸€ä¸ªç½‘å¡è®¾ç½®å¤šä¸ª IP åœ°å€ï¼Œè¿˜å…è®¸å¯¹åŒä¸€å¼ ç½‘å¡ä¸Šè®¾ç½®å¤šä¸ª MAC åœ°å€ï¼Œè¿™ä¹Ÿæ˜¯ MACVLAN åå­—çš„ç”±æ¥ã€‚<br><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250808184541113.png"><br>ç”¨ MACVLAN æŠ€æœ¯è™šæ‹Ÿå‡ºæ¥çš„å‰¯æœ¬ç½‘å¡ï¼Œåœ¨åŠŸèƒ½ä¸Šå’ŒçœŸå®çš„ç½‘å¡æ˜¯å®Œå…¨å¯¹ç­‰çš„ï¼Œæ­¤æ—¶çœŸæ­£çš„ç‰©ç†ç½‘å¡å®é™…ä¸Šç¡®å®æ‰¿æ‹…ç€ç±»ä¼¼äº¤æ¢æœºçš„èŒè´£ï¼Œæ”¶åˆ°æ•°æ®åŒ…åï¼Œæ ¹æ®ç›®æ ‡ MAC åœ°å€åˆ¤æ–­è¿™ä¸ªåŒ…åº”è½¬å‘ç»™å“ªå—å‰¯æœ¬ç½‘å¡å¤„ç†ï¼Œç”±åŒä¸€å—ç‰©ç†ç½‘å¡è™šæ‹Ÿå‡ºæ¥çš„å‰¯æœ¬ç½‘å¡ï¼Œå¤©ç„¶å¤„äºåŒä¸€ä¸ª VLAN ä¹‹ä¸­ï¼Œå¯ä»¥ç›´æ¥äºŒå±‚é€šä¿¡ï¼Œä¸éœ€è¦å°†æµé‡è½¬å‘åˆ°å¤–éƒ¨ç½‘ç»œã€‚</p>
<p>Docker çš„ç½‘ç»œæ–¹æ¡ˆåœ¨æ“ä½œå±‚é¢ä¸Šæ˜¯æŒ‡èƒ½å¤Ÿç›´æ¥é€šè¿‡<code>docker run --network</code>å‚æ•°æŒ‡å®šçš„ç½‘ç»œï¼Œæˆ–è€…å…ˆ<code>docker network create</code>åˆ›å»ºåå†è¢«å®¹å™¨ä½¿ç”¨çš„ç½‘ç»œã€‚å®‰è£… Docker è¿‡ç¨‹ä¸­ä¼šè‡ªåŠ¨åœ¨å®¿ä¸»æœºä¸Šåˆ›å»ºä¸€ä¸ªåä¸º docker0 çš„ç½‘æ¡¥ï¼Œä»¥åŠä¸‰ç§ä¸åŒçš„ Docker ç½‘ç»œï¼Œåˆ†åˆ«æ˜¯ bridgeã€host å’Œ noneï¼Œå¯¹åº”ç€ Docker æä¾›çš„ä¸‰ç§å¼€ç®±å³ç”¨çš„ç½‘ç»œæ–¹æ¡ˆã€‚</p>
<h3 id="å®¹å™¨ç½‘ç»œä¸ç”Ÿæ€"><a href="#å®¹å™¨ç½‘ç»œä¸ç”Ÿæ€" class="headerlink" title="å®¹å™¨ç½‘ç»œä¸ç”Ÿæ€"></a>å®¹å™¨ç½‘ç»œä¸ç”Ÿæ€</h3><h4 id="CNM-ä¸-CNI"><a href="#CNM-ä¸-CNI" class="headerlink" title="CNM ä¸ CNI"></a>CNM ä¸ CNI</h4><p>å®¹å™¨ç½‘ç»œçš„äº‹å®æ ‡å‡†CNIï¼ˆContainer Networking Interfaceï¼‰</p>
<p>ä»ç¨‹åºåŠŸèƒ½ä¸Šçœ‹ï¼ŒCNM å’Œ CNI çš„ç½‘ç»œæ’ä»¶æä¾›çš„èƒ½åŠ›éƒ½èƒ½åˆ’åˆ†ä¸ºç½‘ç»œçš„ç®¡ç†ä¸ IP åœ°å€çš„ç®¡ç†ä¸¤ç±»ï¼Œæ’ä»¶å¯ä»¥é€‰æ‹©åªå®ç°å…¶ä¸­çš„æŸä¸€ä¸ªï¼Œä¹Ÿå¯ä»¥å…¨éƒ¨éƒ½å®ç°ï¼ŒåŒ…æ‹¬<strong>ç®¡ç†ç½‘ç»œåˆ›å»ºä¸åˆ é™¤</strong>ã€<strong>ç®¡ç† IP åœ°å€åˆ†é…ä¸å›æ”¶</strong>ã€‚</p>
<h4 id="CNM-åˆ°-CNI"><a href="#CNM-åˆ°-CNI" class="headerlink" title="CNM åˆ° CNI"></a>CNM åˆ° CNI</h4><p>Kubernetesä¸ CoreOS åˆä½œä»¥ RKT ç½‘ç»œææ¡ˆä¸ºåŸºç¡€å‘å±•å‡º CNI è§„èŒƒã€‚CNIçš„æˆåŠŸå²</p>
<h4 id="ç½‘ç»œæ’ä»¶ç”Ÿæ€"><a href="#ç½‘ç»œæ’ä»¶ç”Ÿæ€" class="headerlink" title="ç½‘ç»œæ’ä»¶ç”Ÿæ€"></a>ç½‘ç»œæ’ä»¶ç”Ÿæ€</h4><p>è·¨ä¸»æœºé€šä¿¡çš„ç½‘ç»œå®ç°æ–¹å¼æœ‰å¦‚ä¸‹ä¸‰ç§æ¨¡å¼ï¼š</p>
<ul>
<li><strong>Overlay æ¨¡å¼</strong>ï¼šä¸€ç§è™šæ‹ŸåŒ–çš„ä¸Šå±‚é€»è¾‘ç½‘ç»œï¼Œå¥½å¤„åœ¨äºå®ƒä¸å—åº•å±‚ç‰©ç†ç½‘ç»œç»“æ„çš„çº¦æŸï¼Œæœ‰æ›´å¤§çš„è‡ªç”±åº¦ï¼Œæ›´å¥½çš„æ˜“ç”¨æ€§ï¼›åå¤„æ˜¯ç”±äºé¢å¤–çš„åŒ…å¤´å°è£…å¯¼è‡´ä¿¡æ¯å¯†åº¦é™ä½ï¼Œé¢å¤–çš„éš§é“å°åŒ…è§£åŒ…ä¼šå¯¼è‡´ä¼ è¾“æ€§èƒ½ä¸‹é™ã€‚</li>
<li><strong>è·¯ç”±æ¨¡å¼</strong>ï¼šè·¯ç”±æ¨¡å¼å…¶å®å±äº Underlay æ¨¡å¼çš„ä¸€ç§ç‰¹ä¾‹ï¼Œè¿™é‡Œå°†å®ƒå•ç‹¬ä½œä¸ºä¸€ç§ç½‘ç»œå®ç°æ¨¡å¼æ¥ä»‹ç»ã€‚ç›¸æ¯”èµ· Overlay ç½‘ç»œï¼Œè·¯ç”±æ¨¡å¼çš„ä¸»è¦åŒºåˆ«åœ¨äºå®ƒçš„è·¨ä¸»æœºé€šä¿¡æ˜¯ç›´æ¥é€šè¿‡è·¯ç”±è½¬å‘æ¥å®ç°çš„ï¼Œå› è€Œæ— é¡»åœ¨ä¸åŒä¸»æœºä¹‹é—´è¿›è¡Œéš§é“å°åŒ…ã€‚è¿™ç§æ¨¡å¼çš„å¥½å¤„æ˜¯æ€§èƒ½ç›¸æ¯” Overlay ç½‘ç»œæœ‰æ˜æ˜¾æå‡ï¼Œåå¤„æ˜¯è·¯ç”±è½¬å‘è¦ä¾èµ–äºåº•å±‚ç½‘ç»œç¯å¢ƒçš„æ”¯æŒ</li>
<li><strong>Underlay æ¨¡å¼</strong>ï¼šè¿™é‡Œçš„ Underlay æ¨¡å¼ç‰¹æŒ‡è®©å®¹å™¨å’Œå®¿ä¸»æœºå¤„äºåŒä¸€ç½‘ç»œï¼Œä¸¤è€…æ‹¥æœ‰ç›¸åŒçš„åœ°ä½çš„ç½‘ç»œæ–¹æ¡ˆã€‚Underlay ç½‘ç»œè¦æ±‚å®¹å™¨çš„ç½‘ç»œæ¥å£èƒ½å¤Ÿç›´æ¥ä¸åº•å±‚ç½‘ç»œè¿›è¡Œé€šä¿¡ï¼Œå› æ­¤è¯¥æ¨¡å¼æ˜¯ç›´æ¥ä¾èµ–äºè™šæ‹ŸåŒ–è®¾å¤‡ä¸åº•å±‚ç½‘ç»œèƒ½åŠ›çš„ã€‚</li>
</ul>
<h2 id="æŒä¹…åŒ–å­˜å‚¨"><a href="#æŒä¹…åŒ–å­˜å‚¨" class="headerlink" title="æŒä¹…åŒ–å­˜å‚¨"></a>æŒä¹…åŒ–å­˜å‚¨</h2><h3 id="Kubernetes-å­˜å‚¨è®¾è®¡"><a href="#Kubernetes-å­˜å‚¨è®¾è®¡" class="headerlink" title="Kubernetes å­˜å‚¨è®¾è®¡"></a>Kubernetes å­˜å‚¨è®¾è®¡</h3><p>Kubernetes é¢„ç½®äº†å¾ˆå¤š In-Treeæ’ä»¶æ¥å¯¹æ¥ï¼Œè®©ç”¨æˆ·æ ¹æ®è‡ªå·±ä¸šåŠ¡æŒ‰éœ€é€‰æ‹©ã€‚</p>
<h4 id="Mount-å’Œ-Volume"><a href="#Mount-å’Œ-Volume" class="headerlink" title="Mount å’Œ Volume"></a>Mount å’Œ Volume</h4><ul>
<li>Mount æ˜¯åŠ¨è¯ï¼Œè¡¨ç¤ºå°†æŸä¸ªå¤–éƒ¨å­˜å‚¨æŒ‚è½½åˆ°ç³»ç»Ÿä¸­</li>
<li>Volume æ˜¯åè¯ï¼Œè¡¨ç¤ºç‰©ç†å­˜å‚¨çš„é€»è¾‘æŠ½è±¡ï¼Œç›®çš„æ˜¯ä¸ºç‰©ç†å­˜å‚¨æä¾›æœ‰å¼¹æ€§çš„åˆ†å‰²æ–¹å¼</li>
</ul>
<p>Docker å†…å»ºæ”¯æŒäº†ä¸‰ç§æŒ‚è½½ç±»å‹ï¼Œåˆ†åˆ«æ˜¯ Bindï¼ˆ<code>--mount type=bind</code>ï¼‰ã€Volumeï¼ˆ<code>--mount type=volume</code>ï¼‰å’Œ tmpfsï¼ˆ<code>--mount type=tmpfs</code>ï¼‰ï¼Œåªç€é‡å…³æ³¨ Bind å’Œ Volume ä¸¤ç§æŒ‚è½½ç±»å‹<br><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250809141518216.png"></p>
<ul>
<li>Bind Mountï¼šæŠŠå®¿ä¸»æœºçš„æŸä¸ªç›®å½•ï¼ˆæˆ–æ–‡ä»¶ï¼‰æŒ‚è½½åˆ°å®¹å™¨çš„æŒ‡å®šç›®å½•ï¼ˆæˆ–æ–‡ä»¶ï¼‰ä¸‹ï¼ŒBind Mount åªèƒ½è®©å®¹å™¨ä¸æœ¬åœ°å®¿ä¸»æœºä¹‹é—´å»ºç«‹äº†æŸä¸ªç›®å½•çš„æ˜ å°„ï¼Œå¦‚æœæƒ³è¦åœ¨ä¸åŒå®¿ä¸»æœºä¸Šçš„å®¹å™¨å…±äº«åŒä¸€ä»½å­˜å‚¨ï¼Œå°±å¿…é¡»å…ˆæŠŠå…±äº«å­˜å‚¨æŒ‚è½½åˆ°æ¯ä¸€å°å®¿ä¸»æœºæ“ä½œç³»ç»Ÿçš„æŸä¸ªç›®å½•ä¸‹ï¼Œç„¶åæ‰èƒ½é€ä¸ªæŒ‚è½½åˆ°å®¹å™¨å†…ä½¿ç”¨<br><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250809141657730.png">ã€</li>
<li>Volume Mountï¼šä¸ºäº†æå‡ Docker å¯¹ä¸åŒå­˜å‚¨ä»‹è´¨çš„æ”¯æ’‘èƒ½åŠ›ï¼Œæå‡ºäº†ä¸ Storage Driver ç›¸å¯¹åº”çš„ Volume Driverï¼ˆå·é©±åŠ¨ï¼‰çš„æ¦‚å¿µã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡docker plugin installå‘½ä»¤å®‰è£…å¤–éƒ¨çš„å·é©±åŠ¨ï¼Œå¹¶åœ¨åˆ›å»º Volume æ—¶æŒ‡å®šä¸€ä¸ªä¸å…¶å­˜å‚¨ç³»ç»Ÿç›¸åŒ¹é…çš„å·é©±åŠ¨</li>
</ul>
<h4 id="é™æ€å­˜å‚¨åˆ†é…"><a href="#é™æ€å­˜å‚¨åˆ†é…" class="headerlink" title="é™æ€å­˜å‚¨åˆ†é…"></a>é™æ€å­˜å‚¨åˆ†é…</h4><p>Kubernetes å°† Volume åˆ†ä¸ºæŒä¹…åŒ–çš„ PersistentVolume å’ŒéæŒä¹…åŒ–çš„æ™®é€š Volume ä¸¤ç±»<img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250809142049107.png"></p>
<ul>
<li>æ™®é€š Volumeï¼šåŒä¸€ä¸ª Pod ä¸­å¤šä¸ªå®¹å™¨æä¾›å¯å…±äº«çš„å­˜å‚¨èµ„æºï¼Œå› æ­¤ Volume å…·æœ‰ååˆ†æ˜ç¡®çš„ç”Ÿå‘½å‘¨æœŸâ€”â€”ä¸æŒ‚è½½å®ƒçš„ Pod ç›¸åŒçš„ç”Ÿå‘½å‘¨æœŸï¼Œè¿™æ„å‘³ç€å°½ç®¡æ™®é€š Volume ä¸å…·å¤‡æŒä¹…åŒ–çš„å­˜å‚¨èƒ½åŠ›ï¼Œä½†è‡³å°‘æ¯” Pod ä¸­è¿è¡Œçš„ä»»ä½•å®¹å™¨çš„å­˜æ´»æœŸéƒ½æ›´é•¿ï¼ŒPod ä¸­ä¸åŒçš„å®¹å™¨èƒ½å…±äº«ç›¸åŒçš„æ™®é€š Volumeï¼Œå½“å®¹å™¨é‡æ–°å¯åŠ¨æ—¶ï¼Œæ™®é€š Volume ä¸­çš„æ•°æ®ä¹Ÿä¼šèƒ½å¤Ÿå¾—åˆ°ä¿ç•™ã€‚</li>
<li>æŒä¹…åŒ–Volumnï¼šå¯ä»¥ç‹¬ç«‹äº Pod å­˜åœ¨ï¼Œç”Ÿå‘½å‘¨æœŸä¸ Pod æ— å…³ï¼Œå› æ­¤ä¹Ÿå†³å®šäº† PersistentVolume ä¸åº”è¯¥ä¾é™„äºä»»ä½•ä¸€ä¸ªå®¿ä¸»æœºèŠ‚ç‚¹ï¼ŒPersistentVolume æ˜¯ç”±ç®¡ç†å‘˜ï¼ˆè¿ç»´äººå‘˜ï¼‰è´Ÿè´£ç»´æŠ¤çš„ï¼Œç”¨æˆ·ï¼ˆå¼€å‘äººå‘˜ï¼‰é€šè¿‡ PersistentVolumeClaim æ¥åŒ¹é…åˆ°åˆä¹éœ€æ±‚çš„ PersistentVolumeã€‚<img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250809142542596.png"></li>
</ul>
<h4 id="åŠ¨æ€å­˜å‚¨åˆ†é…"><a href="#åŠ¨æ€å­˜å‚¨åˆ†é…" class="headerlink" title="åŠ¨æ€å­˜å‚¨åˆ†é…"></a>åŠ¨æ€å­˜å‚¨åˆ†é…</h4><p>ä¸€æ—¦åº”ç”¨è§„æ¨¡å¢å¤§ï¼ŒPersistentVolume å¾ˆéš¾è¢«è‡ªåŠ¨åŒ–çš„é—®é¢˜å°±ä¼šçªæ˜¾å‡ºæ¥ã€‚<br>åŠ¨æ€å­˜å‚¨åˆ†é…ï¼šæŒ‡åœ¨ç”¨æˆ·å£°æ˜å­˜å‚¨èƒ½åŠ›çš„éœ€æ±‚æ—¶ï¼Œä¸æ˜¯æœŸæœ›é€šè¿‡ Kubernetes æ’®åˆæ¥è·å¾—ä¸€ä¸ªç®¡ç†å‘˜äººå·¥é¢„ç½®çš„ PersistentVolumeï¼Œè€Œæ˜¯ç”±ç‰¹å®šçš„èµ„æºåˆ†é…å™¨ï¼ˆProvisionerï¼‰è‡ªåŠ¨åœ°åœ¨å­˜å‚¨èµ„æºæ± æˆ–è€…äº‘å­˜å‚¨ç³»ç»Ÿä¸­åˆ†é…ç¬¦åˆç”¨æˆ·å­˜å‚¨éœ€è¦çš„ PersistentVolumeï¼Œç„¶åæŒ‚è½½åˆ° Pod ä¸­ä½¿ç”¨ï¼Œå®Œæˆè¿™é¡¹å·¥ä½œçš„èµ„æºè¢«å‘½åä¸º StorageClass<br><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250809142941504.png"></p>
<h3 id="å®¹å™¨å­˜å‚¨ä¸ç”Ÿæ€"><a href="#å®¹å™¨å­˜å‚¨ä¸ç”Ÿæ€" class="headerlink" title="å®¹å™¨å­˜å‚¨ä¸ç”Ÿæ€"></a>å®¹å™¨å­˜å‚¨ä¸ç”Ÿæ€</h3><h4 id="Kubernetes-å­˜å‚¨æ¶æ„"><a href="#Kubernetes-å­˜å‚¨æ¶æ„" class="headerlink" title="Kubernetes å­˜å‚¨æ¶æ„"></a>Kubernetes å­˜å‚¨æ¶æ„</h4><p>Kubernetes å‚è€ƒäº†ä¼ ç»Ÿæ“ä½œç³»ç»Ÿæ¥å…¥æˆ–ç§»é™¤æ–°å­˜å‚¨è®¾å¤‡åšæ³•ï¼ŒæŠŠæ¥å…¥æˆ–ç§»é™¤å¤–éƒ¨å­˜å‚¨è¿™ä»¶äº‹æƒ…åˆ†è§£ä¸ºä»¥ä¸‹ä¸‰ç§æ“ä½œï¼š</p>
<ul>
<li><strong>å‡†å¤‡</strong>ï¼ˆProvisionï¼‰ï¼šç¡®å®šäº†æ¥å…¥å­˜å‚¨çš„æ¥æºã€å®¹é‡ã€æ€§èƒ½ä»¥åŠå…¶ä»–æŠ€æœ¯å‚æ•°ï¼Œå®ƒçš„é€†æ“ä½œæ˜¯<strong>ç§»é™¤</strong>ï¼ˆDeleteï¼‰å­˜å‚¨ã€‚</li>
<li><strong>é™„åŠ </strong>ï¼ˆAttachï¼‰ï¼šç¡®å®šäº†å­˜å‚¨çš„è®¾å¤‡åç§°ã€é©±åŠ¨æ–¹å¼ç­‰é¢å‘ç³»ç»Ÿä¸€ä¾§çš„ä¿¡æ¯ï¼Œå®ƒçš„é€†æ“ä½œæ˜¯<strong>åˆ†ç¦»</strong>ï¼ˆDetachï¼‰å­˜å‚¨è®¾å¤‡ã€‚</li>
<li><strong>æŒ‚è½½</strong>ï¼ˆMountï¼‰ï¼šå­˜å‚¨çš„è®¿é—®ç›®å½•ã€æ–‡ä»¶ç³»ç»Ÿæ ¼å¼ç­‰é¢å‘åº”ç”¨ä¸€ä¾§çš„ä¿¡æ¯ï¼Œå®ƒçš„é€†æ“ä½œæ˜¯<strong>å¸è½½</strong>ï¼ˆUnmountï¼‰å­˜å‚¨è®¾å¤‡ã€‚</li>
</ul>
<p>å…­ç§æ“ä½œåˆ†åˆ«è¢« Kubernetes é€šè¿‡ä¸¤ä¸ªæ§åˆ¶å™¨åŠä¸€ä¸ªç®¡ç†å™¨æ¥è¿›è¡Œè°ƒç”¨ï¼Œè¿™äº›æ§åˆ¶å™¨ã€ç®¡ç†å™¨çš„ä½œç”¨åˆ†åˆ«æ˜¯ï¼š</p>
<ul>
<li><strong>PV æ§åˆ¶å™¨</strong>ï¼ˆPersistentVolume Controllerï¼‰ï¼šPV æ§åˆ¶å™¨çš„æœŸæœ›çŠ¶æ€æœ‰ä¸¤ä¸ªï¼Œåˆ†åˆ«æ˜¯â€œæ‰€æœ‰æœªç»‘å®šçš„ PersistentVolume éƒ½èƒ½å¤„äºå¯ç”¨çŠ¶æ€â€ä»¥åŠâ€œæ‰€æœ‰å¤„äºç­‰å¾…çŠ¶æ€çš„ PersistentVolumeClaim éƒ½èƒ½é…å¯¹åˆ°ä¸ä¹‹ç»‘å®šçš„ PersistentVolumeâ€</li>
<li><strong>AD æ§åˆ¶å™¨</strong>ï¼ˆAttach&#x2F;Detach Controllerï¼‰ï¼šAD æ§åˆ¶å™¨çš„æœŸæœ›çŠ¶æ€æ˜¯â€œæ‰€æœ‰è¢«è°ƒåº¦åˆ°å‡†å¤‡æ–°åˆ›å»º Pod çš„èŠ‚ç‚¹ï¼Œéƒ½é™„åŠ å¥½äº†è¦ä½¿ç”¨çš„å­˜å‚¨ï¼›å½“ Pod è¢«é”€æ¯åï¼ŒåŸæœ¬è¿è¡Œ Pod çš„èŠ‚ç‚¹éƒ½åˆ†ç¦»äº†ä¸å†è¢«ä½¿ç”¨çš„å­˜å‚¨â€ï¼Œå¦‚æœå®é™…çŠ¶æ€ä¸ç¬¦åˆè¯¥æœŸæœ›ï¼Œä¼šæ ¹æ®éœ€è¦è°ƒç”¨å­˜å‚¨é©±åŠ¨æ’ä»¶çš„ Attach&#x2F;Detach æ“ä½œã€‚</li>
<li><strong>Volume ç®¡ç†å™¨</strong>ï¼ˆVolume Managerï¼‰ï¼šç”¨æ¥æ”¯æŒæœ¬èŠ‚ç‚¹ä¸­ Volume æ‰§è¡Œ Attach&#x2F;Detach&#x2F;Mount&#x2F;Unmount æ“ä½œã€‚<br><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250809143905280.png"></li>
</ul>
<h4 id="FlexVolume-ä¸-CSI"><a href="#FlexVolume-ä¸-CSI" class="headerlink" title="FlexVolume ä¸ CSI"></a>FlexVolume ä¸ CSI</h4><p>Kubernetes ç›®å‰åŒæ—¶æ”¯æŒFlexVolumeä¸CSIï¼ˆContainer Storage Interfaceï¼‰ä¸¤å¥—ç‹¬ç«‹çš„å­˜å‚¨æ‰©å±•æœºåˆ¶ã€‚</p>
<ul>
<li>FlexVolumeæ˜¯ Kubernetes å¾ˆæ—©æœŸç‰ˆæœ¬ï¼ˆ1.2 ç‰ˆå¼€å§‹æä¾›ï¼Œ1.8 ç‰ˆè¾¾åˆ° GA çŠ¶æ€ï¼‰å°±å¼€å§‹æ”¯æŒçš„æ‰©å±•æœºåˆ¶ï¼Œå®ƒæ˜¯åªé’ˆå¯¹ Kubernetes çš„ç§æœ‰çš„å­˜å‚¨æ‰©å±•ï¼Œç›®å‰å·²ç»å¤„äºå†»ç»“çŠ¶æ€ï¼Œå¯ä»¥æ­£å¸¸ä½¿ç”¨ä½†ä¸å†å‘å±•æ–°åŠŸèƒ½äº†ã€‚</li>
<li>CSI æ˜¯å…¬å¼€çš„æŠ€æœ¯è§„èŒƒï¼Œä»»ä½•å®¹å™¨è¿è¡Œæ—¶ã€å®¹å™¨ç¼–æ’å¼•æ“åªè¦æ„¿æ„æ”¯æŒï¼Œéƒ½å¯ä»¥ä½¿ç”¨ CSI è§„èŒƒå»æ‰©å±•è‡ªå·±çš„å­˜å‚¨èƒ½åŠ›ï¼Œè¿™æ˜¯ç›®å‰ Kubernetes é‡ç‚¹å‘å±•çš„æ‰©å±•æœºåˆ¶ã€‚</li>
</ul>
<h4 id="å®¹å™¨æ’ä»¶ç”Ÿæ€"><a href="#å®¹å™¨æ’ä»¶ç”Ÿæ€" class="headerlink" title="å®¹å™¨æ’ä»¶ç”Ÿæ€"></a>å®¹å™¨æ’ä»¶ç”Ÿæ€</h4><p>ç›®å‰å‡ºç°è¿‡çš„å­˜å‚¨ç³»ç»Ÿå’Œè®¾å¤‡å‡å¯ä»¥åˆ’åˆ†åˆ°å—å­˜å‚¨ã€æ–‡ä»¶å­˜å‚¨å’Œå¯¹è±¡å­˜å‚¨è¿™ä¸‰ç§å­˜å‚¨ç±»å‹ä¹‹ä¸­ï¼Œåˆ’åˆ†ä¾æ®æ˜¯å„ç§å­˜å‚¨æä¾›ä½•ç§å½¢å¼çš„æ¥å£ä¾›å¤–éƒ¨è®¿é—®æ•°æ®ï¼Œä¸åŒçš„å¤–éƒ¨è®¿é—®æ¥å£å°†åè¿‡æ¥å½±å“åˆ°å­˜å‚¨çš„å†…éƒ¨ç»“æ„ã€æ€§èƒ½ä¸åŠŸèƒ½è¡¨ç°ã€‚</p>
<ul>
<li><p><strong>å—å­˜å‚¨</strong>ï¼šå—å­˜å‚¨æ˜¯æ•°æ®å­˜å‚¨çš„æœ€å¤è€å½¢å¼ï¼Œæ•°æ®éƒ½å‚¨å­˜åœ¨å›ºå®šé•¿åº¦çš„ä¸€ä¸ªæˆ–å¤šä¸ªå—ï¼ˆBlockï¼‰ä¸­ï¼Œæƒ³è¦è¯»å†™è®¿é—®æ•°æ®ï¼Œå°±å¿…é¡»ä½¿ç”¨ä¸å­˜å‚¨ç›¸åŒ¹é…çš„åè®®ï¼Œç¡¬ç›˜å°±æ˜¯æœ€ç»å…¸çš„å—å­˜å‚¨è®¾å¤‡ã€‚å—å­˜å‚¨ç”±äºè´´è¿‘åº•å±‚ç¡¬ä»¶ï¼Œæ²¡æœ‰æ–‡ä»¶ã€ç›®å½•ã€è®¿é—®æƒé™ç­‰çš„ç‰µç»Šï¼Œæ‰€ä»¥æ€§èƒ½é€šå¸¸éƒ½æ˜¯æœ€ä¼˜ç§€çš„ï¼Œååé‡é«˜ï¼Œå»¶è¿Ÿä½ã€‚</p>
</li>
<li><p><strong>æ–‡ä»¶å­˜å‚¨</strong>ï¼šæ–‡ä»¶å­˜å‚¨æ˜¯æœ€è´´è¿‘äººç±»ç”¨æˆ·çš„æ•°æ®å­˜å‚¨å½¢å¼ï¼Œæ•°æ®å­˜å‚¨åœ¨é•¿åº¦ä¸å›ºå®šçš„æ–‡ä»¶ä¹‹ä¸­ï¼Œç”¨æˆ·å¯ä»¥é’ˆå¯¹æ–‡ä»¶è¿›è¡Œæ–°å¢ã€å†™å…¥ã€è¿½åŠ ã€ç§»åŠ¨ã€å¤åˆ¶ã€åˆ é™¤ã€é‡å‘½åç­‰å„ç§æ“ä½œï¼ŒPOSIXæ¥å£ï¼ˆPortable Operating System Interfaceï¼ŒPOSIXï¼‰å·²ç»æˆä¸ºäº†äº‹å®æ ‡å‡†ï¼Œè¢«å„ç§å•†ç”¨çš„å­˜å‚¨ç³»ç»Ÿå’Œæ“ä½œç³»ç»Ÿå…±åŒæ”¯æŒã€‚ç»å¤§å¤šæ•°ä¼ ç»Ÿçš„æ–‡ä»¶å­˜å‚¨éƒ½æ˜¯åŸºäºå—å­˜å‚¨ä¹‹ä¸Šå»å®ç°çš„ã€‚äººä»¬æŠŠå®šä¹‰æ–‡ä»¶åˆ†é…è¡¨åº”è¯¥å¦‚ä½•å®ç°ã€å‚¨å­˜å“ªäº›ä¿¡æ¯ã€æä¾›ä»€ä¹ˆåŠŸèƒ½çš„æ ‡å‡†ç§°ä¸ºæ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰ï¼ŒFAT32ã€NTFSã€exFATã€ext2&#x2F;3&#x2F;4ã€XFSã€BTRFS ç­‰éƒ½æ˜¯å¾ˆå¸¸ç”¨çš„æ–‡ä»¶ç³»ç»Ÿã€‚å¯¹äºæ€§èƒ½æœ‰å½±å“</p>
</li>
<li><p><strong>å¯¹è±¡å‚¨å­˜</strong>ï¼šå¯¹è±¡å­˜å‚¨æ˜¯ç›¸å¯¹è¾ƒæ–°çš„æ•°æ®å­˜å‚¨å½¢å¼ï¼Œæ˜¯ä¸€ç§éšç€äº‘æ•°æ®ä¸­å¿ƒçš„å…´èµ·è€Œå‘å±•èµ·æ¥çš„å­˜å‚¨ï¼Œæ˜¯ä»¥éç»“æ„åŒ–æ•°æ®ä¸ºç›®æ ‡çš„å­˜å‚¨æ–¹æ¡ˆã€‚â€œå¯¹è±¡â€å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªå…ƒæ•°æ®åŠä¸å…¶é…å¯¹çš„ä¸€ä¸ªé€»è¾‘æ•°æ®å—çš„ç»„åˆï¼Œå…ƒæ•°æ®æä¾›äº†å¯¹è±¡æ‰€åŒ…å«çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè­¬å¦‚æ•°æ®çš„ç±»å‹ã€å¤§å°ã€æƒé™ã€åˆ›å»ºäººã€åˆ›å»ºæ—¶é—´ï¼Œç­‰ç­‰ï¼Œæ•°æ®å—åˆ™å­˜å‚¨äº†å¯¹è±¡çš„å…·ä½“å†…å®¹ã€‚å¯¹è±¡å­˜å‚¨åŸºæœ¬ä¸Šåªä¼šåœ¨åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿä¹‹ä¸Šå»å®ç°ï¼Œç”±äºå¯¹è±¡å­˜å‚¨å¤©ç”Ÿå°±æœ‰æ˜ç¡®çš„â€œå…ƒæ•°æ®â€æ¦‚å¿µï¼Œä¸å¿…ä¾é æ–‡ä»¶ç³»ç»Ÿæ¥æä¾›æ•°æ®çš„æè¿°ä¿¡æ¯ï¼Œç”±äºå¯¹è±¡çš„å…ƒæ•°æ®ä»…æè¿°å¯¹è±¡æœ¬èº«çš„ä¿¡æ¯ï¼Œä¸å…¶ä»–å¯¹è±¡éƒ½æ²¡æœ‰å…³è”ï¼Œæ¢è€Œè¨€ä¹‹æ¯ä¸ªå¯¹è±¡éƒ½æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œè‡ªç„¶ä¹Ÿå°±ä¸å­˜åœ¨ç›®å½•çš„æ¦‚å¿µï¼Œå¯è§å¯¹è±¡å­˜å‚¨å¤©ç„¶å°±æ˜¯æ‰å¹³åŒ–çš„ã€‚ç”±äºå¯¹è±¡å­˜å‚¨å¤©ç”Ÿçš„åˆ†å¸ƒå¼ç‰¹æ€§ï¼Œä»¥åŠæå…¶ä½å»‰çš„æ‰©å±•æˆæœ¬ï¼Œä½¿å®ƒå¾ˆé€‚åˆäº<a target="_blank" rel="noopener" href="https://icyfenix.cn/architect-perspective/general-architecture/diversion-system/cdn.html">CDN</a>ä¸€ç±»çš„åº”ç”¨ï¼Œæ‹¿æ¥å­˜æ”¾å›¾ç‰‡ã€éŸ³è§†é¢‘ç­‰åª’ä½“å†…å®¹ï¼Œä»¥åŠç½‘é¡µã€è„šæœ¬ç­‰é™æ€èµ„æºã€‚</p>
</li>
</ul>
<h2 id="èµ„æºä¸è°ƒåº¦"><a href="#èµ„æºä¸è°ƒåº¦" class="headerlink" title="èµ„æºä¸è°ƒåº¦"></a>èµ„æºä¸è°ƒåº¦</h2><p><strong>è°ƒåº¦</strong>ï¼šæ˜¯æŒ‡ä¸ºæ–°åˆ›å»ºå‡ºæ¥çš„ Pod å¯»æ‰¾åˆ°ä¸€ä¸ªæœ€æ°å½“çš„å®¿ä¸»æœºèŠ‚ç‚¹æ¥è¿è¡Œå®ƒï¼Œè¿™ä¸ªè¿‡ç¨‹æˆåŠŸä¸å¦ã€ç»“æœæ°å½“ä¸å¦ï¼Œå…³é”®å–å†³äºå®¹å™¨ç¼–æ’ç³»ç»Ÿæ˜¯å¦‚ä½•ç®¡ç†ä¸åˆ†é…é›†ç¾¤èŠ‚ç‚¹çš„èµ„æºçš„ã€‚</p>
<h3 id="èµ„æºæ¨¡å‹"><a href="#èµ„æºæ¨¡å‹" class="headerlink" title="èµ„æºæ¨¡å‹"></a>èµ„æºæ¨¡å‹</h3><p>â€œä¸€åˆ‡çš†ä¸ºèµ„æºâ€çš„è®¾è®¡æ˜¯ Kubernetes èƒ½å¤Ÿé¡ºåˆ©æ–½è¡Œå£°æ˜å¼ API çš„å¿…è¦å‰æï¼ŒKubernetes ä»¥èµ„æºä¸ºè½½ä½“ï¼Œå»ºç«‹äº†ä¸€å¥—åŒæ—¶å›Šæ‹¬äº†æŠ½è±¡å…ƒç´ ï¼ˆå¦‚ç­–ç•¥ã€ä¾èµ–ã€æƒé™ï¼‰å’Œç‰©ç†å…ƒç´ ï¼ˆå¦‚è½¯ä»¶ã€ç¡¬ä»¶ã€ç½‘ç»œï¼‰çš„é¢†åŸŸç‰¹å®šè¯­è¨€ã€‚</p>
<p>ä»ç¼–æ’ç³»ç»Ÿçš„è§’åº¦æ¥çœ‹ï¼ŒNode æ˜¯èµ„æºçš„æä¾›è€…ï¼ŒPod æ˜¯èµ„æºçš„ä½¿ç”¨è€…ï¼Œè°ƒåº¦æ˜¯å°†ä¸¤è€…è¿›è¡Œæ°å½“çš„æ’®åˆã€‚</p>
<p>Node é€šå¸¸èƒ½å¤Ÿæä¾›çš„ä¸‰æ–¹é¢çš„èµ„æºï¼šè®¡ç®—èµ„æºï¼ˆå¦‚å¤„ç†å™¨ã€å›¾å½¢å¤„ç†å™¨ã€å†…å­˜ï¼‰ã€å­˜å‚¨èµ„æºï¼ˆå¦‚ç£ç›˜å®¹é‡ã€ä¸åŒç±»å‹çš„ä»‹è´¨ï¼‰å’Œç½‘ç»œèµ„æºï¼ˆå¦‚å¸¦å®½ã€ç½‘ç»œåœ°å€ï¼‰</p>
<p>å¤„ç†å™¨è¿™æ ·çš„èµ„æºè¢«ç§°ä½œå¯å‹ç¼©èµ„æºï¼ˆCompressible Resourcesï¼‰ï¼Œç‰¹ç‚¹æ˜¯å½“å¯å‹ç¼©èµ„æºä¸è¶³æ—¶ï¼ŒPod åªä¼šå¤„äºâ€œé¥¥é¥¿çŠ¶æ€â€ï¼Œè¿è¡Œå˜æ…¢ï¼Œä½†ä¸ä¼šè¢«ç³»ç»Ÿæ€æ­»ï¼›å†…å­˜è¿™æ ·çš„èµ„æºï¼Œåˆ™è¢«ç§°ä½œä¸å¯å‹ç¼©èµ„æºï¼ˆIncompressible Resourcesï¼‰ï¼Œç‰¹ç‚¹æ˜¯å½“ä¸å¯å‹ç¼©èµ„æºä¸è¶³ï¼Œæˆ–è€…è¶…è¿‡äº†å®¹å™¨è‡ªå·±å£°æ˜çš„æœ€å¤§é™åº¦æ—¶ï¼ŒPod å°±ä¼šå› ä¸ºå†…å­˜æº¢å‡ºï¼ˆOut-Of-Memoryï¼ŒOOMï¼‰è€Œè¢«ç³»ç»Ÿç›´æ¥æ€æ‰ã€‚</p>
<p>Kubernetes åªè´Ÿè´£ä¿è¯ Pod èƒ½å¤Ÿä½¿ç”¨åˆ°â€œä¸€ä¸ªå¤„ç†å™¨â€çš„è®¡ç®—èƒ½åŠ›ï¼Œå¯¹ä¸åŒç¡¬ä»¶ç¯å¢ƒæ„æˆçš„ Kubernetes é›†ç¾¤ï¼Œä¹ƒè‡³åŒä¸€ä¸ªé›†ç¾¤ä¸­ä¸åŒç¡¬ä»¶çš„å®¿ä¸»æœºèŠ‚ç‚¹æ¥è¯´ï¼Œâ€œä¸€ä¸ªå¤„ç†å™¨â€æ‰€ä»£è¡¨çš„çœŸå®ç®—åŠ›å®Œå…¨æœ‰å¯èƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚</p>
<h3 id="æœåŠ¡è´¨é‡ä¸ä¼˜å…ˆçº§"><a href="#æœåŠ¡è´¨é‡ä¸ä¼˜å…ˆçº§" class="headerlink" title="æœåŠ¡è´¨é‡ä¸ä¼˜å…ˆçº§"></a>æœåŠ¡è´¨é‡ä¸ä¼˜å…ˆçº§</h3><p>Pod æ˜¯ç”±ä¸€åˆ°å¤šä¸ªå®¹å™¨æ‰€ç»„æˆï¼Œèµ„æºæœ€ç»ˆæ˜¯äº¤ç”± Pod çš„å„ä¸ªå®¹å™¨å»ä½¿ç”¨ï¼Œæ‰€ä»¥èµ„æºçš„éœ€æ±‚æ˜¯è®¾å®šåœ¨å®¹å™¨ä¸Šçš„ï¼Œå…·ä½“çš„é…ç½®æ˜¯ Pod çš„<code>spec.containers[].resource.limits/requests.cpu/memory</code>å­—æ®µã€‚</p>
<p>èµ„æºéœ€æ±‚çš„é…é¢åˆ™ä¸æ˜¯é’ˆå¯¹å®¹å™¨çš„ï¼Œè€Œæ˜¯é’ˆå¯¹ Pod æ•´ä½“ï¼ŒPod çš„èµ„æºé…é¢æ— éœ€æ‰‹åŠ¨è®¾ç½®ï¼Œå®ƒå°±æ˜¯å®ƒåŒ…å«çš„æ¯ä¸ªå®¹å™¨èµ„æºéœ€æ±‚çš„ç´¯åŠ å€¼ã€‚</p>
<p>æ³¨æ„åˆ° Kubernetes ç»™å‡ºçš„é…ç½®ä¸­æœ‰<code>limits</code>å’Œ<code>requests</code>ä¸¤ä¸ªè®¾ç½®é¡¹ï¼š</p>
<ul>
<li><code>requests</code>æ˜¯ç»™è°ƒåº¦å™¨ç”¨çš„ï¼ŒKubernetes é€‰æ‹©å“ªä¸ªèŠ‚ç‚¹è¿è¡Œ Podï¼Œåªä¼šæ ¹æ®<code>requests</code>çš„å€¼æ¥è¿›è¡Œå†³ç­–</li>
<li><code>limits</code>æ‰æ˜¯ç»™ cgroups ç”¨çš„ï¼ŒKubernetes åœ¨å‘ cgroups çš„ä¼ é€’èµ„æºé…é¢æ—¶ï¼Œä¼šæŒ‰ç…§<code>limits</code>çš„å€¼æ¥è¿›è¡Œè®¾ç½®ã€‚</li>
</ul>
<p>ç»éªŒæ³•åˆ™ï¼šç”¨æˆ·æäº¤å·¥ä½œè´Ÿè½½æ—¶è®¾ç½®çš„èµ„æºé…é¢ï¼Œå¹¶ä¸æ˜¯å®¹å™¨è°ƒåº¦ä¸€å®šå¿…é¡»ä¸¥æ ¼éµå®ˆçš„å€¼ï¼Œå› ä¸ºæ ¹æ®å®é™…ç»éªŒï¼Œå¤§å¤šæ•°çš„å·¥ä½œè´Ÿè½½è¿è¡Œè¿‡ç¨‹ä¸­çœŸæ­£ä½¿ç”¨åˆ°çš„èµ„æºï¼Œå…¶å®éƒ½è¿œå°äºå®ƒæ‰€è¯·æ±‚çš„èµ„æºé…é¢ã€‚</p>
<p><strong>é©±é€æœºåˆ¶</strong>ï¼šè¦è¿›è¡Œé©±é€ï¼Œé¦–å…ˆ Kubernetes å°±å¿…é¡»æ‹¿å‡ºèµ„æºä¸è¶³æ—¶è¯¥å…ˆç‰ºç‰²å“ªäº› Podã€è¯¥ä¿ç•™å“ªäº› Pod çš„æ˜ç¡®å‡†åˆ™ï¼Œç”±æ­¤å°±å½¢æˆäº† Kubernetes çš„<strong>æœåŠ¡è´¨é‡ç­‰çº§</strong>ï¼ˆQuality of Service Levelï¼ŒQoS Levelï¼‰å’Œ<strong>ä¼˜å…ˆçº§</strong>ï¼ˆPriorityï¼‰çš„æ¦‚å¿µ</p>
<p>Kubernetes ç›®å‰æä¾›çš„æœåŠ¡è´¨é‡ç­‰çº§ä¸€å…±åˆ†ä¸ºä¸‰çº§ï¼Œç”±é«˜åˆ°ä½åˆ†åˆ«ä¸º Guaranteedã€Burstable å’Œ BestEffortã€‚</p>
<ul>
<li>Guaranteedï¼šå¦‚æœ Pod ä¸­æ‰€æœ‰çš„å®¹å™¨éƒ½è®¾ç½®äº†<code>limits</code>å’Œ<code>requests</code>ï¼Œä¸”ä¸¤è€…çš„å€¼ç›¸ç­‰ï¼Œé‚£æ­¤ Pod çš„æœåŠ¡è´¨é‡ç­‰çº§ä¾¿ä¸ºæœ€é«˜çš„ Guaranteedï¼›å»ºè®®å°†æ•°æ®åº“åº”ç”¨ç­‰æœ‰çŠ¶æ€çš„åº”ç”¨ï¼Œæˆ–è€…ä¸€äº›é‡è¦çš„è¦ä¿è¯ä¸èƒ½ä¸­æ–­çš„ä¸šåŠ¡çš„æœåŠ¡è´¨é‡ç­‰çº§å®šä¸º Guaranteed</li>
<li>Burstableï¼šå¦‚æœ Pod ä¸­æœ‰éƒ¨åˆ†å®¹å™¨çš„ requests å€¼å°äº<code>limits</code>å€¼ï¼Œæˆ–è€…åªè®¾ç½®äº†<code>requests</code>è€Œæœªè®¾ç½®<code>limits</code>ï¼Œé‚£æ­¤ Pod çš„æœåŠ¡è´¨é‡ç­‰çº§ä¸ºç¬¬äºŒçº§ Burstableï¼›</li>
<li>BestEffortï¼šå¦‚æœä¸å»è®¾ç½®<code>limits</code>å’Œ<code>requests</code>ï¼Œå°±æ˜¯æœ€ä½çš„ BestEffort äº†ã€‚</li>
</ul>
<p>Kubernetes å…è®¸ç³»ç»Ÿç®¡ç†å‘˜è‡ªè¡Œå†³å®š Pod çš„ä¼˜å…ˆçº§ï¼Œè¿™æ˜¯é€šè¿‡ç±»å‹ä¸º PriorityClass çš„èµ„æºæ¥å®ç°çš„ã€‚ä¼˜å…ˆçº§å½±å“æ›´å¤§çš„å¦ä¸€æ–¹é¢æ˜¯æŒ‡ Kubernetes çš„<strong>æŠ¢å æœºåˆ¶</strong>ã€‚å¦‚æœæœ‰ä¸€ä¸ªè¢«è®¾ç½®äº†æ˜ç¡®ä¼˜å…ˆçº§çš„ Pod è°ƒåº¦å¤±è´¥æ— æ³•åˆ›å»ºçš„è¯ï¼ŒKubernetes å°±ä¼šåœ¨ç³»ç»Ÿä¸­å¯»æ‰¾å‡ºä¸€æ‰¹ç‰ºç‰²è€…ï¼ˆVictimsï¼‰ï¼Œå°†å®ƒä»¬æ€æ‰ä»¥ä¾¿ç»™æ›´é«˜ä¼˜å…ˆçº§çš„ Pod è®©å‡ºèµ„æºã€‚å¯»æ‰¾çš„åŸåˆ™æ˜¯æ ¹æ®åœ¨ä¼˜å…ˆçº§ä½äºå¾…è°ƒåº¦ Pod çš„æ‰€æœ‰å·²è°ƒåº¦ Pod é‡Œï¼ŒæŒ‰ç…§ä¼˜å…ˆçº§ä»ä½åˆ°é«˜æ’åºï¼Œä»æœ€ä½çš„æ€èµ·ï¼Œç›´è‡³è…¾å‡ºçš„èµ„æºè¶³ä»¥æ»¡è¶³å¾…è°ƒåº¦ Pod çš„æˆåŠŸè°ƒåº¦ä¸ºæ­¢ï¼Œæˆ–è€…å·²ç»æ‰¾ä¸åˆ°æ›´ä½ä¼˜å…ˆçº§çš„ Pod ä¸ºæ­¢ã€‚</p>
<h4 id="é©±é€æœºåˆ¶"><a href="#é©±é€æœºåˆ¶" class="headerlink" title="é©±é€æœºåˆ¶"></a>é©±é€æœºåˆ¶</h4><p>Pod çš„é©±é€æœºåˆ¶æ˜¯é€šè¿‡ kubelet æ¥æ‰§è¡Œçš„ï¼Œkubelet æ˜¯éƒ¨ç½²åœ¨æ¯ä¸ªèŠ‚ç‚¹çš„é›†ç¾¤ç®¡ç†ç¨‹åºï¼Œç”±äºæœ¬èº«å°±è¿è¡Œåœ¨èŠ‚ç‚¹ä¸­ï¼Œæ‰€ä»¥æœ€å®¹æ˜“æ„ŸçŸ¥åˆ°èŠ‚ç‚¹çš„èµ„æºå®æ—¶è€—ç”¨æƒ…å†µã€‚kubelet ä¸€æ—¦å‘ç°æŸç§ä¸å¯å‹ç¼©èµ„æºå°†è¦è€—å°½ï¼Œå°±ä¼šä¸»åŠ¨ç»ˆæ­¢èŠ‚ç‚¹ä¸Šè¾ƒä½æœåŠ¡è´¨é‡ç­‰çº§çš„ Podï¼Œä»¥ä¿è¯å…¶ä»–æ›´é‡è¦çš„ Pod çš„å®‰å…¨ã€‚è¢«é©±é€çš„ Pod ä¸­æ‰€æœ‰çš„å®¹å™¨éƒ½ä¼šè¢«ç»ˆæ­¢ï¼ŒPod çš„çŠ¶æ€ä¼šè¢«æ›´æ”¹ä¸º Failedã€‚</p>
<p>é©±é€è¡Œä¸ºä¸ç­‰åŒäºåƒåœ¾æ”¶é›†å™¨ã€‚åƒåœ¾æ”¶é›†æ˜¯å®‰å…¨çš„å†…å­˜å›æ”¶è¡Œä¸ºï¼Œè€Œé©±é€ Pod æ˜¯ä¸€ç§æ¯åæ€§çš„æ¸…ç†è¡Œä¸ºï¼Œæœ‰å¯èƒ½ä¼šå¯¼è‡´æœåŠ¡äº§ç”Ÿä¸­æ–­ï¼Œå¿…é¡»æ›´åŠ è°¨æ…ã€‚</p>
<p>é©±é€æœºåˆ¶ä¸­å°±æœ‰äº†<strong>è½¯é©±é€</strong>ï¼ˆSoft Evictionï¼‰ã€<strong>ç¡¬é©±é€</strong>ï¼ˆHard Evictionï¼‰ä»¥åŠ<strong>ä¼˜é›…é€€å‡ºæœŸ</strong>ï¼ˆGrace Periodï¼‰çš„æ¦‚å¿µï¼š</p>
<ul>
<li><strong>è½¯é©±é€</strong>ï¼šé€šå¸¸é…ç½®ä¸€ä¸ªè¾ƒä½çš„è­¦æˆ’çº¿ï¼ˆè­¬å¦‚å¯ç”¨å†…å­˜ä»…å‰© 20%ï¼‰ï¼Œè§¦åŠæ­¤çº¿æ—¶ï¼Œç³»ç»Ÿå°†è¿›å…¥ä¸€æ®µè§‚å¯ŸæœŸã€‚å¦‚æœåªæ˜¯æš‚æ—¶çš„èµ„æºæŠ–åŠ¨ï¼Œåœ¨è§‚å¯ŸæœŸå†…èƒ½å¤Ÿæ¢å¤åˆ°æ­£å¸¸æ°´å¹³çš„è¯ï¼Œé‚£å°±ä¸ä¼šçœŸæ­£å¯åŠ¨é©±é€æ“ä½œã€‚</li>
<li><strong>ç¡¬é©±é€</strong>ï¼šé€šå¸¸é…ç½®ä¸€ä¸ªè¾ƒé«˜çš„ç»ˆæ­¢çº¿ï¼ˆè­¬å¦‚å¯ç”¨å†…å­˜ä»…å‰© 10%ï¼‰ï¼Œä¸€æ—¦è§¦åŠæ­¤çº¢çº¿ï¼Œç«‹å³å¼ºåˆ¶æ€æ‰ Podï¼Œä¸ç†ä¼šä¼˜é›…é€€å‡ºã€‚</li>
</ul>
<h3 id="é»˜è®¤è°ƒåº¦å™¨"><a href="#é»˜è®¤è°ƒåº¦å™¨" class="headerlink" title="é»˜è®¤è°ƒåº¦å™¨"></a>é»˜è®¤è°ƒåº¦å™¨</h3><p>Kubernetes æ˜¯å¦‚ä½•æ’®åˆ Pod ä¸ Node çš„ï¼Œè°ƒåº¦æ˜¯ä¸ºæ–°åˆ›å»ºå‡ºæ¥çš„ Pod å¯»æ‰¾åˆ°ä¸€ä¸ªæœ€æ°å½“çš„å®¿ä¸»æœºèŠ‚ç‚¹å»è¿è¡Œå®ƒã€‚</p>
<ul>
<li>è¿è¡Œï¼šä»é›†ç¾¤æ‰€æœ‰èŠ‚ç‚¹ä¸­æ‰¾å‡ºä¸€æ‰¹å‰©ä½™èµ„æºå¯ä»¥æ»¡è¶³è¯¥ Pod è¿è¡Œçš„èŠ‚ç‚¹ã€‚ä¸ºæ­¤ï¼ŒKubernetes è°ƒåº¦å™¨è®¾è®¡äº†ä¸€ç»„åä¸º Predicate çš„ç­›é€‰ç®—æ³•ã€‚</li>
<li>æ°å½“ï¼šä»ç¬¦åˆè¿è¡Œè¦æ±‚çš„èŠ‚ç‚¹ä¸­æ‰¾å‡ºä¸€ä¸ªæœ€é€‚åˆçš„èŠ‚ç‚¹å®Œæˆè°ƒåº¦ã€‚ä¸ºæ­¤ï¼ŒKubernetes è°ƒåº¦å™¨è®¾è®¡äº†ä¸€ç»„åä¸º Priority çš„è¯„ä»·ç®—æ³•ã€‚</li>
</ul>
<h2 id="æœåŠ¡ç½‘æ ¼"><a href="#æœåŠ¡ç½‘æ ¼" class="headerlink" title="æœåŠ¡ç½‘æ ¼"></a>æœåŠ¡ç½‘æ ¼</h2><blockquote>
<p>æœåŠ¡ç½‘æ ¼æ˜¯ä¸€ç§ç”¨äºç®¡æ§æœåŠ¡é—´é€šä¿¡çš„çš„åŸºç¡€è®¾æ–½ï¼ŒèŒè´£æ˜¯ä¸ºç°ä»£äº‘åŸç”Ÿåº”ç”¨æ”¯æŒç½‘ç»œè¯·æ±‚åœ¨å¤æ‚çš„æ‹“æ‰‘ç¯å¢ƒä¸­å¯é åœ°ä¼ é€’ã€‚åœ¨å®è·µä¸­ï¼ŒæœåŠ¡ç½‘æ ¼é€šå¸¸ä¼šä»¥è½»é‡åŒ–ç½‘ç»œä»£ç†çš„å½¢å¼æ¥ä½“ç°ï¼Œè¿™äº›ä»£ç†ä¸åº”ç”¨ç¨‹åºä»£ç ä¼šéƒ¨ç½²åœ¨ä¸€èµ·ï¼Œå¯¹åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œå®ƒå®Œå…¨ä¸ä¼šæ„ŸçŸ¥åˆ°ä»£ç†çš„å­˜åœ¨ã€‚</p>
</blockquote>
<p><strong>æœåŠ¡ç½‘æ ¼</strong>ï¼šåªæ˜¯ä¸€ç§å¤„ç†ç¨‹åºé—´é€šä¿¡çš„åŸºç¡€è®¾æ–½ï¼Œå…¸å‹çš„å­˜åœ¨å½¢å¼æ˜¯éƒ¨ç½²åœ¨åº”ç”¨æ—è¾¹ï¼Œä¸€å¯¹ä¸€ä¸ºåº”ç”¨æä¾›æœåŠ¡çš„è¾¹è½¦ä»£ç†ï¼ŒåŠç®¡ç†è¿™äº›è¾¹è½¦ä»£ç†çš„æ§åˆ¶ç¨‹åºã€‚</p>
<h3 id="é€æ˜é€šä¿¡çš„æ¶…æ§ƒ"><a href="#é€æ˜é€šä¿¡çš„æ¶…æ§ƒ" class="headerlink" title="é€æ˜é€šä¿¡çš„æ¶…æ§ƒ"></a>é€æ˜é€šä¿¡çš„æ¶…æ§ƒ</h3><h4 id="é€šä¿¡çš„æˆæœ¬-1"><a href="#é€šä¿¡çš„æˆæœ¬-1" class="headerlink" title="é€šä¿¡çš„æˆæœ¬"></a>é€šä¿¡çš„æˆæœ¬</h4><p>å¦‚ä½•åšåˆ°å¯é çš„é€šä¿¡çš„ï¼Œé€šè¿‡ä»¥ä¸‹äº”ä¸ªé˜¶æ®µçš„å˜åŒ–ï¼Œç†è§£åˆ†å¸ƒå¼æœåŠ¡çš„é€šä¿¡æ˜¯å¦‚ä½•é€æ­¥æ¼”åŒ–æˆæœ¬ç« ä¸»è§’æœåŠ¡ç½‘æ ¼</p>
<ol>
<li>å°†é€šä¿¡çš„éåŠŸèƒ½æ€§éœ€æ±‚è§†ä½œä¸šåŠ¡éœ€æ±‚çš„ä¸€éƒ¨åˆ†ï¼Œé€šä¿¡çš„å¯é æ€§ç”±ç¨‹åºå‘˜æ¥ä¿éšœã€‚<br><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250811105702722.png"></li>
<li>å°†ä»£ç ä¸­çš„é€šä¿¡åŠŸèƒ½æŠ½ç¦»é‡æ„æˆå…¬å…±ç»„ä»¶åº“ï¼Œé€šä¿¡çš„å¯é æ€§ç”±ä¸“ä¸šçš„å¹³å°ç¨‹åºå‘˜æ¥ä¿éšœã€‚<br><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250811105750990.png"></li>
<li>å°†è´Ÿè´£é€šä¿¡çš„å…¬å…±ç»„ä»¶åº“åˆ†ç¦»åˆ°è¿›ç¨‹ä¹‹å¤–ï¼Œç¨‹åºé—´é€šè¿‡ç½‘ç»œä»£ç†æ¥äº¤äº’ï¼Œé€šä¿¡çš„å¯é æ€§ç”±ä¸“é—¨çš„ç½‘ç»œä»£ç†æä¾›å•†æ¥ä¿éšœã€‚<br><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250811105826841.png"></li>
<li>å°†ç½‘ç»œä»£ç†ä»¥è¾¹è½¦çš„å½¢å¼æ³¨å…¥åˆ°åº”ç”¨å®¹å™¨ï¼Œè‡ªåŠ¨åŠ«æŒåº”ç”¨çš„ç½‘ç»œæµé‡ï¼Œé€šä¿¡çš„å¯é æ€§ç”±ä¸“é—¨çš„é€šä¿¡åŸºç¡€è®¾æ–½æ¥ä¿éšœã€‚<br><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250811105955427.png"></li>
<li>å°†è¾¹è½¦ä»£ç†ç»Ÿä¸€ç®¡æ§èµ·æ¥å®ç°å®‰å…¨ã€å¯æ§ã€å¯è§‚æµ‹çš„é€šä¿¡ï¼Œå°†æ•°æ®å¹³é¢ä¸æ§åˆ¶å¹³é¢åˆ†ç¦»å¼€æ¥ï¼Œå®ç°é€šç”¨ã€é€æ˜çš„é€šä¿¡ï¼Œè¿™é¡¹å·¥ä½œå°±ç”±ä¸“é—¨çš„æœåŠ¡ç½‘æ ¼æ¡†æ¶æ¥ä¿éšœã€‚<br><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250811110038854.png"></li>
</ol>
<h4 id="æ•°æ®å¹³é¢"><a href="#æ•°æ®å¹³é¢" class="headerlink" title="æ•°æ®å¹³é¢"></a>æ•°æ®å¹³é¢</h4><p>æ•°æ®å¹³é¢ç”±ä¸€ç³»åˆ—è¾¹è½¦ä»£ç†æ‰€æ„æˆï¼Œæ ¸å¿ƒèŒè´£æ˜¯è½¬å‘åº”ç”¨çš„å…¥ç«™ï¼ˆInboundï¼‰å’Œå‡ºç«™ï¼ˆOutboundï¼‰æ•°æ®åŒ…ï¼Œå› æ­¤æ•°æ®å¹³é¢ä¹Ÿæœ‰ä¸ªåˆ«åå«è½¬å‘å¹³é¢ï¼ˆForwarding Planeï¼‰ã€‚åŒæ—¶ï¼Œä¸ºäº†åœ¨ä¸å¯é çš„ç‰©ç†ç½‘ç»œä¸­ä¿è¯ç¨‹åºé—´é€šä¿¡æœ€å¤§çš„å¯é æ€§ï¼Œæ•°æ®å¹³é¢å¿…é¡»æ ¹æ®æ§åˆ¶å¹³é¢ä¸‹å‘ç­–ç•¥çš„æŒ‡å¯¼ï¼Œåœ¨åº”ç”¨æ— æ„ŸçŸ¥çš„æƒ…å†µä¸‹è‡ªåŠ¨å®ŒæˆæœåŠ¡è·¯ç”±ã€å¥åº·æ£€æŸ¥ã€è´Ÿè½½å‡è¡¡ã€è®¤è¯é‰´æƒã€äº§ç”Ÿç›‘æ§æ•°æ®ç­‰ä¸€ç³»åˆ—å·¥ä½œã€‚ä¸ºäº†è¾¾æˆä¸Šè¿°çš„å·¥ä½œç›®æ ‡ï¼Œè‡³å°‘éœ€è¦å¦¥å–„è§£å†³ä»¥ä¸‹ä¸‰ä¸ªå…³é”®é—®é¢˜ï¼š</p>
<ul>
<li>ä»£ç†æ³¨å…¥ï¼šè¾¹è½¦ä»£ç†æ˜¯å¦‚ä½•æ³¨å…¥åˆ°åº”ç”¨ç¨‹åºä¸­çš„ï¼Ÿ</li>
<li>æµé‡åŠ«æŒï¼šè¾¹è½¦ä»£ç†æ˜¯å¦‚ä½•åŠ«æŒåº”ç”¨ç¨‹åºçš„é€šä¿¡æµé‡çš„ï¼Ÿ</li>
<li>å¯é é€šä¿¡ï¼šè¾¹è½¦ä»£ç†æ˜¯å¦‚ä½•ä¿è¯åº”ç”¨ç¨‹åºçš„é€šä¿¡å¯é æ€§çš„ï¼Ÿ</li>
</ul>
<h4 id="æ§åˆ¶å¹³é¢"><a href="#æ§åˆ¶å¹³é¢" class="headerlink" title="æ§åˆ¶å¹³é¢"></a>æ§åˆ¶å¹³é¢</h4><p>æ§åˆ¶å¹³é¢çš„ç‰¹ç‚¹æ˜¯ä¸ç›´æ¥å‚ä¸ç¨‹åºé—´é€šä¿¡ï¼Œè€Œåªä¼šä¸æ•°æ®å¹³é¢ä¸­çš„ä»£ç†é€šä¿¡ï¼Œåœ¨ç¨‹åºä¸å¯è§çš„èƒŒåï¼Œé»˜é»˜åœ°å®Œæˆä¸‹å‘é…ç½®å’Œç­–ç•¥ï¼ŒæŒ‡å¯¼æ•°æ®å¹³é¢å·¥ä½œã€‚</p>
<h3 id="æœåŠ¡ç½‘æ ¼ä¸ç”Ÿæ€"><a href="#æœåŠ¡ç½‘æ ¼ä¸ç”Ÿæ€" class="headerlink" title="æœåŠ¡ç½‘æ ¼ä¸ç”Ÿæ€"></a>æœåŠ¡ç½‘æ ¼ä¸ç”Ÿæ€</h3><p>æœåŠ¡ç½‘æ ¼å®è´¨ä¸Šæ˜¯æ•°æ®å¹³é¢äº§å“ä¸æ§åˆ¶å¹³é¢äº§å“çš„é›†åˆï¼Œæ‰€ä»¥åœ¨è§„èŒƒåˆ¶è®¢æ–¹é¢ï¼Œå¾ˆè‡ªç„¶åœ°ä¹Ÿåˆ†æˆäº†ä¸¤ç±»ï¼šSMI è§„èŒƒæä¾›äº†å¤–éƒ¨ç¯å¢ƒï¼ˆå®é™…ä¸Šå°±æ˜¯ Kubernetesï¼‰ä¸æ§åˆ¶å¹³é¢äº¤äº’çš„æ ‡å‡†ï¼Œä½¿å¾— Kubernetes åŠåœ¨å…¶ä¹‹ä¸Šçš„åº”ç”¨èƒ½å¤Ÿæ— ç¼åœ°åˆ‡æ¢å„ç§æœåŠ¡ç½‘æ ¼äº§å“ã€‚UDPA è§„èŒƒåˆ™æä¾›äº†æ§åˆ¶å¹³é¢ä¸æ•°æ®å¹³é¢äº¤äº’çš„æ ‡å‡†ï¼Œä½¿å¾—æœåŠ¡ç½‘æ ¼äº§å“èƒ½å¤Ÿçµæ´»åœ°æ­é…ä¸åŒçš„è¾¹è½¦ä»£ç†ï¼Œé’ˆå¯¹ä¸åŒåœºæ™¯çš„éœ€æ±‚ï¼Œå‘æŒ¥å„æ¬¾è¾¹è½¦ä»£ç†çš„åŠŸèƒ½æˆ–è€…æ€§èƒ½ä¼˜åŠ¿ã€‚</p>
<p><img src="/images/%E5%87%A4%E5%87%B0%E6%9E%B6%E6%9E%84/file-20250811111217042.png"></p>
<h4 id="æœåŠ¡ç½‘æ ¼æ¥å£"><a href="#æœåŠ¡ç½‘æ ¼æ¥å£" class="headerlink" title="æœåŠ¡ç½‘æ ¼æ¥å£"></a>æœåŠ¡ç½‘æ ¼æ¥å£</h4><p>Â SMI è§„èŒƒåŒ…æ‹¬å››æ–¹é¢çš„ API æ„æˆï¼Œåˆ†åˆ«æ˜¯ï¼š<br>Â - <strong>æµé‡è§„èŒƒ</strong>ï¼ˆTraffic Specsï¼‰ï¼šç›®æ ‡æ˜¯å®šä¹‰æµé‡çš„è¡¨ç¤ºæ–¹å¼ï¼Œè­¬å¦‚ TCP æµé‡ã€HTTP&#x2F;1 æµé‡ã€HTTP&#x2F;2 æµé‡ã€gRPC æµé‡ã€WebSocket æµé‡ç­‰è¯¥å¦‚ä½•åœ¨é…ç½®ä¸­æŠ½è±¡åŠä½¿ç”¨ã€‚<br>Â - <strong>æµé‡æ‹†åˆ†</strong>ï¼ˆTraffic Splitï¼‰ï¼šç›®æ ‡æ˜¯å®šä¹‰ä¸åŒç‰ˆæœ¬æœåŠ¡ä¹‹é—´çš„æµé‡æ¯”ä¾‹ï¼Œæä¾›æµé‡æ²»ç†çš„èƒ½åŠ›ï¼Œè­¬å¦‚é™æµã€é™çº§ã€å®¹é”™ï¼Œç­‰ç­‰ï¼Œä»¥æ»¡è¶³ç°åº¦å‘å¸ƒã€A&#x2F;B æµ‹è¯•ç­‰åœºæ™¯ã€‚<br>Â - <strong>æµé‡åº¦é‡</strong>ï¼ˆTraffic Metricsï¼‰ï¼šç›®æ ‡æ˜¯ä¸ºèµ„æºæä¾›é€šç”¨é›†æˆç‚¹ï¼Œåº¦é‡å·¥å…·å¯ä»¥é€šè¿‡è®¿é—®è¿™äº›é›†æˆç‚¹æ¥æŠ“å–æŒ‡æ ‡ã€‚<br>Â - <strong>æµé‡è®¿é—®æ§åˆ¶</strong>ï¼ˆTraffic Access Controlï¼‰ï¼šç›®æ ‡æ˜¯æ ¹æ®å®¢æˆ·ç«¯çš„èº«ä»½é…ç½®ï¼Œå¯¹ç‰¹å®šçš„æµé‡è®¿é—®ç‰¹å®šçš„æœåŠ¡æä¾›ç®€å•çš„è®¿é—®æ§åˆ¶ã€‚</p>
<h4 id="é€šç”¨æ•°æ®å¹³é¢-API"><a href="#é€šç”¨æ•°æ®å¹³é¢-API" class="headerlink" title="é€šç”¨æ•°æ®å¹³é¢ API"></a>é€šç”¨æ•°æ®å¹³é¢ API</h4><p>UDAP çš„ä¸»è¦å†…å®¹ä¼šåˆ†ä¸ºä¼ è¾“åè®®ï¼ˆUDPA-TPï¼ŒTransPortï¼‰å’Œæ•°æ®æ¨¡å‹ï¼ˆUDPA-DMï¼ŒData Modelï¼‰ä¸¤éƒ¨åˆ†ï¼Œè¿™ä¸¤éƒ¨åˆ†æ˜¯ç‹¬ç«‹è®¾è®¡çš„ï¼Œä»¥åå®Œå…¨æœ‰å¯èƒ½ä¼šå‡ºç°ä¸åŒçš„æ•°æ®æ¨¡å‹å…±ç”¨åŒä¸€å¥—ä¼ è¾“åè®®çš„å¯èƒ½æ€§</p>
<h1 id="å‘å¾®æœåŠ¡è¿ˆè¿›"><a href="#å‘å¾®æœåŠ¡è¿ˆè¿›" class="headerlink" title="å‘å¾®æœåŠ¡è¿ˆè¿›"></a>å‘å¾®æœåŠ¡è¿ˆè¿›</h1><p>â€œ<strong>è½¯ä»¶ç ”å‘ä¸­ä»»ä½•ä¸€é¡¹æŠ€æœ¯ã€æ–¹æ³•ã€æ¶æ„éƒ½ä¸å¯èƒ½æ˜¯é“¶å¼¹</strong>â€</p>
<h2 id="ç›®çš„ï¼šå¾®æœåŠ¡çš„é©±åŠ¨åŠ›"><a href="#ç›®çš„ï¼šå¾®æœåŠ¡çš„é©±åŠ¨åŠ›" class="headerlink" title="ç›®çš„ï¼šå¾®æœåŠ¡çš„é©±åŠ¨åŠ›"></a>ç›®çš„ï¼šå¾®æœåŠ¡çš„é©±åŠ¨åŠ›</h2><p>è½¯ä»¶ç³»ç»Ÿé€‰æ‹©å¾®æœåŠ¡æ¶æ„ï¼Œé€šå¸¸æ¯”è¾ƒå¸¸è§çš„ã€åˆç†çš„é©±åŠ¨åŠ›æ¥è‡ªç»„ç»‡å¤–éƒ¨ã€å†…éƒ¨ä¸¤æ–¹é¢ï¼Œç¬”è€…å…ˆåˆ—ä¸¾ä¸€äº›å¤–éƒ¨å› ç´ ï¼š</p>
<ul>
<li>å½“æ„è¯†åˆ°æ²¡æœ‰ä»€ä¹ˆæŠ€æœ¯èƒ½å¤ŸåŒ…æ‰“å¤©ä¸‹ã€‚</li>
<li>å½“ä¸ªäººèƒ½åŠ›å› ç´ æˆä¸ºç³»ç»Ÿå‘å±•çš„æ˜æ˜¾åˆ¶çº¦ã€‚</li>
<li>å½“é‡åˆ°æ¥è‡ªå¤–éƒ¨å•†ä¸šå±‚é¢å¯¹å†…éƒ¨æŠ€æœ¯å±‚é¢æå‡ºçš„è¦æ±‚ã€‚</li>
</ul>
<p>åœ¨ç³»ç»Ÿå’Œç ”å‘å›¢é˜Ÿå†…éƒ¨ï¼Œä¹Ÿä¼šæœ‰ä¸€äº›å› ç´ ä¿ƒä½¿å…¶å‘å¾®æœåŠ¡é æ‹¢ï¼š</p>
<ul>
<li>å˜åŒ–å‘å±•ç‰¹åˆ«å¿«çš„åˆ›æ–°ä¸šåŠ¡ç³»ç»Ÿå¾€å¾€ä¼šè‡ªä¸»åœ°å‘å¾®æœåŠ¡æ¶æ„é è¿‘ã€‚</li>
<li>å¤§è§„æ¨¡çš„ã€ä¸šåŠ¡å¤æ‚çš„ã€å†å²åŒ…è¢±æ²‰é‡çš„ç³»ç»Ÿä¹Ÿå¯èƒ½ä¸»åŠ¨å‘å¾®æœåŠ¡æ¶æ„é è¿‘ã€‚</li>
</ul>
<p>å¾®æœåŠ¡æœ€ä¸»è¦çš„ç›®çš„æ˜¯å¯¹ç³»ç»Ÿè¿›è¡Œæœ‰æ•ˆçš„æ‹†åˆ†ï¼Œå®ç°ç‰©ç†å±‚é¢çš„éš”ç¦»ï¼Œå¾®æœåŠ¡çš„æ ¸å¿ƒä»·å€¼å°±æ˜¯æ‹†åˆ†ä¹‹åçš„ç³»ç»Ÿèƒ½å¤Ÿè®©å±€éƒ¨çš„å•ä¸ªæœåŠ¡<strong>æœ‰å¯èƒ½</strong>å®ç°æ•æ·åœ°å¸è½½ã€éƒ¨ç½²ã€å¼€å‘ã€å‡çº§ï¼Œå±€éƒ¨çš„æŒç»­æ›´è¿­ï¼Œæ˜¯ç³»ç»Ÿæ•´ä½“å…·å¤‡ Phoenix ç‰¹æ€§çš„å¿…è¦æ¡ä»¶ã€‚</p>
<h2 id="å‰æï¼šå¾®æœåŠ¡éœ€è¦çš„æ¡ä»¶"><a href="#å‰æï¼šå¾®æœåŠ¡éœ€è¦çš„æ¡ä»¶" class="headerlink" title="å‰æï¼šå¾®æœåŠ¡éœ€è¦çš„æ¡ä»¶"></a>å‰æï¼šå¾®æœåŠ¡éœ€è¦çš„æ¡ä»¶</h2><ul>
<li>å†³ç­–è€…ä¸æ‰§è¡Œè€…éƒ½èƒ½æ„è¯†åˆ°åº·å¨å®šå¾‹åœ¨è½¯ä»¶è®¾è®¡ä¸­çš„å…³é”®ä½œç”¨ã€‚</li>
<li>ç»„ç»‡ä¸­å…·å¤‡ä¸€äº›å¯¹å¾®æœåŠ¡æœ‰å……åˆ†ç†è§£ã€æœ‰ä¸€å®šå®è·µç»éªŒçš„æŠ€æœ¯ä¸“å®¶ã€‚</li>
<li>ç³»ç»Ÿåº”å…·æœ‰ä»¥è‡ªæ²»ä¸ºç›®æ ‡çš„è‡ªåŠ¨åŒ–ä¸ç›‘æ§åº¦é‡èƒ½åŠ›ã€‚</li>
<li>å¤æ‚æ€§å·²ç»æˆä¸ºåˆ¶çº¦ç”Ÿäº§åŠ›çš„ä¸»è¦çŸ›ç›¾ã€‚</li>
</ul>
<h2 id="è¾¹ç•Œï¼šå¾®æœåŠ¡çš„ç²’åº¦"><a href="#è¾¹ç•Œï¼šå¾®æœåŠ¡çš„ç²’åº¦" class="headerlink" title="è¾¹ç•Œï¼šå¾®æœåŠ¡çš„ç²’åº¦"></a>è¾¹ç•Œï¼šå¾®æœåŠ¡çš„ç²’åº¦</h2><p>å¾®æœåŠ¡è¾¹ç•Œå…·ä½“å®è·µçš„æ–¹æ³•è®ºï¼Œå³é¢†åŸŸé©±åŠ¨è®¾è®¡ã€‚</p>
<p><strong>å¾®æœåŠ¡ç²’åº¦çš„ä¸‹ç•Œæ˜¯å®ƒè‡³å°‘åº”æ»¡è¶³ç‹¬ç«‹â€”â€”èƒ½å¤Ÿç‹¬ç«‹å‘å¸ƒã€ç‹¬ç«‹éƒ¨ç½²ã€ç‹¬ç«‹è¿è¡Œä¸ç‹¬ç«‹æµ‹è¯•ï¼Œå†…èšâ€”â€”å¼ºç›¸å…³çš„åŠŸèƒ½ä¸æ•°æ®åœ¨åŒä¸€ä¸ªæœåŠ¡ä¸­å¤„ç†ï¼Œå®Œå¤‡â€”â€”ä¸€ä¸ªæœåŠ¡åŒ…å«è‡³å°‘ä¸€é¡¹ä¸šåŠ¡å®ä½“ä¸å¯¹åº”çš„å®Œæ•´æ“ä½œã€‚</strong></p>
<p><strong>å¾®æœåŠ¡ç²’åº¦çš„ä¸Šç•Œæ˜¯ä¸€ä¸ª 2 Pizza Team èƒ½å¤Ÿåœ¨ä¸€ä¸ªç ”å‘å‘¨æœŸå†…å®Œæˆçš„å…¨éƒ¨éœ€æ±‚èŒƒå›´ã€‚</strong></p>
<h2 id="æ²»ç†ï¼šç†è§£ç³»ç»Ÿå¤æ‚æ€§"><a href="#æ²»ç†ï¼šç†è§£ç³»ç»Ÿå¤æ‚æ€§" class="headerlink" title="æ²»ç†ï¼šç†è§£ç³»ç»Ÿå¤æ‚æ€§"></a>æ²»ç†ï¼šç†è§£ç³»ç»Ÿå¤æ‚æ€§</h2><p><strong>è½¯ä»¶è§„æ¨¡å°æ—¶å¾®æœåŠ¡çš„å¤æ‚åº¦é«˜äºå•ä½“ç³»ç»Ÿï¼Œè§„æ¨¡å¤§æ—¶åˆ™ç›¸å</strong>ã€‚</p>
<p>æ¼”è¿›å¼è®¾è®¡æ˜¯ ThoughtWorks æå‡ºçš„æ¶æ„æ–¹æ³•ï¼Œæ— è®ºæ˜¯ä»£é™…çš„æ¼”è¿›è¿˜æ˜¯æ¸è¿›çš„æ¼”è¿›ï¼Œéƒ½å¸¦æœ‰ä¸å°‘äº‰è®®ï¼Œå®ƒä¸ä»…æ˜¯å»ºé€ çš„å­¦é—®ï¼Œä¹Ÿæ˜¯ç ´åçš„å­¦é—®ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/08/01/%E6%8A%80%E6%9C%AF%E4%B9%A6%E7%B1%8D/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%97%A5%E7%9F%A5%E5%BD%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/icon.JPG">
      <meta itemprop="name" content="Uncle Antonio">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Uncle Antonio">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/08/01/%E6%8A%80%E6%9C%AF%E4%B9%A6%E7%B1%8D/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%97%A5%E7%9F%A5%E5%BD%95/" class="post-title-link" itemprop="url">å¤§æ•°æ®æ—¥çŸ¥å½•</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-08-01 12:00:00" itemprop="dateCreated datePublished" datetime="2025-08-01T12:00:00+08:00">2025-08-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-11-22 22:05:25" itemprop="dateModified" datetime="2025-11-22T22:05:25+08:00">2025-11-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%8A%80%E6%9C%AF%E4%B9%A6%E7%B1%8D/" itemprop="url" rel="index"><span itemprop="name">æŠ€æœ¯ä¹¦ç±</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ä½œè€…ï¼š å¼ ä¿Šæ—<br>é˜…è¯»æ—¥æœŸï¼š20250904â€”â€”20250930<br>å­¦ä¹ æ–¹å¼ï¼šä¹¦æœ¬é˜…è¯»</p>
<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ¬ä¹¦ä¸“æ³¨äºä¸å¤§æ•°æ®å¤„ç†æœ‰å…³çš„æ¶æ„ä¸ç®—æ³•ã€‚</p>
<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><p>ç¬¬0ç« â€”â€”å½“è°ˆè®ºå¤§æ•°æ®æ—¶æˆ‘ä»¬åœ¨è°ˆä»€ä¹ˆ<br>ç¬¬1ç« â€”â€”æ•°æ®åˆ†ç‰‡ä¸è·¯ç”±<br>ç¬¬2ç« â€”â€”æ•°æ®å¤åˆ¶ä¸ä¸€è‡´æ€§<br>ç¬¬3ç« â€”â€”å¤§æ•°æ®å¸¸ç”¨çš„ç®—æ³•ä¸æ•°æ®ç»“æ„<br>ç¬¬4ç« â€”â€”é›†ç¾¤èµ„æºç®¡ç†ä¸è°ƒåº¦<br>ç¬¬5ç« â€”â€”åˆ†å¸ƒå¼åè°ƒç³»ç»Ÿ<br>ç¬¬6ç« â€”â€”åˆ†å¸ƒå¼é€šä¿¡<br>ç¬¬7ç« â€”â€”æ•°æ®é€šé“<br>ç¬¬8ç« â€”â€”åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ<br>ç¬¬9ç« â€”â€”å†…å­˜KVæ•°æ®åº“<br>ç¬¬10ç« â€”â€”åˆ—å¼æ•°æ®åº“<br>ç¬¬11ç« â€”â€”å¤§è§„æ¨¡æ‰¹å¤„ç†ç³»ç»Ÿ<br>ç¬¬12ç« â€”â€”æµå¼è®¡ç®—<br>ç¬¬13ç« â€”â€”äº¤äº’å¼æ•°æ®åˆ†æ<br>ç¬¬14ç« â€”â€”å›¾æ•°æ®åº“ï¼šæ¶æ„ä¸ç®—æ³•<br>ç¬¬15ç« â€”â€”æœºå™¨å­¦ä¹ ï¼šèŒƒå‹ä¸æ¶æ„<br>ç¬¬16ç« â€”â€”æœºå™¨å­¦ä¹ ï¼šåˆ†å¸ƒå¼ç®—æ³•<br>ç¬¬17ç« â€”â€”å¢é‡è®¡ç®—</p>
<h1 id="ç¬¬0ç« â€”â€”å½“è°ˆè®ºå¤§æ•°æ®æ—¶æˆ‘ä»¬åœ¨è°ˆä»€ä¹ˆ"><a href="#ç¬¬0ç« â€”â€”å½“è°ˆè®ºå¤§æ•°æ®æ—¶æˆ‘ä»¬åœ¨è°ˆä»€ä¹ˆ" class="headerlink" title="ç¬¬0ç« â€”â€”å½“è°ˆè®ºå¤§æ•°æ®æ—¶æˆ‘ä»¬åœ¨è°ˆä»€ä¹ˆ"></a>ç¬¬0ç« â€”â€”å½“è°ˆè®ºå¤§æ•°æ®æ—¶æˆ‘ä»¬åœ¨è°ˆä»€ä¹ˆ</h1><h2 id="å¤§æ•°æ®æ˜¯ä»€ä¹ˆ"><a href="#å¤§æ•°æ®æ˜¯ä»€ä¹ˆ" class="headerlink" title="å¤§æ•°æ®æ˜¯ä»€ä¹ˆ"></a>å¤§æ•°æ®æ˜¯ä»€ä¹ˆ</h2><p>å¤šå¤§æ‰ç®—å¤§ï¼šæ•°æ®é‡çš„è¡¡é‡å•ä½ï¼Œä»å°åˆ°å¤§ä¾æ¬¡ä¸ºKBã€MBã€GBã€TBã€PBã€EPå’ŒZB</p>
<p>ç”µå­æ•°æ®æ­£åœ¨æš´æ¶¨ï¼š2010å¹´å…¨ä¸–ç•Œä¿¡æ¯æ€»é‡æ˜¯1ZBï¼Œæœ€è¿‘3å¹´äººç±»äº§ç”Ÿçš„ä¿¡æ¯é‡å·²ç»è¶…è¿‡äº†ä¹‹å‰å†å²ä¸Šäººç±»äº§ç”Ÿçš„æ‰€æœ‰ä¿¡æ¯ä¹‹å’Œã€‚</p>
<p>å¤§æ•°æ®çš„å®šä¹‰ï¼š</p>
<ul>
<li>ç»´åŸºç™¾ç§‘ï¼šæ•°æ®é‡å¤ªå¤§ï¼Œæ‰‹å¤´çš„å·¥å…·å·²ç»ä¸ä¾¿äºç®¡ç†</li>
<li>IBMï¼š3Vï¼ˆVolumeã€Velocityã€Varietyï¼‰+1Vï¼ˆValueï¼‰</li>
<li>IDCï¼šä»£è¡¨æ–°ä¸€ä»£çš„æŠ€æœ¯è„šéª¨ï¼Œèƒ½å¤Ÿé«˜é€Ÿè·å–æ•°æ®è¿›è¡Œåˆ†ææŒ–æ˜ï¼ŒæŠ½å–ä»·å€¼ä¿¡æ¯</li>
<li>Googleï¼šæµ·é‡æ•°æ®å¯å¹¿æ³›è·å¾—ï¼Œæ‰€ç¨€ç¼ºçš„æ˜¯å¦‚ä½•ä»ä¸­æŒ–æ˜å‡ºæ™ºæ…§å’Œè§‚ç‚¹ã€‚</li>
</ul>
<h2 id="å¤§æ•°æ®ä¹‹ç¿¼ï¼šæŠ€æœ¯èŒƒå‹è½¬æ¢"><a href="#å¤§æ•°æ®ä¹‹ç¿¼ï¼šæŠ€æœ¯èŒƒå‹è½¬æ¢" class="headerlink" title="å¤§æ•°æ®ä¹‹ç¿¼ï¼šæŠ€æœ¯èŒƒå‹è½¬æ¢"></a>å¤§æ•°æ®ä¹‹ç¿¼ï¼šæŠ€æœ¯èŒƒå‹è½¬æ¢</h2><p>å…³ç³»å‹æ•°æ®åº“â€”â€”&gt;å¹¶è¡Œæ•°æ®åº“â€”â€”&gt;NoSqlæ•°æ®åº“</p>
<p>æ•´ä½“æ¶æ„ï¼š<br>â€”â€”&gt;æ•°æ®æº<br>æ¥æºå„å¼‚ï¼Œå½¢å¼ä¸è§„æ•´<br>â€”â€”&gt;æ•°æ®ç®¡ç†<br>NoSQLä¸è¿½æ±‚åº”ç”¨åœºæ™¯çš„ç»Ÿä¸€ï¼Œè€Œä¸”ä¸åŒç±»å‹ä¸åŒNoSQLåº“å­˜å‚¨ç®¡ç†<br>â€”â€”&gt;æ•°æ®åˆ†æ<br>æŒ–æ˜åˆ†æï¼Œåˆ©ç”¨æ•°æ®æŒ–æ˜ã€æœºå™¨å­¦ä¹ ã€æ—¶åºåˆ†æ<br>â€”â€”&gt;æ•°æ®è·å–<br>æ•°æ®å¯è§†åŒ–å±•ç°</p>
<p>å¤§æ•°æ®æŠ€æœ¯å¤„ç†æ¶æ„å›¾<br>![[Pasted image 20250904182932.jpg]]</p>
<h2 id="å¤§æ•°æ®å•†ä¸šç‚¼é‡‘æœ¯"><a href="#å¤§æ•°æ®å•†ä¸šç‚¼é‡‘æœ¯" class="headerlink" title="å¤§æ•°æ®å•†ä¸šç‚¼é‡‘æœ¯"></a>å¤§æ•°æ®å•†ä¸šç‚¼é‡‘æœ¯</h2><p>äº’è”ç½‘ã€ä¼ ç»ŸITã€é‡‘èã€é›¶å”®è¡Œä¸šéƒ½åœ¨åˆ©äºå¤§æ•°æ®æå‡ä¼ä¸šæ”¶ç›Š</p>
<h2 id="å¤§æ•°æ®åœ¨è·¯ä¸Š"><a href="#å¤§æ•°æ®åœ¨è·¯ä¸Š" class="headerlink" title="å¤§æ•°æ®åœ¨è·¯ä¸Š"></a>å¤§æ•°æ®åœ¨è·¯ä¸Š</h2><p>æ¦‚å¿µæœ€æ—©ç”±éº¦è‚¯é”¡æå‡ºï¼Œå·¨å‹å…¬å¸æä¾›åŸºç¡€æ¶æ„å¹³å°ï¼Œä¸­å°å‹åˆ›ä¸šå…¬å¸å®Œå–„åˆ†å¸ƒå¼è®¡ç®—ç”Ÿæ€ç³»ç»Ÿï¼Œæˆ–è€…æä¾›å¤§æ•°æ®æœåŠ¡ç­‰ã€‚</p>
<h1 id="ç¬¬1ç« â€”â€”æ•°æ®åˆ†ç‰‡ä¸è·¯ç”±"><a href="#ç¬¬1ç« â€”â€”æ•°æ®åˆ†ç‰‡ä¸è·¯ç”±" class="headerlink" title="ç¬¬1ç« â€”â€”æ•°æ®åˆ†ç‰‡ä¸è·¯ç”±"></a>ç¬¬1ç« â€”â€”æ•°æ®åˆ†ç‰‡ä¸è·¯ç”±</h1><p>æ•°æ®è§„æ¨¡è¶Šæ¥è¶Šå¤§ï¼š</p>
<ul>
<li>å¹¶è¡Œæ•°æ®åº“é€šè¿‡çºµå‘æ‰©å±•è§£å†³é—®é¢˜ï¼ˆScale Upï¼‰ï¼Œæ‰©å±•æœºå™¨</li>
<li>å¤§æ•°æ®ç³»ç»Ÿé€šè¿‡æ¨ªå‘æ‰©å±•è§£å†³é—®é¢˜ï¼ˆScale Outï¼‰ï¼Œå¢åŠ æœºå™¨</li>
</ul>
<p>å¢åŠ æœºå™¨å°±å¸¦æ¥äº†<strong>æ•°æ®åˆ†ç‰‡</strong>ï¼Œåˆ†ç‰‡åå°±å¿…é¡»æ‰¾åˆ°æ•°æ®ï¼Œå³<strong>æ•°æ®è·¯ç”±</strong>ã€‚</p>
<ul>
<li>æ•°æ®åˆ†ç‰‡ï¼šå®ç°æ°´å¹³æ‰©å±•</li>
<li>æ•°æ®å¤åˆ¶ï¼šä¿è¯æ•°æ®é«˜å¯ç”¨ï¼Œå› ä¸ºæœåŠ¡å™¨ç»å¸¸å­˜åœ¨æ•…éšœï¼Œæ‰€ä»¥éœ€è¦å­˜å‚¨å¤šä»½å‰¯æœ¬</li>
</ul>
<p>æ•°æ®å¤åˆ¶é¢ä¸´çš„é—®é¢˜ï¼šå¹¶å‘å¯¹æ•°æ®æ›´æ–°æ—¶ï¼Œå¦‚ä½•ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚</p>
<p>å¸¸è§çš„æ•°æ®åˆ†ç‰‡æ–¹æ³•åŒ…æ‹¬å“ˆå¸Œåˆ†ç‰‡ä¸èŒƒå›´åˆ†ç‰‡ï¼Œå…ˆè®²é€šç”¨æ¨¡å‹å†å°†å…·ä½“å®ç°ã€‚</p>
<h2 id="æŠ½è±¡æ¨¡å‹"><a href="#æŠ½è±¡æ¨¡å‹" class="headerlink" title="æŠ½è±¡æ¨¡å‹"></a>æŠ½è±¡æ¨¡å‹</h2><p>äºŒçº§æ˜ å°„ï¼šç¬¬ä¸€çº§ï¼škey-partitionï¼Œä¸€ä¸ªåˆ†ç‰‡åŒ…å«å¤šä¸ªæ•°æ®è®°å½•ï¼›ç¬¬äºŒçº§ï¼špartition-machineï¼Œä¸€ä¸ªç‰©ç†æœºå™¨å®¹çº³å¤šä¸ªæ•°æ®åˆ†ç‰‡ã€‚</p>
<p>![[Pasted image 20250904184458.jpg]]</p>
<p>åœ¨åšæ•°æ®åˆ†ç‰‡æ—¶ï¼Œæ ¹æ®key-partitionæ˜ å°„å…³ç³»å°†å¤§æ•°æ®æ°´å¹³åˆ‡å‰²æˆä¼—å¤šæ•°æ®åˆ†ç‰‡ï¼Œç„¶åå†æŒ‰ç…§partition-machineæ˜ å°„å…³ç³»å°†æ•°æ®åˆ†ç‰‡æ”¾ç½®åˆ°å¯¹åº”çš„ç‰©ç†æœºå™¨ä¸Šã€‚</p>
<ul>
<li>å“ˆå¸Œåˆ†ç‰‡ï¼šä¸»è¦é€šè¿‡å“ˆå¸Œå‡½æ•°æ¥å»ºç«‹key-partitionæ˜ å°„å…³ç³»ï¼Œ<strong>ç‚¹æŸ¥è¯¢</strong>ï¼Œä¸æ”¯æŒèŒƒå›´æŸ¥è¯¢ã€‚Dynamoã€Cassandraã€Riakã€Voldmortã€Membaseç­‰éƒ½æ”¯æŒ</li>
<li>èŒƒå›´åˆ†ç‰‡ï¼š<strong>æ”¯æŒç‚¹æŸ¥è¯¢ä¹Ÿå¯ä»¥æ”¯æŒèŒƒå›´æŸ¥è¯¢</strong>ï¼ŒåŒ…æ‹¬Googleçš„BigTableå’Œå¾®è½¯çš„Azureç­‰ç³»ç»Ÿ</li>
</ul>
<h2 id="å“ˆå¸Œåˆ†ç‰‡"><a href="#å“ˆå¸Œåˆ†ç‰‡" class="headerlink" title="å“ˆå¸Œåˆ†ç‰‡"></a>å“ˆå¸Œåˆ†ç‰‡</h2><p>é€šè¿‡å“ˆå¸Œå‡½æ•°åˆ†ç‰‡ï¼Œæœ‰ä¸‰ç§å“ˆå¸Œåˆ†ç‰‡æ–¹å¼ï¼šRound Robinã€è™šæ‹Ÿæ¡¶åŠä¸€è‡´æ€§å“ˆå¸Œæ–¹æ³•</p>
<h3 id="Round-Robin"><a href="#Round-Robin" class="headerlink" title="Round Robin"></a><strong>Round Robin</strong></h3><p>å°±æ˜¯å“ˆå¸Œå–æ¨¡æ³•ï¼Œå“ˆå¸Œå‡½æ•°ï¼šH(key) &#x3D; hash(key) mod Kã€‚æœºå™¨ç¼–å·0-K-1ï¼Œå…¨éƒ¨æ•°æ®åˆ†é…åˆ°Kå°ç‰©ç†æœºã€‚</p>
<ul>
<li>ä¼˜ç‚¹ï¼šéå¸¸ç®€å•</li>
<li>ç¼ºç‚¹ï¼šçµæ´»æ€§å·®ï¼Œå¢åŠ ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°±éœ€è¦é‡åˆ†å¸ƒ</li>
</ul>
<p>å®ƒæ˜¯ç‰©ç†æœºå’Œæ•°æ®åˆ†ç‰‡çš„äºŒåˆä¸€ï¼Œæœºå™¨å’Œæ˜ å°„å‡½æ•°ç´§è€¦åˆï¼Œè¿™æ˜¯ç¼ºä¹æ‰©å±•çµæ´»æ€§çš„æ ¹æœ¬åŸå› ã€‚</p>
<h3 id="è™šæ‹Ÿæ¡¶"><a href="#è™šæ‹Ÿæ¡¶" class="headerlink" title="è™šæ‹Ÿæ¡¶"></a>è™šæ‹Ÿæ¡¶</h3><p>MemBaseå¯¹äºæ•°æ®åˆ†ç‰‡ç®¡ç†æå‡ºäº†è™šæ‹Ÿæ¡¶çš„å®ç°æ–¹å¼ï¼š<br>è®°å½•å’Œç‰©ç†æœºå¼•å…¥è™šæ‹Ÿæ¡¶ï¼Œæ•°æ®çº¿åˆ°æ¡¶ï¼Œå†åˆ°ç‰©ç†æœºï¼Œéƒ½æ˜¯å¤šå¯¹ä¸€çš„æ˜ å°„ã€‚</p>
<p>è™šæ‹Ÿæ¡¶å±‚å°±æ˜¯æ•°æ®åˆ†ç‰‡å±‚ï¼Œkey-partitionæ˜ å°„é‡‡ç”¨å“ˆå¸Œå‡½æ•°ï¼Œè€Œpartition-machineæ˜ å°„é‡‡ç”¨è¡¨æ ¼ç®¡ç†å®ç°ã€‚<br>![[Pasted image 20250905104631.jpg]]<br>ç³»ç»Ÿçµæ´»æ€§ã€æ‰©å±•æ€§æ›´å¼º</p>
<h3 id="ä¸€è‡´æ€§å“ˆå¸Œ"><a href="#ä¸€è‡´æ€§å“ˆå¸Œ" class="headerlink" title="ä¸€è‡´æ€§å“ˆå¸Œ"></a>ä¸€è‡´æ€§å“ˆå¸Œ</h3><p>åˆ†å¸ƒå¼å“ˆå¸Œè¡¨ï¼šå“ˆå¸Œè¡¨çš„åˆ†å¸ƒå¼æ‰©å±•ã€‚<br>ä¸€è‡´æ€§å“ˆå¸Œå°±æ˜¯åˆ†å¸ƒå¼å“ˆå¸Œçš„ä¸€ç§å®ç°æ–¹å¼ã€‚</p>
<p>â€œä¸€è‡´æ€§å“ˆå¸Œâ€ç®—æ³•å°†å“ˆå¸Œæ•°å€¼ç©ºé—´æŒ‰ç…§å¤§å°ç»„æˆä¸€ä¸ªé¦–å°¾ç›¸æ¥çš„ç¯çŠ¶åºåˆ—ã€‚å¯¹äºæ¯å°æœºå™¨ï¼Œå¯ä»¥æ ¹æ®å…¶IPå’Œç«¯å£å·ç»è¿‡å“ˆå¸Œå‡½æ•°æ˜ å°„åˆ°å“ˆå¸Œæ•°å€¼ç©ºé—´å†…ï¼Œè¿™æ ·ä¸åŒçš„æœºå™¨å°±æˆäº†ç¯çŠ¶åºåˆ—ä¸­çš„ä¸åŒèŠ‚ç‚¹ã€‚<br>![[Pasted image 20250908145043.jpg]]<br><strong>è·¯ç”±æ–¹é¢</strong>ï¼šå¯ä»¥åœ¨æ¯ä¸ªæœºå™¨èŠ‚ç‚¹é…ç½®è·¯ç”±è¡¨ï¼Œè·¯ç”±è¡¨å­˜å‚¨mÂ æ¡è·¯ç”±ä¿¡æ¯ï¼Œå…¶ä¸­ç¬¬iÂ é¡¹ï¼ˆ0â‰¤iÂ â‰¤mÂ âˆ’1ï¼‰è·¯ç”±ä¿¡æ¯ä»£è¡¨è·ç¦»å½“å‰èŠ‚ç‚¹ä¸º2Â iÂ çš„å“ˆå¸Œç©ºé—´æ•°å€¼æ‰€åœ¨çš„æœºå™¨èŠ‚ç‚¹ç¼–å·ã€‚<br>é€šå¸¸æƒ…å†µä¸‹ï¼Œè·¯ç”±ç®—æ³•å‘é€çš„æ¶ˆæ¯ä¸ä¼šå¤šäºmÂ æ¡ï¼Œå› ä¸ºè¿™ä¸ªè¿‡ç¨‹ç±»ä¼¼äºåœ¨0ï½(2Â mÂ âˆ’1)æ•°å€¼ç©ºé—´ä¸Šçš„äºŒåˆ†æŸ¥æ‰¾æ³•ã€‚</p>
<p><strong>æ‰©å±•æ–¹é¢</strong>ï¼šé¦–å…ˆå¢åŠ èŠ‚ç‚¹å¯¹åº”çš„å‰é©±å’Œåç»§èŠ‚ç‚¹å…³ç³»ï¼Œç„¶åè¿˜éœ€è¦è¿›è¡Œæ•°æ®é‡åˆ†å¸ƒã€‚å¹¶å‘æƒ…å†µä¸‹éœ€è¦è¿›è¡Œç¨³å®šæ€§æ£€æµ‹ã€‚</p>
<p><strong>ç¦»å¼€æ–¹é¢</strong>ï¼šæ­£å¸¸ç¦»å¼€è¿›è¡Œé€šçŸ¥å‡†å¤‡ï¼Œè¿›è¡Œæ•°æ®é‡åˆ†å¸ƒï¼Œå¼‚å¸¸ç¦»å¼€é€šè¿‡æ•°æ®å¤šå‰¯æœ¬ä¿éšœã€‚</p>
<p><strong>è™šæ‹ŸèŠ‚ç‚¹</strong>ï¼šä¸¤ä¸ªé—®é¢˜ï¼ŒèŠ‚ç‚¹åˆ°ç¯çŠ¶ç»“æ„çš„ä½ç½®éšæœºï¼Œå®¹æ˜“å­˜åœ¨è´Ÿè½½ä¸å‡è¡¡çš„é—®é¢˜ï¼Œå¦å¤–ä¸åŒæœºå™¨é—´çš„æ€§èƒ½ä¹Ÿä¸åŒã€‚æ‰€ä»¥å¼•å…¥è™šæ‹ŸèŠ‚ç‚¹ï¼Œå³å°†ä¸€ä¸ªç‰©ç†èŠ‚ç‚¹è™šæ‹Ÿæˆè‹¥å¹²è™šæ‹ŸèŠ‚ç‚¹ï¼Œåˆ†åˆ«æ˜ å°„åˆ°ä¸€è‡´æ€§å“ˆå¸Œçš„ç¯çŠ¶ç»“æ„ä¸åŒä½ç½®ã€‚è¿™æ ·ä¸€æ–¹é¢å¯ä»¥å¯¼è‡´æ›´ä½³çš„è´Ÿè½½å‡è¡¡ï¼Œä¹Ÿå¯ä»¥å…¼é¡¾åˆ°æœºå™¨å¼‚è´¨æ€§é—®é¢˜ã€‚</p>
<p><strong>ä¸€è‡´æ€§å“ˆå¸Œ</strong>ï¼šå°†é›†ç¾¤æœºå™¨æ•°ç›®è¿™ä¸€å˜é‡ä»å“ˆå¸Œå‡½æ•°ä¸­ç§»å‡ºï¼Œè½¬è€Œå°†æœºå™¨åŠè®°å½•ä¸»é”®éƒ½æ˜ å°„åˆ°å“ˆå¸Œæ•°å€¼ç©ºé—´ï¼Œè§£é™¤äº†æœºå™¨ä¸æ•°æ®åˆ†å¸ƒå‡½æ•°ä¹‹é—´çš„ç›´æ¥è€¦åˆã€‚å¤§å¤§å¢å¼ºäº†æ•°æ®åˆ†ç‰‡çš„çµæ´»æ€§ï¼Œä½†æ˜¯ç»´æŠ¤æˆæœ¬å¾ˆé«˜ã€‚</p>
<h3 id="èŒƒå›´åˆ†ç‰‡"><a href="#èŒƒå›´åˆ†ç‰‡" class="headerlink" title="èŒƒå›´åˆ†ç‰‡"></a>èŒƒå›´åˆ†ç‰‡</h3><p>èŒƒå›´åˆ†ç‰‡é¦–å…ˆå°†æ‰€æœ‰è®°å½•çš„ä¸»é”®è¿›è¡Œæ’åºï¼Œç„¶ååœ¨æ’å¥½åºçš„ä¸»é”®ç©ºé—´é‡Œå°†è®°å½•åˆ’åˆ†æˆæ•°æ®åˆ†ç‰‡ï¼Œæ¯ä¸ªæ•°æ®åˆ†ç‰‡å­˜å‚¨æœ‰åºçš„ä¸»é”®ç©ºé—´ç‰‡æ®µå†…çš„æ‰€æœ‰è®°å½•ã€‚è‡³äºæ•°æ®åˆ†ç‰‡åœ¨ç‰©ç†æœºçš„ç®¡ç†æ–¹å¼å¾€å¾€é‡‡ç”¨LSMæ ‘ï¼Œè¿™æ˜¯ä¸€ç§é«˜æ•ˆå†™å…¥çš„æ•°æ®ç´¢å¼•ç»“æ„ã€‚</p>
<p>![[Pasted image 20250908175559.jpg]]</p>
<p>å¾ˆå¤šå¤§è§„æ¨¡å­˜å‚¨ç³»ç»Ÿéƒ½æ”¯æŒä¸Šè¿°èŒƒå›´åˆ†ç‰‡æ¨¡å¼ï¼Œæ¯”å¦‚Yahooçš„PNUTSå’Œå¾®è½¯çš„Azureã€‚Googleçš„BigTableä¹ŸåŸºæœ¬éµå¾ªä¸Šè¿°æ¨¡å¼ï¼Œä¸åŒç‚¹åœ¨äºå…¶æ•°æ®åˆ†ç‰‡æ˜ å°„è¡¨ä¸æ˜¯å•å±‚ç»“æ„ï¼Œè€Œæ˜¯ç»„ç»‡æˆç±»ä¼¼B+æ ‘çš„å±‚æ¬¡ç»“æ„ã€‚</p>
<h1 id="ç¬¬2ç« â€”â€”æ•°æ®å¤åˆ¶ä¸ä¸€è‡´æ€§åè®®"><a href="#ç¬¬2ç« â€”â€”æ•°æ®å¤åˆ¶ä¸ä¸€è‡´æ€§åè®®" class="headerlink" title="ç¬¬2ç« â€”â€”æ•°æ®å¤åˆ¶ä¸ä¸€è‡´æ€§åè®®"></a>ç¬¬2ç« â€”â€”æ•°æ®å¤åˆ¶ä¸ä¸€è‡´æ€§åè®®</h1><p>å¤§æ•°æ®é¢†åŸŸï¼Œå¢åŠ ç³»ç»Ÿé«˜å¯ç”¨ï¼Œå³å°†æ•°æ®è¿›è¡Œå¤šå‰¯æœ¬å­˜å‚¨ï¼Œä½†æ˜¯å¤šå‰¯æœ¬ä¼šå¸¦æ¥å…µæ³•å†™å…¥çš„ä¸€è‡´æ€§é—®é¢˜ã€‚</p>
<h2 id="åŸºæœ¬åŸåˆ™ä¸è®¾è®¡ç†å¿µ"><a href="#åŸºæœ¬åŸåˆ™ä¸è®¾è®¡ç†å¿µ" class="headerlink" title="åŸºæœ¬åŸåˆ™ä¸è®¾è®¡ç†å¿µ"></a>åŸºæœ¬åŸåˆ™ä¸è®¾è®¡ç†å¿µ</h2><p>CAPã€BASEã€ACIDç†è®º</p>
<h3 id="åŸæ•™æ—¨CAPä¸»ä¹‰"><a href="#åŸæ•™æ—¨CAPä¸»ä¹‰" class="headerlink" title="åŸæ•™æ—¨CAPä¸»ä¹‰"></a>åŸæ•™æ—¨CAPä¸»ä¹‰</h3><p>CAPæ˜¯å¯¹â€œConsistency&#x2F;Availability&#x2F;Partition Toleranceâ€ï¼š</p>
<ul>
<li><strong>å¼ºä¸€è‡´æ€§</strong>ï¼šåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„åŒä¸€æ•°æ®å¤šå‰¯æœ¬æƒ…å½¢ä¸‹ï¼Œå¯¹äºæ•°æ®çš„æ›´æ–°æ“ä½œä½“ç°å‡ºçš„æ•ˆæœä¸åªæœ‰å•ä»½æ•°æ®æ˜¯ä¸€æ ·çš„ã€‚</li>
<li><strong>å¯ç”¨æ€§</strong>ï¼šå®¢æˆ·ç«¯åœ¨ä»»ä½•æ—¶åˆ»å¯¹å¤§è§„æ¨¡æ•°æ®ç³»ç»Ÿçš„è¯»ï¼å†™æ“ä½œéƒ½åº”è¯¥ä¿è¯åœ¨é™å®šå»¶æ—¶å†…å®Œæˆã€‚</li>
<li><strong>åˆ†åŒºå®¹å¿æ€§</strong>ï¼šç½‘ç»œåˆ†åŒºé€šè®¯æœ‰é—®é¢˜ï¼Œä»ç„¶èƒ½å¤Ÿç»§ç»­å·¥ä½œã€‚</li>
</ul>
<p>1999å¹´Eric Breweræå‡ºè¯¥ç†è®ºï¼Œåªèƒ½å®ç°ä¸‰ä¸ªä¸­çš„ä¸¤ä¸ªï¼Œä¸€èˆ¬ä¸èˆå¼ƒPï¼Œæ•…åªæœ‰APæˆ–CP.</p>
<p>![[Pasted image 20250908180836.jpg]]</p>
<ul>
<li>ä¼ ç»Ÿçš„å…³ç³»æ•°æ®åº“åœ¨ä¸‰è¦ç´ ä¸­é€‰æ‹©CAä¸¤ä¸ªå› ç´ ï¼Œå³å¼ºä¸€è‡´æ€§ã€é«˜å¯ç”¨æ€§ï¼Œä½†æ˜¯å¯æ‰©å±•æ€§ä¸å®¹é”™æ€§å·®ã€‚</li>
<li>NoSQLç³»ç»Ÿå¾€å¾€æ›´å…³æ³¨APå› ç´ ï¼Œå³é«˜å¯æ‰©å±•æ€§å’Œé«˜å¯ç”¨æ€§ï¼Œä½†æ˜¯å¾€å¾€ä»¥å¼±ä¸€è‡´æ€§ä½œä¸ºä»£ä»·.</li>
</ul>
<p>2012å¹´ï¼ŒEric Breweråˆæå‡ºPå¾ˆä½æ¦‚ç‡å‡ºç°ï¼Œæ­£å¸¸æƒ…å†µä¸‹è¿˜æ˜¯è¦å…¼é¡¾CAPï¼Œåœ¨è¿›è¡Œå·®å¼‚åŒ–ã€ç»†ç²’åº¦çš„CAå–èˆã€‚ä¿®æ­£åçš„ç¤ºæ„å›¾å¦‚ä¸‹ï¼Œåœ¨è¿‡ç¨‹ä¸­æ»¡è¶³CAPã€APã€CAPå› ç´ ï¼š<br>![[Pasted image 20250908181729.jpg]]</p>
<h3 id="ACIDåŸåˆ™"><a href="#ACIDåŸåˆ™" class="headerlink" title="ACIDåŸåˆ™"></a>ACIDåŸåˆ™</h3><ul>
<li><strong>åŸå­æ€§</strong>Â ï¼ˆAtomicityï¼‰ï¼šæ˜¯æŒ‡ä¸€ä¸ªäº‹åŠ¡è¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼Œè¦ä¹ˆå®Œå…¨ä¸æ‰§è¡Œã€‚ä¹Ÿå°±æ˜¯ä¸å…è®¸ä¸€ä¸ªäº‹åŠ¡åªæ‰§è¡Œäº†ä¸€åŠå°±åœæ­¢ã€‚</li>
<li><strong>ä¸€è‡´æ€§</strong>Â ï¼ˆConsistencyï¼‰ï¼šäº‹åŠ¡åœ¨å¼€å§‹å’Œç»“æŸæ—¶ï¼Œåº”è¯¥å§‹ç»ˆæ»¡è¶³ä¸€è‡´æ€§çº¦æŸæ¡ä»¶ã€‚</li>
<li><strong>äº‹åŠ¡ç‹¬ç«‹</strong>Â ï¼ˆIsolationï¼‰ï¼šå¦‚æœæœ‰å¤šä¸ªäº‹åŠ¡åŒæ—¶æ‰§è¡Œï¼Œå½¼æ­¤ä¹‹é—´ä¸éœ€è¦çŸ¥æ™“å¯¹æ–¹çš„å­˜åœ¨ï¼Œè€Œä¸”æ‰§è¡Œæ—¶äº’ä¸å½±å“ã€‚</li>
<li><strong>æŒä¹…æ€§</strong> ï¼ˆDurabilityï¼‰ï¼šäº‹åŠ¡çš„æŒä¹…æ€§æ˜¯æŒ‡äº‹åŠ¡è¿è¡ŒæˆåŠŸä»¥åï¼Œå¯¹ç³»ç»ŸçŠ¶æ€çš„æ›´æ–°æ˜¯æ°¸ä¹…çš„ï¼Œä¸ä¼šæ— ç¼˜ç”±åœ°å›æ»šæ’¤é”€ã€‚</li>
</ul>
<h3 id="BASEåŸåˆ™"><a href="#BASEåŸåˆ™" class="headerlink" title="BASEåŸåˆ™"></a>BASEåŸåˆ™</h3><p>å¤§å¤šæ•°å¤§æ•°æ®ç¯å¢ƒä¸‹çš„äº‘å­˜å‚¨ç³»ç»Ÿå’ŒNoSQLç³»ç»Ÿåˆ™é‡‡çº³BASEåŸåˆ™</p>
<ul>
<li><strong>åŸºæœ¬å¯ç”¨</strong>Â ï¼ˆBasically Availableï¼‰ã€‚åœ¨ç»å¤§å¤šæ•°æ—¶é—´å†…ç³»ç»Ÿå¤„äºå¯ç”¨çŠ¶æ€ï¼Œå…è®¸å¶å°”çš„å¤±è´¥ï¼Œæ‰€Â ä»¥ç§°ä¸ºåŸºæœ¬å¯ç”¨ã€‚</li>
<li><strong>è½¯çŠ¶æ€æˆ–è€…æŸ”æ€§çŠ¶æ€</strong> ï¼ˆSoft Stateï¼‰ï¼Œæ˜¯æŒ‡æ•°æ®çŠ¶æ€ä¸è¦æ±‚åœ¨ä»»æ„æ—¶åˆ»éƒ½å®Œå…¨ä¿æŒåŒæ­¥ï¼Œåˆ°ç›®å‰ä¸ºæ­¢è½¯çŠ¶æ€å¹¶æ— ä¸€ä¸ªç»Ÿä¸€æ˜æ™°çš„å®šä¹‰ï¼Œä½†æ˜¯ä»æ¦‚å¿µä¸Šæ˜¯å¯ç†è§£çš„ï¼Œå³å¤„äºæœ‰çŠ¶æ€ï¼ˆStateï¼‰å’Œæ— çŠ¶æ€ï¼ˆStatelessï¼‰ä¹‹é—´çš„ä¸­é—´çŠ¶æ€ã€‚</li>
<li><strong>æœ€ç»ˆä¸€è‡´æ€§</strong>Â ï¼ˆEventual Consistencyï¼‰ã€‚ä¸å¼ºä¸€è‡´æ€§ç›¸æ¯”ï¼Œæœ€ç»ˆä¸€è‡´æ€§æ˜¯ä¸€ç§å¼±ä¸€è‡´æ€§ï¼Œå°½ç®¡è½¯çŠ¶æ€ä¸è¦æ±‚ä»»æ„æ—¶åˆ»æ•°æ®ä¿æŒä¸€è‡´åŒæ­¥ï¼Œä½†æ˜¯æœ€ç»ˆä¸€è‡´æ€§è¦æ±‚åœ¨ç»™å®šæ—¶é—´çª—å£å†…æ•°æ®ä¼šè¾¾åˆ°ä¸€è‡´çŠ¶æ€ã€‚</li>
</ul>
<h3 id="CAP-ACID-BASEä¸‰è€…å…³ç³»"><a href="#CAP-ACID-BASEä¸‰è€…å…³ç³»" class="headerlink" title="CAP&#x2F;ACID&#x2F;BASEä¸‰è€…å…³ç³»"></a>CAP&#x2F;ACID&#x2F;BASEä¸‰è€…å…³ç³»</h3><p>ACIDå¼ºè°ƒä¸€è‡´æ€§ï¼ŒBASEå¼ºè°ƒå¯ç”¨æ€§ï¼Œå¼±åŒ–ä¸€è‡´æ€§ã€‚CAPå’ŒACIDçš„åŒºåˆ«ï¼š</p>
<ul>
<li>ACIDçš„Cæ˜¯æ“ä½œä¸€è‡´æ€§çº¦æŸï¼ŒCAPçš„Cæ˜¯æ•°æ®çš„å¼ºä¸€è‡´æ€§ã€‚CAPä¸­çš„Cæ˜¯ACIDä¸­çš„Cæ‰€æ¶µç›–è¯­ä¹‰çš„å­é›†ã€‚</li>
<li>å‡ºç°ç½‘ç»œåˆ†åŒºåï¼ŒACIDçš„Iåªèƒ½åœ¨æŸä¸ªåˆ†åŒºæ‰§è¡Œ</li>
<li>å½“å‡ºç°ç½‘ç»œåˆ†åŒºæ—¶ï¼Œå¤šä¸ªåˆ†åŒºéƒ½å¯ä»¥å„è‡ªè¿›è¡ŒACIDä¸­çš„æ•°æ®æŒä¹…åŒ–ï¼ˆDï¼‰æ“ä½œã€‚</li>
</ul>
<h3 id="å¹‚ç­‰æ€§"><a href="#å¹‚ç­‰æ€§" class="headerlink" title="å¹‚ç­‰æ€§"></a>å¹‚ç­‰æ€§</h3><p><strong>åˆ†å¸ƒå¼çš„å¹‚ç­‰æ€§</strong>ï¼šè°ƒç”¨æ–¹åå¤æ‰§è¡ŒåŒä¸€æ“ä½œä¸åªæ­£ç¡®æ‰§è¡Œä¸€æ¬¡æ“ä½œæ•ˆæœç›¸åŒï¼Œå³å¯¹åˆ†å¸ƒå¼ç³»ç»Ÿå†…éƒ¨çŠ¶æ€æ¥è¯´ï¼ŒåŒä¸€æ“ä½œè°ƒç”¨ä¸€æ¬¡ä¸åå¤è°ƒç”¨å¤šæ¬¡å…¶çŠ¶æ€ä¿æŒç›¸åŒã€‚</p>
<h2 id="ä¸€è‡´æ€§æ¨¡å‹åˆ†ç±»"><a href="#ä¸€è‡´æ€§æ¨¡å‹åˆ†ç±»" class="headerlink" title="ä¸€è‡´æ€§æ¨¡å‹åˆ†ç±»"></a>ä¸€è‡´æ€§æ¨¡å‹åˆ†ç±»</h2><p>ç†æƒ³æƒ…å†µä¸‹å°±åªæœ‰å¼ºä¸€è‡´æ€§<br>ä¸ºäº†åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹è¿½æ±‚é«˜å¯ç”¨å’Œé«˜æ‰©å±•ï¼Œé‡‡ç”¨å¼±ä¸€è‡´æ€§æ¨¡å‹ï¼Œå¾ˆå¤šNoSQLç³»ç»Ÿé‡‡ç”¨å¼±ä¸€è‡´æ€§æ¨¡å‹</p>
<p>ä¸€è‡´æ€§æ¨¡å‹å…³ç³»å›¾ï¼š<br>![[Pasted image 20250909192340.jpg]]</p>
<h3 id="å¼ºä¸€è‡´æ€§"><a href="#å¼ºä¸€è‡´æ€§" class="headerlink" title="å¼ºä¸€è‡´æ€§"></a>å¼ºä¸€è‡´æ€§</h3><p>æ›´æ–°åæ‰€æœ‰çš„è¯»éƒ½æ˜¯æ›´æ–°çš„å€¼</p>
<p>![[Pasted image 20250909192434.jpg]]</p>
<h3 id="æœ€ç»ˆä¸€è‡´æ€§"><a href="#æœ€ç»ˆä¸€è‡´æ€§" class="headerlink" title="æœ€ç»ˆä¸€è‡´æ€§"></a>æœ€ç»ˆä¸€è‡´æ€§</h3><p>æ— æ³•ä¿è¯å¼ºä¸€è‡´æ€§çš„æ—¶é—´ç‰‡æ®µè¢«ç§°ä¸ºâ€œä¸ä¸€è‡´çª—å£â€ï¼Œè¿™ä¸ªçª—å£å¯èƒ½ä¼šçœ‹åˆ°æ—§çš„æ•°å€¼<br>![[Pasted image 20250909192520.jpg]]</p>
<h3 id="å› æœä¸€è‡´æ€§"><a href="#å› æœä¸€è‡´æ€§" class="headerlink" title="å› æœä¸€è‡´æ€§"></a>å› æœä¸€è‡´æ€§</h3><p>æœ‰å› æœä¾èµ–çš„ï¼Œä¿è¯æ•°æ®çš„å› æœä¸€è‡´æ€§ï¼Œä½†ä¸ä¸€è‡´çª—å£å†…ä»ç„¶ä¼šçœ‹åˆ°æ—§å€¼<br>![[Pasted image 20250909192650.jpg]]</p>
<h3 id="è¯»ä½ æ‰€å†™ä¸€è‡´æ€§"><a href="#è¯»ä½ æ‰€å†™ä¸€è‡´æ€§" class="headerlink" title="è¯»ä½ æ‰€å†™ä¸€è‡´æ€§"></a>è¯»ä½ æ‰€å†™ä¸€è‡´æ€§</h3><p>â€œè¯»ä½ æ‰€å†™â€ä¸€è‡´æ€§æ˜¯å› æœä¸€è‡´æ€§çš„ç‰¹ä¾‹<br>![[Pasted image 20250909192812.jpg]]</p>
<h3 id="ä¼šè¯ä¸€è‡´æ€§"><a href="#ä¼šè¯ä¸€è‡´æ€§" class="headerlink" title="ä¼šè¯ä¸€è‡´æ€§"></a>ä¼šè¯ä¸€è‡´æ€§</h3><p>è¯»ä½ æ‰€å†™çš„å˜ä½“ï¼šå›è¯ä¸€è‡´æ€§<br>![[Pasted image 20250909193509.jpg]]</p>
<h3 id="å•è°ƒè¯»ä¸€è‡´æ€§"><a href="#å•è°ƒè¯»ä¸€è‡´æ€§" class="headerlink" title="å•è°ƒè¯»ä¸€è‡´æ€§"></a>å•è°ƒè¯»ä¸€è‡´æ€§</h3><p>è¯»åˆ°ä¸€æ¬¡æœ€æ–°çš„ï¼Œåé¢å°±éƒ½æ˜¯æœ€æ–°çš„<br>![[Pasted image 20250909193611.jpg]]</p>
<h3 id="å•è°ƒå†™ä¸€è‡´æ€§"><a href="#å•è°ƒå†™ä¸€è‡´æ€§" class="headerlink" title="å•è°ƒå†™ä¸€è‡´æ€§"></a>å•è°ƒå†™ä¸€è‡´æ€§</h3><p>å•è°ƒå†™ä¸€è‡´æ€§å¯ä»¥ä¿è¯å…¶å¤šæ¬¡å†™æ“ä½œçš„åºåˆ—åŒ–ï¼Œå¦‚æœæ²¡æœ‰è¿™ç§ä¿è¯ï¼Œå¯¹äºåº”ç”¨å¼€å‘è€…æ¥è¯´æ˜¯å¾ˆéš¾è¿›è¡Œç¨‹åºå¼€å‘çš„ã€‚</p>
<h2 id="å‰¯æœ¬æ›´æ–°ç­–ç•¥"><a href="#å‰¯æœ¬æ›´æ–°ç­–ç•¥" class="headerlink" title="å‰¯æœ¬æ›´æ–°ç­–ç•¥"></a>å‰¯æœ¬æ›´æ–°ç­–ç•¥</h2><p>åˆ†å¸ƒå¼å­˜å‚¨ä¸‹ï¼Œæ•°æ®å†—ä½™å¢åŠ å¯ç”¨æ€§ï¼Œä¹Ÿå¢åŠ è¯»æ“ä½œçš„å¹¶å‘æ€§ã€‚ä½†æ˜¯ä¸€è‡´æ€§é—®é¢˜å¦‚ä½•è§£å†³å‘¢ï¼Ÿ</p>
<h3 id="åŒæ—¶æ›´æ–°"><a href="#åŒæ—¶æ›´æ–°" class="headerlink" title="åŒæ—¶æ›´æ–°"></a>åŒæ—¶æ›´æ–°</h3><p>å…·ä½“åˆæœ‰ä¸¤ç§ç±»å‹ï¼š</p>
<ul>
<li>Aï¼šä¸é€šè¿‡ä»»ä½•ä¸€è‡´æ€§åè®®ç›´æ¥åŒæ—¶æ›´æ–°å¤šä¸ªå‰¯æœ¬æ•°æ®ã€‚ä¼šæœ‰æ½œåœ¨çš„ä¸€è‡´æ€§é—®é¢˜ï¼Œå¤šä¸ªupdateå¹¶å‘æ‰§è¡Œ</li>
<li>Bï¼šé€šè¿‡æŸç§ä¸€è‡´æ€§åè®®é¢„å…ˆå¤„ç†ï¼Œæœ‰å¤„ç†æˆæœ¬ï¼Œæ‰€ä»¥è¯·æ±‚å»¶æ—¶ä¼šæœ‰æ‰€å¢åŠ ã€‚</li>
</ul>
<h3 id="ä¸»ä»å¼æ›´æ–°"><a href="#ä¸»ä»å¼æ›´æ–°" class="headerlink" title="ä¸»ä»å¼æ›´æ–°"></a>ä¸»ä»å¼æ›´æ–°</h3><p>æ‰€æœ‰çš„æ›´æ–°æ“ä½œéƒ½å…ˆæåˆ°ä¸»å‰¯æœ¬ï¼Œä¸»å‰¯æœ¬å†å»æ›´æ–°ä»å‰¯æœ¬ã€‚æ ¹æ®ä¸»å‰¯æœ¬é€šçŸ¥ä»å‰¯æœ¬çš„ä¸åŒæœºåˆ¶æ¥åŒºåˆ†ï¼Œå­˜åœ¨ä»¥ä¸‹3ç§ç±»å‹ã€‚</p>
<ul>
<li><strong>åŒæ­¥æ–¹å¼</strong>ï¼šä¸»å‰¯æœ¬ç­‰å¾…æ‰€æœ‰ä»å‰¯æœ¬æ›´æ–°å®Œæˆä¹‹åæ‰ç¡®è®¤æ›´æ–°æ“ä½œå®Œæˆï¼Œè¿™å¯ä»¥ç¡®ä¿æ•°æ®çš„å¼ºä¸€è‡´æ€§ï¼Œä½†æ˜¯ä¼šå­˜åœ¨è¾ƒå¤§è¯·æ±‚å»¶æ—¶ã€‚</li>
<li><strong>å¼‚æ­¥æ–¹å¼</strong>ï¼šä¸»å‰¯æœ¬åœ¨é€šçŸ¥ä»å‰¯æœ¬æ›´æ–°ä¹‹å‰å³å¯ç¡®è®¤æ›´æ–°æ“ä½œã€‚æŒ‰ç…§è¯»æ“ä½œåˆå¯ä»¥åˆ†ä¸ºå¦‚ä¸‹ä¸¤ç±»ï¼š<ul>
<li>å¦‚æœæ‰€æœ‰è¯»è¯·æ±‚éƒ½è¦é€šè¿‡ä¸»å‰¯æœ¬æ¥å“åº”ï¼Œå³ä»»æ„ä¸€ä¸ªå‰¯æœ¬æ¥æ”¶åˆ°è¯»è¯·æ±‚åå°†å…¶è½¬å‘ç»™ä¸»å‰¯æœ¬ï¼›å¯ä»¥ä¿éšœå¼ºä¸€è‡´æ€§ï¼Œä½†æ˜¯ä¼šæœ‰è¯·æ±‚å»¶æ—¶ã€‚</li>
<li>å¦‚æœä»»æ„ä¸€ä¸ªå‰¯æœ¬éƒ½å¯ä»¥å“åº”è¯»è¯·æ±‚ï¼Œé‚£ä¹ˆè¯·æ±‚å»¶æ—¶å°†ä¼šå¤§å¤§é™ä½ï¼Œä½†æ˜¯è¿™å¯èƒ½å¯¼è‡´è¯»ç»“æœä¸ä¸€è‡´çš„é—®é¢˜ã€‚</li>
</ul>
</li>
<li><strong>æ··åˆæ–¹å¼</strong>ï¼šåŒæ­¥å’Œå¼‚æ­¥æ··åˆèµ·æ¥ç”¨ï¼ŒæŒ‰ç…§è¯»æ“ä½œåˆå¯ä»¥åˆ†ä¸ºå¦‚ä¸‹ä¸¤ç±»ï¼š<ul>
<li>å¦‚æœè¯»æ“ä½œçš„æ•°æ®è‡³å°‘è¦ä»ä¸€ä¸ªåŒæ­¥æ›´æ–°çš„èŠ‚ç‚¹ä¸­è¯»å‡ºï¼Œæ¯”å¦‚ç±»ä¼¼äºRWNåè®®çš„R+W&gt;Nï¼Œå¯ä»¥ä¿è¯å¼ºä¸€è‡´æ€§ï¼Œä¼šæœ‰è¯·æ±‚å»¶æ—¶ã€‚</li>
<li>å¦‚æœè¯»æ“ä½œä¸è¦æ±‚ä¸€å®šè¦ä»è‡³å°‘ä¸€ä¸ªåŒæ­¥æ›´æ–°èŠ‚ç‚¹ä¸­è¯»å‡ºï¼Œå³RWNåè®®ä¸­çš„R+W&lt;&#x3D;N çš„æ¨¡å¼ï¼Œä¼šæœ‰ä¸ä¸€è‡´é—®é¢˜ã€‚</li>
</ul>
</li>
</ul>
<h3 id="ä»»æ„èŠ‚ç‚¹æ›´æ–°"><a href="#ä»»æ„èŠ‚ç‚¹æ›´æ–°" class="headerlink" title="ä»»æ„èŠ‚ç‚¹æ›´æ–°"></a>ä»»æ„èŠ‚ç‚¹æ›´æ–°</h3><p>æ•°æ®æ›´æ–°è¯·æ±‚å¯èƒ½å‘ç»™å¤šå‰¯æœ¬ä¸­çš„ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç„¶åç”±è¿™ä¸ªèŠ‚ç‚¹æ¥è´Ÿè´£é€šçŸ¥å…¶ä»–å‰¯æœ¬è¿›è¡Œæ•°æ®æ›´æ–°ã€‚æœ‰å¯èƒ½æœ‰ä¸¤ä¸ªä¸åŒå®¢æˆ·ç«¯åœ¨åŒä¸€æ—¶åˆ»å¯¹åŒä¸€ä¸ªæ•°æ®å‘å‡ºæ•°æ®æ›´æ–°è¯·æ±‚ï¼Œè€Œæ­¤æ—¶æœ‰å¯èƒ½æœ‰ä¸¤ä¸ªä¸åŒå‰¯æœ¬å„è‡ªå“åº”ã€‚</p>
<ul>
<li>ç±»å‹Aï¼šåŒæ­¥é€šçŸ¥å…¶ä»–å‰¯æœ¬ï¼šå­˜åœ¨å’Œâ€œä¸»ä»å¼æ›´æ–°â€ç±»å‹Aç›¸ä¼¼çš„æƒ…å†µï¼Œå»¶æ—¶æ›´å¤š</li>
<li>ç±»å‹Bï¼šå¼‚æ­¥é€šçŸ¥å…¶ä»–å‰¯æœ¬ï¼šå­˜åœ¨å’Œâ€œåŒæ—¶æ›´æ–°â€ç­–ç•¥åŠâ€œä¸»ä»å¼æ›´æ–°â€ç­–ç•¥çš„ç±»å‹Bç±»ä¼¼çš„é—®é¢˜ã€‚</li>
</ul>
<h2 id="ä¸€è‡´æ€§åè®®"><a href="#ä¸€è‡´æ€§åè®®" class="headerlink" title="ä¸€è‡´æ€§åè®®"></a>ä¸€è‡´æ€§åè®®</h2><h3 id="ä¸¤é˜¶æ®µæäº¤åè®®2PC"><a href="#ä¸¤é˜¶æ®µæäº¤åè®®2PC" class="headerlink" title="ä¸¤é˜¶æ®µæäº¤åè®®2PC"></a>ä¸¤é˜¶æ®µæäº¤åè®®2PC</h3><p>ä¸¤é˜¶æ®µæäº¤åè®®æ˜¯å¾ˆå¸¸ç”¨çš„è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜çš„æ–¹å¼ï¼Œå®ƒå¯ä»¥ä¿è¯åœ¨åˆ†å¸ƒå¼äº‹åŠ¡ä¸­ï¼Œè¦ä¹ˆæ‰€æœ‰å‚ä¸è¿›ç¨‹éƒ½æäº¤äº‹åŠ¡ï¼Œè¦ä¹ˆéƒ½å–æ¶ˆäº‹åŠ¡ï¼Œå³å®ç°ACIDä¸­çš„åŸå­æ€§ï¼ˆAï¼‰çš„å¸¸ç”¨æ‰‹æ®µã€‚<br>2PCæ›´å¤šçš„æ˜¯ä½œä¸ºå®ç°æ•°æ®æ›´æ–°åŸå­æ€§æ‰‹æ®µå‡ºç°ã€‚</p>
<p>å­˜åœ¨ä¸¤ç±»ä¸åŒå®ä½“ï¼šå”¯ä¸€çš„åè°ƒè€…ï¼ˆCoordinatorï¼‰å’Œä¼—å¤šçš„å‚ä¸è€…ï¼ˆParticipantsï¼‰ã€‚åè°ƒè€…èµ·åˆ°åˆ†å¸ƒå¼äº‹åŠ¡çš„ç‰¹æ®Šçš„ç®¡ç†åè°ƒä½œç”¨ã€‚<br>åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼šè¡¨å†³é˜¶æ®µï¼ˆVotingï¼‰å’Œæäº¤é˜¶æ®µï¼ˆCommitï¼‰ã€‚</p>
<ul>
<li><strong>è¡¨å†³é˜¶æ®µï¼ˆVotingï¼‰</strong>ï¼šåè°ƒè€…å‘æ‰€æœ‰å‚ä¸è€…å‘é€è¡¨å†³è¯·æ±‚ï¼Œå‚ä¸è€…å“åº”å‡†å¤‡æƒ…å†µ</li>
<li><strong>æäº¤é˜¶æ®µï¼ˆCommitï¼‰</strong>ï¼šåè°ƒè€…æ”¶é›†è¡¨å†³ä¿¡æ¯ï¼Œå¦‚æœå‚ä¸è€…å‡è®¤ä¸ºå¯æäº¤ï¼Œåˆ™é€šçŸ¥å¤§å®¶æäº¤ï¼Œå¦‚æœæœ‰ä¸€ä¸ªè¡¨å†³ä¸­æ­¢ï¼Œé€šçŸ¥å¤§å®¶å–æ¶ˆã€‚</li>
</ul>
<p>![[file-20250910190231949.jpg|400]]<br>å¯ä»¥è¿›ä¸€æ­¥è½¬æ¢ä¸ºåè°ƒè€…å’Œå‚ä¸è€…çš„çŠ¶æ€æœºï¼š</p>
<p>![[file-20250910190813183.jpg|400]]![[file-20250910191009985.jpg|400]]<br>å¯¹äºé˜»å¡çŠ¶æ€å¯ä»¥å¼•å…¥è¶…æ—¶åˆ¤æ–­æœºåˆ¶å’Œå‚ä¸è€…äº’è¯¢æœºåˆ¶ã€‚</p>
<ul>
<li>å¼•å…¥è¶…æ—¶åˆ¤æ–­æœºåˆ¶å¯ä»¥è§£å†³åè°ƒè€…çš„WAITçŠ¶æ€å’Œå‚ä¸è€…çš„INITçŠ¶æ€çš„é•¿æ—¶é˜»å¡æƒ…å½¢</li>
<li>å¼•å…¥äº’è¯¢æœºåˆ¶å¯ä»¥è§£å†³å¤§éƒ¨åˆ†æƒ…å½¢ä¸‹å‚ä¸è€…READYçŠ¶æ€çš„é•¿æ—¶é˜»å¡å¯èƒ½ã€‚</li>
</ul>
<p>å¦‚æœå‚ä¸è€…Qæ˜¯READYï¼ŒPä»Qæ— æ³•è·å¾—æ›´å¤šä¿¡æ¯ï¼Œå¦‚æœå…¶å®ƒå‚ä¸è€…éƒ½åœ¨READYï¼Œæ‰€æœ‰å‚ä¸è€…å¿…é¡»é•¿æ—¶é—´å¤„äºé˜»å¡çŠ¶æ€ï¼Œç­‰å¾…å´©æºƒçš„åè°ƒè€…é‡æ–°å¯åŠ¨ã€‚è¿™ç§æƒ…å½¢å°±æ˜¯ä¸Šæ–‡æåˆ°çš„<strong>2PCæ— æ³•è§£å†³çš„ä¸€ç§é•¿æ—¶é˜»å¡çŠ¶æ€</strong>ã€‚</p>
<p>ä¸‰é˜¶æ®µæäº¤åè®®ï¼ˆ3PCï¼‰æ˜¯å­¦æœ¯ç•Œæå‡ºçš„ç”¨æ¥è§£å†³2PCåè®®å­˜åœ¨é•¿æ—¶é˜»å¡çš„åŠæ³•ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯å°†2PCçš„æäº¤é˜¶æ®µå†æ¬¡ç»†åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼šé¢„æäº¤é˜¶æ®µå’Œæäº¤é˜¶æ®µã€‚</p>
<p>![[file-20250910191727851.jpg|400]]<br>![[file-20250910191735909.jpg|400]]</p>
<p>è¯¥åè®®çš„æœ¬è´¨åœ¨äºé€šè¿‡å¼•å…¥PRECOMMITçŠ¶æ€ï¼Œä½¿å¾—åè°ƒè€…å’Œæ¯ä¸ªå‚ä¸è€…éƒ½æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ã€‚<br><strong>æ¡ä»¶ä¸€</strong>ï¼šæ²¡æœ‰ä¸€ä¸ªå¯ä»¥ç›´æ¥è½¬æ¢åˆ°COMMITæˆ–è€…ABORTçŠ¶æ€çš„å•ç‹¬çŠ¶æ€ï¼ˆ2PCä¸­ï¼Œåè°ƒè€…çš„WAITçŠ¶æ€å’Œå‚ä¸è€…çš„READYçŠ¶æ€å°±æ˜¯è¿™ç§å•ç‹¬çŠ¶æ€ï¼‰ã€‚<br><strong>æ¡ä»¶äºŒ</strong>ï¼šä¸å­˜åœ¨è¿™æ ·ä¸€ä¸ªçŠ¶æ€ï¼Œå³å®ƒä¸èƒ½åšå‡ºæœ€åå†³å®šï¼Œè€Œä¸”å¯ä»¥ä»å®ƒç›´æ¥è½¬åˆ°COMMITçŠ¶æ€ï¼ˆ2PCä¸­ï¼Œåè°ƒè€…çš„WAITçŠ¶æ€å’Œå‚ä¸è€…çš„READYçŠ¶æ€å°±æ˜¯è¿™ç§çŠ¶æ€ã€‚3PCä¸­çš„PRECOMMITçŠ¶æ€å¯ç›´æ¥è½¬åˆ°COMMITçŠ¶æ€ï¼Œä½†æ˜¯å®ƒå·²ç»åšå‡ºäº†æäº¤å†³å®šï¼‰ã€‚</p>
<p>è¿™ä¸¤ä¸ªæ¡ä»¶æ˜¯ä½¿å¾—æäº¤åè®®ä¸é˜»å¡çš„å……è¦æ¡ä»¶ã€‚3PCåœ¨å®é™…ç³»ç»Ÿä¸­å¾ˆå°‘ä½¿ç”¨ï¼Œä¸€æ–¹é¢æ˜¯ç”±äº2PCä¸­é•¿æ—¶é˜»å¡æƒ…å†µå¾ˆå°‘å‘ç”Ÿï¼Œå¦å¤–ä¸€æ–¹é¢æ˜¯3PCæ•ˆç‡è¿‡ä½ã€‚</p>
<h3 id="å‘é‡æ—¶é’Ÿ"><a href="#å‘é‡æ—¶é’Ÿ" class="headerlink" title="å‘é‡æ—¶é’Ÿ"></a>å‘é‡æ—¶é’Ÿ</h3><p>å‘é‡æ—¶é’Ÿæ˜¯åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ç”Ÿæˆäº‹ä»¶ä¹‹é—´ååºå…³ç³»çš„ç®—æ³•ï¼Œååºå…³ç³»ä»£è¡¨äº‹ä»¶å‘ç”Ÿå…ˆåé¡ºåºå¯¼è‡´çš„äº‹ä»¶é—´å› æœä¾èµ–å…³ç³»è¯­ä¹‰ï¼Œé€šè¿‡å°†æ—¶é—´æˆ³å’Œäº‹ä»¶ç»‘å®šå¯ä»¥ç”¨æ¥åˆ¤å®šäº‹ä»¶ä¹‹é—´çš„å› æœç›¸å…³æ€§ã€‚</p>
<p>è®¾åˆ†å¸ƒå¼ç³»ç»Ÿæœ‰Aã€Bå’ŒCè¿™3ä¸ªè¿›ç¨‹ï¼Œæ ¹æ®ä¸Šè¿°è§„åˆ™å…¶å„è‡ªå¯¹åº”çš„é€»è¾‘æ—¶é’Ÿéšç€æ—¶é—´æ¼”åŒ–æƒ…å†µå¦‚å›¾æ‰€ç¤ºã€‚<br>![[file-20250910193411653.jpg|600]]<br>å‘é‡æ—¶é’Ÿçš„å…¸å‹åº”ç”¨åœºæ™¯æ˜¯ç”¨æ¥åˆ¤æ–­åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ä¸åŒäº‹ä»¶ä¹‹é—´æ˜¯å¦å­˜åœ¨å› æœå…³ç³»ã€‚å¯¹äºä¸¤ä¸ªäº‹ä»¶E<br> å’ŒFï¼Œå‡è®¾å…¶å„è‡ªçš„å‘é‡æ—¶é’Ÿåˆ†åˆ«æ˜¯E.VCå’ŒF.VCï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®å¦‚ä¸‹æ–¹æ³•åˆ¤æ–­å…¶æ˜¯å¦å­˜åœ¨å› æœå…³ç³»ï¼š<br> ![[file-20250910193536308.jpg]]<br> å³å¦‚æœäº‹ä»¶Eçš„æ—¶é’Ÿå‘é‡å„ä¸ªç»´åº¦çš„æ•°å€¼éƒ½å°äºç­‰äºäº‹ä»¶Få¯¹åº”ä½ç½®çš„æ•°å€¼ä¸”è‡³å°‘æœ‰ä¸€ä½æ˜¯å°äºï¼Œé‚£ä¹ˆå¯ä»¥ç§°ä¸ºäº‹ä»¶Eæ˜¯äº‹ä»¶Fçš„åŸå› ï¼Œäº‹ä»¶Fæ˜¯äº‹ä»¶Eçš„ç»“æœã€‚</p>
<p>Dynamoä¸­ä½¿ç”¨å‘é‡æ—¶é’Ÿè¿›è¡Œæ•°æ®ç‰ˆæœ¬ç®¡ç†ï¼Œé…åˆRWNåè®®å…±åŒå®Œæˆæ•°æ®ä¸€è‡´æ€§ç»´æŠ¤ã€‚</p>
<h3 id="RWNåè®®"><a href="#RWNåè®®" class="headerlink" title="RWNåè®®"></a>RWNåè®®</h3><p>â€œRWNåè®®â€æ˜¯äºšé©¬é€Šå…¬å¸åœ¨å®ç°Dynamo KVå­˜å‚¨ç³»ç»Ÿæ—¶æå‡ºçš„ã€‚è¿™æ˜¯ä¸€ç§é€šè¿‡å¯¹åˆ†å¸ƒå¼ç¯å¢ƒ<br> ä¸‹å¤šå¤‡ä»½æ•°æ®å¦‚ä½•è¯»ï¼å†™æˆåŠŸè¿›è¡Œé…ç½®æ¥ä¿è¯è¾¾åˆ°æ•°æ®ä¸€è‡´æ€§çš„ç®€æ˜åˆ†æå’Œçº¦æŸè®¾ç½®ã€‚</p>
<ul>
<li>Nï¼šåœ¨åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿä¸­ï¼Œæœ‰å¤šå°‘ä»½å¤‡ä»½æ•°æ®ã€‚</li>
<li>Wï¼šä»£è¡¨ä¸€æ¬¡æˆåŠŸçš„æ›´æ–°æ“ä½œè¦æ±‚è‡³å°‘æœ‰Wä»½æ•°æ®å†™å…¥æˆåŠŸã€‚</li>
<li>Rï¼šä»£è¡¨ä¸€æ¬¡æˆåŠŸçš„è¯»æ“ä½œè¦æ±‚è‡³å°‘æœ‰Rä»½æ•°æ®æˆåŠŸè¯»å–ã€‚</li>
</ul>
<p>å¦‚æœR+W&gt;Nï¼Œåˆ™æ»¡è¶³â€œæ•°æ®ä¸€è‡´æ€§åè®®â€ã€‚æˆåŠŸå†™å…¥çš„å¤‡ä»½é›†åˆå’ŒæˆåŠŸè¯»å–çš„å¤‡ä»½é›†åˆä¸€å®šä¼šå­˜åœ¨äº¤é›†ï¼Œè€Œè¿™å°±å¯ä»¥ä¿è¯æ•°æ®çš„å¼ºä¸€è‡´æ€§ï¼Œå³è¯»å–æ“ä½œä¸€å®šå¯ä»¥è¯»åˆ°æœ€æ–°çš„æ•°æ®ç‰ˆæœ¬ã€‚<br>![[file-20250910194226349.jpg|400]]</p>
<p>åœ¨æ»¡è¶³æ•°æ®ä¸€è‡´æ€§åè®®çš„å‰æä¸‹ï¼ŒRæˆ–è€…Wè®¾ç½®å¾—è¶Šå¤§ï¼Œåˆ™ç³»ç»Ÿå»¶è¿Ÿè¶Šå¤§ï¼Œå› ä¸ºè¿™å–å†³äºæœ€æ…¢çš„é‚£ä»½å¤‡ä»½æ•°æ®çš„å“åº”æ—¶é—´ã€‚è€Œå¦‚æœR+W &lt;&#x3D;Nï¼Œåˆ™æ— æ³•ä¿è¯æ•°æ®çš„å¼ºä¸€è‡´æ€§.</p>
<p>åœ¨å…·ä½“å®ç°ç³»ç»Ÿæ—¶ï¼Œä»…ä»…ä¾é RWNåè®®è¿˜ä¸èƒ½å®Œæˆä¸€è‡´æ€§ä¿è¯ï¼Œå› ä¸ºåœ¨ä¸Šè¿°è¿‡ç¨‹ä¸­ï¼Œå½“è¯»å–åˆ°å¤šä¸ªå¤‡ä»½æ•°æ®æ—¶ï¼Œéœ€è¦åˆ¤æ–­å“ªäº›æ•°æ®æ˜¯æœ€æ–°çš„ï¼Œå¦‚ä½•åˆ¤æ–­æ•°æ®çš„æ–°æ—§ï¼Ÿè¿™éœ€è¦å‘é‡æ—¶é’Ÿæ¥é…åˆã€‚</p>
<h3 id="Paxosåè®®"><a href="#Paxosåè®®" class="headerlink" title="Paxosåè®®"></a>Paxosåè®®</h3><p>â€œæ‰€æœ‰ä¸€è‡´æ€§åè®®æœ¬è´¨ä¸Šè¦ä¹ˆæ˜¯Paxosï¼Œè¦ä¹ˆæ˜¯å…¶å˜ä½“â€</p>
<p>Paxosçš„éš¾ç†è§£æ€§åœ¨äºæ˜¯ä»€ä¹ˆå› ç´ å¯¼è‡´åè®®ä»¥æ­¤ç§æ–¹å¼å‘ˆç°ä»¥åŠå…¶æ­£ç¡®æ€§è¯æ˜è¿‡ç¨‹è€Œéæœ€ç»ˆåè®®å†…å®¹æœ¬èº«.</p>
<p>é¦–å…ˆä»‹ç»å‰¯æœ¬çŠ¶æ€æœºæ¨¡å‹ï¼Œä¹‹åä»‹ç»Paxosçš„ä¸€äº›åŸºæœ¬æ¦‚å¿µï¼Œç„¶åæè¿°Paxosåè®®æœ¬èº«å†…å®¹ã€‚</p>
<p><strong>å‰¯æœ¬çŠ¶æ€æœºæ¨¡å‹</strong>ï¼ˆReplicated State Machinesï¼‰</p>
<p>åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼Œä¸€è‡´æ€§åè®®çš„åº”ç”¨åœºæ™¯ä¸€èˆ¬ä¼šé‡‡ç”¨å‰¯æœ¬çŠ¶æ€æœºæ¥è¡¨è¾¾ï¼Œè¿™æ˜¯å¯¹å„ç§ä¸åŒåº”ç”¨åœºæ™¯çš„ä¸€ç§æŠ½è±¡åŒ–è¡¨è¿°ã€‚</p>
<p>![[file-20250910195324044.jpg|500]]<br>é›†ç¾¤ä¸­å¤šå°æœåŠ¡å™¨å„è‡ªä¿å­˜ä¸€ä»½Logå‰¯æœ¬åŠå†…éƒ¨çŠ¶æ€æœºï¼ŒLogå†…é¡ºåºè®°è½½å®¢æˆ·ç«¯å‘æ¥çš„æ“ä½œæŒ‡ä»¤ï¼ŒæœåŠ¡å™¨ä¾æ¬¡æ‰§è¡ŒLogå†…çš„æŒ‡ä»¤å¹¶å°†å…¶ä½“ç°åˆ°å†…éƒ¨çŠ¶æ€æœºä¸Šï¼Œå¦‚æœä¿è¯æ¯å°æœºå™¨å†…çš„Logå‰¯æœ¬å†…å®¹å®Œå…¨ä¸€è‡´ï¼Œé‚£ä¹ˆå¯¹åº”çš„çŠ¶æ€æœºä¹Ÿå¯ä»¥ä¿è¯æ•´ä½“çŠ¶æ€ä¸€è‡´ã€‚ä¸€è‡´æ€§åè®®çš„ä½œç”¨å°±æ˜¯ä¿è¯å„ä¸ªLogå‰¯æœ¬æ•°æ®çš„ä¸€è‡´æ€§ã€‚</p>
<p>è¿½æ±‚ä¸‰ä¸ªç‰¹æ€§ï¼š</p>
<ul>
<li>å®‰å…¨æ€§ï¼ˆSafetyï¼‰ä¿è¯ï¼šå³éæ‹œå åº­æ¨¡å‹ï¼ˆæ­¤æ¦‚å¿µå‚è€ƒåé¢çš„å†…å®¹ï¼‰ä¸‹ï¼ŒçŠ¶æ€æœºä»ä¸è¿”å›é”™è¯¯çš„ç»“æœï¼Œå¤šä¸ªæè®®ä¸­åªä¼šæœ‰ä¸€ä¸ªè¢«é€‰ä¸­ã€‚</li>
<li>å¯ç”¨æ€§ï¼ˆAvailableï¼‰ä¿è¯ï¼šåªè¦å¤§å¤šæ•°æœåŠ¡å™¨æ­£å¸¸ï¼Œåˆ™æ•´ä¸ªæœåŠ¡ä¿æŒå¯ç”¨ã€‚æ¯”å¦‚å‰¯æœ¬çŠ¶æ€æœºæœ‰5å°æœåŠ¡å™¨ï¼Œé‚£ä¹ˆæœ€å¤šå¯ä»¥å®¹å¿2å°æœåŠ¡å™¨å‘ç”Ÿæ•…éšœï¼Œæ­¤æ—¶æ•´ä¸ªæœåŠ¡ä»ç„¶å¯ç”¨ï¼Œå³å¯¹äº2f+1å°å‰¯æœ¬çŠ¶æ€æœºçš„é…ç½®ï¼Œæœ€å¤šå¯å®¹å¿fä¸ªçŠ¶æ€æœºå¤±æ•ˆã€‚</li>
<li>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¤§å¤šæ•°çŠ¶æ€æœºç»´æŠ¤Logä¸€è‡´å³å¯å¿«é€Ÿé€šçŸ¥å®¢æˆ·ç«¯æ“ä½œæˆåŠŸï¼Œè¿™æ ·é¿å…äº†å°‘æ•°æœ€æ…¢çš„çŠ¶æ€æœºæ‹–æ…¢æ•´ä¸ªè¯·æ±‚å“åº”é€Ÿåº¦ã€‚</li>
</ul>
<p>**PaxosåŸºæœ¬æ¦‚å¿µ</p>
<p>åˆ†ä¸ºä¸¤ç§ï¼šå•Paxosï¼ˆSingle-Decree Paxosï¼‰å’Œå¤šPaxosï¼ˆMulti-Paxosï¼‰</p>
<ul>
<li>å•Paxosï¼Œå³å‰¯æœ¬çŠ¶æ€æœºä¸­å„ä¸ªæœåŠ¡å™¨ é’ˆå¯¹Logä¸­å›ºå®šæŸä¸ªä½ç½®çš„æ“ä½œå‘½ä»¤é€šè¿‡åè®®è¾¾æˆä¸€è‡´ï¼Œå› ä¸ºå¯èƒ½æŸä¸€æ—¶åˆ»ä¸åŒæœåŠ¡å™¨çš„Logä¸­ç›¸åŒä½ç½®çš„æ“ä½œå‘½ä»¤æ˜¯ä¸ä¸€æ ·çš„ï¼Œé€šè¿‡æ‰§è¡Œåè®®åä½¿å¾—å„ä¸ªæœåŠ¡å™¨å¯¹åº”æŸä¸ªå›ºå®šä½ç½®çš„æ“ä½œå‘½ä»¤è¾¾æˆä¸€è‡´ã€‚</li>
<li>å¤šPaxosåˆ™æ˜¯æŒ‡è¿™äº›æœåŠ¡å™¨å¯¹åº”çš„Logå†…å®¹ä¸­å¤šä¸ªä½ç½®çš„æ“ä½œå‘½ä»¤åºåˆ—é€šè¿‡åè®®ä¿æŒä¸€è‡´ã€‚å¤šPaxoså¾€å¾€æ˜¯åŒæ—¶è¿è¡Œçš„å¤šä¸ªå•Paxosåè®®å…±åŒæ‰§è¡Œçš„ç»“æœã€‚</li>
</ul>
<p>Paxosåè®®ä¸‹ä¸åŒå¹¶è¡Œè¿›ç¨‹å¯èƒ½æ‰¿æ‹…çš„3ç§è§’è‰²å¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>å€¡è®®è€…</strong>ï¼šå€¡è®®è€…å¯ä»¥æå‡ºæè®®ï¼ˆæ•°å€¼æˆ–æ“ä½œå‘½ä»¤ç­‰ï¼‰ä»¥ä¾›æŠ•ç¥¨è¡¨å†³ã€‚</li>
<li><strong>æ¥å—è€…</strong>ï¼šæ¥å—è€…å¯ä»¥å¯¹å€¡è®®è€…æå‡ºçš„æè®®è¿›è¡ŒæŠ•ç¥¨è¡¨å†³ï¼Œä»ä¼—å¤šæè®®ä¸­é€‰å‡ºå”¯ä¸€ç¡®å®šçš„ä¸€ä¸ªã€‚</li>
<li><strong>å­¦ä¹ è€…</strong>ï¼šå­¦ä¹ è€…æ— å€¡è®®æŠ•ç¥¨æƒï¼Œä½†æ˜¯å¯ä»¥ä»æ¥å—è€…é‚£é‡Œè·çŸ¥æ˜¯å“ªä¸ªæè®®æœ€ç»ˆè¢«é€‰ä¸­ã€‚</li>
</ul>
<p>åœ¨ä¸€è‡´æ€§åè®®æ¡†æ¶ä¸­ï¼Œä¸€ä¸ªå¹¶è¡Œè¿›ç¨‹å¯ä»¥åŒæ—¶æ‰¿æ‹…ä»¥ä¸Šå¤šç§è§’è‰²ã€‚</p>
<p>Paxosåè®®ä»¥åŠå¾ˆå¤šä¸€è‡´æ€§åè®®éƒ½æ˜¯åŸºäºéæ‹œå åº­æ¨¡å‹çš„ï¼Œå³åœ¨éæ‹œå åº­æ¡ä»¶ä¸‹ï¼ŒPaxosåè®®å¯ä»¥å°±ä¸åŒæè®®è¾¾æˆä¸€è‡´ï¼Œè€Œåœ¨æ‹œå åº­æ¨¡å‹ä¸‹æƒ…å†µä¼šæ›´åŠ å¤æ‚ä¸€äº›ã€‚</p>
<p>**Paxosä¸€è‡´æ€§åè®®</p>
<ul>
<li><strong>é˜¶æ®µä¸€ï¼š</strong><ol>
<li>ã€å€¡è®®è€…è§†è§’ã€‘å€¡è®®è€…é€‰æ‹©å€¡è®®ç¼–å·nï¼Œç„¶åå‘å¤§å¤šæ•°ï¼ˆå³è¶…è¿‡åŠæ•°ä»¥ä¸Šï¼‰æ¥å—è€…å‘é€Prepareè¯·æ±‚ï¼Œè¯·æ±‚ä¸­é™„å¸¦å€¡è®®ç¼–å·n</li>
<li>ã€æ¥å—è€…è§†è§’ã€‘å¯¹äºæŸä¸ªæ¥å—è€…æ¥è¯´ï¼Œå¦‚æœæ¥æ”¶åˆ°å¸¦æœ‰å€¡è®®ç¼–å·nçš„Prepareè¯·æ±‚ï¼Œåˆ™åšå¦‚ä¸‹åˆ¤æ–­ï¼šè‹¥å€¡è®®ç¼–å·næ¯”æ­¤æ¥å—è€…ä¹‹å‰å“åº”è¿‡çš„ä»»ä½•å…¶ä»–Prepareè¯·æ±‚é™„å¸¦çš„å€¡è®®ç¼–å·éƒ½å¤§ï¼Œé‚£ä¹ˆæ­¤æ¥å—è€…ä¼šç»™å€¡è®®è€…ä»¥å“åº”ï¼Œå¹¶æ‰¿è¯ºä¸ä¼šå“åº”ä¹‹åæ¥æ”¶åˆ°çš„å…¶ä»–ä»»ä½•å€¡è®®ç¼–å·å°äºnçš„è¯·æ±‚ï¼Œå¦å¤–ï¼Œå¦‚æœæ¥å—è€…æ›¾ç»å“åº”è¿‡2.2é˜¶æ®µçš„Acceptè¯·æ±‚ï¼Œåˆ™å°†æ‰€æœ‰å“åº”çš„Acceptè¯·æ±‚ä¸­å€¡è®®ç¼–å·æœ€é«˜çš„å€¡è®®å†…å®¹å‘é€ç»™å€¡è®®è€…ï¼Œå€¡è®®å†…å®¹åŒ…æ‹¬ä¸¤é¡¹ä¿¡æ¯ï¼šAcceptè¯·æ±‚ä¸­çš„å€¡è®®ç¼–å·ä»¥åŠå…¶å€¡è®®å€¼ã€‚è‹¥å€¡è®®ç¼–å·nä¸æ¯”æ­¤æ¥å—è€…ä¹‹å‰å“åº”è¿‡çš„ä»»ä½•å…¶ä»–Prepareè¯·æ±‚é™„å¸¦çš„å€¡è®®ç¼–å·éƒ½å¤§ï¼Œé‚£ä¹ˆæ­¤æ¥å—è€…ä¸ä¼šç»™å€¡è®®è€…ä»¥å“åº”ã€‚</li>
</ol>
</li>
<li><strong>é˜¶æ®µäºŒï¼š</strong><ol>
<li>ã€å€¡è®®è€…è§†è§’ã€‘å¦‚æœå€¡è®®è€…æ¥æ”¶åˆ°å¤§å¤šæ•°æ¥å—è€…å…³äºå¸¦æœ‰å€¡è®®ç¼–å·nçš„Prepareè¯·æ±‚çš„å“åº”ï¼Œé‚£ä¹ˆå€¡è®®è€…å‘è¿™äº›æ¥å—è€…å‘é€Acceptè¯·æ±‚ï¼ŒAcceptè¯·æ±‚é™„å¸¦ä¸¤ä¸ªä¿¡æ¯ï¼šå€¡è®®ç¼–å·nä»¥åŠå€¡è®®å€¼vã€‚å€¡è®®å€¼vçš„é€‰æ‹©æ–¹å¼å¦‚ä¸‹ï¼šå¦‚æœåœ¨1.2é˜¶æ®µæ¥å—è€…è¿”å›äº†è‡ªå·±æ›¾ç»æ¥æ”¶çš„å…·æœ‰æœ€é«˜å€¡è®®ç¼–å·Acceptè¯·æ±‚å€¡è®®å†…å®¹ï¼Œåˆ™ä»è¿™äº›å€¡è®®å†…å®¹é‡Œé¢é€‰æ‹©å€¡è®®ç¼–å·æœ€é«˜çš„å¹¶å°†å…¶å€¡è®®å€¼ä½œä¸ºå€¡è®®å€¼vï¼›å¦‚æœ1.2é˜¶æ®µæ²¡æœ‰æ”¶åˆ°ä»»ä½•æ¥å—è€…çš„Acceptè¯·æ±‚å€¡è®®å†…å®¹ï¼Œåˆ™å¯ä»¥ä»»æ„èµ‹å€¼ç»™å€¡è®®å€¼vã€‚</li>
<li>ã€æ¥å—è€…è§†è§’ã€‘å¦‚æœæ¥å—è€…æ¥æ”¶åˆ°äº†ä»»æ„å€¡è®®ç¼–å·ä¸ºnçš„Acceptè¯·æ±‚ï¼Œåˆ™æ¥å—è€…æ¥å—æ­¤è¯·æ±‚ï¼Œé™¤éåœ¨æ­¤æœŸé—´æ¥å—è€…å“åº”è¿‡å…·æœ‰æ¯”næ›´é«˜ç¼–å·çš„Prepareè¯·æ±‚ã€‚</li>
</ol>
</li>
</ul>
<p>å¯¹äºå­¦ä¹ è€…æ¥è¯´ï¼Œå…¶éœ€è¦ä»æ¥å—è€…é‚£é‡Œè·çŸ¥åˆ°åº•æ˜¯å“ªä¸ªå€¡è®®å€¼è¢«é€‰å‡ºã€‚ä¸€ä¸ªç›´è§‚çš„æ–¹æ³•å¦‚ä¸‹ï¼šæ¯å½“æ¥å—è€…æ‰§è¡Œå®Œ2.2æ­¥éª¤ï¼Œå³æ¥å—æŸä¸ªAcceptè¯·æ±‚åï¼Œç”±å…¶é€šçŸ¥æ‰€æœ‰å­¦ä¹ è€…å…¶æ‰€æ¥å—çš„å€¡è®®ï¼Œè¿™æ ·ï¼Œå­¦ä¹ è€…å¾ˆå¿«ä¹ å¾—æ˜¯å“ªä¸ªå€¡è®®è¢«æœ€ç»ˆé€‰å‡ºã€‚æœ‰é€šè®¯æˆæœ¬ï¼Œå¯ä»¥é€‰å‡ºè‹¥å¹²å­¦ä¹ è€…ä½œä¸ºä»£è¡¨ï¼Œç”±è¿™äº›ä»£è¡¨ä»æ¥å—è€…é‚£é‡Œè·çŸ¥æœ€ç»ˆå€¡è®®å€¼ï¼Œç„¶åé€šçŸ¥å…¶ä»–å­¦ä¹ è€…ã€‚</p>
<p>é€šè¿‡ä»¥ä¸Šæµç¨‹ï¼Œå¦‚æœæœ‰å¤šä¸ªå¹¶å‘è¿›ç¨‹æå‡ºå„è‡ªçš„å€¡è®®å€¼ï¼ŒPaxoså°±å¯ä»¥ä¿è¯ä»ä¸­é€‰å‡ºä¸”åªé€‰å‡ºä¸€ä¸ªå”¯ä¸€ç¡®å®šçš„å€¡è®®å€¼ï¼Œä»¥æ­¤æ¥è¾¾åˆ°å‰¯æœ¬çŠ¶æ€æœºä¿æŒçŠ¶æ€ä¸€è‡´çš„ç›®æ ‡ã€‚</p>
<h3 id="Raftåè®®"><a href="#Raftåè®®" class="headerlink" title="Raftåè®®"></a>Raftåè®®</h3><p>Raftä¸€è‡´æ€§åè®®æœ€ä¸»è¦çš„ç›®æ ‡æœ‰ä¸¤ä¸ªï¼š</p>
<ul>
<li>é¦–å…ˆæ˜¯å¯ç†è§£æ€§ï¼Œåœ¨åšæŠ€æœ¯å†³ç­–å’Œé€‰å‹çš„æ—¶å€™ï¼Œåœ¨è¾¾åˆ°ç›¸ä¼¼åŠŸèƒ½å‰æä¸‹ï¼Œé¦–å…ˆä»¥æ˜“äºç†è§£ä½œä¸ºé€‰å‹æ ‡å‡†ï¼›</li>
<li>å…¶æ¬¡æ˜¯å®ç°å®é™…ç³»ç»Ÿçš„ç¡®å®šæ€§ï¼Œé‰´äºä¹‹å‰æåˆ°çš„æ ¹æ®Paxoså®ç°å…·ä½“ç³»ç»Ÿæ—¶çš„ä¸ç»Ÿä¸€ï¼ŒRaftè¿½æ±‚æ¯ä¸ªæŠ€æœ¯ç»†èŠ‚çš„æ¸…æ™°ç•Œå®šä¸æè¿°ï¼Œä»¥æ­¤è¾¾åˆ°å®ç°å…·ä½“ç³»ç»Ÿæ—¶çš„æ˜ç¡®æ€§ã€‚</li>
</ul>
<p>ä¸ºäº†è¾¾åˆ°ä¸Šè¿°ä¸¤ä¸ªç›®çš„ï¼Œä¸»è¦é‡‡å–äº†ä»¥ä¸‹ä¸¤ä¸ªæ‰‹æ®µï¼š</p>
<ul>
<li>å°†æ•´ä¸ªä¸€è‡´æ€§åè®®åˆ’åˆ†æˆæ˜ç¡®ä¸”ç‹¬ç«‹çš„3ä¸ªå­é—®é¢˜ï¼Œå³é‡‡å–åˆ†è§£æ³•ã€‚Raftå°†æ•´ä¸ªä¸€è‡´æ€§åè®®åˆ’åˆ†ä¸ºé¢†å¯¼è€…é€‰ä¸¾ã€Logå¤åˆ¶ä¸å®‰å…¨æ€§3ä¸ªé—®é¢˜ã€‚</li>
<li>å°†Paxosçš„P2Pæ¨¡å¼æ”¹é€ ä¸ºMaster-Slaveæ¨¡å¼ã€‚Paxosçš„å¤æ‚æ€§å¾ˆå¤§åŸå› æ˜¯ç”±äºå…¶å®Œå…¨çš„P2Pæ¨¡å¼é€ æˆçš„ï¼Œå³å¤šä¸ªå¹¶å‘è¿›ç¨‹ä¹‹é—´æ— ä¸»æ¬¡å…³ç³»ï¼Œéƒ½å…·æœ‰åŒç­‰åœ°ä½ã€‚</li>
</ul>
<p>**RaftåŸºæœ¬æ¦‚å¿µ</p>
<p>é¦–å…ˆæ˜¯æœåŠ¡å™¨çŠ¶æ€ï¼Œåœ¨ä»»æ„æ—¶åˆ»ï¼Œé›†ç¾¤ä¸­çš„æœåŠ¡å™¨åªèƒ½å¤„äºä»¥ä¸‹3ç§çŠ¶æ€ä¹‹ä¸€ï¼šLeaderã€Followerå’ŒCandidateã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼Œé›†ç¾¤ä¸­åªæœ‰ä¸€ä¸ªå¤„äºLeaderçŠ¶æ€çš„æœåŠ¡å™¨å……å½“é¢†å¯¼è€…ï¼Œç”±å…¶æ¥è´Ÿè´£å“åº”æ‰€æœ‰å®¢æˆ·ç«¯è¯·æ±‚ï¼Œå…¶ä»–æœåŠ¡å™¨éƒ½å¤„äºFollowerçŠ¶æ€ã€‚å¤„äºFollowerçŠ¶æ€çš„æœåŠ¡å™¨éƒ½æ˜¯è¢«åŠ¨æ¥æ”¶RPCæ¶ˆæ¯ï¼Œä»ä¸ä¼šä¸»åŠ¨å‘é€ä»»ä½•RPCæ¶ˆæ¯ã€‚CandidateçŠ¶æ€æ˜¯FollowerçŠ¶æ€æœåŠ¡å™¨å‡†å¤‡å‘èµ·æ–°çš„é¢†å¯¼è€…é€‰ä¸¾å‰éœ€è¦è½¬æ¢åˆ°çš„çŠ¶æ€ï¼Œå³CandidateçŠ¶æ€æ˜¯Followerå‘LeaderçŠ¶æ€è½¬æ¢çš„ä¸­é—´çŠ¶æ€ã€‚</p>
<p>![[file-20250910201124581.jpg]]</p>
<p>Raftå°†æ•´ä¸ªç³»ç»Ÿæ‰§è¡Œæ—¶é—´åˆ’åˆ†ä¸ºç”±è‹¥å¹²ä¸ªä¸åŒæ—¶é—´é—´éš”é•¿åº¦çš„æ—¶é—´ç‰‡æ®µæ„æˆçš„åºåˆ—ï¼Œæ¯ä¸ªæ—¶é—´ç‰‡æ®µè¢«ç§°ä¸ºä¸€ä¸ªTermï¼Œä»¥é€’å¢çš„æ•°å­—æ¥ä½œä¸ºè¿™ä¸ªTermçš„æ ‡è¯†ã€‚æ¯ä¸ªTermç”±â€œé€‰ä¸¾æœŸé—´â€ï¼ˆElectionï¼‰å¼€å§‹ï¼Œåœ¨è¿™ä¸ªæ—¶é—´å†…è‹¥å¹²å¤„äºCandidateçŠ¶æ€çš„æœåŠ¡å™¨è¯•å›¾ç«äº‰æˆä¸ºæ–°çš„é¢†å¯¼è€…ã€‚å¦‚æœæŸä¸ªæœåŠ¡å™¨èµ¢å¾—äº†é€‰ä¸¾ï¼Œåˆ™åœ¨è¿™ä¸ªTermæ¥ä¸‹æ¥çš„æ—¶é—´é‡Œå……å½“æ–°çš„é¢†å¯¼è€…ã€‚</p>
<p>![[file-20250910201216917.jpg]]</p>
<p>**Raftä¸€è‡´æ€§åè®®</p>
<ul>
<li><strong>é¢†å¯¼è€…é€‰ä¸¾</strong>ï¼šRafté‡‡ç”¨å¿ƒè·³æœºåˆ¶æ¥è§¦å‘é¢†å¯¼è€…é€‰ä¸¾è¿‡ç¨‹ã€‚å½“æ•´ä¸ªç³»ç»Ÿå¯åŠ¨æ—¶ï¼Œæ‰€æœ‰æœåŠ¡å™¨å¤„äºFollowerçŠ¶æ€ï¼Œé™¤éæœåŠ¡å™¨æ¥æ”¶åˆ°å¤„äºLeaderæˆ–è€…CandidateçŠ¶æ€æœåŠ¡å™¨å‘å‡ºçš„RPCå‘½ä»¤ï¼Œå¦åˆ™å…¶ä¸€ç›´ç»´æŒè¿™ä¸ªçŠ¶æ€ä¸å˜ã€‚Leaderé€šè¿‡å‘¨æœŸæ€§åœ°å‘å…¶ä»–æœåŠ¡å™¨å‘é€å¿ƒè·³æ¥å®£å‘Šå¹¶ä¿æŒå…¶é¢†å¯¼è€…åœ°ä½ã€‚<br>  åœ¨å¼€å§‹é€‰ä¸¾å‰ï¼ŒFollowerå¢åŠ å…¶Termç¼–å·å¹¶è½¬å…¥CandidateçŠ¶æ€ã€‚ç„¶åå…¶å‘é›†ç¾¤å†…æ‰€æœ‰å…¶ä»–æœåŠ¡å™¨å‘å‡ºRequestVote RPCæ¶ˆæ¯ï¼Œä¹‹åä¸€ç›´å¤„äºCandidateçŠ¶æ€ï¼Œé™¤éä»¥ä¸‹æƒ…å†µä¹‹ä¸€å‘ç”Ÿã€‚<ul>
<li>èµ¢å¾—äº†æœ¬æ¬¡é€‰ä¸¾</li>
<li>å¦å¤–ä¸€ä¸ªæœåŠ¡å™¨Så®£ç§°å¹¶ç¡®è®¤è‡ªå·±æ˜¯æ–°çš„é¢†å¯¼è€…ï¼›</li>
<li>ç»è¿‡ä¸€å®šæ—¶é—´åï¼Œä»ç„¶æ²¡æœ‰æ–°çš„é¢†å¯¼è€…äº§ç”Ÿ</li>
</ul>
</li>
<li><strong>Logå¤åˆ¶</strong>ï¼šå½“é€‰å‡ºé¢†å¯¼è€…åï¼Œä¹‹åæ‰€æœ‰å®¢æˆ·ç«¯è¯·æ±‚éƒ½ç”±é¢†å¯¼è€…æ¥è´Ÿè´£å“åº”ã€‚é¢†å¯¼è€…æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„æ“ä½œå‘½ä»¤åï¼Œå°†å…¶ä½œä¸ºæ–°é¡¹ç›®è¿½åŠ åˆ°Logå°¾éƒ¨ï¼Œç„¶åå‘é›†ç¾¤å†…æ‰€æœ‰å…¶ä»–æœåŠ¡å™¨å‘å‡ºAppendEntries RPCè¯·æ±‚ï¼Œè¿™å¼•å‘å…¶ä»–æœåŠ¡å™¨å¤åˆ¶æ–°çš„æ“ä½œå‘½ä»¤ã€‚å½“å…¶ä»–æœåŠ¡å™¨å®‰å…¨å¤åˆ¶äº†æ–°çš„æ“ä½œå‘½ä»¤åï¼Œé¢†å¯¼è€…å°†è¿™ä¸ªæ“ä½œå‘½ä»¤åº”ç”¨åˆ°å†…éƒ¨çŠ¶æ€æœºï¼Œå¹¶å°†æ‰§è¡Œç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚<br>  ![[file-20250910201547474.jpg|400]]</li>
<li><strong>å®‰å…¨æ€§</strong>ï¼šä»¥ä¸Šä¸¤ä¸ªæ­¥éª¤ï¼Œåœ¨ä¸€èˆ¬æƒ…å½¢ä¸‹Raftå·²ç»å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯ç›®å‰Raftè¿˜æ— æ³•åšåˆ°å®Œå…¨çš„å®‰å…¨æ€§ä¿è¯ï¼Œå³æ— æ³•ä¿è¯æ¯ä¸ªæœåŠ¡å™¨çš„çŠ¶æ€æœºéƒ½èƒ½å¤ŸæŒ‰ç…§ç›¸åŒé¡ºåºæ‰§è¡Œç›¸åŒæ“ä½œå‘½ä»¤ã€‚ä¸ºäº†è¾¾åˆ°çœŸæ­£çš„å®‰å…¨æ€§ï¼ŒRaftå¢åŠ äº†å¦‚ä¸‹ä¸¤ä¸ªçº¦æŸæ¡ä»¶ã€‚<ul>
<li>é™åˆ¶äº†å“ªäº›æœåŠ¡å™¨å¯ä»¥è¢«é€‰ä¸¾æˆä¸ºé¢†å¯¼è€…ï¼Œå…¶è¦æ±‚åªæœ‰å…¶LogåŒ…å«äº†æ‰€æœ‰å·²ç»æäº¤çš„æ“ä½œå‘½ä»¤çš„é‚£äº›æœåŠ¡å™¨æ‰æœ‰æƒè¢«é€‰ä¸¾ä¸ºæ–°çš„é¢†å¯¼è€…</li>
<li>é™åˆ¶äº†å“ªäº›æ“ä½œå‘½ä»¤çš„æäº¤å¯ä»¥è¢«è®¤ä¸ºæ˜¯çœŸæ­£çš„æäº¤ã€‚å¯¹äºæ–°é¢†å¯¼è€…æ¥è¯´ï¼Œåªæœ‰å®ƒè‡ªå·±å·²ç»æäº¤è¿‡å½“å‰Termçš„æ“ä½œå‘½ä»¤æ‰è¢«è®¤ä¸ºæ˜¯çœŸæ­£æäº¤ã€‚</li>
</ul>
</li>
</ul>
<h1 id="ç¬¬3ç« â€”â€”å¤§æ•°æ®å¸¸ç”¨çš„ç®—æ³•ä¸æ•°æ®ç»“æ„"><a href="#ç¬¬3ç« â€”â€”å¤§æ•°æ®å¸¸ç”¨çš„ç®—æ³•ä¸æ•°æ®ç»“æ„" class="headerlink" title="ç¬¬3ç« â€”â€”å¤§æ•°æ®å¸¸ç”¨çš„ç®—æ³•ä¸æ•°æ®ç»“æ„"></a>ç¬¬3ç« â€”â€”å¤§æ•°æ®å¸¸ç”¨çš„ç®—æ³•ä¸æ•°æ®ç»“æ„</h1><h2 id="å¸ƒéš†è¿‡æ»¤å™¨"><a href="#å¸ƒéš†è¿‡æ»¤å™¨" class="headerlink" title="å¸ƒéš†è¿‡æ»¤å™¨"></a>å¸ƒéš†è¿‡æ»¤å™¨</h2><p>Bloom Filterï¼ˆä¸ºäº†è¡¨è¾¾æ–¹ä¾¿ï¼Œåæ–‡ç®€ç§°BFï¼‰å°±æ˜¯å¸¸è¯´çš„å¸ƒéš†è¿‡æ»¤å™¨ï¼Œæ˜¯ç”±Howard Bloomåœ¨1970å¹´æå‡ºçš„äºŒè¿›åˆ¶å‘é‡æ•°æ®ç»“æ„ï¼Œå®ƒå…·æœ‰å¾ˆå¥½çš„ç©ºé—´å’Œæ—¶é—´æ•ˆç‡ï¼Œå°¤å…¶æ˜¯ç©ºé—´æ•ˆç‡æé«˜ï¼ŒBFå¸¸å¸¸è¢«ç”¨æ¥æ£€æµ‹æŸä¸ªå…ƒç´ æ˜¯å¦æ˜¯å·¨é‡æ•°æ®é›†åˆä¸­çš„æˆå‘˜ã€‚</p>
<h3 id="åŸºæœ¬åŸç†"><a href="#åŸºæœ¬åŸç†" class="headerlink" title="åŸºæœ¬åŸç†"></a>åŸºæœ¬åŸç†</h3><p>BFå¯ä»¥é«˜æ•ˆåœ°è¡¨å¾é›†åˆæ•°æ®ï¼Œå…¶ä½¿ç”¨é•¿åº¦ä¸ºmçš„ä½æ•°ç»„æ¥å­˜å‚¨é›†åˆä¿¡æ¯ï¼ŒåŒæ—¶ä½¿ç”¨kä¸ªç›¸äº’ç‹¬ç«‹çš„å“ˆå¸Œå‡½æ•°å°†æ•°æ®æ˜ å°„åˆ°ä½æ•°ç»„ç©ºé—´ã€‚</p>
<p>åŸºæœ¬æ€æƒ³ï¼š</p>
<p>é¦–å…ˆï¼Œå°†é•¿åº¦ä¸ºmçš„ä½æ•°ç»„å…ƒç´ å…¨éƒ¨ç½®ä¸º0ã€‚å¯¹äºé›†åˆSä¸­çš„æŸä¸ªæˆå‘˜aï¼Œåˆ†åˆ«ä½¿ç”¨kä¸ªå“ˆå¸Œå‡½æ•°å¯¹å…¶è®¡ç®—ï¼Œå¦‚æœhi(a)&#x3D;x(1â‰¤iâ‰¤k,1â‰¤xâ‰¤m)ï¼Œåˆ™å°†ä½æ•°ç»„çš„ç¬¬xä½ç½®ä¸º1ã€‚</p>
<p>å½“æŸ¥è¯¢æŸä¸ªæˆå‘˜a æ˜¯å¦åœ¨é›†åˆSä¸­å‡ºç°æ—¶ï¼Œä½¿ç”¨ç›¸åŒçš„kä¸ªå“ˆå¸Œå‡½æ•°è®¡ç®—ï¼Œå¦‚æœå…¶å¯¹åº”ä½æ•°ç»„ä¸­çš„wä½ï¼ˆwâ‰¤kï¼‰éƒ½ä¸º1ï¼Œåˆ™åˆ¤æ–­æˆå‘˜aå±äºé›†åˆSï¼Œåªè¦wä½ä¸­æœ‰ä»»æ„ä¸€ä½ä¸º0ï¼Œåˆ™åˆ¤æ–­æˆå‘˜aä¸å±äºé›†åˆS</p>
<h3 id="è¯¯åˆ¤ç‡åŠç›¸å…³è®¡ç®—"><a href="#è¯¯åˆ¤ç‡åŠç›¸å…³è®¡ç®—" class="headerlink" title="è¯¯åˆ¤ç‡åŠç›¸å…³è®¡ç®—"></a>è¯¯åˆ¤ç‡åŠç›¸å…³è®¡ç®—</h3><p>å¦‚æœæŸä¸ªæˆå‘˜ä¸åœ¨é›†åˆä¸­ï¼Œæœ‰å¯èƒ½BFä¼šå¾—å‡ºå…¶åœ¨é›†åˆä¸­çš„ç»“è®ºã€‚</p>
<p>![[file-20250916194423371.jpg | 400]]</p>
<p>BFä¼šäº§ç”Ÿè¯¯åˆ¤ï¼Œä½†æ˜¯<strong>ä¸ä¼šå‘ç”Ÿæ¼åˆ¤</strong>ï¼ˆFalse Negativeï¼‰çš„æƒ…å†µï¼Œå³å¦‚æœæŸä¸ªæˆå‘˜ç¡®å®å±äºé›†åˆï¼Œé‚£ä¹ˆBFä¸€å®šèƒ½å¤Ÿç»™å‡ºæ­£ç¡®åˆ¤æ–­ã€‚<strong>åœ¨çš„è‚¯å®šåœ¨ï¼Œä¸åœ¨çš„ä¸ä¸€å®šä¸åœ¨</strong></p>
<p>å½±å“è¯¯åˆ¤ç‡çš„å› ç´ ï¼šåŒ…æ‹¬é›†åˆå¤§å°nã€å“ˆå¸Œå‡½æ•°çš„ä¸ªæ•°kã€ å’Œä½æ•°ç»„å¤§å°mã€‚![[file-20250916194659885.jpg]]</p>
<h3 id="æ”¹è¿›ï¼šè®¡æ•°Bloom-filter"><a href="#æ”¹è¿›ï¼šè®¡æ•°Bloom-filter" class="headerlink" title="æ”¹è¿›ï¼šè®¡æ•°Bloom filter"></a>æ”¹è¿›ï¼šè®¡æ•°Bloom filter</h3><p>åŸºæœ¬çš„BFåœ¨ä½¿ç”¨æ—¶æœ‰ä¸ªç¼ºç‚¹ï¼šæ— æ³•åˆ é™¤é›†åˆæˆå‘˜ï¼Œåªèƒ½å¢åŠ æˆå‘˜å¹¶å¯¹å…¶æŸ¥è¯¢</p>
<p>è®¡æ•°BFçš„æ€è·¯ï¼šåŸºæœ¬ä¿¡æ¯å•å…ƒç”±å¤šä¸ªæ¯”ç‰¹ä½æ¥è¡¨ç¤ºï¼Œä¸€èˆ¬æƒ…å†µé‡‡å–3æˆ–4æ¯”ç‰¹ä½ä¸ºå•å…ƒã€‚è¿™æ ·ï¼Œå°†é›†åˆæˆå‘˜åŠ å…¥ä½æ•°ç»„æ—¶ï¼Œæ ¹æ®kä¸ªå“ˆå¸Œå‡½æ•°è®¡ç®—ï¼Œæ­¤æ—¶å¯¹åº”ä½ç½®çš„ä¿¡æ¯å•å…ƒç”±å¤šä¸ªæ¯”ç‰¹ä½æ„æˆï¼Œæ‰€ä»¥å°†åŸå…ˆçš„æ•°å€¼åŠ 1å³å¯ã€‚æŸ¥è¯¢é›†åˆæˆå‘˜æ—¶ï¼Œåªè¦å¯¹åº”ä½ç½®çš„ä¿¡æ¯å•å…ƒéƒ½ä¸ä¸º0å³å¯è®¤ä¸ºè¯¥æˆå‘˜å±äºé›†åˆã€‚è€Œåˆ é™¤æˆå‘˜ï¼Œåªè¦å°†å¯¹åº”ä½ç½®çš„è®¡æ•°å‡1å³å¯ã€‚</p>
<p>å­˜åœ¨è®¡æ•°æº¢å‡ºçš„å¯èƒ½</p>
<h3 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h3><p>å› ä¸ºBFçš„æé«˜ç©ºé—´åˆ©ç”¨ç‡ï¼Œå…¶åœ¨å„ä¸ªé¢†åŸŸè·å¾—äº†éå¸¸å¹¿æ³›çš„ä½¿ç”¨ï¼Œå°¤å…¶æ˜¯æ•°æ®é‡æå¤§ä¸”å®¹å¿ä¸€å®šè¯¯åˆ¤ç‡çš„åœºåˆã€‚</p>
<p>åœ¨BigTableä¸­ï¼ŒBFå¯¹äºè¯»æ“ä½œçš„æ•ˆç‡æå‡æœ‰å·¨å¤§å¸®åŠ©ã€‚BigTableä¸­å¾ˆå¤šæ•°æ®è®°å½•å­˜å‚¨åœ¨ç£ç›˜çš„å¤šä¸ªSSTableæ–‡ä»¶ä¸­ï¼Œä¸ºäº†å®Œæˆä¸€æ¬¡è¯»æ“ä½œï¼Œéœ€è¦ä¾æ¬¡åœ¨è¿™äº›SSTableä¸­æŸ¥æ‰¾æŒ‡å®šçš„Keyï¼Œå› ä¸ºæ˜¯ç£ç›˜æ“ä½œä¸”æ¶‰åŠå¤šä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥ä¼šå¯¹è¯»æ“ä½œæ•ˆç‡æœ‰æå¤§å½±å“ã€‚BigTableå°†SSTableæ–‡ä»¶ä¸­åŒ…å«çš„æ•°æ®è®°å½•Keyå½¢æˆBFç»“æ„å¹¶å°†å…¶æ”¾å…¥å†…å­˜ï¼Œè¿™æ ·å°±èƒ½æé«˜åœ°æé«˜æŸ¥è¯¢é€Ÿåº¦ï¼Œå¯¹äºæ”¹å–„è¯»æ“ä½œæœ‰å·¨å¤§çš„å¸®åŠ©ä½œç”¨ã€‚</p>
<h2 id="SkipList"><a href="#SkipList" class="headerlink" title="SkipList"></a>SkipList</h2><p>SkipListç”±William Pughäº1990å¹´æå‡ºï¼Œè¿™æ˜¯ä¸€ç§å¯æ›¿ä»£å¹³è¡¡æ ‘çš„æ•°æ®ç»“æ„ã€‚å…¶æ’å…¥ã€åˆ é™¤ã€æŸ¥æ‰¾æ•°æ®çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(log(N))</p>
<p><strong>æ ¸å¿ƒæ€è·¯</strong>ï¼š</p>
<ul>
<li>ä¼ ç»Ÿæœ‰åºé“¾è¡¨<br>![[file-20250916195612225.jpg]]</li>
<li>å¢åŠ æŒ‡é’ˆåçš„æœ‰åºé“¾è¡¨<br>![[file-20250916195653158.jpg]]<br>å¤šè·³å‡ æ¬¡ï¼š<br>![[file-20250916195659542.jpg]]</li>
</ul>
<p>SkipList<strong>ä¾èµ–éšæœºæ•°</strong>æ¥ä»¥ä¸€å®šæ¦‚ç‡ä¿æŒæ•°æ®çš„å¹³è¡¡ï¼Œå…·ä½“è€Œè¨€ï¼Œå°±æ˜¯<strong>åœ¨æ’å…¥èŠ‚ç‚¹çš„æ—¶å€™ï¼Œéšæœºå†³å®š</strong>è¯¥èŠ‚ç‚¹åº”è¯¥æœ‰å¤šå°‘ä¸ªæŒ‡å‘åç»­èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œæœ‰å‡ ä¸ªæŒ‡é’ˆå°±ç§°è¿™ä¸ªèŠ‚ç‚¹æ˜¯å‡ å±‚çš„ï¼ˆLevelï¼‰ã€‚</p>
<p>æ’å…¥è¿‡ç¨‹ï¼š<br>![[file-20250916195931890.jpg]]</p>
<h2 id="LSMæ ‘"><a href="#LSMæ ‘" class="headerlink" title="LSMæ ‘"></a>LSMæ ‘</h2><p>LSMæ ‘ï¼ˆLog-structured Merge-treeï¼‰çš„æœ¬è´¨æ˜¯å°†å¤§é‡çš„éšæœºå†™æ“ä½œè½¬æ¢æˆæ‰¹é‡çš„åºåˆ—å†™ï¼Œè¿™æ ·å¯ä»¥æå¤§åœ°æå‡ç£ç›˜æ•°æ®å†™å…¥é€Ÿåº¦ï¼Œæ‰€ä»¥LSMæ ‘éå¸¸é€‚åˆå¯¹å†™æ“ä½œæ•ˆç‡æœ‰é«˜è¦æ±‚çš„åº”ç”¨åœºæ™¯ã€‚</p>
<p>LevelDBé™æ€ç»“æ„ï¼š<br>![[file-20250916200147293.jpg | 500]]</p>
<p>æ„æˆLevelDBé™æ€ç»“æ„çš„åŒ…æ‹¬6ä¸ªä¸»è¦éƒ¨åˆ†ï¼šå†…å­˜ä¸­çš„MemTableå’ŒImmutable MemTableä»¥åŠç£ç›˜ä¸Šçš„å‡ ç§ä¸»è¦æ–‡ä»¶ï¼šCurrentæ–‡ä»¶ã€manifestæ–‡ä»¶ã€logæ–‡ä»¶ä»¥åŠSSTableæ–‡ä»¶ã€‚</p>
<ul>
<li><strong>å†™å…¥</strong>ï¼šLevelDBçš„logæ–‡ä»¶å’ŒMemTableä¸BigTableè®ºæ–‡ä¸­ä»‹ç»çš„æ˜¯ä¸€è‡´çš„ï¼Œå½“åº”ç”¨å†™å…¥ä¸€æ¡Keyï¼šValueè®°å½•çš„æ—¶å€™ï¼ŒLevelDBä¼šå…ˆå¾€logæ–‡ä»¶é‡Œå†™å…¥ï¼ŒæˆåŠŸåå°†è®°å½•æ’è¿›MemTableä¸­ï¼Œè¿™æ ·åŸºæœ¬å°±ç®—å®Œæˆäº†å†™å…¥æ“ä½œï¼Œå› ä¸ºä¸€æ¬¡å†™å…¥æ“ä½œåªæ¶‰åŠä¸€æ¬¡ç£ç›˜é¡ºåºå†™å’Œä¸€æ¬¡å†…å­˜å†™å…¥ï¼Œ<strong>è€Œä¸”MemTableé‡‡ç”¨äº†ç»´æŠ¤æœ‰åºè®°å½•å¿«é€Ÿæ’å…¥æŸ¥æ‰¾çš„SkipListæ•°æ®ç»“æ„</strong>ï¼Œæ‰€ä»¥è¯´LSMæ ‘æ˜¯ä¸€ç§é«˜é€Ÿå†™å…¥æ•°æ®ç»“æ„çš„ä¸»è¦åŸå› ã€‚</li>
<li><strong>åˆ°å¤„</strong>ï¼šå½“MemTableæ’å…¥çš„æ•°æ®å ç”¨å†…å­˜åˆ°äº†ä¸€ä¸ªç•Œé™åï¼Œéœ€è¦å°†å†…å­˜çš„è®°å½•å¯¼å‡ºåˆ°å¤–å­˜æ–‡ä»¶ä¸­ï¼ŒLevelDBä¼šç”Ÿæˆæ–°çš„logæ–‡ä»¶å’ŒMemTableï¼ŒåŸå…ˆçš„MemTableå°±æˆä¸ºImmutable MemTableï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯è¯´è¿™ä¸ªMemTableçš„å†…å®¹æ˜¯ä¸å¯æ›´æ”¹çš„ï¼Œåªèƒ½è¯»ä¸èƒ½å†™å…¥æˆ–è€…åˆ é™¤ã€‚æ–°åˆ°æ¥çš„æ•°æ®è¢«è®°å…¥æ–°çš„logæ–‡ä»¶å’ŒMemTableï¼ŒLevelDBåå°è°ƒåº¦ä¼šå°†Immutable MemTableçš„æ•°æ®å¯¼å‡ºåˆ°ç£ç›˜ï¼Œå½¢æˆä¸€ä¸ªæ–°çš„SSTableæ–‡ä»¶ã€‚ï¼ˆSSTableæœ‰å±‚æ¬¡ï¼Œæ•…å«åšLevelDBï¼‰</li>
<li><strong>è®°å½•</strong>ï¼šSSTableä¸­çš„æ–‡ä»¶æ˜¯ä¸»é”®æœ‰åºçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ–‡ä»¶ä¸­å°keyè®°å½•æ’åœ¨å¤§keyè®°å½•ä¹‹å‰ï¼Œå„ä¸ªLevelçš„SSTableéƒ½æ˜¯å¦‚æ­¤ã€‚manifestè®°è½½äº†SSTableå„ä¸ªæ–‡ä»¶çš„ç®¡ç†ä¿¡æ¯ï¼Œæ¯”å¦‚å±äºå“ªä¸ªLevelã€æ–‡ä»¶åç§°ã€æœ€å°keyå’Œæœ€å¤§keyå„è‡ªæ˜¯å¤šå°‘ã€‚![[file-20250916201110792.jpg | 400]]</li>
<li><strong>åˆå¹¶</strong>ï¼š3ç§ç±»å‹çš„Compactionï¼Œåˆ†åˆ«æ˜¯minorã€majorå’Œfullã€‚æ‰€è°“minor Compactionï¼Œå°±æ˜¯æŠŠMemTableä¸­çš„æ•°æ®å¯¼å‡ºåˆ°SSTableæ–‡ä»¶ä¸­ï¼Œmajor Compactionå°±æ˜¯åˆå¹¶ä¸åŒå±‚çº§çš„SSTableæ–‡ä»¶ï¼Œè€Œfull Compactionå°±æ˜¯å°†æ‰€æœ‰SSTableè¿›è¡Œåˆå¹¶ã€‚<ul>
<li><strong>minor</strong>ï¼šå½“MemTableä¸­è®°å½•æ•°é‡åˆ°äº†ä¸€å®šç¨‹åº¦ä¼šè½¬æ¢ä¸ºImmutable MemTableï¼Œæ­¤æ—¶ä¸èƒ½å¾€å…¶ä¸­å†™å…¥è®°å½•ï¼Œåªèƒ½ä»ä¸­è¯»å–KVå†…å®¹ã€‚Immutable MemTableå…¶å®æ˜¯ä¸€ä¸ªSkipListå¤šå±‚çº§é˜Ÿåˆ—ï¼Œå…¶ä¸­çš„è®°å½•æ˜¯æ ¹æ®keyæœ‰åºæ’åˆ—çš„ã€‚æ‰€ä»¥è¿™ä¸ªminor Compactionå®ç°èµ·æ¥ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯æŒ‰ç…§Immutable MemTableä¸­è®°å½•ç”±å°åˆ°å¤§éå†ï¼Œå¹¶ä¾æ¬¡å†™å…¥ä¸€ä¸ªLevel 0çš„æ–°å»ºSSTableæ–‡ä»¶ä¸­ï¼Œå†™å®Œåå»ºç«‹æ–‡ä»¶çš„indexæ•°æ®ï¼Œè¿™æ ·å°±å®Œæˆäº†ä¸€æ¬¡minor Compactionã€‚</li>
<li><strong>major</strong>ï¼šå½“æŸä¸ªLevelä¸‹çš„SSTableæ–‡ä»¶æ•°ç›®è¶…è¿‡ä¸€å®šè®¾ç½®å€¼åï¼ŒLevelDBä¼šä»è¿™ä¸ªLevelçš„SSTableä¸­é€‰æ‹©ä¸€ä¸ªæ–‡ä»¶ï¼ˆLevel&gt;0ï¼‰ï¼Œå°†å…¶å’Œé«˜ä¸€å±‚çº§çš„Level+1çš„SSTableæ–‡ä»¶åˆå¹¶ï¼Œè¿™å°±æ˜¯major Compactionã€‚å¯¹å¤šä¸ªæ–‡ä»¶é‡‡ç”¨å¤šè·¯å½’å¹¶æ’åºçš„æ–¹å¼ï¼Œä¾æ¬¡æ‰¾å‡ºå…¶ä¸­æœ€å°çš„keyè®°å½•ï¼Œä¹Ÿå°±æ˜¯å¯¹å¤šä¸ªæ–‡ä»¶ä¸­çš„æ‰€æœ‰è®°å½•é‡æ–°è¿›è¡Œæ’åºã€‚ä¹‹åé‡‡å–ä¸€å®šçš„æ ‡å‡†åˆ¤æ–­è¿™ä¸ªkeyæ˜¯å¦è¿˜éœ€è¦ä¿å­˜ï¼Œå¦‚æœåˆ¤æ–­æ²¡æœ‰ä¿å­˜ä»·å€¼ï¼Œé‚£ä¹ˆç›´æ¥æŠ›æ‰ï¼Œå¦‚æœè§‰å¾—è¿˜éœ€è¦ç»§ç»­ä¿å­˜ï¼Œé‚£ä¹ˆå°±å°†å…¶å†™å…¥Level L+1å±‚ä¸­æ–°ç”Ÿæˆçš„SSTableæ–‡ä»¶ä¸­</li>
</ul>
</li>
</ul>
<p>ç”±å†…å­˜ä¸­çš„MemTableå’Œç£ç›˜ä¸Šçš„å„çº§SSTableæ–‡ä»¶å°±å½¢æˆäº†LSMæ ‘ã€‚<br>LSMæ ‘çš„æœ¬è´¨ï¼Œå³å°†å¤§é‡éšæœºå†™è½¬æ¢ä¸ºæ‰¹é‡çš„åºåˆ—å†™ã€‚</p>
<h2 id="Merkleå“ˆå¸Œæ ‘"><a href="#Merkleå“ˆå¸Œæ ‘" class="headerlink" title="Merkleå“ˆå¸Œæ ‘"></a>Merkleå“ˆå¸Œæ ‘</h2><p>Merkleå“ˆå¸Œæ ‘ç”±Ralph Merkleäº1979å¹´å‘æ˜ã€‚Merkleæ ‘æœ€åˆç”¨äºé«˜æ•ˆLamportç­¾åéªŒè¯ï¼Œåæ¥è¢«å¹¿æ³›åº”ç”¨åœ¨åˆ†å¸ƒå¼é¢†åŸŸï¼Œä¸»è¦ç”¨æ¥åœ¨æµ·é‡æ•°æ®ä¸‹å¿«é€Ÿå®šä½å°‘é‡å˜åŒ–çš„æ•°æ®å†…å®¹</p>
<h3 id="Merkleæ ‘åŸºæœ¬åŸç†"><a href="#Merkleæ ‘åŸºæœ¬åŸç†" class="headerlink" title="Merkleæ ‘åŸºæœ¬åŸç†"></a>Merkleæ ‘åŸºæœ¬åŸç†</h3><p>![[file-20250917210229248.jpg]]<br>å­èŠ‚ç‚¹æ˜¯æ¯ä¸ªæ•°æ®é¡¹æˆ–è€…ä¸€æ‰¹æ•°æ®é¡¹ï¼ˆæ•°æ®å—ï¼‰å¯¹åº”çš„å“ˆå¸Œå€¼ï¼Œä¸­é—´èŠ‚ç‚¹åˆ™ä¿å­˜å¯¹å…¶æ‰€æœ‰å­èŠ‚ç‚¹å“ˆå¸Œå€¼å†æ¬¡è¿›è¡Œå“ˆå¸Œè¿ç®—åçš„å€¼ï¼Œä¾æ¬¡ç”±ä¸‹å¾€ä¸Šç±»æ¨ï¼Œç›´åˆ°æ ¹èŠ‚ç‚¹ï¼Œå…¶ä¿å­˜çš„Top Hashä»£è¡¨æ•´æ£µæ ‘çš„å“ˆå¸Œå€¼ï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰æ•°æ®çš„æ•´ä½“å“ˆå¸Œå€¼ã€‚å…·ä½“ä½¿ç”¨çš„æ—¶å€™ï¼Œæ—¢å¯ä»¥åƒä¾‹å­ä¸­ä¸€æ ·æ˜¯ä¸€ä¸ªäºŒå‰æ ‘ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šå‰æ ‘ã€‚</p>
<p>Merkleæ ‘å¸¸ç”¨äºå¿«é€Ÿä¾¦æµ‹éƒ¨åˆ†æ•°æ®æ­£å¸¸æˆ–è€…å¼‚å¸¸çš„å˜åŠ¨ã€‚å½“æŸä¸ªåº•å±‚æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå…¶å¯¹åº”Merkleæ ‘çš„å­èŠ‚ç‚¹å“ˆå¸Œå€¼ä¼šè·Ÿç€å˜åŒ–ï¼Œå­èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹å“ˆå¸Œå€¼ä¹Ÿéšä¹‹å˜åŒ–ã€‚</p>
<p>é€šè¿‡Merkleæ ‘ï¼Œå¯ä»¥åœ¨O(log(n))æ—¶é—´å†…<strong>å¿«é€Ÿå®šä½å˜åŒ–</strong>çš„æ•°æ®å†…å®¹ã€‚</p>
<h3 id="Dynamoä¸­çš„åº”ç”¨"><a href="#Dynamoä¸­çš„åº”ç”¨" class="headerlink" title="Dynamoä¸­çš„åº”ç”¨"></a>Dynamoä¸­çš„åº”ç”¨</h3><p>Dynamoç»“åˆMerkleæ ‘å’ŒGossipåè®®æ¥å¯¹å‰¯æœ¬æ•°æ®è¿›è¡ŒåŒæ­¥ã€‚</p>
<p>Dynamoå¯ä»¥å¿«é€Ÿå®šä½åˆ°æ•°æ®å‰¯æœ¬ä¸åŒå†…å®¹ï¼Œä¸”åªé¡»åŒæ­¥ä¸¤è€…çš„å·®å¼‚éƒ¨åˆ†å³å¯å®ç°å‰¯æœ¬æ•°æ®åŒæ­¥ï¼Œè¿™æ ·æœ‰æ•ˆåœ°å‡å°‘äº†ç½‘ç»œä¼ è¾“æ•°æ®é‡ï¼Œå¢åŠ äº†æ•°æ®åŒæ­¥æ•ˆç‡ã€‚</p>
<h3 id="æ¯”ç‰¹å¸ä¸­çš„åº”ç”¨"><a href="#æ¯”ç‰¹å¸ä¸­çš„åº”ç”¨" class="headerlink" title="æ¯”ç‰¹å¸ä¸­çš„åº”ç”¨"></a>æ¯”ç‰¹å¸ä¸­çš„åº”ç”¨</h3><p>æ¯”ç‰¹å¸ä¸­ï¼Œä¸»è¦ä½¿ç”¨Merkleæ ‘æ¥å¯¹äº¤æ˜“è¿›è¡ŒéªŒè¯ï¼Œä»¥æ­¤æ¥åˆ¤æ–­æŸä¸ªäº¤æ˜“æ˜¯å¦æ˜¯åˆæ³•äº¤æ˜“ã€‚</p>
<p>é€šè¿‡å¼•å…¥Merkleæ ‘å’Œä¸Šè¿°çš„é“¾è¡¨ç»“æ„ï¼Œæ¯”ç‰¹å¸é‡‡ç”¨å°‘é‡è®¡ç®—åŠæ¯”è¾ƒæ“ä½œå³å¯å®Œæˆäº¤æ˜“çš„éªŒè¯è¿‡ç¨‹ã€‚</p>
<h2 id="Snappyå’ŒLZSSç®—æ³•"><a href="#Snappyå’ŒLZSSç®—æ³•" class="headerlink" title="Snappyå’ŒLZSSç®—æ³•"></a>Snappyå’ŒLZSSç®—æ³•</h2><p>Snappyæ˜¯Googleå¼€æºå‡ºçš„é«˜æ•ˆæ•°æ®å‹ç¼©ä¸è§£å‹ç¼©ç®—æ³•åº“ï¼Œå…¶ç›®æ ‡å¹¶éæ˜¯æœ€é«˜çš„æ•°æ®å‹ç¼©ç‡ï¼Œè€Œæ˜¯åœ¨åˆç†çš„å‹ç¼©ç‡åŸºç¡€ä¸Šè¿½æ±‚å°½å¯èƒ½å¿«çš„å‹ç¼©å’Œè§£å‹ç¼©é€Ÿåº¦ã€‚</p>
<ul>
<li>å…¶å‹ç¼©å’Œè§£å‹ç¼©é€Ÿåº¦æå¿«ï¼Œå¯ä»¥åœ¨å•æ ¸å¤„ç†å™¨ä¸Šè¾¾åˆ°250MB&#x2F;sçš„å‹ç¼©æ•ˆç‡å’Œ500MB&#x2F;sçš„è§£å‹ç¼©æ•ˆç‡ã€‚</li>
<li>Snappyç›¸æ¯”å…¶ä»–å‹ç¼©æ–¹æ¡ˆå ç”¨CPUæ—¶é—´æ›´å°‘ã€‚</li>
</ul>
<p>Snappyæ˜¯åŸºäºLZSSç®—æ³•çš„</p>
<h3 id="LZSSç®—æ³•"><a href="#LZSSç®—æ³•" class="headerlink" title="LZSSç®—æ³•"></a>LZSSç®—æ³•</h3><p>LZ77æ˜¯ä¸€ç§åŠ¨æ€è¯å…¸ç¼–ç ï¼ˆDictionary Codingï¼‰</p>
<p><strong>åŸºæœ¬æ€è·¯</strong>ï¼šæ–‡æœ¬ä¸­çš„è¯ç”¨å®ƒåœ¨è¯å…¸ä¸­è¡¨ç¤ºä½ç½®çš„å·ç ä»£æ›¿çš„æ— æŸæ•°æ®å‹ç¼©æ–¹æ³•ï¼Œä¸€èˆ¬åˆ†ä¸ºé™æ€è¯å…¸æ–¹æ³•å’ŒåŠ¨æ€è¯å…¸æ–¹æ³•ä¸¤ç§ã€‚é‡‡ç”¨é™æ€è¯å…¸ç¼–ç æŠ€æœ¯æ—¶ï¼Œç¼–ç å™¨éœ€è¦äº‹å…ˆæ„é€ è¯å…¸ï¼Œè§£ç å™¨è¦äº‹å…ˆçŸ¥é“è¯å…¸ã€‚é‡‡ç”¨åŠ¨æ€è¾å…¸ç¼–ç æŠ€æœ¯æ—¶ï¼Œç¼–ç å™¨å°†ä»è¢«å‹ç¼©çš„æ–‡æœ¬ä¸­è‡ªåŠ¨å¯¼å‡ºè¯å…¸ï¼Œè§£ç å™¨è§£ç æ—¶è¾¹è§£ç è¾¹æ„é€ è§£ç è¯å…¸ã€‚</p>
<p>åŠ¨æ€è¯å…¸ç¼–ç çš„åŸºæœ¬æ€è·¯ï¼špæ›¿ä»£äº†abc<br>![[file-20250917211111486.jpg | 500]]</p>
<p><strong>LZ77ç®—æ³•</strong>ï¼šæè¿°äº†ä¸€ç§åŸºäºæ»‘åŠ¨çª—å£ç¼“å­˜çš„æŠ€æœ¯ï¼Œè¯¥ç¼“å­˜ç”¨äºä¿å­˜æœ€è¿‘åˆšåˆšå¤„ç†çš„æ–‡æœ¬ï¼Œè€ŒåŠ¨æ€è¯å…¸å°±æ˜¯ç”±æ»‘åŠ¨çª—å£å†…çš„æ–‡æœ¬æ„é€ å‡ºæ¥çš„ã€‚</p>
<p>LZ77æ˜¯åŠ¨æ€è¯å…¸ç¼–ç æ–¹æ³•çš„å¼€åˆ›è€…ï¼Œåæ¥æ‰€æœ‰åŠ¨æ€è¯å…¸ç¼–ç å‹ç¼©æ–¹æ³•éƒ½æ˜¯åŸºäºLZ77è¿›è¡Œæ”¹é€ å’Œä¼˜<br>åŒ–çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬ç†ŸçŸ¥çš„GZipã€WinZipã€RARã€Compressç­‰éƒ½é‡‡ç”¨äº†LZç³»åˆ—ç®—æ³•ã€‚</p>
<p>LZ77çš„å‹ç¼©ç®—æ³•ä½¿ç”¨äº†æ»‘åŠ¨çª—å£å’Œå‰å‘ç¼“å†²åŒºçš„æ¦‚å¿µï¼š</p>
<ul>
<li>æ»‘åŠ¨çª—å£ï¼šå‰é¢å¤„ç†è¿‡çš„è‹¥å¹²æºå­—ç¬¦</li>
<li>å‰å‘ç¼“å†²åŒºï¼šåŒ…å«äº†è¾“å…¥æ•°æ®æµä¸­å°†è¦å¤„ç†çš„æ‰€æœ‰åç»­å­—ç¬¦ã€‚<br>![[file-20250917211500784.jpg | 500]]</li>
</ul>
<p>LZSSå¯¹LZ77åšå‡ºäº†æ”¹è¿›ï¼šå¢åŠ äº†æœ€å°åŒ¹é…é•¿åº¦é™åˆ¶ï¼Œå½“åŒ¹é…å­—ç¬¦ä¸²å°äºæŒ‡å®šçš„æœ€å°åŒ¹é…é™åˆ¶æ—¶ï¼Œå¹¶ä¸è¿›è¡Œå‹ç¼©è¾“å‡ºï¼Œè€Œæ˜¯ä»ç„¶æ»‘åŠ¨çª—å£å³ç§»ä¸€ä¸ªå­—ç¬¦ã€‚å®ä¾‹å¦‚ä¸‹ï¼š</p>
<p>![[file-20250917211546710.jpg | 500]]</p>
<h3 id="Snappy"><a href="#Snappy" class="headerlink" title="Snappy"></a>Snappy</h3><p>Snappyåœ¨æ•´ä½“æ¡†æ¶ä¸ŠåŸºæœ¬éµå¾ªLZSSçš„å‹ç¼©ç¼–ç ä¸è§£ç æ–¹æ¡ˆã€‚é¦–å…ˆï¼ŒSnappyè®¾å®šæœ€å°åŒ¹é…é•¿åº¦ä¸º4ï¼Œå³åªæœ‰åŒ¹é…é•¿åº¦å¤§äºç­‰äº4çš„å­—ç¬¦ä¸²æ‰è¿›è¡Œå‹ç¼©ï¼Œç›¸åº”åœ°ï¼Œå…¶è®¾å®šå“ˆå¸Œè¡¨å†…çš„å­—ç¬¦ä¸²ç‰‡æ®µå›ºå®šé•¿åº¦ä¹Ÿä¸º4ã€‚</p>
<p>Snappyåšäº†ä¸€äº›ç›¸å¯¹ç‹¬ç‰¹çš„ä¼˜åŒ–ã€‚æ¯”å¦‚å…¶åœ¨å‹ç¼©æ•°æ®æ—¶ï¼Œå°†æ•´ä¸ªæ•°æ®åˆ‡å‰²æˆ32KBå¤§å°çš„æ•°æ®å—åˆ†åˆ«è¿›è¡Œå‹ç¼©ï¼Œæ•°æ®å—ä¹‹é—´ç‹¬ç«‹æ— å…³è”ï¼Œè¿™æ ·ä¸¤ä¸ªå­—èŠ‚å³å¯è¡¨ç¤ºåŒ¹é…å­—ç¬¦ä¸²çš„ç›¸å¯¹ä½ç½®ã€‚</p>
<h2 id="Cuckooå“ˆå¸Œ"><a href="#Cuckooå“ˆå¸Œ" class="headerlink" title="Cuckooå“ˆå¸Œ"></a>Cuckooå“ˆå¸Œ</h2><p>Cuckooå“ˆå¸Œç”±Rasmus Paghå’ŒFlemming Friche Rodleräº2001å¹´æå‡ºï¼Œä½¿ç”¨å®ƒå¯ä»¥æœ‰æ•ˆè§£å†³å“ˆå¸Œå†²çªï¼ˆHash Collisionsï¼‰é—®é¢˜ã€‚Cuckooå“ˆå¸Œå…·æœ‰å¾ˆå¤šä¼˜è‰¯ç‰¹æ€§ï¼Œæ¯”å¦‚å¯ä»¥åœ¨Oï¼ˆ1ï¼‰æ—¶é—´å¤æ‚åº¦æŸ¥æ‰¾å’Œåˆ é™¤æ•°æ®ï¼Œå¯ä»¥åœ¨å¸¸æ•°æ—¶é—´å†…æ’å…¥æ•°æ®ç­‰ã€‚å…¶æœ‰å¤§çº¦50%çš„å“ˆå¸Œç©ºé—´åˆ©ç”¨ç‡ã€‚</p>
<h3 id="åŸºæœ¬åŸç†-1"><a href="#åŸºæœ¬åŸç†-1" class="headerlink" title="åŸºæœ¬åŸç†"></a>åŸºæœ¬åŸç†</h3><p>Cuckooå“ˆå¸ŒåŒæ—¶ä½¿ç”¨ä¸¤ä¸ªä¸åŒçš„å“ˆå¸Œå‡½æ•°H1(x )å’ŒH 2(x )ã€‚å½“æ’å…¥æ•°æ®xæ—¶ï¼ŒåŒæ—¶è®¡ç®—H1(x)å’ŒH2(x)ï¼Œå¦‚æœå¯¹åº”çš„å“ˆå¸Œç©ºé—´ä¸­ä»»æ„ä¸€ä¸ªæ¡¶ï¼ˆBucketï¼‰ä¸ºç©ºï¼Œåˆ™å¯ä»¥å°†xæ’å…¥ç›¸åº”ä½ç½®ï¼›å¦‚æœä¸¤è€…éƒ½ä¸ç©ºï¼Œåˆ™é€‰æ‹©ä¸€ä¸ªæ¡¶ï¼Œå°†å·²ç»å æ®è¿™ä¸ªä½ç½®çš„å€¼yè¸¢å‡ºå»ï¼Œç”±xæ¥å æ®è¿™ä¸ªä½ç½®ã€‚yç»§ç»­é‡æ–°è®¡ç®—ã€‚</p>
<p>å¯èƒ½ä¼šæ— é™å¾ªç¯ï¼Œéœ€è¦è®¾å®šæœ€å¤§æ›¿æ¢æ¬¡æ•°ã€‚</p>
<p>å¯¹äºæŸ¥æ‰¾æ“ä½œæ¥è¯´ï¼Œåªéœ€è¦æŸ¥æ‰¾ä¸¤ä¸ªå“ˆå¸Œå‡½æ•°æ˜ å°„åˆ°çš„å“ˆå¸Œç©ºé—´å¯¹åº”ä½ç½®ï¼Œè¦ä¹ˆå­˜åœ¨è¦ä¹ˆä¸å­˜åœ¨ï¼Œæ˜¯å”¯ä¸€ç¡®å®šçš„ï¼Œæ‰€ä»¥å¯ä»¥åœ¨O(1)æ—¶é—´å†…å®Œæˆã€‚ä¸ä¼ ç»Ÿçš„å“ˆå¸Œæ–¹å¼ç›¸æ¯”è¾ƒï¼ŒCuckooå“ˆå¸Œçœå»äº†å½“å“ˆå¸Œå†²çªæ—¶è¿›è¡Œå†²çªè§£å†³çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥æŸ¥æ‰¾æ•ˆç‡éå¸¸é«˜ã€‚</p>
<h1 id="ç¬¬4ç« â€”â€”é›†ç¾¤èµ„æºç®¡ç†ä¸è°ƒåº¦"><a href="#ç¬¬4ç« â€”â€”é›†ç¾¤èµ„æºç®¡ç†ä¸è°ƒåº¦" class="headerlink" title="ç¬¬4ç« â€”â€”é›†ç¾¤èµ„æºç®¡ç†ä¸è°ƒåº¦"></a>ç¬¬4ç« â€”â€”é›†ç¾¤èµ„æºç®¡ç†ä¸è°ƒåº¦</h1><p><strong>é™æ€èµ„æºåˆ’åˆ†</strong>ï¼šå°†é›†ç¾¤ä¸­çš„æ‰€æœ‰èµ„æºåšå‡ºé™æ€åˆ’åˆ†ï¼Œå°†åˆ’åˆ†åçš„å›ºå®šçš„ç¡¬ä»¶èµ„æºæŒ‡å®šç»™å›ºå®šçš„è®¡ç®—æ¡†æ¶ä½¿ç”¨ï¼Œå„ä¸ªæ¡†æ¶ä¹‹é—´å„è¡Œå…¶æ˜¯ï¼Œäº’ä¸å¹²æ‰°ã€‚èµ„æºçš„æ•´ä½“åˆ©ç”¨ç‡ä¸é«˜ï¼Œç»å¸¸ä¼šå‡ºç°é›†ç¾¤ä¸­æœ‰äº›è®¡ç®—ç³»ç»Ÿèµ„æºä¸è¶³</p>
<p><strong>å‘å±•è¶‹åŠ¿</strong>ï¼šåœ¨é›†ç¾¤ç¡¬ä»¶å±‚ä¹‹ä¸ŠæŠ½è±¡å‡ºä¸€ä¸ªåŠŸèƒ½ç‹¬ç«‹çš„é›†ç¾¤èµ„æºç®¡ç†ç³»ç»Ÿï¼Œå°†æ‰€æœ‰å¯ç”¨èµ„æºå½“ä½œä¸€ä¸ªæ•´ä½“æ¥è¿›è¡Œç®¡ç†ï¼Œå¹¶å¯¹å…¶ä»–æ‰€æœ‰è®¡ç®—ä»»åŠ¡æä¾›ç»Ÿä¸€çš„èµ„æºç®¡ç†ä¸è°ƒåº¦æ¡†æ¶å’Œæ¥å£ï¼Œè®¡ç®—ä»»åŠ¡æŒ‰éœ€å‘å…¶ç”³è¯·èµ„æºï¼Œä½¿ç”¨å®Œæ¯•é‡Šæ”¾ç»™èµ„æºç®¡ç†ç³»ç»Ÿã€‚</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>é›†ç¾¤æ•´ä½“èµ„æºåˆ©ç”¨ç‡é«˜</li>
<li>å¯å¢åŠ æ•°æ®å…±äº«èƒ½åŠ›</li>
<li>æ”¯æŒå¤šç±»å‹è®¡ç®—æ¡†æ¶å’Œå¤šç‰ˆæœ¬è®¡ç®—æ¡†æ¶</li>
</ul>
<h2 id="èµ„æºç®¡ç†æŠ½è±¡æ¨¡å‹"><a href="#èµ„æºç®¡ç†æŠ½è±¡æ¨¡å‹" class="headerlink" title="èµ„æºç®¡ç†æŠ½è±¡æ¨¡å‹"></a>èµ„æºç®¡ç†æŠ½è±¡æ¨¡å‹</h2><h3 id="æ¦‚å¿µæ¨¡å‹"><a href="#æ¦‚å¿µæ¨¡å‹" class="headerlink" title="æ¦‚å¿µæ¨¡å‹"></a>æ¦‚å¿µæ¨¡å‹</h3><p>ä»æ¦‚å¿µä¸Šè®²ï¼Œèµ„æºç®¡ç†ä¸è°ƒåº¦ç³»ç»Ÿçš„ä¸»è¦ç›®çš„æ˜¯å°†é›†ç¾¤ä¸­çš„å„ç§èµ„æºé€šè¿‡ä¸€å®šç­–ç•¥åˆ†é…ç»™ç”¨æˆ·æäº¤åˆ°ç³»ç»Ÿé‡Œçš„å„ç§ä»»åŠ¡ï¼Œå¸¸è§çš„èµ„æºä¸»è¦åŒ…æ‹¬å†…å­˜ã€CUPã€ç½‘ç»œèµ„æºä¸ç£ç›˜I&#x2F;Oèµ„æº4ç±»ã€‚</p>
<p>ä¸‰è¦ç´ ï¼šèµ„æºç»„ç»‡æ¨¡å‹ã€è°ƒåº¦ç­–ç•¥å’Œä»»åŠ¡ç»„ç»‡æ¨¡å‹</p>
<ul>
<li><strong>èµ„æºç»„ç»‡æ¨¡å‹</strong>ï¼šå°†é›†ç¾¤ä¸­å½“å‰å¯ç”¨çš„å„ç§èµ„æºé‡‡ç”¨ä¸€å®šçš„æ–¹å¼ç»„ç»‡èµ·æ¥ï¼Œä»¥æ–¹ä¾¿åç»­çš„èµ„æºåˆ†é…è¿‡ç¨‹ã€‚</li>
<li><strong>è°ƒåº¦ç­–ç•¥</strong>ï¼šä»¥ä¸€å®šæ–¹å¼å°†èµ„æºåˆ†é…ç»™æäº¤åˆ°ç³»ç»Ÿçš„ä»»åŠ¡ï¼Œå¸¸è§çš„è°ƒåº¦ç­–ç•¥åŒ…æ‹¬FIFOã€å…¬å¹³è°ƒåº¦ã€èƒ½åŠ›è°ƒåº¦ã€å»¶è¿Ÿè°ƒåº¦ç­‰</li>
<li><strong>ä»»åŠ¡ç»„ç»‡æ¨¡å‹</strong>ï¼šå°†å¤šç”¨æˆ·æäº¤çš„å¤šä»»åŠ¡é€šè¿‡ä¸€å®šæ–¹å¼ç»„ç»‡èµ·æ¥ï¼Œä»¥æ–¹ä¾¿åç»­èµ„æºåˆ†é…ã€‚<br>![[file-20250922141748994.jpg | 500]]</li>
</ul>
<h3 id="é€šç”¨æ¶æ„"><a href="#é€šç”¨æ¶æ„" class="headerlink" title="é€šç”¨æ¶æ„"></a>é€šç”¨æ¶æ„</h3><ul>
<li><p><strong>èŠ‚ç‚¹ç®¡ç†å™¨</strong>ï¼šé›†ç¾¤ä¸­æ¯å°æœºå™¨ä¸Šä¼šé…ç½®èŠ‚ç‚¹ç®¡ç†å™¨ï¼Œå…¶ä¸»è¦èŒè´£æ˜¯ä¸æ–­åœ°å‘èµ„æºæ”¶é›†å™¨æ±‡æŠ¥ç›®å‰æœ¬æœºèµ„æºä½¿ç”¨çŠ¶å†µï¼Œå¹¶è´Ÿè´£å®¹å™¨çš„ç®¡ç†å·¥ä½œã€‚å½“æŸä¸ªä»»åŠ¡è¢«åˆ†é…åˆ°æœ¬èŠ‚ç‚¹æ‰§è¡Œæ—¶ï¼ŒèŠ‚ç‚¹ç®¡ç†å™¨è´Ÿè´£å°†å…¶çº³å…¥æŸä¸ªå®¹å™¨æ‰§è¡Œå¹¶å¯¹è¯¥å®¹å™¨è¿›è¡Œèµ„æºéš”ç¦»ï¼Œä»¥é¿å…ä¸åŒå®¹å™¨å†…ä»»åŠ¡çš„ç›¸äº’å¹²æ‰°ã€‚</p>
</li>
<li><p><strong>é€šç”¨è°ƒåº¦å™¨</strong>ï¼šç”±èµ„æºæ”¶é›†å™¨å’Œèµ„æºè°ƒåº¦ç­–ç•¥æ„æˆï¼ŒåŒæ—¶ç®¡ç†èµ„æºæ± å’Œå·¥ä½œé˜Ÿåˆ—æ•°æ®ç»“æ„ã€‚èµ„æºæ”¶é›†å™¨ä¸æ–­åœ°ä»é›†ç¾¤å†…å„ä¸ªèŠ‚ç‚¹æ”¶é›†å’Œæ›´æ–°èµ„æºçŠ¶æ€ä¿¡æ¯ï¼Œå¹¶å°†å…¶æœ€æ–°çŠ¶å†µåæ˜ åˆ°èµ„æºæ± ä¸­ï¼Œèµ„æºæ± åˆ—å‡ºäº†ç›®å‰å¯ç”¨çš„ç³»ç»Ÿèµ„æºã€‚èµ„æºè°ƒåº¦ç­–ç•¥æ˜¯å…·ä½“å†³å®šå¦‚ä½•å°†èµ„æºæ± ä¸­çš„å¯ç”¨èµ„æºåˆ†é…ç»™å·¥ä½œé˜Ÿåˆ—çš„æ–¹æ³•ï¼Œå¸¸è§çš„ç­–ç•¥åŒ…æ‹¬FIFOã€å…¬å¹³è°ƒåº¦ç­–ç•¥å’Œèƒ½åŠ›è°ƒåº¦ç­–ç•¥ç­‰ã€‚èµ„æºè°ƒåº¦ç­–ç•¥æ¨¡å—å¾€å¾€æ˜¯å¯æ’æ‹”çš„ã€‚<br>![[file-20250922141938153.jpg | 500]]</p>
</li>
</ul>
<h2 id="è°ƒåº¦ç³»ç»Ÿè®¾è®¡çš„åŸºæœ¬é—®é¢˜"><a href="#è°ƒåº¦ç³»ç»Ÿè®¾è®¡çš„åŸºæœ¬é—®é¢˜" class="headerlink" title="è°ƒåº¦ç³»ç»Ÿè®¾è®¡çš„åŸºæœ¬é—®é¢˜"></a>è°ƒåº¦ç³»ç»Ÿè®¾è®¡çš„åŸºæœ¬é—®é¢˜</h2><h3 id="èµ„æºå¼‚è´¨æ€§ä¸å·¥ä½œè´Ÿè½½å¼‚è´¨æ€§"><a href="#èµ„æºå¼‚è´¨æ€§ä¸å·¥ä½œè´Ÿè½½å¼‚è´¨æ€§" class="headerlink" title="èµ„æºå¼‚è´¨æ€§ä¸å·¥ä½œè´Ÿè½½å¼‚è´¨æ€§"></a>èµ„æºå¼‚è´¨æ€§ä¸å·¥ä½œè´Ÿè½½å¼‚è´¨æ€§</h3><p>å¼‚è´¨æ€§å¾€å¾€æŒ‡çš„æ˜¯ç»„æˆå…ƒç´ æ„æˆçš„å¤šå…ƒæ€§å’Œç›¸äº’ä¹‹é—´è¾ƒå¤§çš„å·®å¼‚æ€§ã€‚</p>
<ul>
<li><strong>èµ„æºå¼‚è´¨æ€§</strong>ï¼šæ¯”å¦‚æ•°æ®ä¸­å¿ƒçš„æœºå™¨å¾ˆéš¾ä¿è¯é‡‡ç”¨å®Œå…¨ç›¸åŒçš„é…ç½®ï¼Œæ€»ä¼šæœ‰äº›æœºå™¨é«˜é…ç½®ï¼Œæ‹¥æœ‰å¤§é‡çš„å†…å­˜å’Œè®¡ç®—ä»¥åŠå­˜å‚¨èµ„æºï¼Œä¹Ÿä¼šæœ‰å¾ˆå¤šä½é…ç¡¬ä»¶ã€‚åœ¨åšèµ„æºåˆ†é…çš„æ—¶å€™ï¼Œå¿…é¡»è¦è€ƒè™‘è¿™ç§ç¡¬ä»¶çš„èµ„æºå·®å¼‚æ€§ï¼Œä¸€èˆ¬é€šè¿‡å°†èµ„æºåˆ†é…å•ä½ç»†ç²’åº¦åˆ’åˆ†ä¸ºè¾ƒå°å•å…ƒæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</li>
<li><strong>å·¥ä½œè´Ÿè½½å¼‚è´¨æ€§</strong>ï¼šå„ç§æœåŠ¡å’ŒåŠŸèƒ½ç‰¹æ€§å„å¼‚ï¼Œå¯¹èµ„æºçš„éœ€æ±‚å·®å¼‚ä¹Ÿå¾ˆå¤§ã€‚æ¯”å¦‚å¯¹å¤–æœåŠ¡å¼ºè°ƒé«˜å¯ç”¨æ€§ä»¥åŠèµ„æºçš„å……åˆ†ä¼˜å…ˆä¿éšœï¼Œè€Œåå°è¿è¡Œçš„æ‰¹å¤„ç†ä½œä¸šå¾€å¾€æ˜¯ç”±å¾ˆå¤šçŸ­ä»»åŠ¡æ„æˆçš„ï¼Œæ‰€ä»¥éœ€è¦è°ƒåº¦å†³ç­–è¿‡ç¨‹è¦å°½å¯èƒ½å¿«ï¼Œç­‰ç­‰ã€‚</li>
</ul>
<h3 id="æ•°æ®å±€éƒ¨æ€§"><a href="#æ•°æ®å±€éƒ¨æ€§" class="headerlink" title="æ•°æ®å±€éƒ¨æ€§"></a>æ•°æ®å±€éƒ¨æ€§</h3><p><strong>å¤§æ•°æ®åŸºæœ¬è®¾è®¡åŸåˆ™</strong>ï¼šè®¡ç®—ä»»åŠ¡æ¨é€åˆ°æ•°æ®æ‰€åœ¨åœ°è¿›è¡Œè€Œä¸æ˜¯åè¿‡æ¥ã€‚å› ä¸ºæµ·é‡æ•°æ®åˆ†å¸ƒåœ¨å¤§è§„æ¨¡é›†ç¾¤çš„ä¸åŒæœºå™¨ä¸­ï¼Œå¦‚æœç§»åŠ¨æ•°æ®ä¼šäº§ç”Ÿå¤§é‡ä½æ•ˆçš„æ•°æ®ç½‘ç»œä¼ è¾“å¼€é”€</p>
<p>åœ¨èµ„æºç®¡ç†ä¸è°ƒåº¦è¯­å¢ƒä¸‹ï¼Œæœ‰3ç§ç±»å‹çš„æ•°æ®å±€éƒ¨æ€§ï¼šèŠ‚ç‚¹å±€éƒ¨æ€§ï¼ˆNode Localityï¼‰ã€æœºæ¶å±€éƒ¨æ€§ï¼ˆRack Localityï¼‰å’Œå…¨å±€å±€éƒ¨æ€§ï¼ˆGlobal Localityï¼‰</p>
<ul>
<li><strong>èŠ‚ç‚¹å±€éƒ¨æ€§</strong>ï¼šæ˜¯æŒ‡å¯ä»¥å°†è®¡ç®—ä»»åŠ¡åˆ†é…åˆ°æ•°æ®æ‰€åœ¨çš„æœºå™¨èŠ‚ç‚¹ï¼Œè¿™æ˜¯æ•°æ®å±€éƒ¨æ€§æœ€ä¼˜çš„ä¸€ç§æƒ…å½¢ï¼Œå› ä¸ºå®Œæˆè®¡ç®—æ— é¡»ä»»ä½•æ•°æ®ä¼ è¾“ã€‚</li>
<li><strong>æœºæ¶å±€éƒ¨æ€§</strong>ï¼šæŒ‡çš„æ˜¯è™½ç„¶è®¡ç®—ä»»åŠ¡å’Œæ‰€éœ€æ•°æ®åˆ†å±ä¸¤ä¸ªä¸åŒçš„è®¡ç®—èŠ‚ç‚¹ï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªèŠ‚ç‚¹åœ¨åŒä¸€ä¸ªæœºæ¶ä¸­ï¼Œè¿™ä¹Ÿæ˜¯æ•ˆç‡è¾ƒé«˜çš„ä¸€ç§æ•°æ®å±€éƒ¨æ€§ï¼Œå› ä¸ºæœºæ¶å†…æœºå™¨èŠ‚ç‚¹é—´ç½‘ç»œä¼ è¾“é€Ÿåº¦è¦æ˜æ˜¾é«˜äºæœºæ¶é—´ç½‘ç»œä¼ è¾“é€Ÿåº¦ã€‚</li>
<li><strong>å…¨å±€å±€éƒ¨æ€§</strong>ï¼šå…¶ä»–çš„æƒ…å†µéƒ½å±äºï¼Œæ­¤æ—¶éœ€è¦è·¨æœºæ¶è¿›è¡Œç½‘ç»œä¼ è¾“ï¼Œä¼šäº§ç”Ÿè¾ƒå¤§çš„ç½‘ç»œä¼ è¾“å¼€é”€ã€‚</li>
</ul>
<p>èŠ‚ç‚¹å±€éƒ¨æ€§&gt;æœºæ¶å±€éƒ¨æ€§&gt;å…¨å±€å±€éƒ¨æ€§</p>
<h3 id="æŠ¢å å¼è°ƒåº¦ä¸éæŠ¢å å¼è°ƒåº¦"><a href="#æŠ¢å å¼è°ƒåº¦ä¸éæŠ¢å å¼è°ƒåº¦" class="headerlink" title="æŠ¢å å¼è°ƒåº¦ä¸éæŠ¢å å¼è°ƒåº¦"></a>æŠ¢å å¼è°ƒåº¦ä¸éæŠ¢å å¼è°ƒåº¦</h3><ul>
<li><strong>æŠ¢å å¼è°ƒåº¦</strong>ï¼šå¯¹äºæŸä¸ªè®¡ç®—ä»»åŠ¡æ¥è¯´ï¼Œå¦‚æœç©ºé—²èµ„æºä¸è¶³æˆ–è€…å‡ºç°ä¸åŒä»»åŠ¡å…±åŒç«äº‰åŒä¸€èµ„æºï¼Œè°ƒåº¦ç³»ç»Ÿå¯ä»¥ä»æ¯”å½“å‰è®¡ç®—ä»»åŠ¡ä¼˜å…ˆçº§ä½çš„å…¶ä»–ä»»åŠ¡ä¸­è·å–å·²åˆ†é…èµ„æºï¼Œè€Œè¢«æŠ¢å èµ„æºçš„è®¡ç®—ä»»åŠ¡åˆ™éœ€å‡ºè®©èµ„æºåœæ­¢è®¡ç®—ã€‚</li>
<li><strong>éæŠ¢å å¼è°ƒåº¦</strong>ï¼šåªå…è®¸ä»ç©ºé—²èµ„æºä¸­è¿›è¡Œåˆ†é…ï¼Œå¦‚æœå½“å‰ç©ºé—²èµ„æºä¸è¶³ï¼Œåˆ™é¡»ç­‰å¾…å…¶ä»–ä»»åŠ¡é‡Šæ”¾èµ„æºåæ‰èƒ½ç»§ç»­å‘å‰æ¨è¿›ã€‚</li>
</ul>
<h3 id="èµ„æºåˆ†é…ç²’åº¦"><a href="#èµ„æºåˆ†é…ç²’åº¦" class="headerlink" title="èµ„æºåˆ†é…ç²’åº¦"></a>èµ„æºåˆ†é…ç²’åº¦</h3><p>å¤§æ•°æ®åœºæ™¯ä¸‹çš„è®¡ç®—ä»»åŠ¡å¾€å¾€ç”±ä¸¤å±‚ç»“æ„æ„æˆï¼šä½œä¸šçº§ï¼ˆJobï¼‰å’Œä»»åŠ¡çº§ï¼ˆTaskï¼‰ã€‚ä¸€ä¸ªä½œä¸šç”±å¤šä¸ªå¹¶å‘çš„ä»»åŠ¡æ„æˆï¼Œä»»åŠ¡ä¹‹é—´çš„ä¾èµ–å…³ç³»å¾€å¾€å½¢æˆæœ‰å‘æ— ç¯å›¾ï¼ˆDAGï¼‰ï¼Œå…¸å‹çš„MapReduceä»»åŠ¡åˆ™æ˜¯ä¸€ç§æ¯”è¾ƒç‰¹æ®Šçš„DAGå…³ç³»ã€‚</p>
<ul>
<li>ä¸€ç§æç«¯çš„æƒ…å†µæ˜¯éœ€è¦å°†ä½œä¸šçš„æ‰€æœ‰æ‰€éœ€èµ„æºä¸€æ¬¡æ€§åˆ†é…å®Œæˆï¼Œè¿™å¸¸è¢«ç§°ä¸ºâ€œç¾¤ä½“åˆ†é…â€ï¼ˆGang Schedulerï¼‰æˆ–è€…â€œå…¨åˆ†æˆ–ä¸åˆ†â€ï¼ˆAll-or-Nothingï¼‰ç­–ç•¥ã€‚MPIä»»åŠ¡å°±æ˜¯ä¸€ç§å…¸å‹çš„éœ€è¦é‡‡çº³ç¾¤ä½“åˆ†é…ç­–ç•¥çš„ä»»åŠ¡ç±»å‹ã€‚</li>
<li>å¦å¤–ä¸€ç§åˆ†é…ç²’åº¦æ˜¯é‡‡å–å¢é‡æ»¡è¶³å¼åˆ†é…ç­–ç•¥ï¼Œå³å¯¹äºæŸä¸ªä½œä¸šæ¥è¯´ï¼Œåªè¦åˆ†é…éƒ¨åˆ†èµ„æºå°±èƒ½å¯åŠ¨ä¸€äº›ä»»åŠ¡å¼€å§‹è¿è¡Œï¼Œéšç€ç©ºé—²èµ„æºçš„ä¸æ–­å‡ºç°ï¼Œå¯ä»¥é€æ­¥å¢é‡å¼åˆ†é…ç»™ä½œä¸šå…¶ä»–ä»»åŠ¡ä»¥ç»´æŒä½œä¸šä¸æ–­åœ°å‘åæ¨è¿›ï¼Œä»¥MapReduceä¸ºä»£è¡¨çš„æ‰¹å¤„ç†ä»»åŠ¡ä¸€èˆ¬é‡‡ç”¨å¢é‡æ»¡è¶³å¼åˆ†é…ç­–ç•¥ã€‚</li>
<li>æœ‰ä¸€ç§ç‰¹æ®Šçš„å¢é‡æ»¡è¶³å¼åˆ†é…ç­–ç•¥è¢«ç§°ä½œâ€œèµ„æºå‚¨å¤‡â€ï¼ˆResource Hoardingï¼‰ç­–ç•¥ã€‚è¿™æ˜¯æŒ‡åªæœ‰åˆ†é…åˆ°ä¸€å®šé‡çš„èµ„æºä½œä¸šæ‰èƒ½å¯åŠ¨ï¼Œä½†æ˜¯åœ¨æœªè·å¾—è¶³å¤Ÿèµ„æºçš„æ—¶å€™ï¼Œä½œä¸šå¯ä»¥å…ˆæŒæœ‰ç›®å‰å·²åˆ†é…çš„èµ„æºï¼Œå¹¶ç­‰å¾…å…¶ä»–ä½œä¸šé‡Šæ”¾èµ„æºï¼Œè¿™æ ·ä»è°ƒåº¦ç³»ç»Ÿä¸æ–­è·å–æ–°èµ„æºå¹¶è¿›è¡Œå‚¨å¤‡å’Œç´¯ç§¯ï¼Œç›´åˆ°åˆ†é…åˆ°çš„èµ„æºé‡è¾¾åˆ°æœ€ä½æ ‡å‡†åå¼€å§‹è¿è¡Œã€‚</li>
</ul>
<h3 id="é¥¿æ­»ä¸æ­»é”é—®é¢˜"><a href="#é¥¿æ­»ä¸æ­»é”é—®é¢˜" class="headerlink" title="é¥¿æ­»ä¸æ­»é”é—®é¢˜"></a>é¥¿æ­»ä¸æ­»é”é—®é¢˜</h3><ul>
<li>â€œ<strong>é¥¿æ­»</strong>â€ç°è±¡ï¼šè¿™ä¸ªè®¡ç®—ä»»åŠ¡æŒç»­é•¿æ—¶é—´æ— æ³•è·å¾—å¼€å§‹æ‰§è¡Œæ‰€éœ€çš„æœ€å°‘èµ„æºé‡ï¼Œå¯¼è‡´ä¸€ç›´å¤„äºç­‰å¾…æ‰§è¡Œçš„çŠ¶æ€ã€‚æ¯”å¦‚åœ¨èµ„æºç´§å¼ çš„æƒ…å½¢ä¸‹ï¼Œæœ‰äº›ä½ä¼˜å…ˆçº§çš„ä»»åŠ¡å§‹ç»ˆæ— æ³•è·å¾—èµ„æºåˆ†é…æœºä¼š</li>
<li><strong>æ­»é”é—®é¢˜</strong>ï¼šæ˜¯ç”±äºèµ„æºè°ƒåº¦ä¸å½“å¯¼è‡´æ•´ä¸ªè°ƒåº¦ç³»ç»Ÿæ— æ³•ç»§ç»­æ­£å¸¸æ‰§è¡Œã€‚</li>
</ul>
<p>è°ƒåº¦ç³»ç»Ÿå‡ºç°æ­»é”å¿…ç„¶è¡¨ç°ä¸ºæŸäº›ä½œä¸šå¤„äºâ€œé¥¿æ­»â€çŠ¶æ€ï¼Œä½†æ˜¯æœ‰è®¡ç®—ä»»åŠ¡å¤„äºâ€œé¥¿æ­»â€æƒ…å½¢å¹¶ä¸ä¸€å®šæ„å‘³ç€è°ƒåº¦ç³»ç»Ÿå¤„äºæ­»é”çŠ¶æ€ã€‚</p>
<h3 id="èµ„æºéš”ç¦»æ–¹æ³•"><a href="#èµ„æºéš”ç¦»æ–¹æ³•" class="headerlink" title="èµ„æºéš”ç¦»æ–¹æ³•"></a>èµ„æºéš”ç¦»æ–¹æ³•</h3><p>ç›®å‰å¯¹äºèµ„æºéš”ç¦»æœ€å¸¸ç”¨çš„æ‰‹æ®µæ˜¯Linuxå®¹å™¨ï¼ˆLinux Containerï¼ŒLXCï¼‰ï¼ŒYARNå’ŒMesoséƒ½é‡‡ç”¨äº†è¿™ç§æ–¹å¼æ¥å®ç°èµ„æºéš”ç¦»ã€‚</p>
<p><strong>LXC</strong>æ˜¯ä¸€ç§è½»é‡çº§çš„å†…æ ¸è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œå¯ä»¥ç”¨æ¥è¿›è¡Œèµ„æºå’Œè¿›ç¨‹è¿è¡Œçš„éš”ç¦»ï¼Œé€šè¿‡LXCå¯ä»¥åœ¨ä¸€å°ç‰©ç†ä¸»æœºä¸Šéš”ç¦»å‡ºå¤šä¸ªç›¸äº’éš”ç¦»çš„å®¹å™¨ï¼Œç›®å‰æœ‰å¼€æºç‰ˆæœ¬ã€‚LXCåœ¨èµ„æºç®¡ç†æ–¹é¢ä¾èµ–äºLinuxå†…æ ¸çš„cgroupså­ç³»ç»Ÿï¼Œcgroupså­ç³»ç»Ÿæ˜¯Linuxå†…æ ¸æä¾›çš„ä¸€ä¸ªåŸºäºè¿›ç¨‹ç»„çš„èµ„æºç®¡ç†çš„æ¡†æ¶ï¼Œå¯ä»¥ä¸ºç‰¹å®šçš„è¿›ç¨‹ç»„é™å®šå¯ä»¥ä½¿ç”¨çš„èµ„æºã€‚</p>
<h2 id="èµ„æºç®¡ç†ä¸è°ƒåº¦ç³»ç»ŸèŒƒå‹"><a href="#èµ„æºç®¡ç†ä¸è°ƒåº¦ç³»ç»ŸèŒƒå‹" class="headerlink" title="èµ„æºç®¡ç†ä¸è°ƒåº¦ç³»ç»ŸèŒƒå‹"></a>èµ„æºç®¡ç†ä¸è°ƒåº¦ç³»ç»ŸèŒƒå‹</h2><p>3ç§èµ„æºç®¡ç†ä¸è°ƒåº¦ç³»ç»ŸèŒƒå‹ï¼šé›†ä¸­å¼è°ƒåº¦å™¨ã€ä¸¤çº§è°ƒåº¦å™¨ä¸çŠ¶æ€å…±äº«è°ƒåº¦å™¨</p>
<p>![[file-20250922143954531.jpg]]</p>
<h3 id="é›†ä¸­å¼è°ƒåº¦å™¨"><a href="#é›†ä¸­å¼è°ƒåº¦å™¨" class="headerlink" title="é›†ä¸­å¼è°ƒåº¦å™¨"></a>é›†ä¸­å¼è°ƒåº¦å™¨</h3><p>é›†ä¸­å¼è°ƒåº¦å™¨åœ¨æ•´ä¸ªç³»ç»Ÿä¸­åªè¿è¡Œä¸€ä¸ªå…¨å±€çš„ä¸­å¤®è°ƒåº¦å™¨å®ä¾‹ï¼Œæ‰€æœ‰ä¹‹ä¸Šçš„æ¡†æ¶æˆ–è€…è®¡ç®—ä»»åŠ¡çš„èµ„æºè¯·æ±‚å…¨éƒ¨ç»ç”±ä¸­å¤®è°ƒåº¦å™¨æ¥æ»¡è¶³ï¼Œå› æ­¤ï¼Œæ•´ä¸ªè°ƒåº¦ç³»ç»Ÿç¼ºä¹å¹¶å‘æ€§ä¸”æ‰€æœ‰è°ƒåº¦é€»è¾‘å…¨éƒ¨ç”±ä¸­å¤®è°ƒåº¦å™¨æ¥å®ç°ã€‚</p>
<ul>
<li><strong>å•è·¯å¾„è°ƒåº¦å™¨</strong>ï¼šæŒ‡ä¸è®ºè®¡ç®—ä»»åŠ¡æ˜¯ä½•ç§ç±»å‹ï¼Œéƒ½é‡‡å–ç»Ÿä¸€çš„è°ƒåº¦ç­–ç•¥æ¥è¿›è¡Œèµ„æºç®¡ç†ä¸è°ƒåº¦ï¼Œè¿™ç§ç±»å‹è°ƒåº¦å™¨åœ¨é«˜æ€§èƒ½è®¡ç®—ç³»ç»Ÿï¼ˆHPCï¼‰ä¸­éå¸¸å¸¸è§ï¼Œæ¯”å¦‚Mauiä»¥åŠMoabç­‰ç³»ç»Ÿéƒ½é‡‡ç”¨æ­¤ç§æ–¹å¼ã€‚</li>
<li><strong>å¤šè·¯å¾„è°ƒåº¦å™¨</strong>ï¼šå¯ä»¥æ”¯æŒå¤šç§è°ƒåº¦ç­–ç•¥ï¼Œæ¯”å¦‚é’ˆå¯¹æ‰¹å¤„ç†ç±»ä»»åŠ¡é‡‡å–æŸç§è°ƒåº¦ç­–ç•¥ï¼Œå¯¹äºåœ¨çº¿æœåŠ¡ç±»ä»»åŠ¡é‡‡å–å¦å¤–ä¸€ç§è°ƒåº¦ç­–ç•¥ç­‰ã€‚</li>
</ul>
<p>é›†ä¸­å¼è°ƒåº¦å™¨å®ç°é€»è¾‘å¤æ‚ï¼Œç³»ç»Ÿå¯æ‰©å±•æ€§å·®ï¼Œæ”¯æŒä¸åŒç±»å‹çš„è°ƒåº¦ç­–ç•¥ç¼ºä¹çµæ´»æ€§ã€‚</p>
<h3 id="ä¸¤çº§è°ƒåº¦å™¨"><a href="#ä¸¤çº§è°ƒåº¦å™¨" class="headerlink" title="ä¸¤çº§è°ƒåº¦å™¨"></a>ä¸¤çº§è°ƒåº¦å™¨</h3><p>ä¸¤çº§è°ƒåº¦å™¨å°†æ•´ä¸ªç³»ç»Ÿçš„è°ƒåº¦å·¥ä½œåˆ’åˆ†ä¸ºä¸¤ä¸ªçº§åˆ«ï¼šä¸­å¤®è°ƒåº¦å™¨å’Œæ¡†æ¶è°ƒåº¦å™¨ã€‚</p>
<ul>
<li><strong>ä¸­å¤®è°ƒåº¦å™¨</strong>ï¼šå¯ä»¥çœ‹åˆ°é›†ç¾¤ä¸­æ‰€æœ‰æœºå™¨çš„å¯ç”¨èµ„æºå¹¶ç®¡ç†å…¶çŠ¶æ€ï¼Œå®ƒå¯ä»¥æŒ‰ç…§ä¸€å®šç­–ç•¥å°†é›†ç¾¤ä¸­çš„æ‰€æœ‰èµ„æºåˆ†é…ç»™å„ä¸ªè®¡ç®—æ¡†æ¶ï¼Œä¸­å¤®è°ƒåº¦å™¨çº§åˆ«çš„èµ„æºè°ƒåº¦æ˜¯ä¸€ç§ç²—ç²’åº¦çš„èµ„æºè°ƒåº¦æ–¹å¼ã€‚</li>
<li><strong>æ¡†æ¶è°ƒåº¦å™¨</strong>ï¼šå„ä¸ªè®¡ç®—æ¡†æ¶åœ¨æ¥æ”¶åˆ°æ‰€éœ€èµ„æºåï¼Œå¯ä»¥æ ¹æ®è‡ªèº«è®¡ç®—ä»»åŠ¡çš„ç‰¹æ€§ï¼Œä½¿ç”¨è‡ªèº«çš„è°ƒåº¦ç­–ç•¥æ¥è¿›ä¸€æ­¥ç»†ç²’åº¦åœ°åˆ†é…ä»ä¸­å¤®è°ƒåº¦å™¨è·å¾—çš„å„ç§èµ„æºã€‚</li>
</ul>
<p>åªæœ‰ä¸­å¤®è°ƒåº¦å™¨èƒ½å¤Ÿè§‚å¯Ÿåˆ°æ‰€æœ‰é›†ç¾¤èµ„æºçš„çŠ¶æ€ï¼Œè€Œæ¯ä¸ªæ¡†æ¶å¹¶æ— å…¨å±€èµ„æºæ¦‚å¿µï¼Œåªèƒ½çœ‹åˆ°ç”±ä¸­å¤®è°ƒåº¦å™¨åˆ†é…ç»™è‡ªå·±çš„èµ„æºã€‚<br>Mesosã€YARNå’ŒHadoop On Demandç³»ç»Ÿæ˜¯3ä¸ªå…¸å‹çš„ä¸¤çº§è°ƒåº¦å™¨ç³»ç»Ÿã€‚</p>
<p>ä¸¤çº§è°ƒåº¦å™¨ç”±äºåœ¨è®¡ç®—æ¡†æ¶å±‚é¢å­˜åœ¨ç¬¬äºŒçº§èµ„æºè°ƒåº¦ï¼Œè€Œè¿™å¯ä»¥æä¾›ä¸€ç§æ¯”è¾ƒå¤©ç„¶çš„å¹¶å‘æ€§ï¼Œæ‰€ä»¥æ•´ä½“è°ƒåº¦æ€§èƒ½è¾ƒå¥½ï¼Œä¹Ÿé€‚åˆå¤§è§„æ¨¡é›†ç¾¤ä¸‹çš„å¤šä»»åŠ¡é«˜è´Ÿè½½è®¡ç®—æƒ…å½¢ï¼Œå…·æœ‰è¾ƒå¥½çš„å¯æ‰©å±•æ€§ã€‚</p>
<h3 id="çŠ¶æ€å…±äº«è°ƒåº¦å™¨"><a href="#çŠ¶æ€å…±äº«è°ƒåº¦å™¨" class="headerlink" title="çŠ¶æ€å…±äº«è°ƒåº¦å™¨"></a>çŠ¶æ€å…±äº«è°ƒåº¦å™¨</h3><p>åœ¨è¿™ç§è°ƒåº¦èŒƒå‹ä¸­ï¼Œæ¯ä¸ª<strong>è®¡ç®—æ¡†æ¶å¯ä»¥çœ‹åˆ°æ•´ä¸ªé›†ç¾¤ä¸­çš„æ‰€æœ‰èµ„æº</strong>ï¼Œå¹¶é‡‡ç”¨<strong>ç›¸äº’ç«äº‰</strong>çš„æ–¹å¼å»è·å–è‡ªå·±æ‰€éœ€çš„èµ„æºï¼Œæ ¹æ®è‡ªèº«ç‰¹æ€§é‡‡å–ä¸åŒçš„å…·ä½“èµ„æºè°ƒåº¦ç­–ç•¥ï¼ŒåŒæ—¶ç³»ç»Ÿé‡‡ç”¨äº†ä¹è§‚å¹¶å‘æ§åˆ¶æ‰‹æ®µè§£å†³ä¸åŒæ¡†æ¶åœ¨èµ„æºç«äº‰è¿‡ç¨‹ä¸­å‡ºç°çš„éœ€æ±‚å†²çªã€‚</p>
<p>ä¸ä¸¤çº§è°ƒåº¦å™¨å¯¹ç…§å¯ä»¥çœ‹å‡ºï¼Œå…¶å®ä¸¤è€…çš„æ ¹æœ¬åŒºåˆ«åœ¨äºä¸­å¤®è°ƒåº¦å™¨åŠŸèƒ½å¼ºå¼±ä¸åŒã€‚</p>
<p>ä¸¤çº§è°ƒåº¦å™¨ä¾èµ–ä¸­å¤®è°ƒåº¦å™¨æ¥è¿›è¡Œç¬¬ä¸€æ¬¡èµ„æºåˆ†é…ï¼Œè€ŒOmegaåˆ™ä¸¥é‡å¼±åŒ–ä¸­å¤®è°ƒåº¦å™¨çš„åŠŸèƒ½ï¼Œåªæ˜¯ç»´æŠ¤ä¸€ä»½å¯æ¢å¤çš„é›†ç¾¤èµ„æºçŠ¶æ€ä¿¡æ¯ä¸»å‰¯æœ¬ï¼Œè¿™ä»½æ•°æ®è¢«ç§°ä½œâ€œå•å…ƒçŠ¶æ€â€ï¼ˆCell Stateï¼‰ã€‚</p>
<p>æœä¸¤ä¸ªä¸åŒæ¡†æ¶ç«äº‰åŒä¸€ä»½èµ„æºï¼Œå› å…¶å†³ç­–è¿‡ç¨‹éƒ½æ˜¯å„è‡ªåœ¨è‡ªå·±çš„ç§æœ‰æ•°æ®ä¸Šåšå‡ºçš„ï¼Œå¹¶é€šè¿‡åŸå­äº‹åŠ¡è¿›è¡Œæäº¤ï¼Œç³»ç»Ÿä¿è¯æ­¤ç§æƒ…å½¢ä¸‹åªæœ‰ä¸€ä¸ªç«äº‰èƒœå‡ºè€…ï¼Œè€Œå¤±è´¥è€…å¯ä»¥åç»­ç»§ç»­é‡æ–°ç”³è¯·èµ„æºï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ç§<strong>ç±»ä¼¼äºMVCC</strong>çš„ä¹è§‚å¹¶å‘æ§åˆ¶æ‰‹æ®µï¼Œå¯ä»¥å¢åŠ ç³»ç»Ÿçš„æ•´ä½“å¹¶å‘æ€§èƒ½ã€‚</p>
<p>çŠ¶æ€å…±äº«è°ƒåº¦å™¨å°†ä¸¤çº§è°ƒåº¦å™¨çš„ä¸­å¤®è°ƒåº¦å™¨åŠŸ<strong>èƒ½å¼±åŒ–æˆäº†ç»´æŠ¤æŒä¹…åŒ–å¯æ¢å¤çš„é›†ç¾¤èµ„æºçŠ¶æ€ä¿¡æ¯</strong>ï¼Œåªè¦æ‰€æœ‰æ¡†æ¶å…·æœ‰å…³äºç›¸äº’ä¹‹é—´ä¼˜å…ˆçº§é«˜ä½å¯æ¯”çš„å…±è¯†ï¼Œå°±å¯ä»¥é‡‡å–è‡ªç”±ç«äº‰çš„æ–¹å¼å®ç°æŠ¢å å¼æ•´ä½“èµ„æºç®¡ç†ä¸è°ƒåº¦ã€‚</p>
<ul>
<li>é›†ä¸­å¼è°ƒåº¦å™¨æ¯”è¾ƒé€‚åˆå°è§„æ¨¡é›†ç¾¤ä¸‹çš„èµ„æºè°ƒåº¦ä¸ç®¡ç†</li>
<li>ä¸¤çº§è°ƒåº¦å™¨æ¯”è¾ƒé€‚åˆè´Ÿè½½åŒè´¨çš„å¤§è§„æ¨¡é›†ç¾¤åº”ç”¨åœºæ™¯</li>
<li>çŠ¶æ€å…±äº«è°ƒåº¦å™¨åˆ™æ›´é€‚åˆè´Ÿè½½å¼‚è´¨æ€§è¾ƒå¼ºä¸”èµ„æºå†²çªä¸å¤šçš„å¤§è§„æ¨¡é›†ç¾¤åº”ç”¨åœºæ™¯ã€‚</li>
</ul>
<h2 id="èµ„æºè°ƒåº¦ç­–ç•¥"><a href="#èµ„æºè°ƒåº¦ç­–ç•¥" class="headerlink" title="èµ„æºè°ƒåº¦ç­–ç•¥"></a>èµ„æºè°ƒåº¦ç­–ç•¥</h2><h3 id="FIFOè°ƒåº¦ç­–ç•¥"><a href="#FIFOè°ƒåº¦ç­–ç•¥" class="headerlink" title="FIFOè°ƒåº¦ç­–ç•¥"></a>FIFOè°ƒåº¦ç­–ç•¥</h3><p>FIFOç­–ç•¥æ˜¯æœ€ç®€å•çš„èµ„æºè°ƒåº¦ç­–ç•¥ï¼Œæäº¤çš„ä½œä¸šæŒ‰ç…§æäº¤æ—¶é—´å…ˆåé¡ºåºæˆ–è€…æ ¹æ®ä¼˜å…ˆçº§æ¬¡åºå°†å…¶æ”¾å…¥çº¿æ€§é˜Ÿåˆ—ç›¸åº”ä½ç½®ï¼Œåœ¨èµ„æºè°ƒåº¦æ—¶æŒ‰ç…§é˜Ÿåˆ—å…ˆåé¡ºåºï¼Œå…ˆè¿›å…ˆå‡ºåœ°è¿›è¡Œè°ƒåº¦ä¸èµ„æºåˆ†é…ã€‚</p>
<p>FIFOæ˜¯Hadoopé»˜è®¤çš„è°ƒåº¦ç­–ç•¥ï¼Œå¾ˆæ˜æ˜¾è¿™ç§ç­–ç•¥è¿‡äºç®€å•ï¼Œåœ¨å¤šç”¨æˆ·åœºæ™¯ä¸‹ï¼Œæ–°åŠ å…¥çš„ä½œä¸šå¾ˆå®¹æ˜“å‡ºç°é•¿æ—¶é—´ç­‰å¾…è°ƒåº¦çš„ç°è±¡ã€‚</p>
<h3 id="å…¬å¹³è°ƒåº¦å™¨"><a href="#å…¬å¹³è°ƒåº¦å™¨" class="headerlink" title="å…¬å¹³è°ƒåº¦å™¨"></a>å…¬å¹³è°ƒåº¦å™¨</h3><p>å…¬å¹³è°ƒåº¦å™¨æ˜¯Facebookä¸ºHadoopå¼€å‘çš„å¤šç”¨æˆ·å¤šä½œä¸šè°ƒåº¦å™¨ã€‚å…¶å°†ç”¨æˆ·çš„ä»»åŠ¡åˆ†é…åˆ°å¤šä¸ªèµ„æºæ± ï¼ˆPoolï¼‰ï¼Œæ¯ä¸ªèµ„æºæ± è®¾å®šèµ„æºåˆ†é…æœ€ä½ä¿éšœå’Œæœ€é«˜ä¸Šé™ï¼Œç®¡ç†å‘˜ä¹Ÿå¯ä»¥æŒ‡å®šèµ„æºæ± çš„ä¼˜å…ˆçº§ï¼Œä¼˜å…ˆçº§é«˜çš„èµ„æºæ± ä¼šè¢«åˆ†é…æ›´å¤šçš„èµ„æºï¼Œå½“ä¸€ä¸ªèµ„æºæ± èµ„æºæœ‰å‰©ä½™æ—¶ï¼Œå¯ä»¥ä¸´æ—¶å°†å‰©ä½™èµ„æºå…±äº«ç»™å…¶ä»–èµ„æºæ± ã€‚</p>
<p>è°ƒåº¦è¿‡ç¨‹ï¼š</p>
<ul>
<li>æ ¹æ®æ¯ä¸ªèµ„æºæ± çš„æœ€å°èµ„æºä¿éšœé‡ï¼Œå°†ç³»ç»Ÿä¸­çš„éƒ¨åˆ†èµ„æºåˆ†é…ç»™å„ä¸ªèµ„æºæ± ã€‚</li>
<li>æ ¹æ®èµ„æºæ± çš„æŒ‡å®šä¼˜å…ˆçº§å°†å‰©ä½™èµ„æºæŒ‰ç…§æ¯”ä¾‹åˆ†é…ç»™å„ä¸ªèµ„æºæ± ã€‚</li>
<li>åœ¨å„ä¸ªèµ„æºæ± ä¸­ï¼ŒæŒ‰ç…§ä½œä¸šä¼˜å…ˆçº§æˆ–è€…æ ¹æ®å…¬å¹³ç­–ç•¥å°†èµ„æºåˆ†é…ç»™å„ä¸ªä½œä¸šã€‚</li>
</ul>
<p>å…¬å¹³è°ƒåº¦å™¨å’Œèƒ½åŠ›è°ƒåº¦å™¨éƒ½æ˜¯Hadoopå¸¸ç”¨çš„è°ƒåº¦ç­–ç•¥ï¼Œä¸èƒ½åŠ›è°ƒåº¦å™¨ç›¸æ¯”ï¼Œå…¬å¹³è°ƒåº¦å™¨æœ‰ä¸¤ä¸ªæ˜æ˜¾çš„åŒºåˆ«ï¼š</p>
<ul>
<li>å…¬å¹³è°ƒåº¦å™¨æ”¯æŒæŠ¢å å¼è°ƒåº¦ï¼Œå³å¦‚æœæŸä¸ªèµ„æºæ± é•¿æ—¶é—´æœªèƒ½è¢«åˆ†é…åˆ°å…¬å¹³å…±äº«é‡çš„èµ„æºï¼Œåˆ™è°ƒåº¦å™¨å¯ä»¥æ€æ­»è¿‡å¤šåˆ†é…èµ„æºçš„èµ„æºæ± ä¸­çš„ä»»åŠ¡ï¼Œä»¥ç©ºå‡ºèµ„æºä¾›è¿™ä¸ªèµ„æºæ± ä½¿ç”¨ã€‚</li>
<li>å…¬å¹³è°ƒåº¦å™¨æ›´å¼ºè°ƒä½œä¸šé—´çš„å…¬å¹³æ€§ã€‚åœ¨æ¯ä¸ªèµ„æºæ± ä¸­ï¼Œå…¬å¹³è°ƒåº¦å™¨é»˜è®¤ä½¿ç”¨å…¬å¹³ç­–ç•¥æ¥å®ç°èµ„æºåˆ†é…</li>
</ul>
<h3 id="èƒ½åŠ›è°ƒåº¦å™¨"><a href="#èƒ½åŠ›è°ƒåº¦å™¨" class="headerlink" title="èƒ½åŠ›è°ƒåº¦å™¨"></a>èƒ½åŠ›è°ƒåº¦å™¨</h3><p>èƒ½åŠ›è°ƒåº¦å™¨æ˜¯Yahooä¸ºHadoopå¼€å‘çš„å¤šç”¨æˆ·è°ƒåº¦å™¨ï¼Œé€‚åˆç”¨æˆ·é‡ä¼—å¤šçš„åº”ç”¨åœºæ™¯ï¼Œä¸å…¬å¹³è°ƒåº¦å™¨ç›¸æ¯”ï¼Œå…¶æ›´å¼ºè°ƒèµ„æºåœ¨ç”¨æˆ·ä¹‹é—´è€Œéä½œä¸šä¹‹é—´çš„å…¬å¹³æ€§ã€‚</p>
<p>å®ƒå°†ç”¨æˆ·å’Œä»»åŠ¡ç»„ç»‡æˆå¤šä¸ªé˜Ÿåˆ—ï¼Œæ¯ä¸ªé˜Ÿåˆ—å¯ä»¥è®¾å®šèµ„æºæœ€ä½ä¿éšœå’Œä½¿ç”¨ä¸Šé™ï¼Œå½“ä¸€ä¸ªé˜Ÿåˆ—çš„èµ„æºæœ‰å‰©ä½™æ—¶ï¼Œå¯ä»¥å°†å‰©ä½™èµ„æºæš‚æ—¶åˆ†äº«ç»™å…¶ä»–é˜Ÿåˆ—ã€‚è°ƒåº¦å™¨åœ¨è°ƒåº¦æ—¶ï¼Œä¼˜å…ˆå°†èµ„æºåˆ†é…ç»™èµ„æºä½¿ç”¨ç‡æœ€ä½çš„é˜Ÿåˆ—ï¼ˆå³é˜Ÿåˆ—å·²ä½¿ç”¨èµ„æºé‡å åˆ†é…ç»™é˜Ÿåˆ—çš„èµ„æºé‡æ¯”ä¾‹æœ€å°çš„é˜Ÿåˆ—ï¼‰ï¼›åœ¨é˜Ÿåˆ—å†…éƒ¨ï¼Œåˆ™æŒ‰ç…§ä½œä¸šä¼˜å…ˆçº§çš„å…ˆåé¡ºåºéµå¾ªFIFOç­–ç•¥è¿›è¡Œè°ƒåº¦ã€‚</p>
<h3 id="å»¶è¿Ÿè°ƒåº¦ç­–ç•¥"><a href="#å»¶è¿Ÿè°ƒåº¦ç­–ç•¥" class="headerlink" title="å»¶è¿Ÿè°ƒåº¦ç­–ç•¥"></a>å»¶è¿Ÿè°ƒåº¦ç­–ç•¥</h3><p>å»¶è¿Ÿè°ƒåº¦ç­–ç•¥ä¸æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è°ƒåº¦æ–¹å¼ï¼Œå¾€å¾€ä¼šä½œä¸ºå…¶ä»–è°ƒåº¦ç­–ç•¥çš„è¾…åŠ©æªæ–½æ¥å¢åŠ è°ƒåº¦çš„æ•°æ®å±€éƒ¨æ€§ï¼Œä»¥æ­¤æ¥å¢åŠ ä»»åŠ¡æ‰§è¡Œæ•ˆç‡ã€‚</p>
<p>å¯¹äºå½“å‰è¢«è°ƒåº¦åˆ°è¦è¢«åˆ†é…èµ„æºçš„ä»»åŠ¡iï¼Œå¦‚æœå½“å‰èµ„æºä¸æ»¡è¶³æ•°æ®å±€éƒ¨æ€§ï¼Œé‚£ä¹ˆå¯ä»¥æš‚æ—¶æ”¾å¼ƒåˆ†é…å…¬å¹³æ€§ï¼Œä»»åŠ¡iä¸æ¥å—å½“å‰èµ„æºï¼Œè€Œæ˜¯ç­‰å¾…åç»­çš„èµ„æºåˆ†é…ï¼›å½“å‰èµ„æºå¯ä»¥è·³è¿‡ä»»åŠ¡iåˆ†é…ç»™å…¶ä»–å¾…è°ƒåº¦ä»»åŠ¡jï¼Œå¦‚æœä»»åŠ¡iåœ¨è¢«è·³è¿‡kæ¬¡åä»ç„¶ç­‰ä¸åˆ°æ»¡è¶³å±€éƒ¨æ€§çš„èµ„æºï¼Œåˆ™æ”¾å¼ƒæ•°æ®å±€éƒ¨æ€§ï¼Œè¢«è¿«æ¥å—å½“å‰èµ„æºæ¥å¯åŠ¨ä»»åŠ¡æ‰§è¡Œã€‚</p>
<h3 id="ä¸»èµ„æºå…¬å¹³è°ƒåº¦ç­–ç•¥"><a href="#ä¸»èµ„æºå…¬å¹³è°ƒåº¦ç­–ç•¥" class="headerlink" title="ä¸»èµ„æºå…¬å¹³è°ƒåº¦ç­–ç•¥"></a>ä¸»èµ„æºå…¬å¹³è°ƒåº¦ç­–ç•¥</h3><p>ä¸»èµ„æºå…¬å¹³è°ƒåº¦ç­–ç•¥ï¼ˆç®€ç§°DRFï¼‰æ˜¯Mesosä¸­å¤®è°ƒåº¦å™¨é‡‡ç”¨çš„å…¬å¹³è°ƒåº¦ç­–ç•¥ï¼Œä¹Ÿæ˜¯æœ€å¤§æœ€å°å…¬å¹³ç®—æ³•çš„ä¸€ä¸ªå…·ä½“ä½“ç°ã€‚æœ€å¤§æœ€å°å…¬å¹³ç®—æ³•çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šæœ€å¤§åŒ–ç›®å‰åˆ†é…åˆ°æœ€å°‘èµ„æºé‡çš„ç”¨æˆ·æˆ–<br>è€…ä»»åŠ¡çš„èµ„æºé‡ã€‚è¿™ä¸ªç®—æ³•å¸¸å¸¸ç”¨æ¥å¯¹å•ä¸ªèµ„æºè¿›è¡Œå…¬å¹³åˆ†é…ï¼Œè€ŒDRFåˆ™å°†å…¶æ‰©å±•åˆ°äº†å¤šä¸ªèµ„æºçš„å…¬å¹³åˆ†é…åœºæ™¯ä¸‹ã€‚</p>
<h2 id="Mesos"><a href="#Mesos" class="headerlink" title="Mesos"></a>Mesos</h2><p>Mesosæ˜¯ç¾å›½åŠ å·å¤§å­¦ä¼¯å…‹åˆ©åˆ†æ ¡AMPLabå®éªŒå®¤æ¨å‡ºçš„èµ„æºç®¡ç†ä¸è°ƒåº¦ç³»ç»Ÿï¼Œä»å…¶èŒƒå‹æ¥è®²æ˜¯ä¸€ä¸ªå…¸å‹çš„ä¸¤çº§è°ƒåº¦å™¨ã€‚</p>
<p>Mesosçš„æ•´ä½“æ¶æ„å¦‚å›¾æ‰€ç¤ºï¼Œå…¶é‡‡ç”¨äº†å…¸å‹çš„â€œä¸»-ä»â€æ¶æ„ã€‚ä¸­å¤®è°ƒåº¦å™¨ç”±å¤šä¸ªä¸»æ§æœåŠ¡å™¨ï¼ˆMasterï¼‰æ„æˆï¼Œé€šè¿‡ZooKeeperå¯ä»¥ä¿è¯å½“æ­£åœ¨å·¥ä½œçš„ä¸»æ§æœåŠ¡å™¨å‡ºç°æ•…éšœæ—¶ï¼Œå¤‡ç”¨ä¸»æ§æœåŠ¡å™¨ï¼ˆStandby Masterï¼‰å¯ä»¥å¿«é€Ÿå°†ç®¡ç†å·¥ä½œæ¥æ›¿è¿‡æ¥ï¼Œä»¥æ­¤å¢åŠ æ•´ä¸ªè°ƒåº¦ç³»ç»Ÿçš„å¥å£®æ€§ã€‚</p>
<p>![[file-20250922151029334.jpg | 500]]</p>
<p>åˆ†é…èµ„æºè¿‡ç¨‹ï¼š</p>
<ul>
<li>é¦–å…ˆï¼Œ1å·ä»èŠ‚ç‚¹ï¼ˆSlave 1ï¼‰å‘ä¸»æ§æœåŠ¡å™¨æ±‡æŠ¥å…¶æœ‰4ä¸ªCUPå’Œ4 GBå†…å­˜èµ„æºå¯ç”¨ï¼Œä¸»æ§æœåŠ¡å™¨è§¦å‘èµ„æºåˆ†é…æ¨¡å—ï¼Œç”±å…¶åˆ†é…ç­–ç•¥å‘ŠçŸ¥ä¸»æ§æœåŠ¡å™¨åº”è¯¥å°†æ‰€æœ‰èµ„æºåˆ†é…ç»™æ¡†æ¶1ï¼ˆæ­¥éª¤1ï¼‰ã€‚åœ¨æ­¥éª¤2ï¼ŒMesoså°†è¿™ä»½èµ„æºå°è£…ä¸ºâ€œèµ„æºä¾›åº”â€å¹¶å°†å…¶ä¼ ç»™æ¡†æ¶1çš„è°ƒåº¦å™¨ã€‚æ¡†æ¶1çš„è°ƒåº¦å™¨è¿è¡ŒäºŒçº§è°ƒåº¦ç­–ç•¥ï¼Œå°†è¿™ä»½èµ„æºåˆ†é…ç»™ä¸¤ä¸ªä»»åŠ¡ï¼Œå…¶ä¸­ä»»åŠ¡1åˆ†é…äº†2ä¸ªCPUå’Œ1GBå†…å­˜ï¼Œä»»åŠ¡2åˆ†é…äº†1ä¸ªCUPå’Œ2GBå†…å­˜ï¼ˆæ­¥éª¤3ï¼‰</li>
<li>Mesoså°†è¿™ä¸¤ä¸ªä»»åŠ¡åˆ†é…ç»™1å·ä»èŠ‚ç‚¹ï¼Œç”±ä»èŠ‚ç‚¹å®é™…åˆ†é…è¿™äº›èµ„æºç»™å¯¹åº”ä»»åŠ¡å¹¶å¯åŠ¨æ‰§è¡Œå™¨æ‰§è¡Œä»»åŠ¡ï¼ŒåŒæ—¶ä»èŠ‚ç‚¹è¿˜æä¾›ä»»åŠ¡è¿è¡Œçš„èµ„æºéš”ç¦»ç®¡ç†ï¼ˆæ­¥éª¤4ï¼‰ã€‚å› ä¸º1å·ä»èŠ‚ç‚¹æä¾›çš„èµ„æºè¿˜æœ‰å‰©ä½™ï¼ŒMesosä¸­å¤®è°ƒåº¦å™¨è¿˜å¯ä»¥ç»§ç»­å°†å…¶åˆ†é…ç»™æ¡†æ¶2ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒMesoså®ç°äº†ä¸€ä¸ªå…¸å‹çš„ä¸¤çº§è°ƒåº¦å™¨ã€‚</li>
</ul>
<p>![[file-20250922151139957.jpg | 500]]</p>
<p>Mesosæ¯”è¾ƒé€‚åˆä¸åŒæ¡†æ¶ä»»åŠ¡åŒè´¨åŒ–åœºæ™¯ï¼Œå°¤å…¶æ˜¯å¤§éƒ¨åˆ†éƒ½æ˜¯çŸ­ä½œä¸šçš„æƒ…æ™¯ï¼ˆæ¯”å¦‚Hadoopç­‰æ‰¹å¤„ç†ä»»åŠ¡ï¼‰ï¼Œå› ä¸ºä»ä¸Šè¿°æè¿°å¯çŸ¥ï¼ŒMesosæ˜¯ä¸æ”¯æŒæŠ¢å å¼è°ƒåº¦çš„ï¼Œèµ„æºåˆ†é…å‡ºå»ååªèƒ½ç­‰å¾…ä»»åŠ¡è¿è¡Œç»“æŸåè‡ªè¡Œé‡Šæ”¾ï¼Œå¦‚æœæ˜¯å¤§é‡çŸ­ä½œä¸šï¼Œé‚£ä¹ˆèµ„æºé‡Šæ”¾é€Ÿåº¦è¾ƒå¿«ï¼Œè¿™æ ·æ€»æœ‰æ–°èµ„æºå¯åˆ†é…ï¼Œå¯¹äºåç»­çš„ä»»åŠ¡æ¥è¯´å¯ä»¥è¾ƒå¿«è·å¾—èµ„æºï¼Œé¿å…é•¿æ—¶é—´ç­‰å¾…ã€‚</p>
<h2 id="YARN"><a href="#YARN" class="headerlink" title="YARN"></a>YARN</h2><p>YARNæ˜¯Hadoop 2.0çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œä¹Ÿè¢«ç§°ä½œMRV2ï¼Œå…¶å…¨ç§°æ˜¯â€œå¦ä¸€ä¸ªèµ„æºåè°ƒå™¨â€ï¼ˆYet Another Resource Negotiatorï¼‰ï¼Œé¡¾åæ€ä¹‰ï¼Œå…¶æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„èµ„æºç®¡ç†ç³»ç»Ÿã€‚</p>
<p>MRV2ä¸MRV1ç›¸æ¯”ï¼Œæœ€å¤§çš„æ”¹å˜å°±æ˜¯æŠ½è±¡å‡ºYARNè¿™ä¸ªç‹¬ç«‹èµ„æºè°ƒåº¦ç³»ç»Ÿã€‚åœ¨MRV1ä¸­ï¼Œæ‰€æœ‰ä»»åŠ¡çš„èµ„æºç®¡ç†ä»¥åŠç”Ÿå‘½æœŸç®¡ç†éƒ½ç”±å…¨å±€å”¯ä¸€çš„JobTrackeræ¥è´Ÿè´£ï¼Œé€ æˆäº†JobTrackeråŠŸèƒ½ç¹å¤ï¼Œæˆä¸ºæ•´ä¸ªHadoopç³»ç»Ÿçš„ç“¶é¢ˆï¼Œä¸¥é‡é™åˆ¶äº†ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ï¼Œä¹‹å‰æŠ¥é“MRV1ç³»ç»Ÿæœ€å¤§èƒ½æ”¯æŒçš„é›†ç¾¤è§„æ¨¡ä¸º4 000å°æœåŠ¡å™¨ã€‚</p>
<p>YARNåŒMesosä¸€æ ·ï¼Œæ˜¯ä¸ªå…¸å‹çš„ä¸¤çº§è°ƒåº¦å™¨ï¼Œå…¶ä¸­RMç±»ä¼¼äºMesosä¸­çš„ä¸»æ§æœåŠ¡å™¨ï¼Œå……å½“ä¸­å¤®è°ƒåº¦å™¨åŠŸèƒ½ã€‚æ¯ä¸ªä»»åŠ¡çš„AMç±»ä¼¼äºMesosä¸­çš„äºŒçº§è°ƒåº¦å™¨ã€‚AMè´Ÿè´£å‘RMç”³è¯·ä½œä¸šæ‰€éœ€èµ„æºï¼Œå¹¶åœ¨ä½œä¸šçš„ä¼—å¤šä»»åŠ¡ä¸­è¿›è¡Œèµ„æºåˆ†é…ä¸åè°ƒã€‚</p>
<p>YARNä¸Mesoséƒ½æœ‰å¾ˆå¤§çš„å…±æ€§ï¼Œä½†æ˜¯ä¸¤è€…ä¹‹é—´ä¹Ÿæœ‰æ˜æ˜¾çš„åŒºåˆ«ï¼Œæ¯”å¦‚YARNçš„ä¸­å¤®è°ƒåº¦å™¨æ”¯æŒâ€œæŠ¢å å¼è°ƒåº¦â€ä»¥åŠAMå¯ä»¥åœ¨å‘RMç”³è¯·èµ„æºæ—¶æå‡ºæ˜ç¡®çš„æ•°æ®å±€éƒ¨æ€§æ¡ä»¶ç­‰ã€‚</p>
<p><strong>æ•´ä½“æ¶æ„</strong>ï¼šå…¶æœ€ä¸»è¦çš„æ„ä»¶åŒ…æ‹¬ï¼šå”¯ä¸€çš„èµ„æºç®¡ç†å™¨ï¼ˆRMï¼‰ã€æ¯ä¸ªä½œä¸šä¸€ä¸ªçš„â€œåº”ç”¨æœåŠ¡å™¨â€ï¼ˆAMï¼‰ä»¥åŠæ¯ä¸ªæœºå™¨ä¸€ä¸ªçš„â€œèŠ‚ç‚¹ç®¡ç†å™¨â€ï¼ˆNode Managerï¼ŒNMï¼‰ã€‚</p>
<p>![[file-20250922152130039.jpg | 500]]</p>
<ul>
<li>RMï¼šè´Ÿè´£å…¨å±€çš„èµ„æºç®¡ç†å·¥ä½œï¼Œå…¶å†…éƒ¨ä¸»è¦åŠŸèƒ½éƒ¨ä»¶åŒ…æ‹¬ï¼šè°ƒåº¦å™¨ã€AMæœåŠ¡å™¨ï¼ˆAMService&#x2F;ApplicationMastersï¼ŒAMSï¼‰ã€Client-RMæ¥å£ä»¥åŠRM-NMæ¥å£ã€‚YARNçš„RMæ”¯æŒâ€œæŠ¢å å¼è°ƒåº¦â€ï¼Œå½“é›†ç¾¤èµ„æºç¨€ç¼ºæ—¶ï¼ŒRMå¯ä»¥é€šè¿‡åè®®å‘½ä»¤AMé‡Šæ”¾æŒ‡å®šçš„èµ„æºã€‚å¦å¤–ï¼ŒAMåœ¨èµ„æºè¯·æ±‚ä¿¡æ¯å†…ä¹Ÿå¯ä»¥æ˜ç¡®æŒ‡æ˜æ•°æ®å±€éƒ¨æ€§åå¥½ã€‚</li>
<li>AMï¼šè´Ÿè´£å‘RMç”³è¯·å¯åŠ¨ä»»åŠ¡æ‰€éœ€çš„èµ„æºï¼ŒåŒæ—¶åè°ƒä½œä¸šå†…å„ä¸ªä»»åŠ¡çš„è¿è¡Œè¿‡ç¨‹ã€‚å°½ç®¡å…¶åŠŸèƒ½æœ‰ç‰¹æ®Šæ€§ï¼Œä½†æ˜¯å…¶è¿è¡Œè¿‡ç¨‹ä¹Ÿåƒæ™®é€šçš„ä»»åŠ¡ä¸€æ ·è¿è¡Œåœ¨æŸå°æœºå™¨çš„å®¹å™¨å†…ã€‚</li>
<li>NMï¼šæ˜¯YARNä¸­åœ¨æ¯å°æœºå™¨ä¸Šéƒ½éƒ¨ç½²çš„èŠ‚ç‚¹ç®¡ç†å™¨ï¼Œä¸»è¦è´Ÿè´£æœºå™¨å†…å®¹å™¨èµ„æºçš„ç®¡ç†ï¼Œæ¯”å¦‚å®¹å™¨é—´çš„ä¾èµ–å…³ç³»ã€ç›‘æ§å®¹å™¨æ‰§è¡Œä»¥åŠä¸ºå®¹å™¨æä¾›èµ„æºéš”ç¦»ç­‰å„ç§æœåŠ¡ç­‰ã€‚</li>
</ul>
<p>æ‰§è¡Œè¿‡ç¨‹ï¼š<br>ï¼ˆ1ï¼‰ç”¨æˆ·é€šè¿‡å®¢æˆ·ç«¯å‘YARNæäº¤ä½œä¸šã€‚<br>ï¼ˆ2ï¼‰RMé€šè¿‡è°ƒåº¦å™¨ç”³è¯·èµ„æºï¼Œç”¨äºå¯åŠ¨è¿è¡Œä½œä¸šçš„AMï¼›å¦‚æœç”³è¯·åˆ°ï¼Œåˆ™AMSè´Ÿè´£é€šçŸ¥èŠ‚ç‚¹ç®¡ç†å™¨åœ¨ç›¸åº”å®¹å™¨å†…å¯åŠ¨æ‰§è¡ŒAMã€‚<br>ï¼ˆ3ï¼‰AMè´Ÿè´£å°†ä½œä¸šåˆ’åˆ†ä¸ºè‹¥å¹²ä»»åŠ¡ï¼Œå¹¶å‘RMè¯·æ±‚å¯åŠ¨ä»»åŠ¡æ‰€éœ€çš„èµ„æºï¼›RMæ¥æ”¶åˆ°è¯·æ±‚åï¼Œé€šè¿‡è°ƒåº¦å™¨åˆ†é…èµ„æºï¼Œæ‰¾åˆ°åˆé€‚çš„å®¹å™¨åï¼Œå°†è¿™äº›èµ„æºä¿¡æ¯è¿”å›ç»™AMã€‚<br>ï¼ˆ4ï¼‰AMæ ¹æ®èµ„æºä¿¡æ¯ï¼Œåœ¨ä»»åŠ¡é—´ä¼˜åŒ–èµ„æºåˆ†é…ç­–ç•¥ï¼Œç¡®å®šåç›´æ¥ä¸èµ„æºæ‰€åœ¨çš„èŠ‚ç‚¹ç®¡ç†å™¨è”ç³»ï¼Œåœ¨å¯¹åº”çš„å®¹å™¨ä¸­å¯åŠ¨ä»»åŠ¡ï¼ŒèŠ‚ç‚¹ç®¡ç†å™¨è´Ÿè´£å®¹å™¨çš„èµ„æºéš”ç¦»ã€‚<br>ï¼ˆ5ï¼‰AMåœ¨éƒ¨åˆ†ä»»åŠ¡æ‰§è¡Œå®Œæˆåé€æ­¥å‘RMé‡Šæ”¾æ‰€å èµ„æºã€‚</p>
<p>![[file-20250922152759724.jpg | 400]]</p>
<p>YARNæ˜¯ä¸€ä¸ªå…¸å‹çš„ä¸¤çº§è°ƒåº¦å™¨ï¼ŒRMæ‹…å½“ä¸­å¤®è°ƒåº¦å™¨åŠŸèƒ½ï¼Œæ”¯æŒâ€œæŠ¢å å¼è°ƒåº¦â€ï¼ŒAMæ‹…å½“äºŒçº§è°ƒåº¦å™¨çš„åŠŸèƒ½ã€‚ä¸Mesosæ¯”è¾ƒï¼Œç”±äºHadoopçš„å¹¿æ³›æµè¡Œï¼Œå†åŠ ä¸ŠYARNä»£è¡¨äº†Hadoopçš„æœªæ¥å‘å±•è¶‹åŠ¿ï¼Œæ‰€ä»¥ç›¸æ¯”è€Œè¨€æ›´æ´»è·ƒï¼Œå‘å±•å‰æ™¯æ›´ä¹è§‚ã€‚</p>
<h1 id="ç¬¬5ç« â€”â€”åˆ†å¸ƒå¼åè°ƒç³»ç»Ÿ"><a href="#ç¬¬5ç« â€”â€”åˆ†å¸ƒå¼åè°ƒç³»ç»Ÿ" class="headerlink" title="ç¬¬5ç« â€”â€”åˆ†å¸ƒå¼åè°ƒç³»ç»Ÿ"></a>ç¬¬5ç« â€”â€”åˆ†å¸ƒå¼åè°ƒç³»ç»Ÿ</h1><h2 id="Chubbyé”æœåŠ¡"><a href="#Chubbyé”æœåŠ¡" class="headerlink" title="Chubbyé”æœåŠ¡"></a>Chubbyé”æœåŠ¡</h2><p>Chubbyæ˜¯Googleå…¬å¸ç ”å‘çš„é’ˆå¯¹åˆ†å¸ƒå¼ç³»ç»Ÿåè°ƒç®¡ç†çš„ç²—ç²’åº¦é”æœåŠ¡ï¼Œä¸€ä¸ªChubbyå®ä¾‹å¤§çº¦å¯ä»¥è´Ÿè´£1ä¸‡å°4æ ¸CPUæœºå™¨ç›¸äº’ä¹‹é—´å¯¹èµ„æºçš„ååŒç®¡ç†ã€‚è¿™ç§é”æœåŠ¡çš„ä¸»è¦åŠŸèƒ½æ˜¯è®©ä¼—å¤šå®¢æˆ·ç«¯ç¨‹åºè¿›è¡Œç›¸äº’ä¹‹é—´çš„åŒæ­¥ï¼Œå¹¶å¯¹ç³»ç»Ÿç¯å¢ƒæˆ–è€…èµ„æºè¾¾æˆä¸€è‡´è®¤çŸ¥ã€‚</p>
<p>é”æœåŠ¡ï¼šé€šè¿‡å¯¹æ•°æ®åŠ é”çš„æ–¹å¼æ¥å®ç°å„ç§åˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„èµ„æºåè°ƒé—®é¢˜ã€‚</p>
<p>Chubbyæ˜¯ä¸€ç§â€œç²—ç²’åº¦â€é”ï¼Œæ‰€è°“â€œç²—ç²’åº¦â€æŒ‡çš„æ˜¯é”çš„æŒæœ‰æ—¶é—´æ¯”è¾ƒé•¿ï¼Œåä¹‹å¦‚æœé”çš„æŒæœ‰æ—¶é—´è¾ƒçŸ­ï¼ˆç§’çº§åˆ«ï¼‰åˆ™è¢«ç§°ä¸ºç»†ç²’åº¦é”</p>
<p><strong>è®¾è®¡å“²å­¦</strong>ï¼šå¼ºè°ƒåè°ƒç³»ç»Ÿçš„å¯é æ€§ä¸é«˜å¯ç”¨æ€§åŠè¯­ä¹‰æ˜“äºç†è§£ï¼Œè€Œä¸è¿½æ±‚å¤„ç†è¯»ï¼å†™è¯·æ±‚çš„é«˜ååé‡åŠåœ¨åè°ƒç³»ç»Ÿå†…å­˜å‚¨å¤§é‡æ•°æ®ã€‚</p>
<p><strong>ç†è®ºåŸºç¡€</strong>ï¼šPaxosä¸€è‡´æ€§åè®®ï¼ŒPaxosæ˜¯åœ¨å®Œå…¨åˆ†å¸ƒç¯å¢ƒä¸‹ï¼Œä¸åŒå®¢æˆ·ç«¯èƒ½å¤Ÿé€šè¿‡äº¤äº’é€šä¿¡å¹¶æŠ•ç¥¨ï¼Œå¯¹äºæŸä¸ªå†³å®šè¾¾æˆä¸€è‡´çš„ç®—æ³•</p>
<h3 id="ç³»ç»Ÿæ¶æ„"><a href="#ç³»ç»Ÿæ¶æ„" class="headerlink" title="ç³»ç»Ÿæ¶æ„"></a>ç³»ç»Ÿæ¶æ„</h3><p>ç”±å®¢æˆ·ç«¯é“¾æ¥çš„åº“ç¨‹åºå’Œå¤šä¸ªâ€œChubbyå•å…ƒâ€æ„æˆï¼Œä¸€èˆ¬ä¸€ä¸ªæ•°æ®ä¸­å¿ƒéƒ¨ç½²ä¸€å¥—â€œChubbyå•å…ƒâ€ã€‚æ¯ä¸ªâ€œChubbyå•å…ƒâ€é€šå¸¸åŒ…å«5å°æœåŠ¡å™¨ï¼Œé€šè¿‡Paxosåè®®é€‰ä¸¾çš„æ–¹å¼æ¨ä¸¾å…¶ä¸­ä¸€å°ä½œä¸ºâ€œä¸»æ§æœåŠ¡å™¨â€ï¼Œæ‰€æœ‰è¯»ï¼å†™æ“ä½œéƒ½ç”±ä¸»æ§æœåŠ¡å™¨å®Œæˆï¼Œå…¶ä»–4å°ä½œä¸ºå¤‡ä»½æœåŠ¡å™¨ï¼Œåœ¨å†…å­˜ä¸­ç»´æŠ¤å’Œä¸»æ§æœåŠ¡å™¨å®Œå…¨ä¸€è‡´çš„æ ‘å½¢ç»“æ„</p>
<p>![[file-20250923195504240.jpg | 500]]</p>
<ul>
<li>â€œä¸»æ§æœåŠ¡å™¨â€ç”±æ‰€æœ‰æœåŠ¡å™¨é€‰ä¸¾æ¨å‡ºï¼Œæœ‰â€œä»»æœŸâ€çš„ï¼Œæ­¤å³â€œä¸»æ§æœåŠ¡å™¨ç§Ÿçº¦â€ï¼ˆMaster Leaseï¼‰ï¼Œå½“ä¸»æ§æœåŠ¡å™¨â€œä»»æœŸâ€æœŸæ»¡åï¼Œç³»ç»Ÿä¼šå†æ¬¡æŠ•ç¥¨é€‰ä¸¾å‡ºæ–°çš„â€œä¸»æ§æœåŠ¡å™¨â€ï¼Œå¦‚æœæ— æ•…éšœç­‰å¼‚å¸¸æƒ…å†µå‘ç”Ÿï¼Œä¸€èˆ¬æƒ…å†µä¸‹ç³»ç»Ÿè¿˜æ˜¯å°½é‡å°†ç§Ÿçº¦äº¤ç»™åŸå…ˆçš„â€œä¸»æ§æœåŠ¡å™¨â€</li>
<li>å®¢æˆ·ç«¯é€šè¿‡åµŒå…¥çš„åº“ç¨‹åºï¼Œåˆ©ç”¨RPCé€šä¿¡æ¥å’ŒæœåŠ¡å™¨è¿›è¡Œäº¤äº’ï¼Œå¯¹Chubbyçš„è¯»ï¼å†™è¯·æ±‚éƒ½ç”±â€œä¸»æ§æœåŠ¡å™¨â€æ¥è´Ÿè´£ã€‚</li>
</ul>
<h3 id="æ•°æ®æ¨¡å‹"><a href="#æ•°æ®æ¨¡å‹" class="headerlink" title="æ•°æ®æ¨¡å‹"></a>æ•°æ®æ¨¡å‹</h3><p>Chubbyç±»ä¼¼äºæ–‡ä»¶ç³»ç»Ÿçš„ç›®å½•å’Œæ–‡ä»¶ç®¡ç†ç³»ç»Ÿï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šæä¾›é’ˆå¯¹ç›®å½•å’Œæ–‡ä»¶çš„é”æœåŠ¡ã€‚</p>
<p>Chubbyçš„æ–‡ä»¶ä¸»è¦å­˜å‚¨ä¸€äº›ç®¡ç†ä¿¡æ¯æˆ–è€…åŸºç¡€æ•°æ®ï¼ŒChubbyè¦æ±‚å¯¹æ–‡ä»¶å†…å®¹ä¸€æ¬¡æ€§åœ°å…¨éƒ¨è¯»å®Œæˆ–è€…å†™å…¥ï¼Œè¿™æ˜¯ä¸ºäº†å°½å¯èƒ½åœ°æŠ‘åˆ¶å®¢æˆ·ç«¯ç¨‹åºå†™å…¥å¤§é‡æ•°æ®åˆ°æ–‡ä»¶ä¸­ï¼Œå› ä¸ºChubbyçš„ç›®çš„ä¸æ˜¯æ•°æ®å­˜å‚¨ï¼Œè€Œæ˜¯å¯¹èµ„æºçš„åŒæ­¥ç®¡ç†ï¼Œæ‰€ä»¥ä¸æ¨èåœ¨æ–‡ä»¶ä¸­ä¿å­˜å¤§é‡æ•°æ®ã€‚</p>
<p>Chubbyè¿˜æä¾›äº†æ–‡ä»¶å†…å®¹æˆ–è€…ç›®å½•æ›´æ”¹åçš„é€šçŸ¥æœºåˆ¶ï¼Œå®¢æˆ·ç«¯å¯ä»¥è®¢é˜…æŸä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œå½“æ–‡ä»¶å†…å®¹å’Œå­ç›®å½•å‘ç”Ÿå˜åŒ–æˆ–è€…ä¸€äº›ç³»ç»Ÿç¯å¢ƒå‘ç”Ÿå˜åŒ–æ—¶ï¼ŒChubbyä¼šä¸»åŠ¨é€šçŸ¥è¿™äº›è®¢é˜…è¯¥æ–‡ä»¶æˆ–ç›®å½•çš„å®¢æˆ·ç«¯ï¼Œä»¥ä½¿å¾—è¿™ç§ä¿¡æ¯å˜åŒ–å¾—ä»¥åŠæ—¶ä¼ æ’­ã€‚</p>
<p>![[file-20250923195842521.jpg | 500]]<br>Chubbyåœ¨è¿™ä¸ªæ ‘å½¢ç›®å½•ç»“æ„ä¸­æä¾›äº†å¾ˆå¤šç®¡ç†åŠŸèƒ½ï¼Œæ¯”å¦‚é’ˆå¯¹æŸä¸ªç›®å½•æˆ–è€…æ–‡ä»¶çš„åŠ é”æœåŠ¡ï¼Œé’ˆå¯¹ç›®å½•æˆ–è€…æ–‡ä»¶çš„è®¿é—®æƒé™æ§åˆ¶ï¼Œæ–‡ä»¶å†…å®¹å­˜å–ä»¥åŠäº‹ä»¶é€šçŸ¥æœºåˆ¶ã€‚é€šè¿‡è¿™ç§ç»“æ„ï¼Œå¯ä»¥æœ‰æ•ˆå®ç°åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„åŒæ­¥ååŒå’Œèµ„æºç®¡ç†åŠŸèƒ½ã€‚</p>
<h3 id="ä¼šè¯ä¸KeepAliveæœºåˆ¶"><a href="#ä¼šè¯ä¸KeepAliveæœºåˆ¶" class="headerlink" title="ä¼šè¯ä¸KeepAliveæœºåˆ¶"></a>ä¼šè¯ä¸KeepAliveæœºåˆ¶</h3><p>è¿™é‡Œçš„ä¼šè¯ï¼ˆSessionï¼‰æŒ‡çš„æ˜¯å®¢æˆ·ç«¯å’Œä¸»æ§æœåŠ¡å™¨ä¹‹é—´å»ºç«‹çš„è”ç³»é€šé“ï¼Œè€Œä¼šè¯çš„ç»´æŒæ˜¯ç”±å‘¨æœŸæ€§è¿›è¡Œæ¡æ‰‹çš„KeepAliveæœºåˆ¶ä¿è¯çš„ï¼Œå³é€šè¿‡ä¸¤è€…ä¹‹é—´ä¸æ–­çš„KeepAliveé€šä¿¡æ¥å»¶ç»­ä¼šè¯ã€‚</p>
<p>æ¯æ¬¡ä¼šè¯ä¹Ÿæœ‰ç›¸åº”çš„ç§Ÿçº¦ï¼Œåœ¨ç§Ÿçº¦æ—¶é—´æ®µå†…æœåŠ¡å™¨ä¿è¯ä¸ä¼šå•æ–¹é¢å°†ä¼šè¯ç»ˆæ­¢ã€‚</p>
<p>ä¼šè¯æœºåˆ¶å·¥ä½œè¿‡ç¨‹ï¼šå®¢æˆ·ç«¯å‘ä¸»æ§æœåŠ¡å™¨å‘å‡ºKeepAliveæ¶ˆæ¯ï¼ˆä¸€ä¸ªRPCè°ƒç”¨ï¼‰ï¼ŒæœåŠ¡å™¨åœ¨æ¥æ”¶åˆ°KeepAliveæ¶ˆæ¯åï¼Œé˜»å¡è¿™ä¸ªRPCè°ƒç”¨ï¼Œç›´åˆ°å®¢æˆ·ç«¯åŸå…ˆçš„ç§Ÿçº¦æ¥è¿‘è¿‡æœŸä¸ºæ­¢ã€‚</p>
<h3 id="å®¢æˆ·ç«¯ç¼“å­˜"><a href="#å®¢æˆ·ç«¯ç¼“å­˜" class="headerlink" title="å®¢æˆ·ç«¯ç¼“å­˜"></a>å®¢æˆ·ç«¯ç¼“å­˜</h3><p>ä¸ºäº†å‡å°‘å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡é‡ï¼ŒChubbyå…è®¸å®¢æˆ·ç«¯åœ¨æœ¬åœ°ç¼“å­˜éƒ¨åˆ†æœåŠ¡å™¨æ•°æ®ï¼Œè€Œç”±Chubbyæ¥ä¿è¯ç¼“å­˜æ•°æ®å’ŒæœåŠ¡å™¨ç«¯æ•°æ®å®Œå…¨ä¸€è‡´ã€‚</p>
<h3 id="ZooKeeper"><a href="#ZooKeeper" class="headerlink" title="ZooKeeper"></a>ZooKeeper</h3><p>ZooKeeperæ˜¯Yahooå¼€å‘å¹¶å¼€æºå‡ºçš„ä¸€å¥—å¯æ‰©å±•é«˜åååˆ†å¸ƒå¼åè°ƒç³»ç»Ÿï¼Œç›®å‰å·²ç»åœ¨å„ç§NoSQLæ•°æ®åº“åŠè¯¸å¤šå¼€æºè½¯ä»¶ä¸­è·å¾—å¹¿æ³›ä½¿ç”¨ã€‚æ­£ç¡®åœ°ä½¿ç”¨ZooKeeperå¯ä»¥å¾ˆæ–¹ä¾¿åœ°è§£å†³å„ç§åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç®¡ç†åè°ƒé—®é¢˜ï¼Œæœ¬èŠ‚ä¸»è¦ä»‹ç»è¿™ä¸€åè°ƒç³»ç»Ÿçš„è®¾è®¡æ¶æ„åŠç›¸åº”çš„ä½¿ç”¨åœºæ™¯ã€‚</p>
<h3 id="ä½“ç³»ç»“æ„"><a href="#ä½“ç³»ç»“æ„" class="headerlink" title="ä½“ç³»ç»“æ„"></a>ä½“ç³»ç»“æ„</h3><p>ZooKeeperæ˜¯ä¸€ä¸ªé«˜ååçš„åˆ†å¸ƒå¼åè°ƒç³»ç»Ÿï¼ŒåŒä¸€æ—¶åˆ»å¯ä»¥åŒæ—¶å“åº”ä¸Šä¸‡ä¸ªå®¢æˆ·ç«¯è¯·æ±‚ã€‚ZooKeeperæœåŠ¡ç”±è‹¥å¹²å°æœåŠ¡å™¨æ„æˆï¼Œæ¯å°æœåŠ¡å™¨å†…å­˜ä¸­ç»´æŠ¤ç›¸åŒçš„ç±»ä¼¼äºæ–‡ä»¶ç³»ç»Ÿçš„æ ‘å½¢æ•°æ®ç»“æ„ï¼Œå…¶ä¸­çš„ä¸€å°é€šè¿‡ZABåŸå­å¹¿æ’­åè®®é€‰ä¸¾ä½œä¸ºä¸»æ§æœåŠ¡å™¨ï¼Œå…¶ä»–çš„ä½œä¸ºä»å±æœåŠ¡å™¨ã€‚å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡TCPåè®®è¿æ¥ä»»æ„ä¸€å°æœåŠ¡å™¨ï¼Œå¦‚æœå®¢æˆ·ç«¯æ˜¯è¯»æ“ä½œè¯·æ±‚ï¼Œåˆ™ä»»æ„ä¸€ä¸ªæœåŠ¡å™¨éƒ½å¯ä»¥ç›´æ¥å“åº”è¯·æ±‚ï¼›å¦‚æœæ˜¯æ›´æ–°æ•°æ®æ“ä½œï¼ˆå†™æ•°æ®æˆ–è€…æ›´æ–°æ•°æ®ï¼‰ï¼Œåˆ™åªèƒ½ç”±ä¸»æ§æœåŠ¡å™¨æ¥åè°ƒæ›´æ–°æ“ä½œï¼›å¦‚æœå®¢æˆ·ç«¯è¿æ¥çš„æ˜¯ä»å±æœåŠ¡å™¨ï¼Œåˆ™ä»å±æœåŠ¡å™¨ä¼šå°†æ›´æ–°æ•°æ®è¯·æ±‚è½¬å‘åˆ°ä¸»æ§æœåŠ¡å™¨ï¼Œç”±å…¶å®Œæˆæ›´æ–°æ“ä½œã€‚</p>
<p>![[file-20250923200647825.jpg | 500]]</p>
<p>ä¸»æ§æœåŠ¡å™¨å°†æ‰€æœ‰æ›´æ–°æ“ä½œåºåˆ—åŒ–ï¼Œåˆ©ç”¨ZABåè®®å°†æ•°æ®æ›´æ–°è¯·æ±‚é€šçŸ¥æ‰€æœ‰ä»å±æœåŠ¡å™¨ï¼ŒZABä¿è¯æ›´æ–°æ“ä½œçš„ä¸€è‡´æ€§åŠé¡ºåºæ€§ã€‚</p>
<p>ZooKeeperçš„ä»»æ„ä¸€å°æœåŠ¡å™¨éƒ½å¯ä»¥å“åº”å®¢æˆ·ç«¯çš„è¯»æ“ä½œï¼Œè¿™æ˜¯ä¸ºä½•å…¶ååé‡é«˜çš„ä¸»è¦åŸå› ã€‚</p>
<p>Chubbyåœ¨è¿™ç‚¹ä¸Šä¸ZooKeeperä¸åŒï¼Œæ‰€æœ‰è¯»ï¼å†™æ“ä½œéƒ½ç”±ä¸»æ§æœåŠ¡å™¨å®Œæˆï¼Œä»å±æœåŠ¡å™¨åªæ˜¯ä¸ºäº†æé«˜æ•´ä¸ªåè°ƒç³»ç»Ÿçš„å¯ç”¨æ€§ï¼Œå³ä¸»æ§æœåŠ¡å™¨å‘ç”Ÿæ•…éšœåèƒ½å¤Ÿåœ¨ä»å±æœåŠ¡å™¨ä¸­å¿«é€Ÿé€‰ä¸¾å‡ºæ–°çš„ä¸»æ§æœåŠ¡å™¨ã€‚</p>
<ul>
<li><strong>æ½œåœ¨é—®é¢˜</strong>ï¼šå®¢æˆ·ç«¯å¯èƒ½ä¼šè¯»åˆ°è¿‡æœŸæ•°æ®</li>
<li><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šåœ¨ZooKeeperçš„æ¥å£APIå‡½æ•°ä¸­æä¾›äº†Syncæ“ä½œï¼Œåº”ç”¨å¯ä»¥æ ¹æ®éœ€è¦åœ¨è¯»æ•°æ®å‰è°ƒç”¨è¯¥æ“ä½œï¼Œå…¶å«ä¹‰æ˜¯ï¼šæ¥æ”¶åˆ°Syncå‘½ä»¤çš„ä»å±æœåŠ¡å™¨ä»ä¸»æ§æœåŠ¡å™¨åŒæ­¥çŠ¶æ€ä¿¡æ¯ï¼Œä¿è¯ä¸¤è€…å®Œå…¨ä¸€è‡´ã€‚è¿™æ ·å¦‚æœåœ¨è¯»æ“ä½œå‰è°ƒç”¨Syncæ“ä½œï¼Œåˆ™å¯ä»¥ä¿è¯å®¢æˆ·ç«¯ä¸€å®šå¯ä»¥è¯»å–åˆ°æœ€æ–°çŠ¶æ€çš„æ•°æ®ã€‚</li>
</ul>
<p>ZooKeeperé€šè¿‡â€œé‡æ”¾æ—¥å¿—ï¼ˆReplay logï¼‰â€ç»“åˆâ€œæ¨¡ç³Šå¿«ç…§ï¼ˆFuzzy Snapshotï¼‰â€æ¥å¯¹æœåŠ¡å™¨æ•…éšœè¿›è¡Œå®¹é”™ã€‚</p>
<ul>
<li>â€œé‡æ”¾æ—¥å¿—â€ï¼šåœ¨å°†æ›´æ–°æ“ä½œä½“ç°åœ¨å†…å­˜æ•°æ®ä¹‹å‰å…ˆå†™å…¥å¤–å­˜æ—¥å¿—ä¸­é¿å…æ•°æ®ä¸¢å¤±ï¼›</li>
<li>â€œæ¨¡ç³Šå¿«ç…§â€ï¼šåœ¨å‘¨æœŸæ€§å¯¹å†…å­˜æ•°æ®åšæ•°æ®å¿«ç…§æ—¶ï¼Œå¹¶ä¸å¯¹å†…å­˜æ•°æ®åŠ é”ï¼Œè€Œæ˜¯ç”¨æ·±åº¦éå†çš„æ–¹å¼å°†å†…å­˜ä¸­çš„æ ‘å½¢ç»“æ„è½¬å…¥å¤–å­˜å¿«ç…§æ•°æ®ä¸­</li>
</ul>
<h3 id="æ•°æ®æ¨¡å‹-1"><a href="#æ•°æ®æ¨¡å‹-1" class="headerlink" title="æ•°æ®æ¨¡å‹"></a>æ•°æ®æ¨¡å‹</h3><p>ä¸Chubbyä¸€æ ·ï¼ŒZooKeeperçš„å†…å­˜æ•°æ®æ¨¡å‹ç±»ä¼¼äºä¼ ç»Ÿçš„æ–‡ä»¶ç³»ç»Ÿæ¨¡å¼ï¼Œç”±æ ‘å½¢çš„å±‚çº§ç›®å½•ç»“æ„æ„æˆï¼Œå…¶ä¸­çš„èŠ‚ç‚¹è¢«ç§°ä½œZnodeã€‚Znodeå¯ä»¥æ˜¯æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯ç›®å½•ï¼Œå¦‚æœæ˜¯ç›®å½•çš„è¯è¿˜å¯ä»¥æœ‰å­ç›®å½•ã€‚å¦‚æœæ˜¯æ–‡ä»¶çš„è¯ï¼Œä¸€èˆ¬éœ€è¦æ•´ä½“å®Œæˆè¯»ï¼å†™æ“ä½œçš„å°æ–‡ä»¶ï¼Œè¿™ä¸Chubbyä¸€æ ·æ˜¯å‡ºäºé¿å…åº”ç”¨å°†åè°ƒç³»ç»Ÿå½“ä½œå­˜å‚¨ç³»ç»Ÿæ¥ç”¨ã€‚</p>
<p>![[file-20250923201038244.jpg | 300]]<br>ZnodeèŠ‚ç‚¹æœ‰ä¸¤ç§ç±»å‹ï¼š</p>
<ul>
<li>æŒä¹…èŠ‚ç‚¹ä¸è®ºå®¢æˆ·ç«¯ä¼šè¯æƒ…å†µï¼Œä¸€ç›´å­˜åœ¨ï¼Œåªæœ‰å½“å®¢æˆ·ç«¯æ˜¾å¼è°ƒç”¨åˆ é™¤æ“ä½œæ‰ä¼šæ¶ˆå¤±ã€‚</li>
<li>ä¸´æ—¶èŠ‚ç‚¹ä¸åŒï¼Œä¼šåœ¨å®¢æˆ·ç«¯ä¼šè¯ç»“æŸæˆ–è€…å‘ç”Ÿæ•…éšœçš„æ—¶å€™è¢«ZooKeeperç³»ç»Ÿè‡ªåŠ¨æ¸…é™¤ã€‚</li>
</ul>
<h3 id="API"><a href="#API" class="headerlink" title="API"></a>API</h3><p>ZooKeeperæä¾›äº†ç®€å•çš„æ“ä½œåŸè¯­ä¾›åº”ç”¨ä½¿ç”¨ï¼Œè¿™äº›æ“ä½œåŸè¯­ç±»ä¼¼äºæ–‡ä»¶ç³»ç»Ÿçš„è°ƒç”¨æ¥å£ï¼Œå«ä¹‰å¾ˆæ¸…æ¥šã€‚</p>
<p>syncæ“ä½œçš„è¯­ä¹‰ï¼šå…¶å«ä¹‰æ˜¯é€šçŸ¥å®¢æˆ·ç«¯è¿æ¥åˆ°çš„é‚£ä¸ªZooKeeperæœåŠ¡å™¨ï¼Œå°†å…¶å†…å­˜æ•°æ®åº“å†…å®¹ä»å…¶ä»–æœåŠ¡å™¨åŒæ­¥åˆ°æœ€æ–°çŠ¶æ€ï¼Œè¿™æ˜¯ä¸ºäº†é¿å…è¯»åˆ°è¿‡æœŸæ•°æ®ã€‚</p>
<h3 id="ZooKeeperçš„å…¸å‹åº”ç”¨åœºæ™¯"><a href="#ZooKeeperçš„å…¸å‹åº”ç”¨åœºæ™¯" class="headerlink" title="ZooKeeperçš„å…¸å‹åº”ç”¨åœºæ™¯"></a>ZooKeeperçš„å…¸å‹åº”ç”¨åœºæ™¯</h3><h4 id="1ï¼é¢†å¯¼è€…é€‰ä¸¾ï¼ˆLeader-Electionï¼‰"><a href="#1ï¼é¢†å¯¼è€…é€‰ä¸¾ï¼ˆLeader-Electionï¼‰" class="headerlink" title="1ï¼é¢†å¯¼è€…é€‰ä¸¾ï¼ˆLeader Electionï¼‰"></a>1ï¼é¢†å¯¼è€…é€‰ä¸¾ï¼ˆLeader Electionï¼‰</h4><p>åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä¸€ç§ç»å…¸çš„ä½“ç³»ç»“æ„æ˜¯ä¸»ä»ç»“æ„ï¼ˆMaster-Slaveï¼‰ï¼Œä¸»æ§æœåŠ¡å™¨è´Ÿè´£å…¨å±€ç®¡ç†æ§åˆ¶å·¥ä½œï¼Œè€Œä»èŠ‚ç‚¹è´Ÿè´£å…·ä½“çš„ä»»åŠ¡è®¡ç®—æˆ–è€…æ•°æ®å­˜å‚¨ç®¡ç†å·¥ä½œã€‚</p>
<p>ä¸ºäº†é˜²æ­¢å•ç‚¹å¤±æ•ˆï¼Œå¾€å¾€ä¼šé‡‡å–ä¸€ä¸»ä¸€å¤‡æˆ–è€…ä¸€ä¸»å¤šå¤‡ï¼Œå½“ä¸»æ§æœåŠ¡å™¨å‘ç”Ÿæ•…éšœåï¼Œç”±æŸå°å¤‡æœºæ¥ç®¡ä¸»æ§æœåŠ¡å™¨åŠŸèƒ½æˆä¸ºæ–°çš„ä¸»æ§æœºï¼Œè€Œè¿™ä¸€èˆ¬è¢«ç§°ä¸ºé¢†å¯¼è€…é€‰ä¸¾ï¼ŒZooKeeperæ˜¯è§£å†³è¿™ç±»é—®é¢˜çš„å¸¸è§è§£å†³æ–¹æ¡ˆã€‚</p>
<p>ZooKeeperåœ¨å®ç°é¢†å¯¼è€…é€‰ä¸¾æ—¶ï¼Œå°†ä¸´æ—¶èŠ‚ç‚¹Zlè®¾ç½®ä¸ºé¢†å¯¼è€…ä¸“ç”¨èŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹å†…å®¹ä¸­å­˜å‚¨é¢†å¯¼è€…çš„åœ°å€ä¿¡æ¯åŠå…¶ä»–è¾…åŠ©ä¿¡æ¯ã€‚æ¯ä¸ªè¿›ç¨‹ï¼ˆæˆ–è€…æœºå™¨ï¼‰æ‰§è¡Œä»¥ä¸‹é€»è¾‘å®ç°é¢†å¯¼è€…é€‰ä¸¾è¿‡ç¨‹ã€‚</p>
<p>è¿›ç¨‹pè¯»å–Zlå†…å®¹å¹¶è®¾ç½®è§‚å¯Ÿæ ‡è¯†ï¼Œå¦‚æœè¯»å–æ“ä½œæˆåŠŸï¼Œè¯´æ˜ç›®å‰å·²æœ‰é¢†å¯¼è€…å¹¶å¯ä»è¯»å–ç»“æœä¸­è·å¾—é¢†å¯¼è€…ç›¸å…³ä¿¡æ¯ï¼›å¦‚æœè¯»å–å¤±è´¥ï¼Œè¯´æ˜ç›®å‰æ— é¢†å¯¼è€…ï¼Œåˆ™è¿›ç¨‹pè¯•å›¾è‡ªå·±åˆ›å»ºè¯¥èŠ‚ç‚¹ï¼ˆä¸´æ—¶èŠ‚ç‚¹æ–¹å¼ï¼‰ï¼Œå¹¶å°†è‡ªå·±çš„ç›¸å…³ä¿¡æ¯å†™å…¥ã€‚å¦‚æœåˆ›å»ºå¹¶å†™å…¥æˆåŠŸåˆ™pæˆä¸ºé¢†å¯¼è€…ï¼Œå…¶ä»–éé¢†å¯¼è€…å› ä¸ºè®¾ç½®äº†è§‚å¯Ÿæ ‡è¯†ï¼Œæ‰€ä»¥ZooKeeperä¼šé€šçŸ¥æ‰€æœ‰éé¢†å¯¼è€…è¯´é¢†å¯¼è€…å‘ç”Ÿäº†å˜åŒ–ï¼Œéé¢†å¯¼è€…å¯ä»¥è¯»å–Zlå†…å®¹è·å–æœ€æ–°é¢†å¯¼è€…ä¿¡æ¯ã€‚</p>
<h4 id="2ï¼é…ç½®ç®¡ç†ï¼ˆConfiguration-Managementï¼‰"><a href="#2ï¼é…ç½®ç®¡ç†ï¼ˆConfiguration-Managementï¼‰" class="headerlink" title="2ï¼é…ç½®ç®¡ç†ï¼ˆConfiguration Managementï¼‰"></a>2ï¼é…ç½®ç®¡ç†ï¼ˆConfiguration Managementï¼‰</h4><p>ZooKeeperå¯ä»¥ç”¨æ¥è¿›è¡Œé…ç½®ä¿¡æ¯çš„åŠ¨æ€ç®¡ç†,é…ç½®æ–‡ä»¶å­˜å‚¨åœ¨ZooKeeperçš„æŸä¸ªèŠ‚ç‚¹Zcä¸­ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å®¢æˆ·ç«¯è¿›ç¨‹åœ¨å¯åŠ¨æ—¶ä»Zc ä¸­è¯»å–é…ç½®ä¿¡æ¯ï¼Œå¹¶è®¾ç½®è§‚å¯Ÿæ ‡è®°ã€‚è‹¥é…ç½®æ–‡ä»¶å†…å®¹åœ¨ä»¥åè¢«æ”¹å˜ï¼Œå®¢æˆ·ç«¯è¿›ç¨‹ä¼šæ¥æ”¶åˆ°Zc çš„å˜åŒ–é€šçŸ¥ï¼Œå¯ä»¥å†æ¬¡è¯»å–Zc èŠ‚ç‚¹å†…å®¹ä»¥æ•è·å˜åŒ–ç‚¹å¹¶åŒæ—¶å†æ¬¡è®¾ç½®è§‚å¯Ÿæ ‡è®°ï¼Œè¿™æ ·ä»¥åæ¯æ¬¡é…ç½®æ–‡ä»¶çš„å˜åŒ–å®¢æˆ·ç«¯éƒ½å¯ä»¥åŠæ—¶æ”¶åˆ°é€šçŸ¥ã€‚</p>
<p>![[file-20250923202014501.jpg | 400]]</p>
<h4 id="3ï¼ç»„æˆå‘˜ç®¡ç†ï¼ˆGroup-Membershipï¼‰"><a href="#3ï¼ç»„æˆå‘˜ç®¡ç†ï¼ˆGroup-Membershipï¼‰" class="headerlink" title="3ï¼ç»„æˆå‘˜ç®¡ç†ï¼ˆGroup Membershipï¼‰"></a>3ï¼ç»„æˆå‘˜ç®¡ç†ï¼ˆGroup Membershipï¼‰</h4><p>ç»„æˆå‘˜ç®¡ç†çš„ä»»åŠ¡ç›®æ ‡æ˜¯åŠ¨æ€ç›‘æ§ä¸€ä¸ªç»„å†…æˆå‘˜çš„å˜åŒ–æƒ…å†µï¼Œæ¯”å¦‚æœ‰æˆå‘˜åŠ å…¥ç¾¤ç»„æˆ–è€…ç¦»å¼€ç¾¤ç»„ã€‚ä¸€ä¸ªå…¸å‹çš„åº”ç”¨åœºæ™¯ï¼Œæ¯”å¦‚å·¥ä½œæœåŠ¡å™¨ï¼ˆWorkerï¼‰çš„åŠ¨æ€æ·»åŠ ä¸æ•…éšœå‘ç°ï¼Œå¦‚æœæ•´ä¸ªç³»ç»Ÿå·¥ä½œè´Ÿè½½å¤ªå¤§ï¼Œå¯ä»¥æ–°å¢å·¥ä½œæœåŠ¡å™¨æ¥è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œè€Œä¸»æ§æœåŠ¡å™¨å¦‚ä½•è‡ªåŠ¨å‘ç°æ–°åŠ å…¥çš„æœºå™¨åˆ™æ˜¯ç»„æˆå‘˜ç®¡ç†é—®é¢˜ï¼›</p>
<p>ZooKeeperå¯ä»¥åˆ©ç”¨ä¸´æ—¶èŠ‚ç‚¹æ¥è¿›è¡Œç»„æˆå‘˜ç®¡ç†.</p>
<h4 id="4ï¼ä»»åŠ¡åˆ†é…"><a href="#4ï¼ä»»åŠ¡åˆ†é…" class="headerlink" title="4ï¼ä»»åŠ¡åˆ†é…"></a>4ï¼ä»»åŠ¡åˆ†é…</h4><p>åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼Œå°†ä¸åŒçš„ä»»åŠ¡è´Ÿè½½åˆ†åˆ«åˆ†é…åˆ°å¤šå°å¯ç”¨æœåŠ¡å™¨ä¹Ÿæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„é—®é¢˜ã€‚ä½¿ç”¨ZooKeeperå¯ä»¥æ¯”è¾ƒæ–¹ä¾¿åœ°å®æ–½è¿™ä¸€è¿‡ç¨‹<br>![[file-20250923202134282.jpg | 400]]<br>å¯¹äºç›‘æ§è¿›ç¨‹æ¥è¯´ï¼Œå¯ä»¥åˆ›å»ºä»»åŠ¡é˜Ÿåˆ—ç®¡ç†èŠ‚ç‚¹tasksï¼Œæ‰€æœ‰æ–°è¿›å…¥ç³»ç»Ÿçš„ä»»åŠ¡éƒ½å¯ä»¥åœ¨tasksèŠ‚ç‚¹ä¸‹åˆ›å»ºå­èŠ‚ç‚¹ï¼Œç›‘æ§è¿›ç¨‹è§‚å¯ŸtasksèŠ‚ç‚¹çš„å˜åŒ–ã€‚</p>
<h4 id="5ï¼é”ç®¡ç†ï¼ˆLocksï¼‰"><a href="#5ï¼é”ç®¡ç†ï¼ˆLocksï¼‰" class="headerlink" title="5ï¼é”ç®¡ç†ï¼ˆLocksï¼‰"></a>5ï¼é”ç®¡ç†ï¼ˆLocksï¼‰</h4><p>å¯ä»¥åˆ©ç”¨å…¶æä¾›çš„åŸè¯­æ„é€ é”æœåŠ¡åŠŸèƒ½ã€‚å¯ä»¥ç”¨ZooKeeperå®ç°è¯»ï¼å†™é”ã€æ’ä»–é”ã€‚</p>
<h4 id="6ï¼åŒå‘è·¯éšœåŒæ­¥ï¼ˆDouble-Barrierï¼‰"><a href="#6ï¼åŒå‘è·¯éšœåŒæ­¥ï¼ˆDouble-Barrierï¼‰" class="headerlink" title="6ï¼åŒå‘è·¯éšœåŒæ­¥ï¼ˆDouble Barrierï¼‰"></a>6ï¼åŒå‘è·¯éšœåŒæ­¥ï¼ˆDouble Barrierï¼‰</h4><p>æ‰€è°“è·¯éšœåŒæ­¥ï¼Œæ˜¯æŒ‡å¤šä¸ªå¹¶å‘è¿›ç¨‹éƒ½è¦åˆ°è¾¾æŸä¸ªåŒæ­¥ç‚¹åå†ç»§ç»­å‘åæ¨è¿›ï¼Œå›¾è®¡ç®—ä¸­çš„BSPæ¨¡å‹å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„è·¯éšœåŒæ­¥ç®—æ³•ï¼Œåªæœ‰æ‰€æœ‰å¹¶å‘è¿›ç¨‹çš„ä¸Šä¸€è½®è®¡ç®—éƒ½å®Œå…¨åˆ°è¾¾åŒæ­¥ç‚¹åæ‰èƒ½å¼€å§‹ä¸‹ä¸€è½®è®¡ç®—ã€‚</p>
<p>ZooKeeperå¯ä»¥ç”¨æ¥è¿›è¡Œå¹¶å‘è¿›ç¨‹çš„åŒå‘è·¯éšœåŒæ­¥ã€‚</p>
<h2 id="ZooKeeperçš„å®é™…åº”ç”¨"><a href="#ZooKeeperçš„å®é™…åº”ç”¨" class="headerlink" title="ZooKeeperçš„å®é™…åº”ç”¨"></a>ZooKeeperçš„å®é™…åº”ç”¨</h2><ul>
<li>ZooKeeperåœ¨HBaseçš„ä½¿ç”¨åœºæ™¯åŒ…æ‹¬ä¸»æ§æœåŠ¡å™¨é€‰ä¸¾ä¸ä¸»å¤‡åˆ‡æ¢ï¼Œä½œä¸ºé…ç½®ç®¡ç†åœ¨ZooKeeperä¸­å­˜å‚¨ç³»ç»Ÿå¯åŠ¨ä¿¡æ¯ï¼Œå‘ç°æ–°çš„å­è¡¨æœåŠ¡å™¨åŠä¾¦æµ‹å­è¡¨æœåŠ¡å™¨æ˜¯å¦ä¾ç„¶å­˜æ´»ç­‰ã€‚</li>
<li>LinkedInçš„Pub-Subæ¶ˆæ¯ç³»ç»ŸKafkaåœ¨ä»¥ä¸‹åœºæ™¯ä½¿ç”¨ZooKeeperï¼šè‡ªåŠ¨å‘ç°æ–°æ·»åŠ çš„æ¶ˆæ¯æœåŠ¡å™¨ï¼ˆBrokerï¼‰å’Œæ¶ˆæ¯æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰ï¼›åœ¨æ¶ˆæ¯æœåŠ¡å™¨é—´è¿›è¡Œè‡ªåŠ¨è´Ÿè½½å‡è¡¡ï¼›åœ¨ZooKeeperé‡Œä¿å­˜æ¶ˆè´¹è€…å’Œæ¶ˆæ¯é˜Ÿåˆ—çš„æ˜ å°„å…³ç³»åŠæ¶ˆè´¹è€…å½“å‰æ¶ˆè´¹ä¿¡æ¯åœ¨æ¶ˆæ¯é˜Ÿåˆ—çš„ä½ç½®ç­‰ã€‚</li>
</ul>
<h1 id="ç¬¬6ç« â€”â€”åˆ†å¸ƒå¼é€šä¿¡"><a href="#ç¬¬6ç« â€”â€”åˆ†å¸ƒå¼é€šä¿¡" class="headerlink" title="ç¬¬6ç« â€”â€”åˆ†å¸ƒå¼é€šä¿¡"></a>ç¬¬6ç« â€”â€”åˆ†å¸ƒå¼é€šä¿¡</h1><p>ä»å„ç§å¤§æ•°æ®ç³»ç»Ÿä¸­æŠ½è±¡å½’çº³å‡º3ç§å¸¸è§çš„é€šä¿¡æœºåˆ¶ï¼šåºåˆ—åŒ–ä¸è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ã€æ¶ˆæ¯é˜Ÿåˆ—å’Œå¤šæ’­é€šä¿¡ã€‚</p>
<ul>
<li>åºåˆ—åŒ–ä¸è¿œç¨‹è¿‡ç¨‹è°ƒç”¨çš„é‡ç‚¹æ˜¯ç½‘ç»œä¸­ä½äºä¸åŒæœºå™¨ä¸Šè¿›ç¨‹ä¹‹é—´çš„äº¤äº’ï¼›</li>
<li>æ¶ˆæ¯é˜Ÿåˆ—çš„é‡ç‚¹æ˜¯å­ç³»ç»Ÿä¹‹é—´çš„æ¶ˆæ¯å¯é ä¼ é€’ï¼›</li>
<li>å¤šæ’­é€šä¿¡æ˜¯ä»¥Gossipåè®®ä¸ºä¸»ï¼Œè®²è§£P2Pç½‘ç»œç¯å¢ƒä¸‹å¦‚ä½•å®ç°ä¿¡æ¯çš„é«˜æ•ˆå¤šæ’­ä¼ è¾“ã€‚</li>
</ul>
<h2 id="åºåˆ—åŒ–ä¸è¿œç¨‹è¿‡ç¨‹è°ƒç”¨æ¡†æ¶"><a href="#åºåˆ—åŒ–ä¸è¿œç¨‹è¿‡ç¨‹è°ƒç”¨æ¡†æ¶" class="headerlink" title="åºåˆ—åŒ–ä¸è¿œç¨‹è¿‡ç¨‹è°ƒç”¨æ¡†æ¶"></a>åºåˆ—åŒ–ä¸è¿œç¨‹è¿‡ç¨‹è°ƒç”¨æ¡†æ¶</h2><p><strong>è¿œç¨‹è¿‡ç¨‹è°ƒç”¨</strong>ï¼šå…è®¸ç¨‹åºè°ƒç”¨ä½äºç½‘ç»œä¸­å…¶ä»–æœºå™¨ä¸Šçš„è¿›ç¨‹ï¼Œå½“æœºå™¨Aä¸Šçš„è¿›ç¨‹è°ƒç”¨æœºå™¨Bä¸Šçš„è¿›ç¨‹æ—¶ï¼ŒAä¸Šçš„è°ƒç”¨è¿›ç¨‹è¢«æŒ‚èµ·ï¼Œè€ŒBä¸Šçš„è¢«è°ƒç”¨è¿›ç¨‹å¼€å§‹æ‰§è¡Œï¼Œè°ƒç”¨æ–¹å¯ä»¥é€šè¿‡å‚æ•°å°†ä¿¡æ¯ä¼ é€’ç»™è¢«è°ƒç”¨æ–¹ï¼Œç„¶åé€šè¿‡Bä¸Šçš„è¿›ç¨‹è¿”å›çš„ç»“æœå¾—åˆ°æ‰€éœ€çš„ä¿¡æ¯ã€‚</p>
<p>ä¸€èˆ¬RPCæ¡†æ¶ä¼šèåˆæ•°æ®<strong>åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</strong>åŠŸèƒ½ï¼Œä»¥å®ç°é«˜æ•ˆçš„æ•°æ®å­˜å–ä¸é€šä¿¡ã€‚å¾ˆå¤šåº”ç”¨ç›´æ¥ä½¿ç”¨JSONæˆ–è€…XMLæ¥ä½œä¸ºæ•°æ®é€šä¿¡çš„æ ¼å¼ã€‚<br>![[file-20250924203202439.jpg]]<br>é€šç”¨çš„åºåˆ—åŒ–ä¸RPCæ¡†æ¶éƒ½æ”¯æŒä»¥ä¸‹ç‰¹æ€§ï¼šæ¥å£æè¿°è¯­è¨€ï¼ˆInterface Description Languageï¼ŒIDLï¼‰ã€é«˜æ€§èƒ½ã€æ•°æ®ç‰ˆæœ¬æ”¯æŒä»¥åŠäºŒè¿›åˆ¶æ•°æ®æ ¼å¼ã€‚</p>
<h3 id="Protocol-Bufferä¸Thrift"><a href="#Protocol-Bufferä¸Thrift" class="headerlink" title="Protocol Bufferä¸Thrift"></a>Protocol Bufferä¸Thrift</h3><ul>
<li>PBæ˜¯åœ¨Googleå†…éƒ¨å¹¿æ³›ä½¿ç”¨çš„åºåˆ—åŒ–ä¸RPCæ¡†æ¶ï¼Œæ˜¯å‡ ä¹æ‰€æœ‰GoogleæœåŠ¡çš„é»åˆå‰‚ï¼Œæ”¯æŒC++ã€Javaã€Pythonå’ŒJavaScriptè¿™4ç§è¯­è¨€ï¼Œéšç€ç³»ç»Ÿå¼€æºï¼Œç›®å‰ä¹Ÿæ”¯æŒå¾ˆå¤šå…¶ä»–è¯­è¨€çš„ç¬¬ä¸‰æ–¹æ’ä»¶ã€‚ä¸JSONã€XMLåŠThriftç­‰ç›¸æ¯”ï¼Œ<strong>PBå¯¹æ•°æ®çš„å‹ç¼©ç‡æ˜¯æœ€é«˜çš„ã€‚</strong></li>
<li>Thriftåˆ™æ˜¯Facebookå¼€æºå‡ºçš„åºåˆ—åŒ–ä¸RPCæ¡†æ¶ï¼Œåœ¨Facebookå†…éƒ¨ä¹Ÿå¾—åˆ°äº†å¹¿æ³›çš„ä½¿ç”¨ã€‚æ”¯æŒåå‡ ç§å¸¸è§ç¼–ç¨‹è¯­è¨€ï¼ŒåŒæ—¶ä¹Ÿç›´æ¥æä¾›RPCè°ƒç”¨æ¡†æ¶æœåŠ¡ã€‚å› ä¸ºRPCåŠŸèƒ½ä»¥åŠIDLè¯­è¨€æ¯”PBè¡¨è¾¾èƒ½åŠ›æ›´å¼ºï¼ˆThriftæ”¯æŒList&#x2F;Set&#x2F;Mapå¤æ‚æ•°æ®ç»“æ„ï¼ŒPBä¸æ”¯æŒï¼‰ï¼Œæ‰€ä»¥Thriftçš„ä½¿ç”¨åœºæ™¯æ›´ä¸°å¯Œã€‚æ¯”å¦‚Hadoop&#x2F;HBaseã€‚</li>
</ul>
<p>ä½¿ç”¨æµç¨‹æ–¹é¢å¤§è‡´ç›¸åŒã€‚å…¶æµç¨‹ä¸€èˆ¬å¦‚ä¸‹ï¼š</p>
<ul>
<li>ä½¿ç”¨IDLå®šä¹‰æ¶ˆæ¯ä½“ä»¥åŠPRCå‡½æ•°è°ƒç”¨æ¥å£ã€‚é¡¾åæ€ä¹‰ï¼ŒIDLæ˜¯ä¸å…·ä½“ç¼–ç¨‹è¯­è¨€æ— å…³çš„æ¥å£æè¿°è¯­è¨€ï¼Œä½¿ç”¨å®ƒå¯ä»¥å®šä¹‰è°ƒç”¨æ–¹å’Œè¢«è°ƒç”¨æ–¹éƒ½ä¸€è‡´éµå¾ªçš„æ•°æ®ç»“æ„ä¸æ¥å£ã€‚</li>
<li>ä½¿ç”¨å·¥å…·æ ¹æ®ä¸Šæ­¥çš„IDLå®šä¹‰æ–‡ä»¶ç”ŸæˆæŒ‡å®šç¼–ç¨‹è¯­è¨€çš„ä»£ç </li>
<li>å¯åœ¨åº”ç”¨ç¨‹åºä¸­é“¾æ¥ä½¿ç”¨ä¸Šä¸€æ­¥ç”Ÿæˆçš„ä»£ç ã€‚å¯¹äºRPCåŠŸèƒ½æ¥è¯´ï¼Œè°ƒç”¨æ–¹å’Œè¢«è°ƒç”¨æ–¹åŒæ—¶å¼•å…¥åå³å¯å®ç°é€æ˜ç½‘ç»œè®¿é—®ï¼Œå¦‚æœè°ƒç”¨æ–¹å’Œè¢«è°ƒç”¨æ–¹é‡‡å–ä¸åŒçš„è¯­è¨€ï¼Œåªè¦åˆ†åˆ«æ ¹æ®IDLå®šä¹‰æ–‡ä»¶ç”Ÿæˆä¸åŒè¯­è¨€åº“å³å¯å®ç°ä¸¤è€…çš„ç¼–ç è¯­è¨€è§£è€¦ã€‚</li>
</ul>
<h3 id="Avro"><a href="#Avro" class="headerlink" title="Avro"></a>Avro</h3><p>Avroæ˜¯Apacheå¼€æºçš„åºåˆ—åŒ–ä¸RPCæ¡†æ¶ï¼Œä½¿ç”¨åœ¨Hadoopçš„æ•°æ®å­˜å‚¨ä¸å†…éƒ¨é€šä¿¡ä¸­ã€‚Avroä½¿ç”¨JSONä½œä¸ºIDLå®šä¹‰è¯­è¨€ï¼Œå¯ä»¥çµæ´»åœ°å®šä¹‰æ•°æ®SchemaåŠRPCé€šä¿¡åè®®ï¼Œæä¾›äº†ç®€æ´å¿«é€Ÿçš„äºŒè¿›åˆ¶æ•°æ®æ ¼å¼ï¼Œå¹¶èƒ½å’ŒåŠ¨æ€è¯­è¨€è¿›è¡Œé›†æˆã€‚</p>
<p>Avroçš„IDLè¯­è¨€ä¸ä»…æ”¯æŒå¸¸è§çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä¹Ÿèƒ½å¤Ÿæ”¯æŒRecordã€Arrayã€Mapç­‰å¤æ‚æ•°æ®ç±»å‹ï¼Œæ‰€ä»¥æœ‰å¾ˆå¼ºçš„æ•°æ®æè¿°èƒ½åŠ›ã€‚</p>
<p>æ•°æ®Schemaä½¿ç”¨JSONæè¿°å¹¶å­˜æ”¾åœ¨æ•°æ®æ–‡ä»¶çš„èµ·å§‹éƒ¨åˆ†ï¼Œæ•°æ®ä»¥äºŒè¿›åˆ¶å½¢å¼å­˜å‚¨ï¼Œè¿™æ ·è¿›è¡Œæ•°æ®åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ—¶é€Ÿåº¦å¾ˆå¿«ä¸”å ç”¨é¢å¤–å­˜å‚¨ç©ºé—´å¾ˆå°‘ã€‚</p>
<p>æ•°æ®å†…å®¹å¯ä»¥é‡‡ç”¨äºŒè¿›åˆ¶æ ¼å¼æˆ–è€…JSONæ ¼å¼ï¼Œä¸€èˆ¬é‡‡ç”¨äºŒè¿›åˆ¶æ ¼å¼ï¼Œå› ä¸ºå…¶æ›´å°ã€ä¼ è¾“æ•ˆç‡æ›´é«˜ï¼Œå½“è°ƒè¯•åº”ç”¨æ—¶å¯ä»¥é‡‡ç”¨JSONæ ¼å¼ï¼Œä¸»è¦ä¾¿äºè§‚å¯Ÿæ•°æ®çš„æ­£ç¡®æ€§ã€‚</p>
<p>ç‹¬ç‰¹ä¹‹å¤„ï¼š</p>
<ul>
<li>å…¶æ”¯æŒåŠ¨æ€è¯­è¨€é›†æˆï¼›</li>
<li>å…¶æ•°æ®Schemaç‹¬ç«‹äºæ•°æ®å¹¶åœ¨åºåˆ—åŒ–æ—¶ç½®äºæ•°æ®ä¹‹é¦–ï¼›</li>
<li>å…¶IDLä½¿ç”¨JSONè¡¨è¾¾ï¼Œæ‰€ä»¥æ— é¡»é¢å¤–å®šåˆ¶IDLè§£æå™¨ã€‚</li>
</ul>
<h2 id="æ¶ˆæ¯é˜Ÿåˆ—"><a href="#æ¶ˆæ¯é˜Ÿåˆ—" class="headerlink" title="æ¶ˆæ¯é˜Ÿåˆ—"></a>æ¶ˆæ¯é˜Ÿåˆ—</h2><h3 id="å¸¸è§çš„æ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿ"><a href="#å¸¸è§çš„æ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿ" class="headerlink" title="å¸¸è§çš„æ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿ"></a>å¸¸è§çš„æ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿ</h3><p>å‰å¸¸è§çš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­é—´ä»¶äº§å“åŒ…æ‹¬ActiveMQã€ZeroMQã€RabbitMQå’ŒKafkaç­‰ã€‚å®é™…æµ‹è¯•è¡¨æ˜ï¼Œè¿ç»­å¹¶å‘å‘é€1KBå¤§å°çš„æ¶ˆæ¯ï¼Œä»æ€§èƒ½çš„è§’åº¦çœ‹ï¼ŒZeroMQæ€§èƒ½æœ€ä¼˜ï¼Œå¯è¾¾10ä¸‡TPSï¼ˆTransaction Per Secondï¼Œæ¯ç§’äº‹åŠ¡å¤„ç†é‡ï¼‰ä»¥ä¸Šï¼›Kafkaæ¬¡ä¹‹ï¼Œå¯è¾¾4ä¸‡TPSå·¦å³ï¼›RabbitMQå†æ¬¡ï¼Œå¤§çº¦1ä¸‡TPSå·¦å³ï¼›ActiveMQæœ€æ¬¡ï¼Œæ€§èƒ½å¤§çº¦åœ¨6 000 TPSå·¦å³ã€‚</p>
<p>ä¸€èˆ¬è¿™äº›æ¶ˆæ¯ä¸­é—´ä»¶éƒ½æ”¯æŒä¸¤ç§æ¨¡å¼çš„é˜Ÿåˆ—ï¼šæ¶ˆæ¯é˜Ÿåˆ—æ¨¡å¼åŠPub-Subæ¨¡å¼ï¼š</p>
<ul>
<li><p><strong>æ¶ˆæ¯é˜Ÿåˆ—æ¨¡å¼</strong>ï¼šå³æ¶ˆæ¯ç”Ÿäº§è€…å°†æ¶ˆæ¯å­˜å…¥é˜Ÿåˆ—ï¼Œæ¶ˆæ¯æ¶ˆè´¹è€…ä»é˜Ÿåˆ—æ¶ˆè´¹æ¶ˆæ¯ï¼›</p>
</li>
<li><p><strong>Pub-Subæ¨¡å¼</strong>ï¼šåˆ™æ˜¯æ¶ˆæ¯ç”Ÿäº§è€…å°†æ¶ˆæ¯å‘å¸ƒåˆ°æŒ‡å®šä¸»é¢˜çš„é˜Ÿåˆ—ä¸­ï¼Œè€Œæ¶ˆæ¯æ¶ˆè´¹è€…è®¢é˜…æŒ‡å®šä¸»é¢˜çš„é˜Ÿåˆ—æ¶ˆæ¯ï¼Œå½“è®¢é˜…çš„ä¸»é¢˜æœ‰æ–°æ¶ˆæ¯æ—¶ï¼Œæ¶ˆæ¯æ¶ˆè´¹è€…å¯ä»¥é€šè¿‡æ‹‰å–ï¼ˆPullï¼‰æˆ–è€…æ¶ˆæ¯ä¸­é—´ä»¶é€šè¿‡æ¨é€ï¼ˆPushï¼‰çš„æ–¹å¼å°†æ¶ˆæ¯æ¶ˆè´¹æ‰ã€‚</p>
</li>
<li><p>ActiveMQå’ŒRabbitMQç›¸å¯¹æ¥è¯´ç®—æ˜¯é‡é‡çº§ç³»ç»Ÿï¼Œå…¶éµå¾ªAMQPåè®®ï¼Œå…·æœ‰è¾ƒå¼ºçš„åŠŸèƒ½å’Œç›¸å¯¹å¹¿æ³›çš„é€‚ç”¨åœºæ™¯ï¼Œä½†ä¹Ÿå› æ­¤å¯¼è‡´å…¶æ€§èƒ½è¾ƒä½å’Œæ‰©å±•æ€§è¾ƒå·®ã€‚</p>
</li>
<li><p>ZeroMQç›¸å¯¹ç‰¹æ®Šï¼Œä¹Ÿæ˜¯å…¶ä¸­æœ€è½»é‡çº§çš„ç³»ç»Ÿï¼Œä¸¥æ ¼æ¥è®²ï¼Œå…¶æ˜¯ä»‹äºä¼šè¯å±‚ä¹‹ä¸Šåº”ç”¨å±‚ä¹‹ä¸‹çš„ç½‘ç»œé€šä¿¡åº“ï¼Œé€‚ç”¨äºé«˜å¹¶å‘ä½å»¶è¿Ÿçš„åœºæ™¯ï¼Œæ¯”å¦‚é‡‘èè¡Œä¸šæ•°æ®ä¼ è¾“ï¼›ä½†æ˜¯å…¶ä¸æ”¯æŒæ¶ˆæ¯æŒä¹…åŒ–</p>
</li>
<li><p>Kafkaç®—æ˜¯è½»é‡çº§çš„æ¶ˆæ¯ç³»ç»Ÿï¼ŒåŒæ—¶å…¶æä¾›äº†æ¶ˆæ¯æŒä¹…åŒ–ä¿è¯ï¼Œæ”¯æŒæ¶ˆæ¯â€œè‡³å°‘é€è¾¾ä¸€æ¬¡â€è¯­ä¹‰ï¼Œåœ¨æ€§èƒ½æ–¹é¢è¡¨ç°ä¼˜å¼‚ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œå…¶åœ¨é«˜å¯ç”¨æ€§åŠå¯æ‰©å±•æ€§æ–¹é¢ä¹Ÿå¾ˆå‡ºè‰²ã€‚</p>
</li>
</ul>
<h3 id="Kafka"><a href="#Kafka" class="headerlink" title="Kafka"></a>Kafka</h3><p>Kafkaæ˜¯Linkedinå¼€æºçš„é‡‡ç”¨<strong>Pub-Subæœºåˆ¶</strong>çš„åˆ†å¸ƒå¼æ¶ˆæ¯ç³»ç»Ÿï¼Œå…¶å…·æœ‰æé«˜çš„æ¶ˆæ¯ååé‡ï¼Œè¾ƒå¼ºçš„å¯æ‰©å±•æ€§å’Œé«˜å¯ç”¨æ€§ï¼Œæ¶ˆæ¯ä¼ é€’ä½å»¶è¿Ÿï¼Œèƒ½å¤Ÿå¯¹æ¶ˆæ¯é˜Ÿåˆ—è¿›è¡ŒæŒä¹…åŒ–ä¿å­˜ï¼Œä¸”æ”¯æŒæ¶ˆæ¯ä¼ é€’çš„â€œè‡³å°‘é€è¾¾ä¸€æ¬¡â€è¯­ä¹‰ã€‚</p>
<p>å¯ä»¥ç”¨æ¥ä½œä¸ºé€šç”¨çš„æ¶ˆæ¯ç³»ç»Ÿã€å³æ—¶Logæ”¶é›†ã€ç”¨æˆ·è¡Œä¸ºå®æ—¶æ”¶é›†ä»¥åŠæœºå™¨çŠ¶æ€ç›‘æ§ç­‰ã€‚</p>
<h4 id="æ•´ä½“æ¶æ„"><a href="#æ•´ä½“æ¶æ„" class="headerlink" title="æ•´ä½“æ¶æ„"></a>æ•´ä½“æ¶æ„</h4><p>ä¸»è¦ç”±3ç§ç±»å‹è§’è‰²æ„æˆï¼šæ¶ˆæ¯ç”Ÿäº§è€…ï¼ˆProducerï¼‰ã€ä»£ç†æœåŠ¡å™¨ï¼ˆBrokerï¼‰å’Œæ¶ˆæ¯æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰</p>
<ul>
<li>æ¶ˆæ¯ç”Ÿäº§è€…äº§ç”ŸæŒ‡å®šTopicï¼ˆä¸»é¢˜ï¼‰çš„æ¶ˆæ¯å¹¶å°†å…¶ä¼ å…¥ä»£ç†æœåŠ¡å™¨é›†ç¾¤</li>
<li>ä»£ç†æœåŠ¡å™¨é›†ç¾¤åœ¨ç£ç›˜å­˜å‚¨ç»´æŠ¤å„ç§Topicçš„æ¶ˆæ¯é˜Ÿåˆ—</li>
<li>è®¢é˜…äº†æŸä¸ªTopicçš„æ¶ˆæ¯æ¶ˆè´¹è€…ä»ä»£ç†æœåŠ¡å™¨é›†ç¾¤ä¸­æ‹‰å–ï¼ˆPullï¼‰å‡ºæ–°äº§ç”Ÿçš„æ¶ˆæ¯å¹¶å¯¹å…¶è¿›è¡Œå¤„ç†ã€‚<br>![[file-20250924204323417.jpg | 400]]</li>
</ul>
<p>åœ¨Kafkaå†…éƒ¨ï¼Œæ”¯æŒå¯¹Topicè¿›è¡Œæ•°æ®åˆ†ç‰‡ï¼ˆPartitionï¼‰ï¼Œæ¯ä¸ªæ•°æ®åˆ†ç‰‡æ˜¯æœ‰åºçš„ã€ä¸å¯æ›´æ”¹çš„å°¾éƒ¨è¿½åŠ æ¶ˆæ¯é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—å†…çš„æ¯ä¸ªæ¶ˆæ¯è¢«åˆ†é…æœ¬æ•°æ®åˆ†ç‰‡å†…å”¯ä¸€çš„æ¶ˆæ¯IDã€‚é˜Ÿåˆ—å†…çš„æ¯ä¸ªæ¶ˆæ¯è¢«åˆ†é…æœ¬æ•°æ®åˆ†ç‰‡å†…å”¯ä¸€çš„æ¶ˆæ¯IDï¼ˆè¢«ç§°ä¸ºâ€œOffsetâ€ï¼‰ã€‚<br>![[file-20250924204504138.jpg | 500]]</p>
<p>ä¸å¾ˆå¤šæ¶ˆæ¯ç³»ç»Ÿå°†æ¶ˆè´¹è€…ç›®å‰è¯»å–åˆ°é˜Ÿåˆ—ä¸­å“ªä¸ªæ¶ˆæ¯è¿™ç§ç®¡ç†ä¿¡æ¯å­˜å‚¨åœ¨ä»£ç†æœåŠ¡å™¨ç«¯ä¸åŒï¼Œ<strong>Kafkaå°†è¿™ä¸ªä¿¡æ¯äº¤ç”±æ¶ˆæ¯æ¶ˆè´¹è€…å„è‡ªä¿å­˜</strong>ï¼Œè¿™æ ·æ˜æ˜¾ç®€åŒ–äº†è®¾è®¡ã€‚</p>
<p>é™¤æ¶ˆè´¹è€…è¯»å–åˆ°å“ªä¸ªæ¶ˆæ¯å¤–ï¼ŒKafkaçš„å¾ˆå¤šå…¶ä»–ç®¡ç†ä¿¡æ¯éƒ½å­˜æ”¾åœ¨ZooKeeperè€ŒéæœåŠ¡å™¨ä¸­ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ï¼Œä»£ç†æœåŠ¡å™¨æˆä¸ºå®Œå…¨æ— çŠ¶æ€çš„ï¼Œæ— é¡»è®°è½½ä»»ä½•çŠ¶æ€ä¿¡æ¯ï¼Œè¿™æ ·å¯¹äºæ¶ˆæ¯ç³»ç»Ÿçš„å®¹é”™æ€§ä»¥åŠå¯æ‰©å±•æ€§éƒ½æœ‰å¾ˆå¤§å¥½å¤„ã€‚</p>
<p>Kafkaä½¿ç”¨ZooKeeperä¿å­˜çš„ç®¡ç†ä¿¡æ¯å’Œå®ç°çš„åŠŸèƒ½åŒ…æ‹¬ï¼š</p>
<ul>
<li>ä¾¦æµ‹ä»£ç†æœåŠ¡å™¨å’Œæ¶ˆæ¯æ¶ˆè´¹è€…çš„åŠ¨æ€åŠ å…¥å’Œåˆ é™¤</li>
<li>å½“åŠ¨æ€åŠ å…¥æˆ–è€…åˆ é™¤ä»£ç†æœåŠ¡å™¨ä»¥åŠæ¶ˆæ¯æ¶ˆè´¹è€…åå¯¹æ¶ˆæ¯ç³»ç»Ÿè¿›è¡Œè´Ÿè½½å‡è¡¡</li>
<li>ç»´æŠ¤æ¶ˆè´¹è€…å’Œæ¶ˆæ¯Topicä»¥åŠæ•°æ®åˆ†ç‰‡çš„ç›¸äº’å…³ç³»ï¼Œå¹¶ä¿å­˜æ¶ˆè´¹è€…å½“å‰è¯»å–æ¶ˆæ¯çš„Offset</li>
<li>æ•°æ®å‰¯æœ¬ç®¡ç†ä¿¡æ¯</li>
</ul>
<h4 id="ISRå‰¯æœ¬ç®¡ç†æœºåˆ¶"><a href="#ISRå‰¯æœ¬ç®¡ç†æœºåˆ¶" class="headerlink" title="ISRå‰¯æœ¬ç®¡ç†æœºåˆ¶"></a>ISRå‰¯æœ¬ç®¡ç†æœºåˆ¶</h4><p>Kafkaé€šè¿‡æ¶ˆæ¯å‰¯æœ¬æœºåˆ¶æä¾›äº†é«˜å¯ç”¨çš„æ¶ˆæ¯æœåŠ¡ï¼Œå…¶å‰¯æœ¬ç®¡ç†å•ä½ä¸æ˜¯Topicæ¶ˆæ¯é˜Ÿåˆ—ï¼Œè€Œæ˜¯Topicçš„æ•°æ®åˆ†ç‰‡ï¼ˆPartitionï¼‰ã€‚</p>
<p>åœ¨é…ç½®æ–‡ä»¶é‡Œå¯ä»¥æŒ‡å®šæ•°æ®åˆ†ç‰‡çš„å‰¯æœ¬ä¸ªæ•°ï¼Œåœ¨å¤šä¸ªå‰¯æœ¬é‡Œï¼Œå…¶ä¸­ä¸€ä¸ªä½œä¸ºä¸»å‰¯æœ¬ï¼ˆLeaderï¼‰ï¼Œå…¶ä»–ä½œä¸ºæ¬¡çº§å‰¯æœ¬ï¼ˆSlaveï¼‰ã€‚æ‰€æœ‰é’ˆå¯¹è¿™ä¸ªæ•°æ®åˆ†ç‰‡çš„æ¶ˆæ¯è¯»ï¼å†™è¯·æ±‚éƒ½ç”±ä¸»å‰¯æœ¬æ¥è´Ÿè´£å“åº”ï¼Œæ¬¡çº§å‰¯æœ¬åªæ˜¯ä»¥ä¸»å‰¯æœ¬æ•°æ®æ¶ˆè´¹è€…çš„æ–¹å¼ä»ä¸»å‰¯æœ¬åŒæ­¥æ•°æ®ï¼›å½“ä¸»å‰¯æœ¬å‘ç”Ÿæ•…éšœæ—¶ï¼ŒKafkaå°†å…¶ä¸­æŸä¸ªæ¬¡çº§å‰¯æœ¬æå‡ä¸ºä¸»å‰¯æœ¬ï¼Œä»¥æ­¤æ¥è¾¾åˆ°æ•´ä¸ªæ¶ˆæ¯ç³»ç»Ÿçš„é«˜å¯ç”¨æ€§ã€‚</p>
<p>Kafkaå¹¶æœªä½¿ç”¨ç±»ä¼¼Zabæˆ–è€…Paxosåè®®çš„å¤šæ•°æŠ•ç¥¨æœºåˆ¶æ¥ä¿è¯ä¸»å¤‡æ•°æ®çš„ä¸€è‡´æ€§ï¼Œè€Œæ˜¯æå‡ºäº†ä¸€ç§è¢«ç§°ä¸ºISRï¼ˆIn-Sync Replicasï¼‰çš„æœºåˆ¶æ¥ä¿è¯æ•°æ®ä¸€è‡´æ€§ã€‚åªå…è®¸1ä¸ªå‰¯æœ¬å®¹é”™è¿‡äºè„†å¼±ï¼Œæ‰€ä»¥è‡³å°‘è¦æ”¯æŒ2ä¸ªå‰¯æœ¬å®¹é”™ï¼Œå³è‡³å°‘è¦ç»´æŠ¤5ä¸ªæ•°æ®å‰¯æœ¬ï¼Œä½†æ˜¯è¿™è¦æ±‚åœ¨æ¶ˆæ¯å†™å…¥çš„æ—¶å€™åŒæ—¶åŒæ­¥5ä¸ªæ•°æ®ï¼Œæ˜æ˜¾æ•ˆç‡å¤ªä½ã€‚è¿™å°±æ˜¯ä¸ºä½•è¦å¼•å…¥ISRæœºåˆ¶çš„ä¸»è¦åŸå› ã€‚</p>
<p>ISRçš„è¿è¡Œæœºåˆ¶å¦‚ä¸‹ï¼š<br>å°†æ‰€æœ‰æ¬¡çº§å‰¯æœ¬æ•°æ®åˆ†åˆ°ä¸¤ä¸ªé›†åˆï¼Œå…¶ä¸­ä¸€ä¸ªè¢«ç§°ä¸ºISRé›†åˆï¼Œè¿™ä¸ªé›†åˆå¤‡ä»½æ•°æ®çš„ç‰¹ç‚¹æ˜¯å³æ—¶å’Œä¸»å‰¯æœ¬æ•°æ®ä¿æŒä¸€è‡´ï¼Œè€Œå¦å¤–ä¸€ä¸ªé›†åˆçš„å¤‡ä»½æ•°æ®å…è®¸å…¶æ¶ˆæ¯é˜Ÿåˆ—è½åäºä¸»å‰¯æœ¬çš„æ•°æ®ã€‚åœ¨åšä¸»å¤‡åˆ‡æ¢æ—¶ï¼Œåªå…è®¸ä»ISRé›†åˆä¸­é€‰æ‹©å€™é€‰ä¸»å‰¯æœ¬ï¼Œè¿™æ ·å³å¯ä¿è¯åˆ‡æ¢åæ–°çš„ä¸»å‰¯æœ¬æ•°æ®çŠ¶æ€å’Œè€çš„ä¸»å‰¯æœ¬ä¿æŒä¸€è‡´ã€‚åœ¨æ•°æ®åˆ†ç‰‡è¿›è¡Œæ¶ˆæ¯å†™å…¥æ—¶ï¼Œåªæœ‰ISRé›†åˆå†…æ‰€æœ‰å¤‡ä»½éƒ½å†™æˆåŠŸæ‰èƒ½è®¤ä¸ºè¿™æ¬¡å†™å…¥æ“ä½œæˆåŠŸã€‚åœ¨å…·ä½“å®ç°æ—¶ï¼ŒKafkaåˆ©ç”¨ZooKeeperæ¥ä¿å­˜æ¯ä¸ªISRé›†åˆçš„ä¿¡æ¯ï¼Œå½“ISRé›†åˆå†…æˆå‘˜å˜åŒ–æ—¶ï¼Œç›¸å…³æ„ä»¶ä¹Ÿä¾¿äºé€šçŸ¥ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¦‚æœè®¾å®šISRé›†åˆå¤§å°ä¸ºf+1ï¼Œé‚£ä¹ˆå¯ä»¥æœ€å¤šå…è®¸fä¸ªå‰¯æœ¬æ•…éšœï¼Œè€Œå¯¹äºå¤šæ•°æŠ•ç¥¨æœºåˆ¶æ¥è¯´ï¼Œåˆ™éœ€è¦2f+1ä¸ªå‰¯æœ¬æ‰èƒ½è¾¾åˆ°ç›¸åŒçš„å®¹é”™æ€§ã€‚</p>
<h4 id="æ€§èƒ½ä¼˜åŒ–"><a href="#æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="æ€§èƒ½ä¼˜åŒ–"></a>æ€§èƒ½ä¼˜åŒ–</h4><p>Kafkaèƒ½å¤Ÿé«˜æ•ˆå¤„ç†å¤§æ‰¹é‡æ¶ˆæ¯çš„ä¸€ä¸ªé‡è¦åŸå› å°±æ˜¯å°†è¯»ï¼å†™æ“ä½œå°½å¯èƒ½è½¬æ¢ä¸ºé¡ºåºè¯»ï¼å†™ï¼Œæ¯”å¦‚ç±»ä¼¼äºLogæ–‡ä»¶æ–¹å¼çš„æ–‡ä»¶å°¾éƒ¨è¿½åŠ å†™ã€‚å¦å¤–ï¼ŒKafkaæ¶‰åŠå°†æ–‡ä»¶å†…å®¹é€šè¿‡ç½‘ç»œè¿›è¡Œä¼ è¾“ï¼Œä¸ºäº†æå‡æ•ˆç‡ï¼ŒKafkaé‡‡ç”¨äº†Linuxæ“ä½œç³»ç»Ÿçš„SendFileè°ƒç”¨ã€‚</p>
<p>æ­£å¸¸æƒ…å†µä¸‹å°†æ–‡ä»¶å†…å®¹é€šè¿‡ç½‘ç»œä¼ è¾“æ‰€ç»è¿‡çš„æ•°æ®é€šé“æ¶‰åŠ4æ¬¡æ•°æ®å¤åˆ¶å’Œ2ä¸ªç³»ç»Ÿè°ƒç”¨ã€‚å¦‚æœä½¿ç”¨SendFileï¼Œåˆ™å¯ä»¥é¿å…å¤šæ¬¡æ•°æ®å¤åˆ¶ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥ç›´æ¥å°†æ•°æ®ä»å†…æ ¸é¡µç¼“å­˜ä¸­å¤åˆ¶åˆ°ç½‘å¡ç¼“å­˜ï¼Œè¿™æ ·å¯ä»¥å¤§å¤§åŠ å¿«æ•´ä¸ªè¿‡ç¨‹çš„é€Ÿåº¦ã€‚</p>
<h2 id="åº”ç”¨å±‚å¤šæ’­é€šä¿¡"><a href="#åº”ç”¨å±‚å¤šæ’­é€šä¿¡" class="headerlink" title="åº”ç”¨å±‚å¤šæ’­é€šä¿¡"></a>åº”ç”¨å±‚å¤šæ’­é€šä¿¡</h2><p>å¤šæ’­é€šä¿¡ï¼šæ˜¯å¦‚ä½•å°†æ•°æ®é€šçŸ¥åˆ°ç½‘ç»œä¸­å¤šä¸ªæ¥æ”¶æ–¹</p>
<p>Gossipåè®®å°±æ˜¯å¸¸ç”¨çš„åº”ç”¨å±‚å¤šæ’­é€šä¿¡åè®®ï¼Œä¸å…¶ä»–å¤šæ’­åè®®ç›¸æ¯”ï¼Œå…¶åœ¨ä¿¡æ¯ä¼ é€’çš„å¼ºå£®æ€§å’Œä¼ æ’­æ•ˆç‡è¿™ä¸¤æ–¹é¢æœ‰è¾ƒå¥½çš„æŠ˜ä¸­æ•ˆæœï¼Œä½¿å¾—å…¶åœ¨å¤§æ•°æ®é¢†åŸŸå¹¿æ³›ä½¿ç”¨</p>
<h3 id="Gossipåè®®"><a href="#Gossipåè®®" class="headerlink" title="Gossipåè®®"></a>Gossipåè®®</h3><p>â€œGossipâ€çš„åŸæ„æ˜¯è°£è¨€æˆ–è€…å°é“æ¶ˆæ¯ï¼Œä¹‹æ‰€ä»¥è¢«ç§°ä¸ºâ€œGossipåè®®â€ï¼Œä¹Ÿæ˜¯å› å…¶ä¿¡æ¯ä¼ æ’­æœºåˆ¶å’Œå°é“æ¶ˆæ¯åœ¨äººç¾¤ä¸­çš„ä¼ æ’­æ–¹å¼éå¸¸ç±»ä¼¼ã€‚</p>
<p>Gossipåè®®åœ¨å¤§æ•°æ®ç³»ç»Ÿä¸­å¾—åˆ°å¹¿æ³›ä½¿ç”¨ã€‚æ¯”å¦‚ï¼šDynamoåŠå…¶æ¨¡ä»¿è€…Cassandraã€Riakç­‰ç³»ç»Ÿä½¿ç”¨Gossipåè®®æ¥è¿›è¡Œæ•…éšœæ£€æµ‹ã€é›†ç¾¤æˆå‘˜ç®¡ç†æˆ–è€…å‰¯æœ¬æ•°æ®ä¿®å¤ã€‚</p>
<h4 id="ä¿¡æ¯ä¼ æ’­æ¨¡å‹"><a href="#ä¿¡æ¯ä¼ æ’­æ¨¡å‹" class="headerlink" title="ä¿¡æ¯ä¼ æ’­æ¨¡å‹"></a>ä¿¡æ¯ä¼ æ’­æ¨¡å‹</h4><p>Gossipåè®®ç”¨æ¥å°½å¿«åœ°å°†æœ¬åœ°æ›´æ–°æ•°æ®é€šçŸ¥åˆ°ç½‘ç»œä¸­çš„æ‰€æœ‰å…¶ä»–èŠ‚ç‚¹ã€‚å…¶å…·ä½“æ›´æ–°æ¨¡å‹åˆå¯ä»¥<br>åˆ†ä¸º3ç§ï¼šå…¨éƒ¨é€šçŸ¥æ¨¡å‹ï¼ˆBest Effortæˆ–Direct Mailï¼‰ã€åç†µæ¨¡å‹ï¼ˆAnti-Entropyï¼‰å’Œæ•£å¸ƒè°£è¨€æ¨¡å‹ï¼ˆRumor Mongeringï¼‰ã€‚å…¶ä¸­åç†µæ¨¡å‹æ˜¯æœ€å¸¸ç”¨çš„ã€‚</p>
<ul>
<li>å…¨éƒ¨é€šçŸ¥æ¨¡å‹å¦‚æ­¤ä¼ æ’­ï¼šå½“æŸä¸ªèŠ‚ç‚¹æœ‰æ›´æ–°æ¶ˆæ¯ï¼Œåˆ™ç«‹å³é€šçŸ¥æ‰€æœ‰å…¶ä»–èŠ‚ç‚¹ï¼›å…¶ä»–èŠ‚ç‚¹åœ¨æ¥æ”¶åˆ°é€šçŸ¥åï¼Œåˆ¤æ–­æ¥æ”¶åˆ°çš„æ¶ˆæ¯æ˜¯å¦æ¯”æœ¬åœ°æ¶ˆæ¯è¦æ–°ï¼ˆå¯ä»¥é€šè¿‡æ—¶é—´æˆ³æˆ–è€…ç‰ˆæœ¬ä¿¡æ¯æ¥åˆ¤æ–­ï¼‰ï¼Œå¦‚æœæ˜¯çš„è¯åˆ™æ›´æ–°æœ¬åœ°æ•°æ®ï¼Œå¦åˆ™ä¸é‡‡å–ä»»ä½•è¡Œä¸ºã€‚</li>
<li>åç†µæ¨¡å‹æ˜¯æœ€å¸¸ç”¨çš„â€œGossipåè®®â€ï¼Œæ¯”å¦‚Dynamoå°±ç”¨å…¶æ¥è¿›è¡Œæ•…éšœæ£€æµ‹ã€‚ä¹‹æ‰€ä»¥ç§°ä¹‹ä¸ºâ€œåç†µâ€ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“â€œç†µâ€æ˜¯ä¿¡æ¯è®ºé‡Œç”¨æ¥è¡¡é‡ç³»ç»Ÿæ··ä¹±æ— åºç¨‹åº¦çš„æŒ‡æ ‡ï¼Œç†µè¶Šå¤§è¯´æ˜ç³»ç»Ÿè¶Šæ— åºã€åŒ…å«çš„æœ‰ç”¨ä¿¡æ¯å«é‡è¶Šå°‘ï¼›è€Œâ€œåç†µâ€åˆ™åå…¶é“è€Œè¡Œï¼Œå› ä¸ºæ›´æ–°çš„ä¿¡æ¯ç»è¿‡ä¸€å®šè½®æ•°ï¼ˆRoundï¼‰çš„ä¼ æ’­åï¼Œé›†ç¾¤å†…æ‰€æœ‰èŠ‚ç‚¹éƒ½ä¼šè·å¾—å…¨å±€æœ€æ–°ä¿¡æ¯ï¼Œæ‰€ä»¥ç³»ç»Ÿå˜å¾—è¶Šæ¥è¶Šæœ‰åºï¼Œè¿™å°±æ˜¯â€œåç†µâ€çš„ç‰©ç†å«ä¹‰ã€‚ï¼ˆ<strong>éšæœºé€‰æ‹©</strong>ï¼‰</li>
<li>æ•£å¸ƒè°£è¨€æ¨¡å‹å’Œåç†µæ¨¡å‹ç›¸æ¯”ï¼Œå¢åŠ äº†ä¼ æ’­åœæ­¢åˆ¤æ–­ã€‚å…¶æµç¨‹å¦‚ä¸‹ï¼šå¦‚æœèŠ‚ç‚¹Pæ›´æ–°æ•°æ®ï¼Œåˆ™éšæœºé€‰æ‹©èŠ‚ç‚¹Qäº¤æ¢ä¿¡æ¯ï¼›å¦‚æœèŠ‚ç‚¹Qå·²ç»è¢«å…¶ä»–èŠ‚ç‚¹é€šçŸ¥æ›´æ–°äº†ï¼Œé‚£ä¹ˆèŠ‚ç‚¹Påˆ™å¢åŠ å…¶ä¸å†ä¸»åŠ¨é€šçŸ¥å…¶ä»–èŠ‚ç‚¹çš„æ¦‚ç‡ï¼Œåˆ°äº†ä¸€å®šç¨‹åº¦ï¼Œæ¯”å¦‚ä¸å†é€šçŸ¥å…¶ä»–èŠ‚ç‚¹çš„æ¦‚ç‡è¾¾åˆ°ä¸€å®šå€¼ï¼Œåˆ™èŠ‚ç‚¹Påœæ­¢é€šçŸ¥è¡Œä¸ºã€‚</li>
</ul>
<h4 id="åº”ç”¨ï¼šCassandraé›†ç¾¤ç®¡ç†"><a href="#åº”ç”¨ï¼šCassandraé›†ç¾¤ç®¡ç†" class="headerlink" title="åº”ç”¨ï¼šCassandraé›†ç¾¤ç®¡ç†"></a>åº”ç”¨ï¼šCassandraé›†ç¾¤ç®¡ç†</h4><p>Cassandraæ˜¯P2Pçš„åˆ—å¼æ•°æ®åº“é›†ç¾¤ï¼Œå…¶é‡‡ç”¨äº†BigTableçš„æ•°æ®æ¨¡å‹ï¼Œåº•å±‚åˆ™é‡‡ç”¨äº†ç±»ä¼¼Dynamoçš„å®ç°æœºåˆ¶ã€‚å› ä¸ºP2Pæ¶æ„æ— ä¸­å¿ƒç®¡ç†èŠ‚ç‚¹ï¼Œæ‰€ä»¥å¯¹äºé›†ç¾¤ç®¡ç†ï¼Œæ¯”å¦‚å¯¹æ˜¯å¦æ–°åŠ å…¥äº†æœºå™¨èŠ‚ç‚¹ï¼Œæ˜¯å¦æœ‰æœºå™¨å®•æœºç­‰æœºå™¨çŠ¶æ€ä¿¡æ¯çš„ç»´æŠ¤ä¸å¯èƒ½ä¾èµ–ä¸»æ§èŠ‚ç‚¹æ¥å®Œæˆã€‚åœ¨è¿™ç§åœºæ™¯ä¸‹ï¼ŒCassandraä½¿ç”¨Gossipåè®®æ¥ç»´æŠ¤é›†ç¾¤ä¸­æœºå™¨èŠ‚ç‚¹çŠ¶æ€ä¿¡æ¯ï¼Œè¿™æ ·æ¯ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥æœ€ç»ˆä¸€è‡´è·å¾—æ•´ä¸ªé›†ç¾¤å…¶ä»–èŠ‚ç‚¹çš„å…¨å±€çŠ¶æ€ã€‚</p>
<h1 id="ç¬¬7ç« â€”â€”æ•°æ®é€šé“"><a href="#ç¬¬7ç« â€”â€”æ•°æ®é€šé“" class="headerlink" title="ç¬¬7ç« â€”â€”æ•°æ®é€šé“"></a>ç¬¬7ç« â€”â€”æ•°æ®é€šé“</h1><h2 id="Logæ•°æ®æ”¶é›†"><a href="#Logæ•°æ®æ”¶é›†" class="headerlink" title="Logæ•°æ®æ”¶é›†"></a>Logæ•°æ®æ”¶é›†</h2><p>Logæ•°æ®æ”¶é›†ç³»ç»Ÿçš„è®¾è®¡å…³æ³¨ç‚¹ï¼š</p>
<ul>
<li><strong>ä½å»¶è¿Ÿ</strong>ï¼šÂ ä»Logæ•°æ®äº§ç”Ÿåˆ°èƒ½å¤Ÿå¯¹å…¶åˆ†æï¼Œå¸Œæœ›å°½å¯èƒ½å¿«åœ°å®Œæˆæ”¶é›†è¿‡ç¨‹ã€‚</li>
<li><strong>å¯æ‰©å±•æ€§</strong>ï¼šLogæ”¶é›†æœ‰ä¸ªç‰¹ç‚¹å°±æ˜¯å¾…æ”¶é›†æ•°æ®çš„å¹¿æ³›åˆ†å¸ƒæ€§ï¼Œæ‰€ä»¥è¿™å¯¹Logæ”¶é›†ç³»ç»Ÿçš„å¯æ‰©å±•æ€§æœ‰ä¸€å®šè¦æ±‚ï¼Œå› ä¸ºåŠ¨æ€å¢å‡æœåŠ¡å™¨åŠç›¸å…³æœåŠ¡å¯¹äºäº’è”ç½‘è¿ç»´æ¥è¯´æ˜¯å¸¸æ€ï¼ŒLogæ”¶é›†ç³»ç»Ÿåº”è¯¥ç›¸åº”åœ°æ˜“æ‰©å±•ã€æ˜“éƒ¨ç½²ã€‚</li>
<li><strong>å®¹é”™æ€§</strong>ï¼šÂ åŒæ ·å› ä¸ºLogæ”¶é›†æ¶‰åŠå¤§é‡æœåŠ¡å™¨ï¼Œè€Œè¿™æ„å‘³ç€éšæ—¶æœ‰å¯èƒ½å‘ç”Ÿæœºå™¨æ•…éšœï¼Œåœ¨æ­¤çº¦æŸæ¡ä»¶ä¸‹ï¼Œå¦‚ä½•ä¿è¯Logæ”¶é›†ç³»ç»Ÿçš„å®¹é”™æ€§ï¼Œä¸ä¸¢å¤±åº”è¯¥æ”¶é›†çš„æ•°æ®å°±æ˜¯ä¸€ä¸ªå¿…è¦çš„è¦æ±‚ã€‚</li>
</ul>
<h3 id="Chukwa"><a href="#Chukwa" class="headerlink" title="Chukwa"></a>Chukwa</h3><p>Chukwaæ˜¯ç”¨äºé’ˆå¯¹å¤§è§„æ¨¡åˆ†å¸ƒå¼ç³»ç»ŸLogæ”¶é›†ä¸åˆ†æç”¨é€”çš„Apacheå¼€æºé¡¹ç›®ï¼Œå…¶å»ºç«‹åœ¨Hadoopä¹‹ä¸Šã€‚</p>
<p>Chukwaçš„åŸºæœ¬ç­–ç•¥æ˜¯é¦–å…ˆæ”¶é›†å¤§é‡å•æœºçš„Logå¢é‡æ–‡ä»¶ï¼Œå°†å…¶æ±‡æ€»åå½¢æˆå¤§æ–‡ä»¶ï¼Œä¹‹åå†åˆ©ç”¨MRä»»åŠ¡æ¥å¯¹å…¶è¿›è¡ŒåŠ å·¥å¤„ç†ã€‚Chukwaå’Œå…¶ä»–ç±»ä¼¼ç³»ç»Ÿä¸åŒçš„åœ°æ–¹åœ¨äºä¸ä»…ä»…å®šä½äºæ•°æ®æ”¶é›†ï¼Œä¹Ÿåœ¨åç«¯é›†æˆæ•°æ®åˆ†æå’Œå¯è§†åŒ–ç•Œé¢ã€‚</p>
<ul>
<li>æ¯å°æœºå™¨èŠ‚ç‚¹éƒ½éƒ¨ç½²Chukwaä»£ç†ç¨‹åºï¼ˆAgentï¼‰ï¼Œå…¶è´Ÿè´£æ”¶é›†åº”ç”¨äº§ç”Ÿçš„Logæ•°æ®å¹¶é€šè¿‡HTTPåè®®ä¼ ç»™Chukwaæ”¶é›†å™¨ï¼ˆCollectorsï¼‰ã€‚ä¸€èˆ¬ä¸€ä¸ªæ”¶é›†å™¨è´Ÿè´£æ”¶é›†æ•°ç™¾ä¸ªä»£ç†ç¨‹åºä¼ æ¥çš„æ•°æ®ï¼Œå¦‚æœä»£ç†ç¨‹åºå¯¹åº”çš„æ”¶é›†å™¨å‘ç”Ÿæ•…éšœï¼Œä»£ç†ç¨‹åºå¯ä»¥æ£€æŸ¥æ”¶é›†å™¨åˆ—è¡¨å¹¶ä»ä¸­é€‰æ‹©å¦å¤–ä¸€ä¸ªæ”¶é›†å™¨æ¥å‘é€æ•°æ®ï¼Œè¿™æ ·å³å¯å®ç°ä¸€å®šç¨‹åº¦çš„å®¹é”™ã€‚</li>
<li>æ”¶é›†å™¨è´Ÿè´£å°†æ±‡æ€»çš„æ•°æ®å†™å…¥HDFSæ–‡ä»¶ä¸­ï¼Œè¿™äº›æ–‡ä»¶è¢«ç§°ä¸ºDataSinkæ–‡ä»¶ã€‚DataSinkæ–‡ä»¶ä¿å­˜çš„æ˜¯æœ€åŸå§‹çš„Logä¿¡æ¯ï¼Œå½“å…¶å¤§å°è¾¾åˆ°ä¸€å®šç¨‹åº¦ï¼Œæ”¶é›†å™¨åˆ™å…³é—­è¯¥æ–‡ä»¶ï¼Œéšåäº§ç”Ÿçš„æ–°æ•°æ®å°†è¢«å†™å…¥æ–°ç”Ÿæˆçš„DataSinkæ–‡ä»¶ä¸­ã€‚</li>
<li>ArchiveBuilderè¿›ä¸€æ­¥åˆå¹¶DataSinkæ–‡ä»¶å¹¶åšäº›æ’åºä»¥åŠå»é‡çš„å·¥ä½œã€‚Demuxæ˜¯MRç¨‹åºï¼Œè´Ÿè´£å¯¹åŸå§‹Logæ•°æ®è¿›è¡Œè§£ææŠ½å–ï¼Œå°†åŸå§‹æ— ç»“æ„è®°å½•è½¬æ¢ä¸ºç»“æ„åŒ–æˆ–è€…åŠç»“æ„åŒ–çš„æ•°æ®ï¼ˆChukwa Recordsï¼‰ã€‚å¯¹äºç»“æ„åŒ–Logæ•°æ®ï¼Œå¯ä»¥ç›´æ¥å±•ç°ç»™ç”¨æˆ·ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨MRç¨‹åºå¯¹å…¶è¿›è¡Œè¿›ä¸€æ­¥åˆ†æï¼Œè¿˜å¯ä»¥é€šè¿‡MDLæ„ä»¶å°†å…¶å¯¼å…¥å…³ç³»æ•°æ®åº“ä¸­ä½¿ç”¨SQLè¯­å¥è¿›è¡ŒæŸ¥è¯¢ã€‚<br>![[file-20250925093854062.jpg | 500]]</li>
</ul>
<p>æ•´ä½“æ•ˆç‡ä¸å¤ªé«˜ï¼Œä¸»è¦æ˜¯MRä»»åŠ¡çš„å¯åŠ¨å¼€é”€åŠä¸­é—´æ•°æ®å’Œç»“æœæ•°æ®å¤šæ¬¡ç£ç›˜è¯»ï¼å†™é€ æˆçš„ã€‚</p>
<h3 id="Scribe"><a href="#Scribe" class="headerlink" title="Scribe"></a>Scribe</h3><p>Scribeæ˜¯Facebookå¼€æºçš„åˆ†å¸ƒå¼æ—¥å¿—æ”¶é›†ç³»ç»Ÿï¼Œå…¶å¯ä»¥ä»é›†ç¾¤ä¸­çš„æœºå™¨èŠ‚ç‚¹æ”¶é›†æ±‡æ€»Logä¿¡æ¯å¹¶é€è¾¾ä¸­å¤®æ•°æ®å­˜å‚¨åŒºï¼ˆHDFSæˆ–è€…NFSï¼‰ï¼Œä¹‹åå¯ä»¥å¯¹å…¶è¿›è¡Œè¿›ä¸€æ­¥çš„åˆ†æå¤„ç†ã€‚Scribeå…·å¤‡é«˜æ‰©å±•æ€§å’Œé«˜å®¹é”™èƒ½åŠ›ã€‚</p>
<ul>
<li>åº”ç”¨ç¨‹åºä½œä¸ºThriftå®¢æˆ·ç«¯æ¥å’ŒScribeæœåŠ¡å™¨é€šä¿¡ï¼Œå°†æœ¬åœ°Logä¿¡æ¯åŠå…¶ä¿¡æ¯åˆ†ç±»å‘é€åˆ°ScribeæœåŠ¡å™¨ã€‚ä½¿ç”¨Thriftçš„å¥½å¤„æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œå®ƒå…è®¸åº”ç”¨ç¨‹åºä½¿ç”¨å¤šç§è¯­è¨€æ¥åšLogæ”¶é›†ï¼Œå…·å¤‡è¾ƒå¤§çµæ´»æ€§ã€‚</li>
<li>ScribeæœåŠ¡å™¨å¯ä»¥æ˜¯å•æœºä¹Ÿå¯ä»¥æ˜¯é›†ç¾¤ï¼Œå…¶å†…éƒ¨ç»´æŠ¤äº†æ¶ˆæ¯é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—å†…å®¹å³å„ä¸ªå®¢æˆ·ç«¯Â å‘é€çš„ä¿¡æ¯ã€‚ScribeæœåŠ¡å™¨åç«¯å¯ä»¥å°†é˜Ÿåˆ—å†…å®¹æ¶ˆè´¹ä¼ è¾¾ä¸­å¤®å­˜å‚¨åŒºï¼ˆHDFSã€NFSæˆ–è€…å¦å¤–çš„ScribeæœåŠ¡å™¨ï¼‰ï¼Œå¦‚æœä¸­å¤®å­˜å‚¨åŒºä¸å¯ç”¨ï¼ŒScribeå°†ä¿¡æ¯å…ˆå­˜å…¥æœ¬åœ°ç£ç›˜ï¼Œå¾…å…¶å¯ç”¨æ—¶å†è½¬å‘è¿‡å»ï¼Œè¿™æ ·æ•´ä¸ªç³»ç»Ÿå°±å…·å¤‡è¾ƒå¥½çš„å®¹é”™èƒ½åŠ›ã€‚</li>
</ul>
<p>![[file-20250925094112176.jpg | 500]]</p>
<h2 id="æ•°æ®æ€»çº¿"><a href="#æ•°æ®æ€»çº¿" class="headerlink" title="æ•°æ®æ€»çº¿"></a>æ•°æ®æ€»çº¿</h2><p>æ•°æ®æ€»çº¿çš„ä½œç”¨å°±æ˜¯èƒ½å¤Ÿå½¢æˆæ•°æ®å˜åŒ–é€šçŸ¥é€šé“ï¼Œå½“é›†ä¸­å­˜å‚¨çš„æ•°æ®æºï¼ˆå¾€å¾€æ˜¯å…³ç³»å‹æ•°æ®åº“ï¼‰çš„æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œèƒ½å°½å¿«é€šçŸ¥å¯¹æ•°æ®å˜åŒ–æ•æ„Ÿçš„ç›¸å…³åº”ç”¨æˆ–è€…ç³»ç»Ÿæ„ä»¶ï¼Œä½¿å¾—å®ƒä»¬èƒ½å°½å¿«æ•è·è¿™ç§æ•°æ®å˜åŒ–ã€‚<br>è®¾è®¡æ•°æ®æ€»çº¿ç³»ç»Ÿæ—¶è¦å…³æ³¨ä»¥ä¸‹3ä¸ªç‰¹æ€§ã€‚</p>
<ul>
<li>è¿‘å®æ—¶æ€§ï¼šå› ä¸ºå¾ˆå¤šåº”ç”¨å¸Œæœ›èƒ½å°½å¯èƒ½å¿«åœ°æ•è·æ•°æ®å˜åŒ–ï¼Œæ‰€ä»¥è¿™ç§å˜åŒ–é€šçŸ¥æœºåˆ¶è¶Šå¿«è¶Šå¥½ã€‚</li>
<li>æ•°æ®å›æº¯èƒ½åŠ›ï¼šåº”ç”¨å¯ä»¥é‡æ–°è·å–æŒ‡å®šæ—¶åˆ»çš„å†å²æ•°æ®å˜åŒ–æƒ…å†µã€‚</li>
<li>ä¸»é¢˜è®¢é˜…èƒ½åŠ›ï¼šæ•°æ®æ€»çº¿æœ€å¥½èƒ½å¤Ÿæ”¯æŒåº”ç”¨çµæ´»åœ°è®¢é˜…å…¶å…³å¿ƒçš„æ•°æ®å˜åŒ–æƒ…å†µã€‚</li>
</ul>
<p>æœ‰ä¸¤ç§ä¸åŒçš„å®ç°æ€è·¯ï¼šåº”ç”¨åŒå†™ï¼ˆDual Writeï¼‰æˆ–è€…æ•°æ®åº“æ—¥å¿—æŒ–æ˜ã€‚<br>![[file-20251010185947253.jpg | 400]]</p>
<ul>
<li>â€œåº”ç”¨åŒå†™â€ï¼šæŒ‡åº”ç”¨å°†æ•°æ®å˜åŒ–åŒæ—¶å†™å…¥æ•°æ®åº“ä»¥åŠæŸä¸ªPub-Subæ¶ˆæ¯ç³»ç»Ÿä¸­ï¼Œå…³æ³¨æ•°æ®å˜åŒ–çš„åº”ç”¨å¯ä»¥è®¢é˜…Pub-Subæ¶ˆæ¯ç³»ç»Ÿä¸­è‡ªå·±å…³å¿ƒçš„ä¸»é¢˜ï¼Œä»¥æ­¤æ¥è·å¾—æ•°æ®é€šçŸ¥ï¼Œå³æ•°æ®åº“çš„å½’æ•°æ®åº“ï¼Œåº”ç”¨çš„å½’æ¶ˆæ¯ç³»ç»Ÿã€‚</li>
<li>æ•°æ®åº“æ—¥å¿—æŒ–æ˜ï¼šåº”ç”¨å…ˆå°†æ•°æ®å˜æ›´å†™å…¥æ•°æ®åº“ï¼Œæ•°æ®æ€»çº¿ä»æ•°æ®åº“çš„æ—¥å¿—ä¸­æŒ–æ˜å‡ºæ•°æ®å˜åŒ–ä¿¡æ¯ï¼Œç„¶åé€šçŸ¥ç»™å…³å¿ƒæ•°æ®å˜åŒ–çš„å„ç±»åº”ç”¨ã€‚<ul>
<li><strong>Databus</strong>ï¼šä¸ºäº†åŠ å¿«æ•°æ®é€šçŸ¥é€Ÿåº¦ï¼ŒDatabusé‡‡ç”¨äº†å†…å­˜æ•°æ®ä¸­ç»§å™¨ï¼ˆRelayï¼‰ï¼Œä¸­ç»§å™¨æœ¬è´¨ä¸Šæ˜¯ä¸ªç¯çŠ¶çš„å†…å­˜ç¼“å†²åŒºï¼Œä¹‹æ‰€ä»¥è®¾è®¡æˆç¯çŠ¶ï¼Œæ˜¯è€ƒè™‘å†…å­˜å¤§å°æœ‰é™ï¼Œåªèƒ½ä¿å­˜ä¸€å®šé‡çš„æœ€æ–°æ›´æ–°ï¼Œæ‰€ä»¥å½“æ›´æ–°æ•°æ®è¶…å‡ºç¼“å†²åŒºå¤§å°æ—¶ï¼Œç›¸å¯¹æ—§çš„æ•°æ®ä¼šè¢«æ–°æ•°æ®è¦†ç›–ã€‚</li>
<li><strong>Wormhole</strong>ï¼šå…¶å°†æ•°æ®åº“æ•°æ®å˜åŒ–ä¿¡æ¯é«˜æ•ˆåœ°é€šçŸ¥æ„Ÿå…´è¶£çš„ç›¸å…³åº”ç”¨ã€‚ç›®å‰Wormholeå·²ç»æˆä¸ºFacebookæ•´ä½“å·¥ç¨‹æ¶æ„ä¸­çš„é‡è¦ä¸€ç¯ï¼Œæ¯æ—¥é€šè¿‡Wormholeä¼ è¾¾çš„æ•°æ®å˜åŒ–æ¶ˆæ¯é«˜è¾¾10äº¿æ¡ä¹‹å¤šã€‚</li>
</ul>
</li>
</ul>
<h2 id="æ•°æ®å¯¼å…¥-å¯¼å‡º"><a href="#æ•°æ®å¯¼å…¥-å¯¼å‡º" class="headerlink" title="æ•°æ®å¯¼å…¥&#x2F;å¯¼å‡º"></a>æ•°æ®å¯¼å…¥&#x2F;å¯¼å‡º</h2><p>Sqoopæ˜¯ä¸“é—¨åœ¨Hadoopå’Œå…¶ä»–å…³ç³»å‹æ•°æ®åº“æˆ–è€…NoSQLæ•°æ®åº“ä¹‹é—´è¿›è¡Œç›¸äº’ä¹‹é—´æ•°æ®å¯¼å…¥å’Œå¯¼å‡ºçš„å¼€æºå·¥å…·ã€‚åœ¨å…¶å†…éƒ¨å®ç°æ—¶ï¼Œå…·ä½“çš„å¯¼å…¥ï¼å¯¼å‡ºå·¥ä½œæ˜¯é€šè¿‡å¯ä»¥è¿æ¥å¹¶æ“ä½œæ•°æ®åº“çš„MRä»»åŠ¡å®Œæˆçš„ã€‚<br>![[file-20251010191103194.jpg | 500]]</p>
<p>Sqoop1ä¸­åªæä¾›äº†å‘½ä»¤è¡Œå·¥å…·ï¼Œè€ŒSqoop2åˆ™å°†SqoopæŠ½ç¦»ä¸ºç‹¬ç«‹çš„æœåŠ¡ï¼Œå¹¶æ–°å¢äº†Web Browseræ“ä½œç•Œé¢ä»¥åŠRestè°ƒç”¨æ¥å£ã€‚åŒæ—¶ï¼ŒSqoop1åªèƒ½ä»¥JDBCæ–¹å¼è¿æ¥æ•°æ®åº“ï¼Œè€ŒSqoop2ä¸ä»…å¯ä»¥æ”¯æŒæ›´å¤šè¿æ¥æ–¹å¼ï¼Œåœ¨å°è£…è¿æ¥å™¨ï¼ˆConnectorï¼‰æ—¶ä¹Ÿæ›´åŠ ç®€æ˜“ä¾¿æ·ã€‚å¦å¤–ï¼ŒSqoop1åªæ”¯æŒå¯¹Hadoopæ•°æ®çš„å®‰å…¨è®¤è¯ï¼ˆKerberosï¼‰ï¼Œè€ŒSqoop2åˆ™å¢åŠ äº†å¯¹å¤–éƒ¨æ•°æ®åº“çš„è®¤è¯æ”¯æŒã€‚</p>
<p>Sqoopæ˜¯åœ¨Hadoopå’Œå…¶ä»–æ•°æ®å­˜å‚¨æ–¹å¼ä¹‹é—´è¿›è¡Œæ•°æ®å¯¼å…¥ï¼å¯¼å‡ºçš„ä¾¿æ·å·¥å…·ï¼Œå¯ä»¥æå¤§åœ°æé«˜æ­¤ç±»å·¥ä½œçš„æ•ˆç‡ã€‚</p>
<h1 id="ç¬¬8ç« -åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ"><a href="#ç¬¬8ç« -åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="ç¬¬8ç«  åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ"></a>ç¬¬8ç«  åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ</h1><h2 id="Googleæ–‡ä»¶ç³»ç»Ÿ"><a href="#Googleæ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="Googleæ–‡ä»¶ç³»ç»Ÿ"></a>Googleæ–‡ä»¶ç³»ç»Ÿ</h2><p>FSæ˜¯å…¶ä»–ç›¸å…³æŠ€æœ¯çš„åŸºçŸ³ï¼Œå› ä¸ºGFSæä¾›äº†æµ·é‡éç»“æ„åŒ–ä¿¡æ¯çš„å­˜å‚¨å¹³å°ï¼Œå¹¶æä¾›äº†æ•°æ®çš„å†—ä½™å¤‡ä»½ã€æˆåƒå°æœåŠ¡å™¨çš„è‡ªåŠ¨è´Ÿè½½å‡è¡¡ä»¥åŠå¤±æ•ˆæœåŠ¡å™¨æ£€æµ‹ç­‰å„ç§å®Œå¤‡çš„åˆ†å¸ƒå¼å­˜å‚¨åŠŸèƒ½ã€‚</p>
<h3 id="è®¾è®¡åŸåˆ™"><a href="#è®¾è®¡åŸåˆ™" class="headerlink" title="è®¾è®¡åŸåˆ™"></a>è®¾è®¡åŸåˆ™</h3><ul>
<li>å†—ä½™å¤‡ä»½ã€è‡ªåŠ¨æ£€æµ‹æœºå™¨æ˜¯å¦è¿˜åœ¨æœ‰æ•ˆæä¾›æœåŠ¡ã€æ•…éšœæœºå™¨çš„è‡ªåŠ¨æ¢å¤</li>
<li>é’ˆå¯¹è¿™ç§å¤§æ–‡ä»¶çš„è¯»ï¼å†™æ“ä½œåšå‡ºä¼˜åŒ–</li>
<li>ç³»ç»Ÿä¸­å­˜åœ¨å¤§é‡çš„â€œè¿½åŠ å†™â€æ“ä½œï¼Œå³å°†æ–°å¢å†…å®¹è¿½åŠ åˆ°å·²æœ‰æ–‡ä»¶çš„æœ«å°¾ï¼Œå·²ç»å†™å…¥çš„å†…å®¹ä¸€èˆ¬ä¸åšæ›´æ”¹ï¼Œå¾ˆå°‘æœ‰æ–‡ä»¶çš„â€œéšæœºå†™â€è¡Œä¸º</li>
</ul>
<h3 id="æ•´ä½“æ¶æ„-1"><a href="#æ•´ä½“æ¶æ„-1" class="headerlink" title="æ•´ä½“æ¶æ„"></a>æ•´ä½“æ¶æ„</h3><p>![[file-20251029201231991.jpg | 500]]<br>GFSæ–‡ä»¶ç³»ç»Ÿä¸»è¦ç”±3ä¸ªç»„æˆéƒ¨åˆ†æ„æˆï¼šå”¯ä¸€çš„â€œä¸»æ§æœåŠ¡å™¨â€ï¼ˆMasterï¼‰ã€ä¼—å¤šçš„â€œChunkæœåŠ¡å™¨â€å’Œâ€œGFSå®¢æˆ·ç«¯â€ã€‚â€œä¸»æ§æœåŠ¡å™¨â€ä¸»è¦åšç®¡ç†å·¥ä½œï¼Œâ€œChunkæœåŠ¡å™¨â€è´Ÿè´£å®é™…çš„æ•°æ®å­˜å‚¨å¹¶å“åº”â€œGFSå®¢æˆ·ç«¯â€çš„è¯»ï¼å†™è¯·æ±‚ã€‚</p>
<ul>
<li>GFSå‘½åç©ºé—´ç”±ä¼—å¤šçš„ç›®å½•å’ŒGFSæ–‡ä»¶æ„æˆï¼Œä¸€ä¸ªGFSæ–‡ä»¶ç”±ä¼—å¤šå›ºå®šå¤§å°çš„Chunkæ„æˆï¼Œè€Œæ¯ä¸ªChunkåˆç”±æ›´å°ç²’åº¦çš„Blockæ„æˆï¼ŒChunkæ˜¯GFSä¸­åŸºæœ¬çš„å­˜å‚¨å•å…ƒï¼Œè€ŒBlockæ˜¯åŸºæœ¬çš„è¯»å–å•å…ƒã€‚</li>
</ul>
<p>![[file-20251029201555539.jpg | 500]]</p>
<h3 id="ä¸»æ§æœåŠ¡å™¨"><a href="#ä¸»æ§æœåŠ¡å™¨" class="headerlink" title="ä¸»æ§æœåŠ¡å™¨"></a>ä¸»æ§æœåŠ¡å™¨</h3><p>ä¸»æ§æœåŠ¡å™¨ä¸»è¦ä»äº‹ç³»ç»Ÿå…ƒæ•°æ®å­˜å‚¨ç®¡ç†ä»¥åŠæ•´ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿçš„ç®¡ç†ï¼Œæ¯”å¦‚è´Ÿè½½å‡è¡¡ï¼Œæ•°æ®åœ¨å­˜å‚¨æœåŠ¡å™¨ä¹‹é—´è¿ç§»ï¼Œæ£€æµ‹æ–°åŠ å…¥çš„æœºå™¨ä»¥åŠå¤±æ•ˆæœºå™¨ç­‰å·¥ä½œã€‚</p>
<p>ç»´æŒæ•´ä¸ªç³»ç»Ÿæ­£å¸¸è¿è½¬éœ€è¦3ç±»å…ƒæ•°æ®ã€‚</p>
<ul>
<li>GFSå‘½åç©ºé—´å’ŒChunkå‘½åç©ºé—´</li>
<li>ä»æ–‡ä»¶åˆ°å…¶æ‰€å±Chunkä¹‹é—´çš„æ˜ å°„å…³ç³»</li>
<li>æ¯ä¸ªChunkåœ¨å“ªå°â€œChunkæœåŠ¡å™¨â€å­˜å‚¨çš„ä¿¡æ¯</li>
</ul>
<p>ä¸ºäº†é¿å…å•ä¸€â€œä¸»æ§æœåŠ¡å™¨â€å¯èƒ½å­˜åœ¨çš„å•ç‚¹å¤±æ•ˆé—®é¢˜ï¼ŒGFSé‡‡ç”¨äº†å¢åŠ å¦å¤–ä¸€å°â€œå½±å­æœåŠ¡å™¨â€ï¼ˆShadowï¼‰çš„æ–¹å¼ï¼Œå½“â€œä¸»æ§æœåŠ¡å™¨â€å‡ºç°æ•…éšœæ— æ³•æä¾›æœåŠ¡æ—¶ï¼Œå¯ç”±å½±å­æœåŠ¡å™¨æ¥æ›¿â€œä¸»æ§æœåŠ¡å™¨â€è¡Œä½¿å¯¹åº”çš„ç®¡ç†åŠŸèƒ½ã€‚</p>
<h3 id="ç³»ç»Ÿäº¤äº’è¡Œä¸º"><a href="#ç³»ç»Ÿäº¤äº’è¡Œä¸º" class="headerlink" title="ç³»ç»Ÿäº¤äº’è¡Œä¸º"></a>ç³»ç»Ÿäº¤äº’è¡Œä¸º</h3><p>ä¸ºäº†æ–¹ä¾¿ç®¡ç†ï¼ŒGFSå¯¹äºå¤šä¸ªç›¸äº’å¤‡ä»½çš„Chunkï¼Œä»ä¸­é€‰å‡ºä¸€ä¸ªä½œä¸ºâ€œä¸»å¤‡ä»½â€ï¼Œå…¶ä»–çš„è¢«ç§°ä½œâ€œæ¬¡çº§å¤‡ä»½â€ï¼Œç”±â€œä¸»å¤‡ä»½â€å†³å®šâ€œæ¬¡çº§å¤‡ä»½â€çš„æ•°æ®å†™å…¥é¡ºåº</p>
<p>![[file-20251029202339323.jpg | 400]]</p>
<ul>
<li>GFSå®¢æˆ·ç«¯é¦–å…ˆå’Œâ€œä¸»æ§æœåŠ¡å™¨â€é€šä¿¡ï¼Œè·çŸ¥å“ªäº›â€œChunkæœåŠ¡å™¨â€å­˜å‚¨äº†è¦å†™å…¥çš„Chunkï¼ŒåŒ…æ‹¬â€œä¸»å¤‡ä»½â€å’Œä¸¤ä¸ªâ€œæ¬¡çº§å¤‡ä»½â€çš„åœ°å€æ•°æ®ã€‚</li>
<li>ä¹‹åï¼ŒGFSå®¢æˆ·ç«¯å°†è¦å†™å…¥çš„æ•°æ®æ¨é€ç»™3ä¸ªå¤‡ä»½Chunkï¼Œå¤‡ä»½Chunké¦–å…ˆå°†è¿™äº›å¾…å†™å…¥çš„æ•°æ®æ”¾åœ¨ç¼“å­˜ä¸­</li>
<li>ç„¶åé€šçŸ¥GFSå®¢æˆ·ç«¯æ˜¯å¦æ¥æ”¶æˆåŠŸï¼Œå¦‚æœæ‰€æœ‰çš„å¤‡ä»½éƒ½æ¥æ”¶æ•°æ®æˆåŠŸï¼ŒGFSå®¢æˆ·ç«¯é€šçŸ¥â€œä¸»å¤‡ä»½â€å¯ä»¥æ‰§è¡Œå†™å…¥æ“ä½œã€‚</li>
</ul>
<h3 id="Colossus"><a href="#Colossus" class="headerlink" title="Colossus"></a>Colossus</h3><p>Colossusæ˜¯Googleçš„ä¸‹ä¸€ä»£GFSåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œå°šæœªæœ‰å…¬å¼€æ–‡çŒ®è®²è¿°å…¶æŠ€æœ¯ç»†èŠ‚ï¼Œä»é›¶æ˜Ÿå…¬å¼€èµ„æ–™ä¸­å¯ä»¥çœ‹åˆ°å…¶å¯¹GFSçš„æ”¹è¿›é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ã€‚</p>
<ul>
<li>å°†å•ä¸€ä¸»æ§æœåŠ¡å™¨æ”¹é€ ä¸ºå¤šä¸»æ§æœåŠ¡å™¨æ„æˆçš„é›†ç¾¤ï¼Œå°†æ‰€æœ‰ç®¡ç†æ•°æ®è¿›è¡Œæ•°æ®åˆ†ç‰‡ååˆ†é…åˆ°ä¸åŒçš„ä¸»æ§æœåŠ¡å™¨ä¸­ï¼Œè¿™æ ·æ•´ä¸ªåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿçš„æ°´å¹³æ‰©å±•æ€§å¾—åˆ°äº†æå¤§å¢å¼ºï¼Œä½¿å¾—ç³»ç»Ÿå¯ä»¥å®¹çº³æ›´å¤šæ•°é‡çš„æ–‡ä»¶ã€‚</li>
<li>Colossusä½¿ç”¨äº†Reed-Solomonçº åˆ ç ç®—æ³•æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œè¿™æ ·å¯ä»¥åœ¨æä¾›ç›¸åŒæœåŠ¡æƒ…å½¢ä¸‹å¤§å¤§å‡å°‘ç¡¬ä»¶æˆæœ¬ã€‚</li>
<li>Colossuså¢åŠ äº†å®¢æˆ·ç«¯çš„çµæ´»æ€§ï¼Œä½¿å¾—å®¢æˆ·ç«¯å¯ä»¥ç®¡ç†å¤‡ä»½æ•°æ®çš„å­˜å‚¨åœ°ç‚¹</li>
</ul>
<h2 id="HDFS"><a href="#HDFS" class="headerlink" title="HDFS"></a>HDFS</h2><p>ä»Hadoop 2.0å¼€å§‹æå‡ºé«˜å¯ç”¨æ–¹æ¡ˆï¼ˆHigh Availabilityï¼ŒHAï¼‰å’ŒNameNodeè”ç›Ÿï¼ˆNameNode Federationï¼‰ã€‚å…¶ä¸­HAæ˜¯ä¸ºäº†è§£å†³å•ç‚¹å¤±æ•ˆé—®é¢˜ï¼Œè€ŒNameNodeè”ç›Ÿåˆ™æ˜¯ä¸ºäº†è§£å†³æ•´ä¸ªç³»ç»Ÿçš„æ°´å¹³æ‰©å±•é—®é¢˜ã€‚</p>
<h3 id="HDFSæ•´ä½“æ¶æ„"><a href="#HDFSæ•´ä½“æ¶æ„" class="headerlink" title="HDFSæ•´ä½“æ¶æ„"></a>HDFSæ•´ä½“æ¶æ„</h3><p>![[file-20251031145834448.jpg | 500]]</p>
<ul>
<li>NameNodeï¼šè´Ÿè´£ç®¡ç†æ•´ä¸ªåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿçš„å…ƒæ•°æ®ï¼ŒåŒ…æ‹¬æ–‡ä»¶ç›®å½•æ ‘ç»“æ„ã€æ–‡ä»¶åˆ°æ•°æ®å—Blockçš„æ˜ å°„å…³ç³»ã€Blockå‰¯æœ¬åŠå…¶å­˜å‚¨ä½ç½®ç­‰å„ç§ç®¡ç†æ•°æ®ã€‚è¿™äº›æ•°æ®ä¿æŒåœ¨å†…å­˜ä¸­ï¼ŒåŒæ—¶åœ¨ç£ç›˜ä¿å­˜ä¸¤ä¸ªå…ƒæ•°æ®ç®¡ç†æ–‡ä»¶ï¼šfsimageå’Œeditlogï¼›è´Ÿè´£DataNodeçš„çŠ¶æ€ç›‘æ§ï¼Œä¸¤è€…é€šè¿‡çŸ­æ—¶é—´é—´éš”çš„å¿ƒè·³æ¥ä¼ é€’ç®¡ç†ä¿¡æ¯å’Œæ•°æ®ä¿¡æ¯ã€‚</li>
<li>Secondary NameNodeï¼šå®šæœŸä»NameNodeæ‹‰å–fsimageå’Œeditlogæ–‡ä»¶å¹¶å¯¹è¿™ä¸¤ä¸ªæ–‡ä»¶è¿›è¡Œåˆå¹¶ï¼Œå‡è½»NameNodeçš„å·¥ä½œå‹åŠ›ï¼ŒNameNodeæœ¬èº«å¹¶ä¸åšè¿™ç§åˆå¹¶æ“ä½œã€‚æ‰€ä»¥æœ¬è´¨ä¸ŠSecondary NameNodeæ˜¯ä¸ªæä¾›æ£€æŸ¥ç‚¹åŠŸèƒ½æœåŠ¡çš„æœåŠ¡å™¨ã€‚</li>
<li>DataNodeï¼šè´Ÿè´£æ•°æ®å—çš„å®é™…å­˜å‚¨å’Œè¯»ï¼å†™å·¥ä½œ</li>
<li>å®¢æˆ·ç«¯ï¼šå’ŒNameNodeè”ç³»è·å–æ‰€éœ€è¯»ï¼å†™æ–‡ä»¶çš„å…ƒæ•°æ®ï¼Œå®é™…çš„æ•°æ®è¯»ï¼å†™éƒ½æ˜¯å’ŒDataNodeç›´æ¥é€šä¿¡å®Œæˆçš„ã€‚</li>
</ul>
<h3 id="HAæ–¹æ¡ˆ"><a href="#HAæ–¹æ¡ˆ" class="headerlink" title="HAæ–¹æ¡ˆ"></a>HAæ–¹æ¡ˆ</h3><p>ä¸ºäº†é¿å…â€œä¸»æ§æœåŠ¡å™¨â€çš„å•ç‚¹å¤±æ•ˆé—®é¢˜ï¼ŒHadoop 2.0ç»™å‡ºäº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆã€‚â€œä¸»æ§æœåŠ¡å™¨â€ç”±Active NameNodeï¼ˆç®€ç§°ANNï¼‰å’ŒStandby NameNodeï¼ˆç®€ç§°SNNï¼‰ä¸€ä¸»ä¸€ä»ä¸¤å°æœåŠ¡å™¨æ„æˆï¼ŒANNæ˜¯å½“å‰å“åº”å®¢æˆ·ç«¯è¯·æ±‚çš„æœåŠ¡å™¨ï¼ŒSNNä½œä¸ºå†·å¤‡ä»½æˆ–è€…çƒ­å¤‡ä»½æœºï¼Œåœ¨ANNå‘ç”Ÿæ•…éšœæ—¶æ¥ç®¡å®¢æˆ·ç«¯è¯·æ±‚å¹¶ç”±SNNè½¬æ¢ä¸ºANNã€‚</p>
<p>![[file-20251104140305579.jpg | 450]]</p>
<p>ä¸€è‡´æ€§ä¿è¯ï¼š</p>
<ul>
<li>ä½¿ç”¨ç¬¬ä¸‰æ–¹å…±äº«å­˜å‚¨ï¼ˆNAS+NFSï¼‰æ¥ä¿å­˜ç›®å½•æ–‡ä»¶ç­‰å‘½åç©ºé—´å…ƒæ•°æ®ï¼ˆeditlogï¼‰ï¼ŒANNå°†å…ƒæ•°æ®çš„æ›´æ”¹ä¿¡æ¯å†™å…¥ç¬¬ä¸‰æ–¹å­˜å‚¨ï¼ŒSNNä»ç¬¬ä¸‰æ–¹å­˜å‚¨ä¸æ–­è·å–æ›´æ–°çš„å…ƒæ•°æ®å¹¶ä½“ç°åœ¨å†…å­˜å…ƒæ•°æ®ä¸­ï¼Œä»¥æ­¤æ¥è¾¾åˆ°ä¸¤è€…çš„æ•°æ®ä¸€è‡´æ€§ã€‚å¾ˆå¤šç¬¬ä¸‰æ–¹å­˜å‚¨è‡ªå¸¦å¾ˆå¼ºçš„å†—ä½™ä¸å®¹é”™æœºåˆ¶ï¼Œæ‰€ä»¥å…¶å¯é æ€§è¦æ¯”å•å°æœåŠ¡å™¨å¼ºå¾—å¤šã€‚</li>
<li>æ‰€æœ‰DataNodeåŒæ—¶å°†å¿ƒè·³ä¿¡æ¯å‘é€ç»™ANNå’ŒSNNã€‚ç”±äºNNä¸­çš„Block Mapä¿¡æ¯å¹¶ä¸å­˜å‚¨åœ¨å‘½åç©ºé—´å…ƒæ•°æ®ä¸­ï¼Œè€Œæ˜¯åœ¨NNå¯åŠ¨æ—¶ä»å„ä¸ªDataNodeè·å¾—çš„ï¼Œä¸ºäº†èƒ½å¤Ÿä½¿å¾—æ•…éšœåˆ‡æ¢æ—¶æ–°ANNé¿å…è¿™ä¸€è€—æ—¶è¡Œä¸ºï¼Œæ‰€ä»¥DataNodeåŒæ—¶å°†ä¿¡æ¯å‘é€ç»™ANNå’ŒSNNã€‚</li>
</ul>
<p>ä¸€é”®åˆ‡æ¢çš„ä¿éšœï¼š</p>
<ul>
<li>ä»¥ä¸Šæªæ–½åªèƒ½ä¿è¯SNNçš„å…ƒæ•°æ®å’ŒANNä¿æŒä¸€è‡´ï¼Œä½†æ˜¯è¿˜ä¸èƒ½å¤Ÿå®ç°æ•…éšœè‡ªåŠ¨åˆ‡æ¢ï¼Œä¸ºäº†è¾¾åˆ°è¿™ä¸€ç‚¹ï¼ŒHAè§£å†³æ–¹æ¡ˆé‡‡ç”¨äº†ç‹¬ç«‹äºNNä¹‹å¤–çš„æ•…éšœåˆ‡æ¢æ§åˆ¶å™¨ï¼ˆFailover Controllerï¼ŒFCï¼‰</li>
<li>FCç”¨äºç›‘æ§NNæœåŠ¡å™¨çš„ç¡¬ä»¶ã€æ“ä½œç³»ç»ŸåŠNNæœ¬èº«ç­‰å„ç§å¥åº·çŠ¶å†µä¿¡æ¯ï¼Œå¹¶ä¸æ–­åœ°å‘ZooKeeperå†™å…¥å¿ƒè·³ä¿¡æ¯ï¼ŒZooKeeperåœ¨æ­¤ç”¨ä½œâ€œé¢†å¯¼è€…é€‰ä¸¾â€ï¼Œå½“ANNå‘ç”Ÿæ•…éšœæ—¶ï¼ŒZooKeeperé‡æ–°é€‰ä¸¾SNNä½œä¸ºâ€œä¸»æ§æœåŠ¡å™¨â€ï¼ŒFCé€šçŸ¥SNNä»å¤‡ä»½æœºè½¬æ¢ä¸ºä¸»æ§æœºã€‚åœ¨Hadoopç³»ç»Ÿåˆšå¯åŠ¨æ—¶ï¼Œä¸¤å°æœåŠ¡å™¨éƒ½æ˜¯SNNï¼Œé€šè¿‡ZooKeeperé€‰ä¸¾ä½¿å¾—æŸå°æœåŠ¡å™¨æˆä¸ºANNã€‚<br>é‡‡å–ç‹¬ç«‹äºNNçš„FCï¼š</li>
<li>å› ä¸ºNNåœ¨åšåƒåœ¾å›æ”¶ï¼ˆGCï¼‰çš„æ—¶å€™å¾ˆå¯èƒ½åœ¨è¾ƒé•¿æ—¶é—´ï¼ˆ10ç§’å·¦å³ï¼‰å†…æ•´ä¸ªç³»ç»Ÿæ— å“åº”ï¼Œæ‰€ä»¥æ— æ³•å‘ZooKeeperæ­£å¸¸å†™å…¥å¿ƒè·³ä¿¡æ¯</li>
<li>åœ¨è®¾è®¡åŸåˆ™ä¸Šåº”è¯¥å°†ç›‘æ§ç¨‹åºå’Œè¢«ç›‘æ§ç¨‹åºè¿›è¡Œåˆ†ç¦»è€Œéç»‘å®šåœ¨ä¸€èµ·ã€‚</li>
</ul>
<p>è„‘è£‚é—®é¢˜ï¼šæ•´ä¸ªç³»ç»Ÿä¸­åŒæ—¶æœ‰ä¸¤ä¸ªæˆ–è€…å¤šä¸ªæ´»è·ƒçš„â€œä¸»æ§æœåŠ¡å™¨â€<br>é¢„é˜²æªæ–½ï¼š</p>
<ul>
<li>ç¬¬ä¸‰æ–¹å…±äº«å­˜å‚¨ï¼šÂ éœ€è¦ä¿è¯åœ¨ä»»ä¸€æ—¶åˆ»ï¼Œåªæœ‰ä¸€ä¸ªNNèƒ½å¤Ÿå†™å…¥ã€‚</li>
<li>DataNodeï¼šÂ éœ€è¦ä¿è¯åªæœ‰ä¸€ä¸ªNNå‘å‡ºä¸ç®¡ç†æ•°æ®å‰¯æœ¬æœ‰å…³çš„åˆ é™¤å‘½ä»¤ã€‚</li>
<li>å®¢æˆ·ç«¯ï¼šÂ éœ€è¦ä¿è¯åŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªNNèƒ½å¤Ÿå¯¹å®¢æˆ·ç«¯è¯·æ±‚å‘å‡ºæ­£ç¡®å“åº”ã€‚</li>
</ul>
<p>è¿˜æ˜¯å­˜åœ¨ç¼ºç‚¹ï¼š</p>
<ul>
<li>ç¬¬ä¸‰æ–¹å­˜å‚¨ä»ç„¶å­˜åœ¨å•ç‚¹å¤±æ•ˆå¯èƒ½</li>
<li>éœ€è¦åœ¨å¤šå¤„è¿›è¡Œéš”ç¦»æªæ–½ä»¥é˜²æ­¢è„‘è£‚ç°è±¡å‡ºç°</li>
</ul>
<p>Clouderaåœ¨å…¶Hadoopå‘è¡Œç‰ˆä¸­æä¾›äº†åŸºäºQJMï¼ˆQuorum Journal Managerï¼‰çš„HAæ–¹æ¡ˆï¼š<br>![[file-20251104141839945.jpg | 300]]</p>
<p>åˆ©ç”¨Paxosåè®®åœ¨å¤šå°å¤‡ä»½æœºä¹‹é—´é€‰ä¸¾â€œä¸»æ§æœåŠ¡å™¨â€çš„ç»å…¸åº”ç”¨ï¼šQJMåœ¨2FÂ +1ä¸ªJournalNodeä¸­å­˜å‚¨NNçš„editlogï¼Œæ¯æ¬¡å†™å…¥æ“ä½œå¦‚æœæœ‰FÂ å°æœåŠ¡å™¨è¿”å›æˆåŠŸå³å¯è®¤ä¸ºæˆåŠŸå†™å…¥ï¼Œé€šè¿‡Paxosåè®®ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼ŒQJMæœ€å¤šå¯ä»¥å®¹å¿FÂ ä¸ªJournalNodeåŒæ—¶å‘ç”Ÿæ•…éšœè€Œç³»ç»Ÿä»ç„¶å¯ä»¥æ­£å¸¸è¿è¡Œã€‚</p>
<p>æ­¤æ–¹æ¡ˆçš„ä¼˜åŠ¿ï¼š</p>
<ul>
<li>å½»åº•è§£å†³äº†å•ç‚¹å¤±æ•ˆé—®é¢˜ï¼Œä¸”å¯å®¹å¿æœ€å¤§æ•…éšœJournalNodeä¸ªæ•°å¯é€šè¿‡é…ç½®è¿›è¡Œç®¡ç†ã€‚</li>
<li>æ— é¡»é…ç½®é¢å¤–çš„ç¬¬ä¸‰æ–¹å­˜å‚¨è®¾å¤‡ï¼Œè¿™å¯¹äºç›®å‰æµè¡Œçš„é‡‡ç”¨æ™®é€šå•†ç”¨æœåŠ¡å™¨æ„å»ºå¤§è§„æ¨¡é›†ç¾¤çš„æ¨¡å¼æ¥è¯´ï¼Œå‡å°‘äº†æ•´ä¸ªç³»ç»Ÿçš„å¤æ‚åº¦å’Œç»´æŠ¤æˆæœ¬ã€‚</li>
<li>æ— é¡»é˜²è„‘è£‚è€Œå•ç‹¬åœ¨å¤šå¤„é‡‡ç”¨éš”ç¦»æªæ–½ï¼Œå› ä¸ºQJMæœ¬èº«å†…ç½®äº†è¯¥åŠŸèƒ½</li>
</ul>
<h3 id="NameNodeè”ç›Ÿ"><a href="#NameNodeè”ç›Ÿ" class="headerlink" title="NameNodeè”ç›Ÿ"></a>NameNodeè”ç›Ÿ</h3><p>Hadoop 1.xÂ ä¸­çš„HDFSç”±äºé‡‡å–å•ä¸€NNçš„æ¶æ„ï¼Œä¼šå¯¼è‡´ç³»ç»Ÿå…·æœ‰å¦‚ä¸‹ç¼ºé™·ï¼š</p>
<ul>
<li>å‘½åç©ºé—´å¯æ‰©å±•æ€§å·®ï¼šæœºå™¨ç‰©ç†å†…å­˜çš„å¤§å°é™åˆ¶äº†æ•´ä¸ªHDFSèƒ½å¤Ÿå®¹çº³æ–‡ä»¶çš„æœ€å¤§ä¸ªæ•°</li>
<li>æ€§èƒ½å¯æ‰©å±•æ€§å·®ï¼šå•ä¸€NNå¯¼è‡´æ‰€æœ‰è¯·æ±‚éƒ½ç”±ä¸€å°æœåŠ¡å™¨å“åº”ï¼Œå®¹æ˜“è¾¾åˆ°æœºå™¨ååæé™ï¼Œé€ æˆç³»ç»Ÿæ•´ä½“æ€§èƒ½çš„æå‡æ— æ³•åšåˆ°æ°´å¹³æ‰©å±•</li>
<li>éš”ç¦»æ€§å·®ï¼šå•ä¸€NNçš„æ¶æ„æ— æ³•åœ¨ç§Ÿæˆ·ä¹‹é—´è¿›è¡Œéš”ç¦»ï¼Œä¼šé€ æˆä¸å¯é¿å…çš„ç›¸äº’å½±å“</li>
</ul>
<p>ä»Hadoop 2.0å¼€å§‹ï¼ŒHDFSé€šè¿‡NameNodeè”ç›Ÿçš„æ–¹å¼æ¥è§£å†³ä¸Šè¿°é—®é¢˜</p>
<p>æ ¸å¿ƒæ€æƒ³ï¼šå°†ä¸€ä¸ªå¤§çš„å‘½åç©ºé—´åˆ‡å‰²æˆè‹¥å¹²å­å‘½åç©ºé—´ï¼Œæ¯ä¸ªå­å‘½åç©ºé—´ç”±å•ç‹¬çš„NNæ¥è´Ÿè´£ç®¡ç†ï¼ŒNNä¹‹é—´ç‹¬ç«‹ï¼Œç›¸äº’ä¹‹é—´æ— é¡»åšä»»ä½•åè°ƒå·¥ä½œã€‚æ‰€æœ‰çš„DataNodeè¢«å¤šä¸ªNNå…±äº«ï¼Œä»ç„¶å……å½“å®é™…æ•°æ®å—çš„å­˜å‚¨åœºæ‰€ã€‚è€Œå­å‘½åç©ºé—´å’ŒDataNodeä¹‹é—´åˆ™ç”±æ•°æ®å—ç®¡ç†Â å±‚ä½œä¸ºä¸­ä»‹å»ºç«‹æ˜ å°„å…³ç³»ï¼Œæ•°æ®å—ç®¡ç†å±‚ç”±è‹¥å¹²æ•°æ®å—æ± ï¼ˆPoolï¼‰æ„æˆï¼Œæ¯ä¸ªæ•°æ®å—å”¯ä¸€å±äºæŸä¸ªå›ºå®šçš„æ•°æ®å—æ± ï¼Œè€Œä¸€ä¸ªå­å‘½åç©ºé—´å¯ä»¥å¯¹åº”å¤šä¸ªæ•°æ®å—æ± ã€‚</p>
<p>![[file-20251104143934958.jpg | 350]]</p>
<h2 id="HayStackå­˜å‚¨ç³»ç»Ÿ"><a href="#HayStackå­˜å‚¨ç³»ç»Ÿ" class="headerlink" title="HayStackå­˜å‚¨ç³»ç»Ÿ"></a>HayStackå­˜å‚¨ç³»ç»Ÿ</h2><p>HayStackæ˜¯Facebookå…¬å¸è®¾è®¡å¼€å‘çš„ä¸€ç§â€œå¯¹è±¡å­˜å‚¨ç³»ç»Ÿâ€</p>
<p>â€œå¯¹è±¡â€ï¼ˆBlobæ•°æ®ï¼‰å¾€å¾€æ˜¯æŒ‡æ»¡è¶³ä¸€å®šæ€§è´¨çš„åª’ä½“ç±»å‹ï¼Œç±»ä¼¼äºå›¾ç‰‡æ•°æ®çš„å­˜å‚¨æœ‰å…¶è‡ªèº«ç‰¹ç‚¹ï¼Œå…¸å‹çš„ç‰¹å¾æ˜¯ï¼šä¸€æ¬¡å†™å…¥ï¼Œå¤šæ¬¡è¯»å–ï¼Œä»ä¸æ›´æ”¹ï¼Œå¾ˆå°‘åˆ é™¤ã€‚</p>
<p>ä¸ºäº†å‡å°‘ç³»ç»Ÿè¯»å–å‹åŠ›ï¼Œå¯¹äºæµ·é‡çš„é™æ€æ•°æ®è¯·æ±‚ï¼Œä¸€èˆ¬ä¼šè€ƒè™‘ä½¿ç”¨CDNæ¥ç¼“å­˜çƒ­é—¨è¯·æ±‚ï¼Œè¿™æ ·å¤§é‡è¯·æ±‚ç”±CDNç³»ç»Ÿå°±å¯ä»¥æ»¡è¶³ã€‚HayStackå­˜å‚¨ç³»ç»Ÿçš„åˆè¡·æ˜¯ä½œä¸ºCDNç³»ç»Ÿçš„è¡¥å……ï¼Œå³çƒ­é—¨è¯·æ±‚ç”±CDNç³»ç»Ÿè´Ÿè´£ï¼Œé•¿å°¾çš„å›¾ç‰‡æ•°æ®è¯·æ±‚ç”±HayStackç³»ç»Ÿè´Ÿè´£ã€‚</p>
<p>HayStackåœ¨è®¾è®¡æ—¶ï¼Œä»ä¸¤ä¸ªæ–¹é¢æ¥è€ƒè™‘å‡å°‘â€œå…ƒæ•°æ®â€çš„æ€»ä½“æ•°é‡ï¼šä¸€æ–¹é¢æ˜¯ç”±å¤šä¸ªå›¾ç‰‡æ•°æ®æ‹¼æ¥æˆä¸€ä¸ªæ•°æ®æ–‡ä»¶ï¼Œè¿™æ ·å°±å¯ä»¥å‡å°‘ç”¨äºç®¡ç†æ•°æ®çš„æ•°é‡ï¼›å¦ä¸€æ–¹é¢ï¼Œç”±äºä¸€ä¸ªå›¾ç‰‡çš„â€œå…ƒæ•°æ®â€åŒ…å«å¤šä¸ªå±æ€§ä¿¡æ¯ï¼Œæ•…HayStackè€ƒè™‘å°†æ–‡ä»¶ç³»ç»Ÿä¸­çš„â€œå…ƒæ•°æ®â€å±æ€§å‡å°‘ï¼Œåªä¿ç•™å¿…éœ€çš„å±æ€§ã€‚</p>
<h3 id="HayStackæ•´ä½“æ¶æ„"><a href="#HayStackæ•´ä½“æ¶æ„" class="headerlink" title="HayStackæ•´ä½“æ¶æ„"></a>HayStackæ•´ä½“æ¶æ„</h3><ul>
<li>ç‰©ç†å·ï¼šå­˜å‚¨å¤šä¸ªå›¾ç‰‡æ•°æ®å¯¹åº”çš„æŸä¸ªæ–‡ä»¶ï¼Œä¸€èˆ¬ä¸€ä¸ªâ€œç‰©ç†å·â€æ–‡ä»¶å¤§å°ä¸º100GB</li>
<li>é€»è¾‘å·ï¼šä¸åŒæœºå™¨ä¸Šçš„è‹¥å¹²â€œç‰©ç†å·â€å…±åŒæ„æˆä¸€ä¸ªâ€œé€»è¾‘å·â€</li>
</ul>
<p>![[file-20251104145009455.jpg | 400]]</p>
<p>HayStackç”±3ä¸ªéƒ¨åˆ†æ„æˆï¼šHayStackç›®å½•æœåŠ¡ã€HayStackç¼“å­˜ç³»ç»Ÿå’ŒHayStackå­˜å‚¨ç³»ç»Ÿã€‚<br>![[file-20251104145131701.jpg | 400]]</p>
<h3 id="ç›®å½•æœåŠ¡"><a href="#ç›®å½•æœåŠ¡" class="headerlink" title="ç›®å½•æœåŠ¡"></a>ç›®å½•æœåŠ¡</h3><p>é‡‡ç”¨æ•°æ®åº“å®ç°çš„ï¼Œæä¾›å¤šç§åŠŸèƒ½ï¼š</p>
<ul>
<li>â€œç›®å½•æœåŠ¡â€ä¿å­˜äº†ä»â€œé€»è¾‘å·â€åˆ°â€œç‰©ç†å·â€çš„æ˜ å°„å…³ç³»è¡¨ï¼Œè¿™æ ·åœ¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡å’Œè¯»å–å›¾ç‰‡æ—¶å¯ä»¥æ‰¾åˆ°æ­£ç¡®çš„æ–‡ä»¶ã€‚</li>
<li>æä¾›äº†HayStackå­˜å‚¨ç³»ç»Ÿçš„è´Ÿè½½å‡è¡¡åŠŸèƒ½ï¼Œä¿è¯å›¾ç‰‡å†™å…¥å’Œè¯»å–åœ¨ä¸åŒæœºå™¨ä¹‹Â é—´è´Ÿè½½æ˜¯ç›¸å½“çš„ï¼Œä¸è‡³äºå‡ºç°æœºå™¨ä¹‹é—´å¿™é—²ä¸å‡çš„çŠ¶å†µã€‚</li>
<li>å†³å®šæ˜¯å°†ç”¨æˆ·è¯·æ±‚ç›´æ¥æäº¤ç»™ç¼“å­˜ç³»ç»Ÿè¿˜æ˜¯æäº¤ç»™CDNï¼Œä»¥æ­¤æ¥å¯¹è¿™ä¸¤è€…æ¥æ”¶åˆ°çš„è¯·æ±‚é‡è¿›è¡Œå‡è¡¡ã€‚</li>
</ul>
<h3 id="HayStackç¼“å­˜"><a href="#HayStackç¼“å­˜" class="headerlink" title="HayStackç¼“å­˜"></a>HayStackç¼“å­˜</h3><p>HayStackç¼“å­˜ä»åŠŸèƒ½ä¸Šè®²æ˜¯ä¸CDNä¸€è‡´çš„ï¼Œç¼“å­˜æ¥æ”¶åˆ°çš„è®¿é—®è¯·æ±‚å¯èƒ½æ¥è‡ªCDNï¼Œä¹Ÿå¯èƒ½ç›´æ¥æ¥è‡ªç”¨æˆ·æµè§ˆå™¨è¯·æ±‚ã€‚åœ¨å…¶å†…éƒ¨å®ç°ï¼ŒHayStacké‡‡ç”¨å“ˆå¸Œè¡¨çš„æ–¹å¼å­˜å‚¨å›¾ç‰‡IDå’Œå…¶å¯¹åº”çš„æ•°æ®ï¼Œå¦‚æœåœ¨ç¼“å­˜å†…æ²¡æœ‰æ‰¾åˆ°å›¾ç‰‡ï¼Œåˆ™ä»HayStackå­˜å‚¨ç³»ç»Ÿä¸­è¯»å–å›¾ç‰‡ï¼Œå¹¶åŠ å…¥ç¼“å­˜ä¸­ï¼Œä¹‹åå°†å›¾ç‰‡å†…å®¹ä¼ ç»™CDNæˆ–è€…ç›´æ¥ä¼ é€’ç»™ç”¨æˆ·ã€‚</p>
<h3 id="HayStackå­˜å‚¨ç³»ç»Ÿçš„å®ç°"><a href="#HayStackå­˜å‚¨ç³»ç»Ÿçš„å®ç°" class="headerlink" title="HayStackå­˜å‚¨ç³»ç»Ÿçš„å®ç°"></a>HayStackå­˜å‚¨ç³»ç»Ÿçš„å®ç°</h3><p>![[file-20251104145833765.jpg]]</p>
<p>å¯¹äºæ¯ä¸ªâ€œç‰©ç†å·â€æ–‡ä»¶ï¼Œç”±ä¸€ä¸ªâ€œè¶…çº§å—â€å’Œå›¾ç‰‡æ•°æ®ç»„æˆã€‚æ¯ä¸ªå›¾ç‰‡çš„ä¿¡æ¯è¢«ç§°ä¸ºä¸€ä¸ªNeedleï¼Œå…·ä½“åŒ…å«å›¾ç‰‡å±æ€§ä¿¡æ¯ï¼Œå…¶ä¸­æ¯”è¾ƒé‡è¦çš„å±æ€§ä¿¡æ¯åŒ…æ‹¬å›¾ç‰‡å”¯ä¸€æ ‡è®°Keyå’Œè¾…åŠ©Keyã€åˆ é™¤æ ‡è®°ä½ã€å›¾ç‰‡å¤§å°ä»¥åŠå›¾ç‰‡æ•°æ®ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜åŒ…å«ä¸€äº›ç®¡ç†å±æ€§ä»¥åŠæ•°æ®æ ¡éªŒå±æ€§ã€‚</p>
<p>å­˜å–è¿‡ç¨‹ï¼š</p>
<ul>
<li><strong>è¯»å–å›¾ç‰‡</strong>ï¼šHayStackç¼“å­˜ç³»ç»Ÿä¼šå‘å­˜å‚¨ç³»ç»Ÿæä¾›å›¾ç‰‡çš„â€œé€»è¾‘å·â€IDç¼–å·ä»¥åŠå›¾ç‰‡IDï¼ˆç”±Keyå’Œè¾…åŠ©Keyæ„æˆï¼‰ï¼Œå½“å­˜å‚¨ç³»ç»Ÿæ¥æ”¶åˆ°è¯·æ±‚åï¼Œä¼šåœ¨å†…å­˜ä¸­çš„â€œç‰©ç†å·â€æ˜ å°„è¡¨ä¸­æŸ¥æ‰¾å›¾ç‰‡IDï¼Œå¦‚æœæ‰¾åˆ°ï¼Œåˆ™æ ¹æ®æ˜ å°„è¡¨ä¿å­˜çš„ä¿¡æ¯å¯ä»¥è·å–å…¶åœ¨å¯¹åº”â€œç‰©ç†å·â€ä¸­çš„æ–‡ä»¶èµ·å§‹ä½ç½®Â å’Œæ–‡ä»¶å¤§å°</li>
<li><strong>ä¸Šä¼ å›¾ç‰‡</strong>ï¼šHayStackå­˜å‚¨ç³»ç»Ÿæ ¹æ®WebæœåŠ¡å™¨ä¼ è¿‡æ¥çš„å›¾ç‰‡â€œé€»è¾‘å·â€IDç¼–å·ä»¥åŠå›¾ç‰‡IDå’Œå›¾ç‰‡æ•°æ®ï¼Œå°†è¿™ä¸ªå›¾ç‰‡ä¿¡æ¯è¿½åŠ åˆ°å¯¹åº”çš„â€œç‰©ç†å·â€æ–‡ä»¶æœ«å°¾ï¼ŒåŒæ—¶åœ¨å†…å­˜çš„æ˜ å°„è¡¨ä¸­å¢åŠ ç›¸åº”çš„æ˜ å°„ä¿¡æ¯ã€‚</li>
<li><strong>ä¸Šä¼ æ›´æ”¹å›¾ç‰‡</strong>ï¼šå½“ä½œä¸€ä¸ªæ–°çš„å›¾ç‰‡è¿½åŠ åˆ°â€œç‰©ç†å·â€çš„æ–‡ä»¶æœ«å°¾ï¼Œä¸è¿‡è¿™ä¸ªå›¾ç‰‡çš„IDæ˜¯ä¸å˜çš„ã€‚</li>
<li><strong>åˆ é™¤æŸå¼ å›¾ç‰‡</strong>ï¼šåªè¦åœ¨å†…å­˜æ˜ å°„è¡¨å’Œâ€œç‰©ç†å·â€ä¸­åœ¨ç›¸åº”çš„â€œåˆ é™¤æ ‡è®°ä½ç½®â€ä¸Šåšå‡ºæ ‡è®°å³å¯ã€‚ç³»ç»Ÿä¼šåœ¨é€‚å½“çš„æ—¶æœºå›æ”¶è¿™äº›è¢«åˆ é™¤çš„å›¾ç‰‡æ•°æ®ç©ºé—´ã€‚</li>
</ul>
<h2 id="æ–‡ä»¶å­˜å‚¨å¸ƒå±€"><a href="#æ–‡ä»¶å­˜å‚¨å¸ƒå±€" class="headerlink" title="æ–‡ä»¶å­˜å‚¨å¸ƒå±€"></a>æ–‡ä»¶å­˜å‚¨å¸ƒå±€</h2><p>åº•å±‚æ–‡ä»¶å­˜å‚¨å¸ƒå±€å¯¹äºå°†æ•°æ®åŠ è½½å…¥æ•°æ®ä»“åº“çš„æ•ˆç‡ã€å“åº”ç”¨æˆ·æŸ¥è¯¢çš„é€Ÿåº¦ï¼Œä»¥åŠå¯¹äºåº•å±‚å­˜å‚¨æ¶æ„ç£ç›˜ç©ºé—´åˆ©ç”¨ç‡çš„æå‡éƒ½æœ‰ç›´æ¥ä¸”é‡è¦çš„å½±å“ã€‚</p>
<p>å¸¸è§çš„æ–‡ä»¶å­˜å‚¨å¸ƒå±€æœ‰è¡Œå¼å­˜å‚¨ã€åˆ—å¼å­˜å‚¨åŠæ··åˆå¼å­˜å‚¨3ç§ç±»åˆ«ï¼Œç›®å‰çš„å¤§æ•°æ®åˆ†æç³»ç»Ÿä¸­ï¼Œåˆ—å¼å’Œæ··åˆå¼å­˜å‚¨æ–¹æ¡ˆå› ä¸ºå…¶ç‰¹æ®Šä¼˜ç‚¹è¢«å¹¿æ³›ä½¿ç”¨ï¼Œå…¶ä¸­RCFileã€ORCFileåŠParquetç­‰ä»£è¡¨æ€§çš„æ–¹æ¡ˆè¢«å¹¿æ³›é›†æˆåˆ°å„ç§å¤§æ•°æ®åˆ†æç³»ç»Ÿçš„åº•å±‚æ¶æ„ä¸­ã€‚</p>
<h3 id="è¡Œå¼å­˜å‚¨"><a href="#è¡Œå¼å­˜å‚¨" class="headerlink" title="è¡Œå¼å­˜å‚¨"></a>è¡Œå¼å­˜å‚¨</h3><p>è¡Œå¼å­˜å‚¨å¹¿æ³›ä½¿ç”¨åœ¨ä¸»æµå…³ç³»å‹æ•°æ®åº“åŠHDFSæ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œæ¯æ¡è®°å½•çš„å„ä¸ªå­—æ®µè¿ç»­å­˜å‚¨åœ¨ä¸€èµ·ï¼Œè€Œå¯¹äºæ–‡ä»¶ä¸­çš„å„ä¸ªè®°å½•ä¹Ÿæ˜¯è¿ç»­å­˜å‚¨åœ¨æ•°æ®å—ä¸­çš„ã€‚<br>![[file-20251104151014798.jpg | 500]]<br>æ˜æ˜¾ç¼ºé™·ï¼š</p>
<ul>
<li>å¯¹äºå¾ˆå¤šSQLæŸ¥è¯¢æ¥è¯´ï¼Œå…¶æ‰€éœ€è¯»å–çš„è®°å½•å¯èƒ½åªæ¶‰åŠæ•´ä¸ªè®°å½•æ‰€æœ‰å­—æ®µä¸­çš„éƒ¨åˆ†ã€‚è¦å°†æ•´ä¸ªè®°å½•å…¨éƒ¨è¯»å‡ºåæ‰èƒ½è¯»å–åˆ°æ‰€éœ€çš„å­—æ®µï¼›</li>
<li>å¯¹äºè®°å½•çš„æ‰€æœ‰å­—æ®µåªèƒ½ç»Ÿä¸€é‡‡ç”¨åŒä¸€ç§å‹ç¼©ç®—æ³•ï¼Œè¿™æ ·çš„å‹ç¼©æ¨¡å¼å¯¼è‡´æ•°æ®å‹ç¼©ç‡ä¸é«˜ï¼Œæ‰€ä»¥ç£ç›˜åˆ©ç”¨ç‡ä¸æ˜¯å¾ˆé«˜ã€‚<br>ä¼˜åŠ¿ï¼š</li>
<li>æŒ‰è¡Œéå†æˆ–è€…æŸ¥æ‰¾æ•°æ®ï¼Œæ­¤æ—¶è¾ƒé€‚åˆä½¿ç”¨æ­¤ç§å­˜å‚¨å¸ƒå±€ï¼Œå› ä¸ºè¡Œæ•°æ®è¿ç»­å­˜å‚¨ï¼Œæ‰€ä»¥èƒ½å¤Ÿä¸€æ¬¡æ€§åœ°å°†æ‰€æœ‰å­—æ®µçš„å†…å®¹è¯»å‡º</li>
</ul>
<h3 id="åˆ—å¼å­˜å‚¨"><a href="#åˆ—å¼å­˜å‚¨" class="headerlink" title="åˆ—å¼å­˜å‚¨"></a>åˆ—å¼å­˜å‚¨</h3><p>åˆ—å¼å­˜å‚¨å¸ƒå±€åœ¨å®é™…å­˜å‚¨æ•°æ®æ—¶ï¼ŒæŒ‰ç…§åˆ—å¯¹æ‰€æœ‰è®°å½•è¿›è¡Œå‚ç›´åˆ’åˆ†ï¼Œå°†åŒä¸€åˆ—çš„å†…å®¹è¿ç»­å­˜æ”¾åœ¨ä¸€èµ·ã€‚åœ¨å„ç§åº”ç”¨åœºæ™¯ä¸­ï¼Œè®°å½•æ•°æ®çš„æ ¼å¼æœ‰ç®€å•çš„å’Œå¤æ‚çš„ä¸¤ç§ã€‚</p>
<ul>
<li><strong>åˆ—æ—æ–¹å¼ï¼š</strong></li>
</ul>
<p>å…¸å‹çš„åˆ—å¼å­˜å‚¨å¸ƒå±€æ˜¯æŒ‰ç…§è®°å½•çš„ä¸åŒåˆ—ï¼Œå¯¹æ•°æ®è¡¨è¿›è¡Œå‚ç›´åˆ’åˆ†ï¼ŒåŒä¸€åˆ—çš„æ‰€æœ‰æ•°æ®è¿ç»­å­˜å‚¨åœ¨ä¸€èµ·ã€‚ä¸€æ–¹é¢å¯¹äºä¸Šå±‚çš„å¤§æ•°æ®åˆ†æç³»ç»Ÿæ¥è¯´ï¼Œå¦‚æœSQLæŸ¥è¯¢åªæ¶‰åŠè®°å½•çš„ä¸ªåˆ«åˆ—ï¼Œåˆ™åªéœ€è¯»å–å¯¹åº”çš„åˆ—å†…å®¹å³å¯ï¼›å¦ä¸€æ–¹é¢å¯ä»¥é’ˆå¯¹æ¯åˆ—æ•°æ®çš„ç±»å‹é‡‡å–å…·æœ‰é’ˆå¯¹æ€§çš„æ•°æ®å‹ç¼©ç®—æ³•ã€‚</p>
<p>ç¼ºé™·ï¼šç»å…¸çš„MRä»»åŠ¡å¾€å¾€éœ€è¦éå†æ¯æ¡æ•°æ®è®°å½•ï¼Œå¹¶å¤„ç†è®°å½•çš„å„ä¸ªå­—æ®µæˆ–è€…å¤šä¸ªå­—æ®µï¼Œä¸ºäº†æ‹¼åˆå‡ºå®Œæ•´è®°å½•å†…å®¹ï¼Œå¯èƒ½éœ€è¦å¤§é‡çš„ç½‘ç»œä¼ è¾“æ‰è¡Œï¼Œå¾ˆæ˜æ˜¾è¿™æ ·æ•ˆç‡ä¼šæ¯”è¾ƒä½ä¸‹</p>
<p><strong>åˆ—æ—</strong>ï¼šå°†è®°å½•çš„åˆ—è¿›è¡Œåˆ†ç»„ï¼Œå°†ç»å¸¸ä¸€èµ·ä½¿ç”¨çš„åˆ—åˆ†ä¸ºä¸€ç»„ï¼Œè¿™æ ·å³ä½¿æ˜¯æŒ‰ç…§åˆ—å¼æ¥å­˜å‚¨æ•°æ®çš„ï¼Œä¹Ÿå¯ä»¥å°†ç»å¸¸è”åˆä½¿ç”¨çš„åˆ—æ•°æ®å­˜å‚¨åœ¨ä¸€ä¸ªæ•°æ®å—ä¸­ï¼Œé¿å…ä¸å¿…è¦çš„ç½‘ç»œä¼ è¾“æ¥è·å–å¤šåˆ—æ•°æ®ï¼Œå¯¹äºæŸäº›åœºæ™¯ä¼šè¾ƒå¤§æé«˜ç³»ç»Ÿæ€§èƒ½</p>
<p>![[file-20251104170158393.jpg | 300]]</p>
<p>BigTableå’ŒHBaseçš„åº•å±‚GFSæˆ–è€…HDFSå­˜å‚¨å¸ƒå±€å°±æ˜¯é‡‡ç”¨ä¸Šè¿°åˆ—æ—æ–¹å¼ã€‚</p>
<ul>
<li><strong>Dremelçš„åˆ—å­˜å‚¨æ–¹å¼</strong></li>
</ul>
<p>Googleå¼€å‘çš„é’ˆå¯¹æµ·é‡æ•°æ®è¿›è¡Œäº¤äº’å¼æŸ¥è¯¢ä¸æ•°æ®åˆ†æåº”ç”¨åœºæ™¯çš„å¤§æ•°æ®åˆ†æç³»ç»Ÿï¼Œåˆ©ç”¨Dremelï¼Œå¯ä»¥å¯¹å­˜å‚¨åœ¨æ•°ä»¥åƒè®¡GFSæˆ–è€…BigTableæœåŠ¡å™¨ä¸Šçš„æµ·é‡æ•°æ®è¿›è¡Œç§’çº§åˆ«çš„SQLæŸ¥è¯¢ï¼Œå…¶èƒ½å¤„ç†çš„æ•°æ®é‡ä¹‹å¤§ä»¥åŠå¤„ç†æ•ˆç‡ä¹‹é«˜ç»™äººç•™ä¸‹äº†æ·±åˆ»å°è±¡ï¼Œè€Œå…¶ä¸­å¾ˆå…³é”®çš„ä¸€ç‚¹å°±æ˜¯é’ˆå¯¹å¤æ‚åµŒå¥—æ•°æ®çš„åˆ—å¼å­˜å‚¨ã€‚</p>
<p>å¤æ‚åµŒå¥—å¼æ•°æ®ç±»å‹è¿›è¡Œå½¢å¼åŒ–å®šä¹‰ï¼š![[file-20251104170902491.jpg | 300]]<br>å…¶ä¸­çš„Ï„Â å¯ä»¥æ˜¯åŸå­å‹æˆ–è€…è®°å½•å‹ç»“æ„ï¼Œæ‰€è°“åŸå­å‹æ˜¯æŒ‡æ•´æ•°å‹ã€æµ®ç‚¹æ•°å‹æˆ–è€…å­—ç¬¦ä¸²å‹ç­‰åŸºç¡€ç±»å‹ã€‚å¦‚ä¸Šå®šä¹‰å¯è§ï¼Œæ¯ä¸ªè®°å½•å¯ä»¥ç”±è‹¥å¹²å­—æ®µï¼ˆFieldï¼‰æ„æˆï¼Œç¬¬iÂ ä¸ªå­—æ®µæœ‰å…¶åç§°AiÂ åŠå…¶å­—æ®µå†…å®¹ï¼Œå­—æ®µå†…å®¹å¯å¸¦æœ‰æè¿°ç¬¦<em>æˆ–è€…ï¼Ÿï¼Œæè¿°ç¬¦</em>ä»£è¡¨å¯é‡å¤ï¼ˆRepeatedï¼‰</p>
<ul>
<li><strong>æ··åˆå¼å­˜å‚¨æ–¹å¼</strong></li>
</ul>
<p>æ··åˆå¼å­˜å‚¨å¸ƒå±€èåˆäº†è¡Œå¼å’Œåˆ—å¼å­˜å‚¨å„è‡ªçš„ä¼˜ç‚¹ï¼Œé¦–å…ˆå…¶å°†è®°å½•è¡¨æŒ‰ç…§è¡Œè¿›è¡Œåˆ†ç»„ï¼Œè‹¥å¹²è¡Œåˆ’åˆ†ä¸ºä¸€ç»„ï¼Œè€Œå¯¹äºæ¯ç»„å†…çš„æ‰€æœ‰è®°å½•ï¼Œåœ¨å®é™…å­˜å‚¨æ—¶æŒ‰ç…§åˆ—å°†åŒä¸€åˆ—å†…å®¹è¿ç»­å­˜å‚¨åœ¨ä¸€èµ·ã€‚</p>
<p>å…¸å‹çš„æ··åˆå¼å­˜å‚¨æ–¹æ¡ˆåŒ…æ‹¬RCFileã€ORCFileå’ŒParquetã€‚å…¶ä¸­ï¼ŒRCFileå’ŒORCFileå·²ç»é›†æˆè¿›å…¥Hiveç³»ç»Ÿï¼Œè€ŒParquetåˆ™æ˜¯Twitteræ¨¡ä»¿Dremelçš„åˆ—å¼å­˜å‚¨å¼€å‘å¹¶å¼€æºå‡ºçš„æ–‡ä»¶å¸ƒå±€æ–¹æ¡ˆï¼Œå› å…¶æ•ˆç‡æé«˜è€Œå—åˆ°å¹¿æ³›å…³æ³¨ã€‚</p>
<ul>
<li>RCFile<br>é¦–å…ˆå°†è®°å½•è¡¨å†…çš„è®°å½•æŒ‰ç…§è¡Œåˆ’åˆ†ä¸ºè¡Œç»„ï¼ˆRow Groupï¼‰ï¼ŒHDFSæ¯ä¸ªæ•°æ®å—å¯ä»¥åŒ…å«å¤šä¸ªè¡Œç»„æ•°æ®ã€‚å¯¹äºæ¯ä¸ªè¡Œç»„ï¼Œå­˜å‚¨3ç±»ä¿¡æ¯ï¼šSyncæ˜¯è¡Œç»„åŒæ­¥æ ‡è¯†ï¼Œç”¨äºè¯†åˆ«æ˜¯å¦æ˜¯æ•°æ®å—ä¸­ä¸€ä¸ªæ–°çš„è¡Œç»„å¼€å§‹ï¼›å…ƒæ•°æ®ï¼ˆMetadata Headerï¼‰åˆ™è®°å½•äº†è¿™ä¸ªè¡Œç»„åŒ…å«å¤šå°‘è®°å½•ï¼Œæ¯åˆ—å ç”¨ç©ºé—´å¤§å°ç­‰æ•°æ®ï¼›å¦å¤–ä¸€ç±»æ˜¯å®é™…æ•°æ®ï¼Œåœ¨æ•°æ®å—ä¸­æŒ‰ç…§åˆ—å¼å­˜å‚¨ã€‚<br>![[file-20251104171757431.jpg | 450]]</li>
<li>ORCFile<br>ORCFileæ˜¯ä¸€ç§é’ˆå¯¹RCFileæå‡ºçš„ä¼˜åŒ–çš„æ–‡ä»¶å­˜å‚¨å¸ƒå±€æ–¹æ¡ˆ,åŒ…å«è‹¥å¹²æ•°æ®è¡Œç»„ï¼Œæ¯ä¸ªæ•°æ®è¡Œç»„è¢«ç§°ä¸ºæ•°æ®å¸¦ï¼ˆStripeï¼‰ï¼Œæ–‡ä»¶å°¾ï¼ˆFile Footerï¼‰è®°å½•æ–‡ä»¶ä¸­æ‰€æœ‰æ•°æ®å¸¦çš„å…ƒä¿¡æ¯ï¼Œæ¯”å¦‚æœ‰å¤šå°‘ä¸ªæ•°æ®å¸¦ï¼Œæ¯ä¸ªæ•°æ®å¸¦åŒ…å«çš„è®°å½•ä¸ªæ•°åŠæ¯åˆ—é‡‡ç”¨ä½•ç§Â æ•°æ®å‹ç¼©ç®—æ³•ç­‰ä¿¡æ¯ï¼ŒåŒæ—¶ä¹Ÿè®°å½•æ¯åˆ—çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œæ¯”å¦‚è¯¥åˆ—çš„æœ€å¤§å€¼ã€æœ€å°å€¼ç­‰ã€‚é™„å½•ï¼ˆPostscriptï¼‰ä¸­è®°è½½äº†å‹ç¼©ç®—æ³•çš„å‚æ•°ä¿¡æ¯ã€‚</li>
</ul>
<p>![[file-20251104171848103.jpg | 300]]</p>
<ul>
<li>Parquet<br>Parquetæ˜¯Twitterå‚ç…§Dremelçš„åˆ—å¼å­˜å‚¨æ–¹æ¡ˆå¼€å‘çš„é’ˆå¯¹Hadoopçš„æ··åˆå¼æ–‡ä»¶å¸ƒå±€æ–¹æ¡ˆï¼Œç›®å‰å·²æœ‰å¼€æºç‰ˆæœ¬ã€‚ä¸€ä¸ªHDFSæ–‡ä»¶ç”±è‹¥å¹²è¡Œç»„æ„æˆï¼Œæ¯ä¸ªè¡Œç»„çš„å„ä¸ªåˆ—å½¢æˆä¸€ä¸ªåˆ—æ•°æ®å—ï¼ˆColumn Chunkï¼‰ï¼Œè€Œæ¯ä¸ªåˆ—æ•°æ®å—åˆè¢«ç»†åˆ†ä¸ºè‹¥å¹²ä¸ªæ•°æ®é¡µï¼ˆPageï¼‰ï¼Œæ¯ä¸ªæ•°æ®é¡µå†…è¿ç»­å­˜æ”¾åˆ—æ•°æ®ï¼Œæ¯ä¸ªåˆ—æ•°æ®åˆ™é‡‡å–ç±»ä¼¼Dremelçš„é‡å¤å±‚ã€å®šä¹‰å±‚å’Œåˆ—æ•°æ®é¡¹æ¥å­˜å‚¨ç›¸å…³ä¿¡æ¯ã€‚è€Œåœ¨æ–‡ä»¶å°¾Â ï¼ˆFooterï¼‰åˆ™å­˜å‚¨äº†å…³äºè¡Œç»„ã€åˆ—æ•°æ®å—åŠæ•°æ®é¡µçš„å…ƒæ•°æ®ã€‚</li>
</ul>
<p>![[file-20251104172030860.jpg | 450]]</p>
<h2 id="çº åˆ ç "><a href="#çº åˆ ç " class="headerlink" title="çº åˆ ç "></a>çº åˆ ç </h2><p>å¯¹äºçƒ­ç‚¹æ•°æ®ï¼Œåœ¨å¤§è§„æ¨¡å­˜å‚¨ç³»ç»Ÿä¸­ä»ç„¶ä¿ç•™3ä¸ªå¤‡ä»½ï¼Œè€Œå¯¹äºå†·æ•°æ®ï¼Œåˆ™åªä¿ç•™1ä»½æ•°æ®ï¼Œé€šè¿‡çº åˆ ç æ¥ä¿è¯æ•°æ®çš„å¯é æ€§ã€‚ä¹‹æ‰€ä»¥ä¸å¯¹æ‰€æœ‰æ•°æ®éƒ½é‡‡ç”¨çº åˆ ç çš„æ–¹å¼ï¼Œæ˜¯å› ä¸ºå¤‡ä»½æ•°æ®é™¤äº†èƒ½å¤Ÿå¢åŠ æ•°æ®çš„å¯ç”¨æ€§å¤–ï¼Œè¿˜å¯ä»¥æå‡æ•°æ®çš„å¹¶å‘è¯»å–æ•ˆç‡ï¼Œæ‰€ä»¥å¯¹äºçƒ­ç‚¹æ•°æ®ç”¨å¤šå¤‡ä»½çš„æ–¹å¼æ¯”è¾ƒåˆé€‚ã€‚</p>
<p><strong>çº åˆ ç </strong>ï¼šé€šè¿‡å¯¹åŸå§‹æ•°æ®è¿›è¡Œæ ¡éªŒå¹¶ä¿ç•™æ ¡éªŒæ•°æ®ï¼Œä»¥å¢åŠ å†—ä½™çš„æ–¹å¼æ¥ä¿è¯æ•°æ®çš„å¯æ¢å¤æ€§ã€‚æå¤§è·ç¦»å¯åˆ†ç ä¸€ç§éå¸¸å¸¸ç”¨çš„çº åˆ ç ï¼Œå…¶å°†æ•°æ®æ–‡ä»¶åˆ‡å‰²ä¸ºç­‰é•¿çš„nä¸ªæ•°æ®å—ï¼Œå¹¶æ ¹æ®è¿™nä¸ªæ•°æ®ç”Ÿæˆmä¸ªå†—ä½™çš„æ ¡éªŒä¿¡æ¯ï¼Œè¿™æ ·ä½¿å¾—n+må—æ•°æ®ä¸­å³ä½¿ä»»æ„må—æ•°æ®æŸå¤±ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å‰©ä¸‹çš„nå—æ•°æ®å¯¹må—æŸå¤±çš„æ•°æ®è¿›è¡Œé‡æ„ï¼Œä»¥æ­¤æ¥å®Œæˆæ•°æ®å®¹é”™åŠŸèƒ½ã€‚</p>
<p>ä»‹ç»ä¸¤ç§ï¼š</p>
<ul>
<li>Reed-Solomonï¼šæœ€å…¸å‹çš„MDSç¼–ç ï¼Œç›®å‰åœ¨Googleçš„Colossusä»¥åŠFacebookçš„HDFS-RAIDéƒ½å·²ç»å¼•å…¥è¿™ç§ç¼–ç </li>
<li>å±€éƒ¨å¯ä¿®å¤ç¼–ç ï¼šå¹¶éMDSç¼–ç ï¼Œè¿™æ˜¯é’ˆå¯¹RSç¼–ç åœ¨åˆ†å¸ƒå¼å­˜å‚¨ä¸­é¢ä¸´çš„é—®é¢˜è€Œåœ¨æœ€è¿‘æå‡ºçš„ä¸€ç§ç¼–ç ï¼Œå¾®è½¯çš„AWSäº‘å­˜å‚¨ç³»ç»ŸåŠFacebookçš„Xorbasç³»ç»Ÿéƒ½é‡‡ç”¨äº†è¿™ç§ç¼–ç ã€‚</li>
</ul>
<h3 id="Reed-Solomonç¼–ç "><a href="#Reed-Solomonç¼–ç " class="headerlink" title="Reed-Solomonç¼–ç "></a>Reed-Solomonç¼–ç </h3><p>ç›®å‰Googleåœ¨Colossusä»¥åŠFacebookåœ¨HDFS-RAIDä¸­éƒ½å·²ç»å®ç°å¹¶éƒ¨ç½²äº†RSç¼–ç æ¥å‡å°‘å­˜å‚¨æˆæœ¬ã€‚</p>
<p>n&#x3D;8ï¼Œm&#x3D;2é…ç½®ä¸‹çš„RSç¼–ç ç¤ºæ„å›¾ï¼Œå¯¹äº8å—åŸå§‹æ•°æ®ï¼Œä¸¤ä¸ªå‡½æ•°F1 å’ŒF2ä»¥è¿™äº›æ•°æ®å—æ•°æ®ä½œä¸ºè¾“å…¥ï¼Œç”Ÿæˆå¯¹åº”çš„æ ¡éªŒæ•°æ®å—C1å’ŒC2 ï¼Œè¿™ç§é…ç½®å¯ä»¥å®¹å¿10å—æ•°æ®ä¸­ä»»æ„æŸå¤±2å—æ•°æ®è€Œä¸ä¼šé€ æˆæ•°æ®ä¸¢å¤±ã€‚<br>![[file-20251104192952726.jpg | 300]]<br>å·²çŸ¥n ä¸ªæ•°æ®å­—d1ï¼Œd2ï¼Œâ€¦ï¼Œdnåˆ†åˆ«å­˜å‚¨åœ¨ä¸åŒçš„å­˜å‚¨è®¾å¤‡ä¸Šï¼Œéœ€è¦æ ¹æ®è¿™äº›æ•°æ®å­—è®¡ç®—mä¸ªæ ¡éªŒå­—c1ï¼Œc2ï¼Œâ€¦ï¼Œcmï¼Œä½¿å¾—n+mä¸ªæ•°æ®å­—å¯ä»¥å®¹å¿æœ€å¤šmä¸ªæ•°æ®æŸå¤±ã€‚</p>
<p>ç¼–ç æ¶‰åŠ3ä¸ªé—®é¢˜ï¼š<br>1ï¼ä½¿ç”¨VandermondeçŸ©é˜µï¼ˆVandermonde Matrixï¼‰è®¡ç®—åŸå§‹æ•°æ®çš„æ ¡éªŒå­—ã€‚<br>2ï¼ä½¿ç”¨é«˜æ–¯æ¶ˆå…ƒæ³•ï¼ˆGaussian Eliminationï¼‰ä»æ•°æ®é”™è¯¯ä¸­æ¢å¤åŸå§‹æ•°æ®ã€‚<br>3ï¼åœ¨æœ‰é™åŸŸï¼ˆGalois Fieldsï¼‰ä¸Šè¿›è¡Œå¿«é€Ÿè®¡ç®—ã€‚</p>
<h3 id="LRCç¼–ç "><a href="#LRCç¼–ç " class="headerlink" title="LRCç¼–ç "></a>LRCç¼–ç </h3><p>RCç¼–ç çš„ç¼ºç‚¹ï¼š<br>å¦‚æœå°†ä¸€ä¸ªæ–‡ä»¶åˆ’åˆ†æˆ10ä¸ªæ•°æ®å—ï¼Œå³ä½¿åªæœ‰å…¶ä¸­ä¸€ä¸ªæ•°æ®å—æŸæ¯ï¼Œä¹Ÿéœ€è¦å…¶ä»–æ‰€æœ‰æ•°æ®å—æ¥å…±åŒæ¢å¤è¿™ä¸ªæŸæ¯çš„æ•°æ®å—ã€‚åœ¨åˆ†å¸ƒå¼ç½‘ç»œç¯å¢ƒä¸‹ï¼Œæ•°æ®å—å¾€å¾€å­˜å‚¨åœ¨ä¸åŒæœºå™¨èŠ‚ç‚¹ï¼Œè¿™æ„å‘³ç€å³ä½¿å•å°å­˜å‚¨æœºå™¨å‘ç”Ÿæ•…éšœï¼Œä¸ºäº†æ¢å¤å°‘é‡æ•°æ®å—ï¼Œéœ€è¦å¤§é‡çš„ç½‘ç»œä¼ è¾“å’Œç£ç›˜I&#x2F;Oæ‰èƒ½å¤Ÿå°†å…¶è¿›è¡Œæ¢å¤ã€‚</p>
<p>LRCçš„æå‡ºå°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸€éš¾é¢˜ï¼Œæ‰€ä»¥LRCé¢ä¸´çš„é—®é¢˜æ˜¯ï¼šèƒ½å¦åœ¨å¯é æ€§ä¸RSç¼–ç å¤§è‡´ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œå‡å°‘æ¢å¤æŸæ¯æ•°æ®æ‰€éœ€çš„æ•°æ®å—æ•°é‡ã€‚</p>
<p><strong>å—å±€éƒ¨æ€§</strong>ï¼šå¯¹äºæŸä¸ªçº åˆ ç æ¥è¯´ï¼Œè¦å¯¹ä¸€ä¸ªæ•°æ®å—ç¼–ç ï¼Œæœ€å¤šéœ€è¦å¤šå°‘å…¶ä»–çš„æ•°æ®å—ã€‚<br><strong>æœ€å°ç è·</strong>ï¼šå¯¹äºåˆ‡å‰²æˆnå—çš„æ–‡ä»¶ï¼Œæœ€å°‘æŸæ¯å¤šå°‘å—æ•°æ®æ–‡ä»¶å°±ä¸å¯æ¢å¤äº†ã€‚</p>
<p>ç”¨XorBasä¸­å®ç°çš„(10, 6, 5)LRCç¼–ç æ¥å¯¹LRCè¿›è¡Œå…·ä½“è¯´æ˜ï¼Œè¿™é‡Œ(10, 6, 5)é…ç½®çš„å«ä¹‰æ˜¯ï¼šé€šè¿‡LRCç¼–ç ï¼Œå¯¹äº10å—åŸå§‹æ•°æ®ï¼Œç”Ÿæˆ6å—æ ¡éªŒæ•°æ®ï¼Œå…¶ç¼–ç çš„æœ€å°ç è·æ˜¯5ã€‚</p>
<p>LRCæœ¬è´¨ä¸Šæ˜¯åœ¨RSç¼–ç åŸºç¡€ä¸Šé€šè¿‡å¢åŠ æ•°æ®å†—ä½™æ¥æ¢å–æ ¡éªŒæ•°æ®çš„å±€éƒ¨æ€§ã€‚</p>
<h3 id="HDFS-RAIDæ¶æ„"><a href="#HDFS-RAIDæ¶æ„" class="headerlink" title="HDFS-RAIDæ¶æ„"></a>HDFS-RAIDæ¶æ„</h3><p>HDFS-RAIDæ˜¯Facebookå¼€æºçš„åœ¨HDFSä¸Šå¼•å…¥(10,4)RSç¼–ç çš„æ–‡ä»¶ç³»ç»Ÿï¼Œä¸€èˆ¬ç§°ä¸ºDRFSï¼ˆDistributed Raid File systemï¼‰ã€‚DRFSä¸­çš„æ–‡ä»¶è¢«åˆ‡å‰²æˆæ•°æ®å¸¦ï¼ˆStripeï¼‰ï¼Œæ¯ä¸ªæ•°æ®å¸¦ç”±è‹¥å¹²ä¸ªæ•°æ®å—ï¼ˆBlockï¼‰æ„æˆã€‚å¯¹äºæ¯ä¸ªæ•°æ®å¸¦ï¼ŒDRFSæ ¹æ®åŸå§‹æ•°æ®å—è®¡ç®—å…¶å¯¹åº”çš„æ ¡éªŒæ•°æ®å—å¹¶åˆ†åˆ«å­˜å‚¨ã€‚</p>
<p>HDFS-RAIDçš„ç³»ç»Ÿæ¶æ„ä¸­æœ€ä¸»è¦çš„æ˜¯RaidNodeå’ŒBlockFixerï¼Œå…¶å¯¹åº”çš„åŠŸèƒ½å¦‚ä¸‹ã€‚</p>
<ul>
<li>RaidNodeï¼šå¯¹DRFSä¸­çš„æ–‡ä»¶å»ºç«‹å’Œç»´æŠ¤å¯¹åº”çš„æ ¡éªŒæ•°æ®æ–‡ä»¶</li>
<li>BlockFixerï¼šä¸RaidNodeè¿è¡Œåœ¨åŒä¸€æœºå™¨ä¸Šçš„ç‹¬ç«‹è¿›ç¨‹ã€‚å®ƒå‘¨æœŸæ€§åœ°æ‰«ææ–‡ä»¶ç³»ç»Ÿï¼Œä»å·²ç»ç»è¿‡RSç¼–ç çš„æ–‡ä»¶ä¸­è¯†åˆ«å‡ºé‚£äº›æŸæ¯çš„ï¼Œå¯¹äºè¿™äº›æŸæ¯æ•°æ®å—ï¼Œä¹Ÿæ˜¯é€šè¿‡MRç¨‹åºï¼Œè·å¾—å…¶æ‰€åœ¨æ•°æ®å¸¦å…¶ä»–æ•°æ®å—æ–‡ä»¶å’Œæ ¡éªŒæ–‡ä»¶ï¼Œä¹‹åå¯¹æŸæ¯æ•°æ®å—è¿›è¡Œæ¢å¤çš„ã€‚</li>
</ul>
<h1 id="ç¬¬9ç« -å†…å­˜KVæ•°æ®åº“"><a href="#ç¬¬9ç« -å†…å­˜KVæ•°æ®åº“" class="headerlink" title="ç¬¬9ç«  å†…å­˜KVæ•°æ®åº“"></a>ç¬¬9ç«  å†…å­˜KVæ•°æ®åº“</h1><ul>
<li>åœ¨å¤§è§„æ¨¡å­˜å‚¨ç¯å¢ƒä¸‹ï¼Œä¸ºäº†æ•°æ®çš„é«˜å¯ç”¨æ€§ï¼Œå¾€å¾€ä¼šå°†åŒä¸€ä¸ªæ•°æ®ä¿å­˜3ä»½ï¼Œè¿™å¯¹äºä»¥å¤–å­˜å­˜å‚¨æ•°æ®ä¸ºä¸»çš„ç³»ç»Ÿæ¥è¯´ä¸æ˜¯éšœç¢ï¼Œå› ä¸ºå…¶å­˜å‚¨æˆæœ¬è¾ƒä½</li>
<li>å¯¹äºå†…å­˜æ¥è¯´åˆ™æ˜¯ä¸ªé—®é¢˜ï¼Œæ¯•ç«Ÿç›¸å¯¹å¤–å­˜å’ŒSSDæ¥è¯´ï¼Œå†…å­˜çš„æˆæœ¬è¿˜æ˜¯æ¯”è¾ƒé«˜çš„ã€‚<ul>
<li>å¿½ç•¥æˆæœ¬æé«˜å¯ç”¨æ€§ï¼Œä¸å¤–å­˜å­˜å‚¨ç³»ç»Ÿä¸€æ ·ï¼Œåœ¨å†…å­˜é‡Œå¯¹æ•°æ®è¿›è¡Œå¤‡ä»½</li>
<li>åªåœ¨å†…å­˜ä¿ç•™ä¸€ä»½æ•°æ®ï¼Œæ•°æ®å¤‡ä»½æ”¾åœ¨ç£ç›˜æˆ–è€…SSDä¸­</li>
</ul>
</li>
</ul>
<p>RAMCloudé‡‡å–äº†ç¬¬2ç§ç­–ç•¥ï¼ŒRediså’ŒMembaseé‡‡å–äº†ç¬¬1ç§ç­–ç•¥ã€‚</p>
<h2 id="RAMCloud"><a href="#RAMCloud" class="headerlink" title="RAMCloud"></a>RAMCloud</h2><p>æ–¯å¦ç¦å¤§å­¦æå‡ºçš„å¤§è§„æ¨¡é›†ç¾¤ä¸‹çš„çº¯å†…å­˜KVæ•°æ®åº“ç³»ç»Ÿï¼Œæœ€å¤§çš„ç‰¹ç‚¹æ˜¯è¯»ï¼å†™æ•ˆç‡é«˜ï¼Œå…¶è®¾è®¡ç›®æ ‡æ˜¯åœ¨æ•°åƒå°æœåŠ¡å™¨è§„æ¨¡ä¸‹è¯»å–å°å¯¹è±¡é€Ÿåº¦èƒ½å¤Ÿè¾¾åˆ°5ï½10çº³ç§’ï¼Œè¿™ç§é€Ÿåº¦æ˜¯ç›®å‰å¸¸è§„æ•°æ®ä¸­å¿ƒå­˜å‚¨æ–¹æ¡ˆæ€§èƒ½çš„50ï½1000å€ã€‚</p>
<p>åªåœ¨æœåŠ¡å™¨å†…å­˜æ”¾ç½®ä¸€ä»½åŸå§‹æ•°æ®ï¼ŒåŒæ—¶å°†æ•°æ®å¤‡ä»½å­˜å‚¨åœ¨é›†ç¾¤å…¶ä»–æœåŠ¡å™¨çš„å¤–å­˜ä¸­ï¼Œä»¥æ­¤è¾¾åˆ°æ•°æ®çš„æŒä¹…åŒ–ä¸å®‰å…¨æ€§å¹¶å…¼é¡¾æ•´ä½“å­˜å‚¨æˆæœ¬ã€‚</p>
<h3 id="æ•´ä½“æ¶æ„-2"><a href="#æ•´ä½“æ¶æ„-2" class="headerlink" title="æ•´ä½“æ¶æ„"></a>æ•´ä½“æ¶æ„</h3><p>![[file-20251106194602589.jpg | 500]]<br>å­˜å‚¨æœåŠ¡å™¨ç”±é«˜é€Ÿç½‘ç»œè¿æ¥ï¼Œæ¯å°å­˜å‚¨æœåŠ¡å™¨åŒ…å«ä¸¤ä¸ªæ„ä»¶ï¼šMasterå’ŒBackupã€‚Masterè´Ÿè´£å†…å­˜KVæ•°æ®çš„å­˜å‚¨å¹¶å“åº”å®¢æˆ·ç«¯è¯»ï¼å†™è¯·æ±‚ï¼ŒBackupè´Ÿè´£åœ¨å¤–å­˜å­˜å‚¨ç®¡ç†å…¶ä»–æœåŠ¡å™¨èŠ‚ç‚¹å†…å­˜æ•°æ®çš„æ•°æ®å¤‡ä»½ã€‚</p>
<p>åè°ƒå™¨ï¼šè®°è½½é›†ç¾¤ä¸­çš„ä¸€äº›é…ç½®ä¿¡æ¯ï¼Œæ¯”å¦‚å„ä¸ªå­˜å‚¨æœåŠ¡å™¨çš„IPåœ°å€ç­‰ï¼Œå¦å¤–è¿˜è´Ÿè´£ç»´æŠ¤å­˜å‚¨å¯¹è±¡å’Œå­˜å‚¨æœåŠ¡å™¨çš„æ˜ å°„å…³ç³»ï¼Œå³æŸä¸ªå­˜å‚¨å¯¹è±¡æ˜¯æ”¾åœ¨å“ªå°æœåŠ¡å™¨çš„ã€‚</p>
<h3 id="æ•°æ®å‰¯æœ¬ç®¡ç†ä¸æ•°æ®æ¢å¤"><a href="#æ•°æ®å‰¯æœ¬ç®¡ç†ä¸æ•°æ®æ¢å¤" class="headerlink" title="æ•°æ®å‰¯æœ¬ç®¡ç†ä¸æ•°æ®æ¢å¤"></a>æ•°æ®å‰¯æœ¬ç®¡ç†ä¸æ•°æ®æ¢å¤</h3><p>RAMCloudåœ¨å†…å­˜å’Œå¤–å­˜å­˜å‚¨æ•°æ®æ—¶éƒ½ç»Ÿä¸€é‡‡ç”¨äº†LSMæ ‘æ–¹æ¡ˆï¼Œå…¶å¯¹åº”çš„Logç»“æ„è¢«åˆ‡å‰²ä¸º8MBå¤§å°çš„æ•°æ®ç‰‡æ®µï¼ˆSegmentï¼‰ã€‚</p>
<p>![[file-20251106195240362.jpg | 450]]</p>
<ul>
<li>å½“RAMCloudæ¥æ”¶åˆ°å†™æ•°æ®è¯·æ±‚æ—¶ï¼Œé¦–å…ˆå°†å…¶è¿½åŠ è¿›å…¥å†…å­˜ä¸­çš„Logç»“æ„ä¸­ï¼Œç„¶åæ›´æ–°å“ˆå¸Œè¡¨ä»¥è®°è½½è®°å½•åœ¨å†…å­˜ä¸­çš„å­˜å‚¨ä½ç½®ï¼Œè¿™é‡Œä¹‹æ‰€ä»¥ä¼šéœ€è¦å“ˆå¸Œè¡¨ï¼Œæ˜¯å› ä¸ºå†…å­˜æ•°æ®é‡‡å–LSMæ ‘ç»“æ„åï¼Œæ˜¯ç”±è‹¥å¹²ä¸ªLogç‰‡æ®µæ„æˆçš„ï¼Œæ‰€ä»¥éœ€è¦è®°è½½è®°å½•æ‰€åœ¨Logç‰‡æ®µçš„ä½ç½®ä¿¡æ¯ã€‚</li>
<li>ä¹‹åï¼ŒRAMCloudçš„ä¸»æ•°æ®æœåŠ¡å™¨å°†æ–°æ•°æ®è½¬å‘ç»™å…¶ä»–å¤‡ä»½æœåŠ¡å™¨ï¼Œå¤‡ä»½æœåŠ¡å™¨å°†æ–°æ•°æ®è¿½åŠ åˆ°å†…å­˜ä¸­Logç‰‡æ®µåå³é€šçŸ¥ä¸»æ•°æ®æœåŠ¡å™¨è¿”å›</li>
</ul>
<h2 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h2><p>è‘—åçš„å†…å­˜KVæ•°æ®åº“ï¼Œåœ¨å·¥ä¸šç•Œè·å¾—äº†å¹¿æ³›ä½¿ç”¨ã€‚å…¶ä¸ä»…æ”¯æŒåŸºæœ¬æ•°æ®ç±»å‹ï¼Œä¹Ÿæ”¯æŒåˆ—è¡¨ã€é›†åˆç­‰å¤æ‚æ•°æ®ç»“æ„ï¼Œæ‰€ä»¥æœ‰è¾ƒå¼ºçš„è¡¨è¾¾èƒ½åŠ›ï¼ŒåŒæ—¶æœ‰éå¸¸é«˜çš„å•æœºè¯»ï¼å†™æ•ˆç‡ã€‚</p>
<p>![[file-20251106195846729.jpg | 300]]</p>
<p>ç³»ç»Ÿä¸­å”¯ä¸€çš„Masterè´Ÿè´£æ•°æ®çš„è¯»ï¼å†™æ“ä½œï¼Œå¯ä»¥æœ‰å¤šä¸ªSlaveæ¥ä¿å­˜æ•°æ®å‰¯æœ¬ï¼Œå‰¯æœ¬æ•°æ®åªèƒ½è¯»ä¸èƒ½åšæ•°æ®æ›´æ–°æ“ä½œã€‚</p>
<ul>
<li>å½“Slaveåˆæ¬¡å¯åŠ¨æ—¶ï¼Œä»Masterè·å–æ•°æ®ï¼Œåœ¨æ•°æ®å¤åˆ¶è¿‡ç¨‹ä¸­ï¼ŒMasteræ˜¯éé˜»å¡çš„ï¼Œå³åŒæ—¶å¯ä»¥æ”¯æŒè¯»ï¼å†™æ“ä½œã€‚</li>
<li>Masteré‡‡ç”¨å¿«ç…§åŠ å¢é‡çš„å¼‚æ­¥æ–¹å¼å®Œæˆæ•°æ®å¤åˆ¶è¿‡ç¨‹ï¼Œé¦–å…ˆåœ¨æ—¶åˆ»Tå°†å†…å­˜æ•°æ®å†™å…¥æœ¬åœ°å¿«ç…§æ–‡ä»¶ï¼ŒåŒæ—¶åœ¨å†…å­˜è®°å½•ä»Tæ—¶åˆ»èµ·æ–°å¢çš„æ•°æ®æ“ä½œï¼Œå½“å¿«ç…§æ–‡ä»¶ç”Ÿæˆç»“æŸåï¼ŒMasterå°†æ–‡ä»¶ä¼ ç»™Slaveï¼ŒSlaveå…ˆä¿å­˜ä¸ºæœ¬åœ°æ–‡ä»¶ï¼Œç„¶åå°†å…¶åŠ è½½å…¥å†…å­˜</li>
<li>Masterå°†Tæ—¶åˆ»åçš„æ•°æ®å˜æ›´æ“ä½œä»¥å‘½ä»¤æµçš„å½¢å¼ä¼ ç»™Slaveï¼ŒSlaveé¡ºåºæ‰§è¡Œå‘½ä»¤æµï¼Œè¿™æ ·å°±è¾¾åˆ°æ•°æ®å’ŒMasterä¿æŒåŒæ­¥ã€‚</li>
</ul>
<p>Redisçš„ä¸»ä»å¤åˆ¶é‡‡ç”¨å¼‚æ­¥æ–¹å¼ï¼ŒMasterå‘ç”Ÿæ•…éšœå¯èƒ½ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚</p>
<p>ä½¿ç”¨Keepalivedç»“åˆè™šæ‹ŸIPæ¥å®ç°Redisçš„HAæ–¹æ¡ˆã€‚Keepalivedæ˜¯è½¯ä»¶è·¯ç”±ç³»ç»Ÿï¼Œä¸»è¦çš„ç›®çš„æ˜¯ä¸ºåº”ç”¨ç³»ç»Ÿæä¾›ç®€æ´å¼ºå£®çš„è´Ÿè½½å‡è¡¡æ–¹æ¡ˆå’Œé€šç”¨é«˜å¯ç”¨æ–¹æ¡ˆã€‚ä½¿ç”¨Keepalivedå®ç°Redisé«˜å¯ç”¨æ–¹æ¡ˆæ€è·¯å¦‚ä¸‹ã€‚</p>
<ul>
<li>é¦–å…ˆï¼Œåœ¨ä¸¤å°æœåŠ¡å™¨ï¼ˆæˆ–è€…å¤šå°ï¼Œæœºåˆ¶ç±»ä¼¼ï¼‰åˆ†åˆ«å®‰è£…Rediså¹¶è®¾ç½®æˆä¸€ä¸»ä¸€å¤‡ã€‚</li>
<li>å…¶æ¬¡ï¼ŒKeepalivedé…ç½®è™šæ‹ŸIPå’Œä¸¤å°RedisæœåŠ¡å™¨IPçš„æ˜ å°„å…³ç³»ï¼Œè¿™æ ·ï¼Œå¯¹å¤–ç»Ÿä¸€é‡‡ç”¨è™šæ‹ŸIPï¼Œè€Œè™šæ‹ŸIPå’ŒçœŸå®IPçš„æ˜ å°„å…³ç³»åŠæ•…éšœåˆ‡æ¢ç”±Keepalivedæ¥è´Ÿè´£ã€‚å½“RedisæœåŠ¡å™¨éƒ½æ­£å¸¸æ—¶ï¼Œæ•°æ®è¯·æ±‚ç”±Masterè´Ÿè´£ï¼ŒSalveåªéœ€ä»MasteråŒæ­¥æ•°æ®ï¼›å½“Masterå‘ç”Ÿæ•…éšœæ—¶ï¼ŒSlaveæ¥ç®¡æ•°æ®è¯·æ±‚ï¼ŒåŒæ—¶å…³é—­ä¸»ä»å¤åˆ¶åŠŸèƒ½ä»¥é¿å…Masterå†æ¬¡å¯åŠ¨åSlaveæ•°æ®è¢«æ¸…æ‰ï¼›å½“å‘ç”Ÿæ•…éšœçš„Masteræ¢å¤æ­£å¸¸åï¼Œé¦–å…ˆä»SlaveåŒæ­¥æ•°æ®ä»¥è·å¾—æœ€æ–°çš„æ•°æ®æƒ…å†µï¼Œç„¶åå…³é—­ä¸»ä»å¤åˆ¶åŠŸèƒ½å¹¶æ¢å¤Masterèº«ä»½ï¼Œä¸æ­¤åŒæ—¶Slaveæ¢å¤å…¶Slaveèº«ä»½ã€‚è¿™ç§æ–¹å¼å¯ä»¥åœ¨æŸç§ç¨‹åº¦ä¸Šæä¾›é«˜å¯ç”¨æ–¹æ¡ˆ</li>
</ul>
<h1 id="ç¬¬10ç« -åˆ—å¼æ•°æ®åº“"><a href="#ç¬¬10ç« -åˆ—å¼æ•°æ®åº“" class="headerlink" title="ç¬¬10ç«  åˆ—å¼æ•°æ®åº“"></a>ç¬¬10ç«  åˆ—å¼æ•°æ®åº“</h1><h2 id="BigTable"><a href="#BigTable" class="headerlink" title="BigTable"></a>BigTable</h2><h3 id="BigTableçš„æ•°æ®æ¨¡å‹"><a href="#BigTableçš„æ•°æ®æ¨¡å‹" class="headerlink" title="BigTableçš„æ•°æ®æ¨¡å‹"></a>BigTableçš„æ•°æ®æ¨¡å‹</h3><p>BigTableæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªä¸‰ç»´çš„æ˜ å°„è¡¨ï¼Œå…¶æœ€åŸºç¡€çš„å­˜å‚¨å•å…ƒæ˜¯ç”±ï¼ˆè¡Œä¸»é”®ã€åˆ—ä¸»é”®ã€æ—¶é—´ï¼‰ä¸‰ç»´ä¸»é”®ï¼ˆKeyï¼‰æ‰€å®šä½çš„ã€‚</p>
<p>![[file-20251107181351589.jpg | 500]]<br>BigTableä¸­çš„åˆ—ä¸»é”®åŒ…å«ä¸¤çº§ï¼Œå…¶ä¸­ç¬¬ä¸€çº§è¢«ç§°ä¸ºâ€œåˆ—å®¶æ—â€ï¼ˆColumn Familiesï¼‰ï¼Œç¬¬äºŒçº§è¢«ç§°ä¸ºâ€œåˆ—æè¿°ç¬¦â€ï¼ˆQualifierï¼‰ï¼Œä¸¤è€…å…±åŒç»„æˆä¸€ä¸ªåˆ—çš„ä¸»é”®ï¼Œå³ï¼šåˆ—ä¸»é”®&#x3D;â€œåˆ—å®¶æ—ï¼šåˆ—æè¿°ç¬¦â€</p>
<p>BigTableå†…å¯ä»¥ä¿ç•™åŒä¸€ä¿¡æ¯éšç€æ—¶é—´å˜åŒ–çš„ä¸åŒç‰ˆæœ¬ï¼Œè¿™ä¸ªä¸åŒç‰ˆæœ¬ç”±â€œæ—¶é—´â€ç»´åº¦æ¥è¿›è¡Œè¡¨è¾¾ã€‚<br>![[file-20251107181725643.jpg | 400]]</p>
<h3 id="BigTableçš„æ•´ä½“ç»“æ„"><a href="#BigTableçš„æ•´ä½“ç»“æ„" class="headerlink" title="BigTableçš„æ•´ä½“ç»“æ„"></a>BigTableçš„æ•´ä½“ç»“æ„</h3><p>BigTableçš„æ•´ä½“ç»“æ„ç¤ºæ„å›¾ï¼š</p>
<ul>
<li>â€œå­è¡¨æœåŠ¡å™¨â€ä¸»è¦è´Ÿè´£å­è¡¨çš„æ•°æ®å­˜å‚¨å’Œç®¡ç†ï¼ŒåŒæ—¶éœ€è¦å“åº”å®¢æˆ·ç«¯ç¨‹åºçš„è¯»ï¼å†™è¯·æ±‚ï¼Œå…¶è´Ÿè´£ç®¡ç†çš„å­è¡¨ä»¥GFSæ–‡ä»¶çš„å½¢å¼å­˜åœ¨ï¼ŒBigTableå†…éƒ¨å°†è¿™ç§æ–‡ä»¶ç§°ä¹‹ä¸ºSSTableï¼Œä¸€ä¸ªå­è¡¨å°±æ˜¯ç”±â€œå­è¡¨æœåŠ¡å™¨â€ç£ç›˜ä¸­å­˜å‚¨çš„è‹¥å¹²ä¸ªSSTableæ–‡ä»¶ç»„æˆçš„ã€‚</li>
<li>â€œä¸»æ§æœåŠ¡å™¨â€è´Ÿè´£æ•´ä¸ªç³»ç»Ÿçš„ç®¡ç†å·¥ä½œï¼ŒåŒ…æ‹¬å­è¡¨çš„åˆ†é…ã€å­è¡¨æœåŠ¡å™¨çš„è´Ÿè½½å‡è¡¡ã€å­è¡¨æœåŠ¡å™¨å¤±æ•ˆæ£€æµ‹ç­‰ã€‚</li>
<li>â€œå®¢æˆ·ç«¯ç¨‹åºâ€åˆ™æ˜¯å…·ä½“åº”ç”¨çš„æ¥å£ç¨‹åºï¼Œç›´æ¥å’Œâ€œå­è¡¨æœåŠ¡å™¨â€è¿›è¡Œäº¤äº’é€šä¿¡ï¼Œæ¥è¯»ï¼å†™æŸä¸ªå­è¡¨å¯¹åº”çš„æ•°æ®ã€‚</li>
</ul>
<p>![[file-20251107181920571.jpg | 400]]</p>
<h3 id="BigTableçš„ç®¡ç†æ•°æ®"><a href="#BigTableçš„ç®¡ç†æ•°æ®" class="headerlink" title="BigTableçš„ç®¡ç†æ•°æ®"></a>BigTableçš„ç®¡ç†æ•°æ®</h3><p>åˆ©ç”¨Chubbyç³»ç»Ÿå’Œä¸€ä¸ªè¢«ç§°ä¸ºâ€œå…ƒæ•°æ®è¡¨â€ï¼ˆMetaData Tableï¼‰çš„ç‰¹æ®Šè¡¨æ ¼æ¥å…±åŒç»´æŠ¤ç³»ç»Ÿç®¡ç†æ•°æ®ï¼š</p>
<ul>
<li>â€œå…ƒæ•°æ®è¡¨â€æ˜¯BigTableä¸­ä¸€ä¸ªèµ·ç€ç‰¹æ®Šä½œç”¨çš„è¡¨ï¼Œè¿™ä¸ªè¡¨æ ¼çš„æ¯ä¸€è¡Œè®°è½½äº†æ•´ä¸ªBigTableä¸­æŸä¸ªå…·ä½“å­è¡¨å­˜å‚¨åœ¨å“ªå°â€œå­è¡¨æœåŠ¡å™¨â€ä¸Šç­‰ç®¡ç†ä¿¡æ¯</li>
<li>â€œå…ƒæ•°æ®è¡¨â€ä¸­å…¶ä»–å­è¡¨çš„æ¯ä¸€è¡Œï¼Œåˆ™è®°å½•äº†BigTableä¸­åº”ç”¨ç¨‹åºç”Ÿæˆçš„è¡¨æ ¼ï¼ˆç”¨æˆ·è¡¨ï¼‰çš„æŸä¸ªå­è¡¨çš„ç®¡ç†æ•°æ®ã€‚å…¶ä¸­ï¼Œæ¯ä¸€è¡Œä»¥â€œç”¨æˆ·è¡¨è¡¨åâ€å’Œåœ¨è¿™ä¸ªå­è¡¨å†…å­˜å‚¨çš„æœ€åä¸€ä¸ªâ€œè¡Œä¸»é”®â€å…±åŒæ„æˆâ€œå…ƒæ•°æ®è¡¨â€å†…æ­¤æ¡è®°å½•çš„â€œè¡Œä¸»é”®â€ï¼Œåœ¨è®°å½•è¡Œçš„æ•°æ®é‡Œåˆ™å­˜å‚¨äº†è¿™ä¸ªå­è¡¨å¯¹åº”çš„â€œå­è¡¨æœåŠ¡å™¨â€ç­‰å…¶ä»–ç®¡ç†ä¿¡æ¯ã€‚è€ŒChubbyä¸­æŸä¸ªç‰¹æ®Šæ–‡ä»¶åˆ™æŒ‡å‡ºäº†â€œRootå­è¡¨â€æ‰€åœ¨çš„â€œå­è¡¨æœåŠ¡å™¨â€åœ°å€ã€‚<br>![[file-20251107182218134.jpg | 500]]</li>
</ul>
<h3 id="ä¸»æ§æœåŠ¡å™¨-1"><a href="#ä¸»æ§æœåŠ¡å™¨-1" class="headerlink" title="ä¸»æ§æœåŠ¡å™¨"></a>ä¸»æ§æœåŠ¡å™¨</h3><p>â€œä¸»æ§æœåŠ¡å™¨â€çš„å¯åŠ¨æµç¨‹ï¼š<br>![[file-20251107182311029.jpg | 500]]</p>
<ul>
<li>å½“â€œä¸»æ§æœåŠ¡å™¨â€å¯åŠ¨æ—¶ï¼Œé¦–å…ˆåœ¨Chubbyä¸­è·å¾—ä¸€ä¸ªMasteré”ï¼Œè¿™æ ·å¯ä»¥é˜»æ­¢å…¶ä»–â€œä¸»æ§æœåŠ¡å™¨â€å†æ¬¡å¯åŠ¨ï¼Œé¿å…æ•´ä¸ªç³»ç»Ÿä¸­å‡ºç°å¤šä¸ªç®¡ç†èŠ‚ç‚¹ã€‚</li>
<li>ä¸»æ§æœåŠ¡å™¨è¯»å–Serversç›®å½•ï¼Œä»è¯¥ç›®å½•ä¸‹çš„æ–‡ä»¶å¯ä»¥è·å¾—æ¯ä¸ªå­è¡¨æœåŠ¡å™¨çš„åœ°å€ä¿¡æ¯ã€‚è·å¾—åœ°å€ä¿¡æ¯åï¼Œåœ¨ä¹‹åçš„ç®¡ç†è¿‡ç¨‹ä¸­ï¼Œâ€œä¸»æ§æœåŠ¡å™¨â€å°±å¯ä»¥ç›´æ¥å’Œâ€œå­è¡¨æœåŠ¡å™¨â€è¿›è¡Œé€šä¿¡ã€‚</li>
<li>åœ¨å¯åŠ¨æ—¶ï¼Œâ€œä¸»æ§æœåŠ¡å™¨â€å’Œâ€œå­è¡¨æœåŠ¡å™¨â€é€šä¿¡ï¼Œè·çŸ¥æ¯ä¸ªâ€œå­è¡¨æœåŠ¡å™¨â€å­˜å‚¨äº†å“ªäº›å­è¡¨å¹¶è®°å½•åœ¨å†…å­˜ç®¡ç†æ•°æ®ä¸­ã€‚</li>
<li>â€œä¸»æ§æœåŠ¡å™¨â€ä»Chubbyçš„rootèŠ‚ç‚¹å¯ä»¥è¯»å–MetaDataå…ƒæ•°æ®ï¼Œè¿™é‡Œè®°è½½äº†ç³»ç»Ÿä¸­æ‰€æœ‰å­è¡¨çš„ä¿¡æ¯ï¼›</li>
<li>é€šè¿‡MetaDataå’Œâ€œå­è¡¨æœåŠ¡å™¨â€åé¦ˆçš„ä¿¡æ¯ï¼Œä¸¤è€…å¯¹æ¯”ï¼Œå¯èƒ½ä¼šå‘ç°æœ‰ä¸€éƒ¨åˆ†å­è¡¨åœ¨MetaDataä¸­ï¼Œä½†æ˜¯æ²¡æœ‰â€œå­è¡¨æœåŠ¡å™¨â€è´Ÿè´£å­˜å‚¨ï¼Œè¯´æ˜è¿™äº›å­è¡¨æ˜¯æœªè·å¾—åˆ†é…çš„å†…å®¹ï¼Œæ‰€ä»¥å°†è¿™äº›å­è¡¨ä¿¡æ¯åŠ å…¥ä¸€ä¸ªâ€œæœªåˆ†é…å­è¡¨â€é›†åˆä¸­ï¼Œä¹‹åä¼šåœ¨é€‚å½“çš„æ—¶æœºï¼Œå°†è¿™äº›â€œæœªåˆ†é…å­è¡¨â€åˆ†é…ç»™è´Ÿè½½è¾ƒè½»çš„â€œå­è¡¨æœåŠ¡å™¨â€ã€‚</li>
</ul>
<h3 id="å­è¡¨æœåŠ¡å™¨"><a href="#å­è¡¨æœåŠ¡å™¨" class="headerlink" title="å­è¡¨æœåŠ¡å™¨"></a>å­è¡¨æœåŠ¡å™¨</h3><p>â€œå­è¡¨æœåŠ¡å™¨â€æ˜¯BigTableç³»ç»Ÿä¸­ç”¨æ¥å­˜å‚¨å’Œç®¡ç†å­è¡¨æ•°æ®çš„ï¼Œä»å…·ä½“åŠŸèƒ½æ¥è®²ï¼Œå­è¡¨æœåŠ¡å™¨æ”¯æŒä»¥ä¸‹åŠŸèƒ½ã€‚</p>
<ul>
<li>å­˜å‚¨ç®¡ç†å­è¡¨æ•°æ®ï¼ŒåŒ…æ‹¬å­è¡¨å­˜å‚¨ã€å­è¡¨æ¢å¤ã€å­è¡¨åˆ†è£‚ã€å­è¡¨åˆå¹¶ç­‰ã€‚</li>
<li>å“åº”å®¢æˆ·ç«¯ç¨‹åºå¯¹å­è¡¨çš„è¯»ã€å†™è¯·æ±‚ã€‚</li>
</ul>
<ol>
<li><p>æ›´æ–°å­è¡¨æ•°æ®ï¼š<br> å½“â€œå­è¡¨æœåŠ¡å™¨â€æ¥æ”¶åˆ°æ•°æ®æ›´æ–°è¯·æ±‚æ—¶ï¼Œé¦–å…ˆå°†æ›´æ–°å‘½ä»¤è®°å…¥CommitLogæ–‡ä»¶ä¸­ï¼Œä¹‹åå°†æ›´æ–°æ•°æ®å†™å…¥å†…å­˜çš„MemTableç»“æ„ä¸­ï¼Œå½“MemTableé‡Œå®¹çº³çš„æ•°æ®è¶…è¿‡è®¾å®šå¤§å°æ—¶ï¼Œå°†å†…å®¹è¾“å‡ºåˆ°GFSæ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œå½¢æˆä¸€ä¸ªæ–°çš„SSTableæ–‡ä»¶ã€‚ä¸€ä¸ªå…·ä½“çš„å­è¡¨æ•°æ®å°±æ˜¯ç”±è‹¥å¹²ä¸ªé™†ç»­ä»MemTableäº§ç”Ÿçš„SSTableæ–‡ä»¶æ„æˆçš„ã€‚ä»è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼ŒBigTableçš„å­è¡¨æœåŠ¡å™¨å¯¹æ•°æ®ç®¡ç†æ˜¯ä¸ªå…¸å‹çš„LSMæ ‘ç»“æ„ã€‚<br> ![[file-20251107182816083.jpg | 500]]<br> ![[file-20251107182904699.jpg|400]]</p>
</li>
<li><p>è¯»å–å­è¡¨æ•°æ®<br> ä¸€ä¸ªå­è¡¨æ˜¯ç”±å†…å­˜ä¸­çš„MemTableå’ŒGFSä¸­å­˜å‚¨çš„è‹¥å¹²SSTableæ–‡ä»¶æ„æˆçš„ã€‚åœ¨MemTableå’ŒSSTableä¸­å­˜å‚¨çš„æ•°æ®éƒ½æ˜¯æŒ‰ç…§â€œè¡Œä¸»é”®â€çš„å­—æ¯é¡ºåºæ’åºçš„ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“å°†è¿™äº›æ–‡ä»¶çœ‹ä½œä¸€ä¸ªæŒ‰ç…§â€œè¡Œä¸»é”®â€æ’å¥½åºçš„æ•´ä½“åºåˆ—ç»“æ„ï¼Œè€Œè¯»å–æ“ä½œå°±æ˜¯é¦–å…ˆæŸ¥æ‰¾æ•°æ®çš„å­˜å‚¨ä½ç½®ï¼Œå¦‚æœæ‰¾åˆ°åˆ™è¯»å‡ºæ•°æ®ã€‚ç”±äºSSTableæ˜¯åœ¨GFSæ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œä¸ºäº†å¢å¿«æŸ¥æ‰¾é€Ÿåº¦ï¼ŒBigTableé™¤äº†â€œå—ç´¢å¼•â€å¤–ï¼Œè¿˜å¼•å…¥äº†â€œå¸ƒéš†è¿‡æ»¤å™¨ï¼ˆBloom Filterï¼‰â€ç®—æ³•ï¼Œè¿™ç§ç®—æ³•åªå ç”¨å°‘é‡å†…å­˜ï¼Œå°±å¯ä»¥å¿«é€Ÿåˆ¤æ–­æŸä¸ªSSTableæ–‡ä»¶æ˜¯å¦åŒ…å«è¦è¯»å–æ•°æ®çš„â€œä¸»é”®â€ï¼Œè¿™æ ·å¯¹äºå¾ˆå¤šè¯»æ“ä½œè€Œè¨€ï¼Œé¿å…äº†åœ¨ç£ç›˜ä¸­æŸ¥æ‰¾ï¼ŒåŠ å¿«äº†è¯»å–é€Ÿåº¦ã€‚<br> ![[file-20251107183130818.jpg | 500]]</p>
</li>
<li><p>SSTableåˆå¹¶<br> å¦‚æœSSTableæ•°é‡è¿‡å¤šï¼Œä¼šå½±å“ç³»ç»Ÿè¯»å–æ•ˆç‡ï¼Œæ‰€ä»¥â€œå­è¡¨æœåŠ¡å™¨â€ä¼šå‘¨æœŸæ€§åœ°å¯¹å­è¡¨çš„SSTableå’ŒMemTableè¿›è¡Œåˆå¹¶ã€‚æ ¹æ®åˆå¹¶è§„æ¨¡çš„å·®å¼‚ï¼Œå­˜åœ¨3ç§ä¸åŒç±»å‹çš„åˆå¹¶ç­–ç•¥ï¼šå¾®åˆå¹¶ï¼ˆMinor Compactionï¼‰ã€éƒ¨åˆ†åˆå¹¶ï¼ˆMerging Compactionï¼‰ä»¥åŠä¸»åˆå¹¶ï¼ˆMajor Compactionï¼‰<br> ![[file-20251107183400379.jpg| 500]]</p>
</li>
<li><p>å­è¡¨æ¢å¤<br> å½“æ­»æœºçš„â€œå­è¡¨æœåŠ¡å™¨â€é‡æ–°å¯åŠ¨åï¼Œä¼šä»â€œå…ƒæ•°æ®å­è¡¨â€ï¼ˆMetaDataï¼‰ä¸­è¯»å–ç®¡ç†ä¿¡æ¯ï¼ŒåŒ…æ‹¬â€œå­è¡¨æœåŠ¡å™¨â€è´Ÿè´£ç®¡ç†çš„å­è¡¨å¯¹åº”å“ªäº›SSTableæ–‡ä»¶ï¼Œä»¥åŠCommitLogå¯¹åº”çš„æ¢å¤ç‚¹ï¼ˆRedo Pointï¼‰æ ¹æ®CommitLogæ¢å¤ç‚¹ï¼Œâ€œå­è¡¨æœåŠ¡å™¨â€å¯ä»¥æ‰¾åˆ°CommitLogå¯¹åº”ä½ç½®ï¼Œæ¢å¤ä»è¿™ä¸ªä½ç½®ä¹‹åçš„æ‰€æœ‰æ›´æ–°è¡Œä¸ºåˆ°MemTableä¸­ï¼Œè¿™æ ·å°±å®Œæˆäº†MemTableçš„é‡å»ºå·¥ä½œã€‚ä»â€œå…ƒæ•°æ®å­è¡¨â€ä¸­è¯»å–åˆ°å¯¹åº”çš„SSTableæ–‡ä»¶åï¼Œâ€œå­è¡¨æœåŠ¡å™¨â€å°†å¯¹åº”çš„SSTableçš„å—ç´¢å¼•è¯»å…¥å†…å­˜ï¼Œè¿™æ ·å°±èƒ½å¤Ÿå®Œå…¨æ¢å¤åˆ°æ­»æœºå‰çš„çŠ¶æ€ã€‚<br> ![[file-20251107183853559.jpg | 500]]</p>
</li>
</ol>
<p>BigTableä½œä¸ºå¯¹æµ·é‡æ•°æ®å­˜å–å¯ä»¥å®æ—¶å“åº”çš„å¤§è§„æ¨¡å­˜å‚¨ç³»ç»Ÿï¼Œå…¶å¾ˆå¤šè®¾è®¡æ€è·¯å¯¹åç»­çš„NoSQLç³»ç»Ÿå…·æœ‰å¾ˆå¤§çš„å½±å“ã€‚æœ€å…¸å‹çš„æ˜¯Apache HBaseï¼Œå¯ä»¥å°†å…¶çœ‹ä½œBigTableçš„å¼€æºç‰ˆæœ¬ï¼Œç›®å‰å·²å¹¿æ³›åº”ç”¨åœ¨å„ç§å¤§æ•°æ®å®æ—¶å­˜å–åœºæ™¯ä¸­ã€‚</p>
<h2 id="PNUTSå­˜å‚¨ç³»ç»Ÿ"><a href="#PNUTSå­˜å‚¨ç³»ç»Ÿ" class="headerlink" title="PNUTSå­˜å‚¨ç³»ç»Ÿ"></a>PNUTSå­˜å‚¨ç³»ç»Ÿ</h2><p>PNUTSæ˜¯Yahooå…¬å¸æ„å»ºçš„æä¾›åœ¨çº¿æ•°æ®æœåŠ¡çš„åˆ—å¼äº‘å­˜å‚¨ç³»ç»Ÿï¼Œä¸å…¶ä»–çš„æµ·é‡äº‘å­˜å‚¨ç³»ç»Ÿç›¸ä¼¼ï¼ŒPNUTSé‡‡å–äº†å¼±ä¸€è‡´æ€§æ¨¡å‹ï¼Œä»¥è¿™ç§å®½æ¾çš„ä¸€è‡´æ€§æ¨¡å‹ä¸ºä»£ä»·ï¼Œæ¢å–ç³»ç»Ÿæ›´å¥½çš„å¯æ‰©å±•æ€§ã€é«˜å¯ç”¨æ€§ä»¥åŠå¼ºå®¹é”™æ€§ã€‚</p>
<h3 id="PNUTSçš„æ•´ä½“æ¶æ„"><a href="#PNUTSçš„æ•´ä½“æ¶æ„" class="headerlink" title="PNUTSçš„æ•´ä½“æ¶æ„"></a>PNUTSçš„æ•´ä½“æ¶æ„</h3><p>PNUTSæ”¯æŒæ•°æ®çš„å¤šæ•°æ®ä¸­å¿ƒéƒ¨ç½²ï¼Œæ¯ä¸ªæ•°æ®ä¸­å¿ƒè¢«ç§°ä¸ºä¸€ä¸ªâ€œåŒºåŸŸâ€ï¼ˆRegionï¼‰ï¼Œæ¯ä¸ªåŒºåŸŸæ‰€éƒ¨ç½²çš„ç³»ç»Ÿéƒ½æ˜¯å®Œå…¨ç›¸åŒçš„ï¼Œæ¯æ¡è®°å½•åœ¨æ¯ä¸ªåŒºåŸŸéƒ½æœ‰ç›¸åº”çš„å¤‡ä»½ã€‚æ¯ä¸ªåŒºåŸŸå†…ä¸»è¦åŒ…å«3ä¸ªåŸºæœ¬å•å…ƒï¼šâ€œå­è¡¨æ§åˆ¶å™¨â€ã€â€œæ•°æ®è·¯ç”±å™¨â€å’Œâ€œå­˜å‚¨å•å…ƒâ€ï¼Œå…¶ä¸­â€œå­˜å‚¨å•å…ƒâ€è´Ÿè´£å®é™…æ•°æ®çš„å­˜å‚¨ï¼Œå…¶ä»–ä¸¤ä¸ªéƒ¨åˆ†èµ·åˆ°æ•°æ®ç®¡ç†çš„ä½œç”¨ï¼Œâ€œæ¶ˆæ¯ä»£ç†â€åˆ™æ¨ªè·¨å¤šä¸ªåŒºåŸŸï¼Œä¸»è¦è´Ÿè´£æ•°æ®åœ¨ä¸åŒåŒºåŸŸçš„æ›´æ–°ä¸åŒæ­¥ã€‚</p>
<p>![[file-20251107184629945.jpg | 700]]</p>
<h3 id="å­˜å‚¨å•å…ƒ"><a href="#å­˜å‚¨å•å…ƒ" class="headerlink" title="å­˜å‚¨å•å…ƒ"></a>å­˜å‚¨å•å…ƒ</h3><p>â€œå­˜å‚¨å•å…ƒâ€è´Ÿè´£å®é™…æ•°æ®çš„å­˜å‚¨ï¼Œå¯¹äºæ¯ä¸ªäºŒç»´æ•°æ®è¡¨æ ¼ï¼Œè‹¥å¹²æ¡è®°å½•ç»„æˆä¸€ä¸ªâ€œå­è¡¨â€ï¼ˆTabletï¼‰ï¼Œæ¯ä¸ªâ€œå­˜å‚¨å•å…ƒâ€è´Ÿè´£å­˜å‚¨å‡ ç™¾ä¸ªä¸åŒçš„â€œå­è¡¨â€ï¼Œåœ¨å…·ä½“æŸä¸ªåŒºåŸŸå†…ï¼Œåªä¿ç•™ä¸€ä»½â€œå­è¡¨â€ï¼Œæ•°æ®çš„å†—ä½™å­˜å‚¨æ˜¯é€šè¿‡ä¸åŒåŒºåŸŸå¤‡ä»½æ¥å®ç°çš„ï¼Œå³æ¯æ¡è®°å½•åœ¨æ¯ä¸ªåŒºåŸŸéƒ½æœ‰ä¸€ä¸ªå¤‡ä»½ã€‚</p>
<p>å­è¡¨åˆ’åˆ†æ–¹å¼ï¼š</p>
<ul>
<li>â€œæœ‰åºåˆ’åˆ†â€ï¼Œå°±æ˜¯æŒ‰ç…§è®°å½•ä¸»é”®æ’åºï¼Œç„¶åå°†è¿ç»­çš„ä¸€æ®µè®°å½•åˆ’åˆ†æˆä¸€ä¸ªå­è¡¨ï¼Œæ¯ä¸ªå­è¡¨å†…çš„è®°å½•ä¸»é”®ä»ç„¶æ˜¯æœ‰åºçš„</li>
<li>å“ˆå¸Œåˆ’åˆ†åŸºæœ¬æ€è·¯ä¸Dynamoç³»ç»Ÿçš„â€œä¸€è‡´æ€§å“ˆå¸Œâ€æ•°æ®åˆ’åˆ†æ–¹å¼ç±»ä¼¼ï¼Œå³å¯¹æ‰€æœ‰è®°å½•çš„ä¸»é”®è¿›è¡Œå“ˆå¸Œè®¡ç®—ï¼Œå°†æ‰€æœ‰å“ˆå¸Œå€¼çœ‹ä½œä¸€ä¸ªé—­ç¯ï¼Œå°†è¿™ä¸ªé—­ç¯åˆ‡å‰²ï¼Œå½¢æˆäº†ä¸åŒçš„å­è¡¨</li>
</ul>
<h3 id="å­è¡¨æ§åˆ¶å™¨ä¸æ•°æ®è·¯ç”±å™¨"><a href="#å­è¡¨æ§åˆ¶å™¨ä¸æ•°æ®è·¯ç”±å™¨" class="headerlink" title="å­è¡¨æ§åˆ¶å™¨ä¸æ•°æ®è·¯ç”±å™¨"></a>å­è¡¨æ§åˆ¶å™¨ä¸æ•°æ®è·¯ç”±å™¨</h3><p>æ•°æ®è·¯ç”±å™¨è´Ÿè´£æŸ¥æ‰¾æŸæ¡è®°å½•æ‰€åœ¨å­˜å‚¨å•å…ƒçš„ä½ç½®ï¼Œå½“å®¢æˆ·ç«¯ç¨‹åºè¦å¯¹æŸä¸ªè®°å½•è¿›è¡Œè¯»ï¼å†™æ—¶ï¼Œä¼šè¯¢é—®æ•°æ®è·¯ç”±å™¨åº”è¯¥å’Œå“ªä¸ªå­˜å‚¨å•å…ƒé€šä¿¡ï¼Œæ•°æ®è·¯ç”±å™¨åœ¨å†…å­˜ä¿ç•™è®°å½•ä¸»é”®æ‰€åœ¨å­˜å‚¨å•å…ƒçš„æ˜ å°„è¡¨ï¼Œé€šè¿‡æŸ¥æ‰¾æ˜ å°„è¡¨ï¼Œå‘ŠçŸ¥å®¢æˆ·ç«¯å­˜å‚¨å•å…ƒåœ°å€ã€‚<br>![[file-20251107184828312.jpg | 500]]</p>
<h3 id="é›…è™æ¶ˆæ¯ä»£ç†"><a href="#é›…è™æ¶ˆæ¯ä»£ç†" class="headerlink" title="é›…è™æ¶ˆæ¯ä»£ç†"></a>é›…è™æ¶ˆæ¯ä»£ç†</h3><p>é›…è™æ¶ˆæ¯ä»£ç†è´Ÿè´£æ•°æ®çš„æ›´æ–°ä¸åŒæ­¥ï¼Œæ¥ä¿æŒè®°å½•æ•°æ®çš„ä¸€è‡´æ€§ã€‚é›…è™æ¶ˆæ¯ä»£ç†é‡‡å–â€œå‘å¸ƒï¼è®¢é˜…â€çš„æ¶ˆæ¯é˜Ÿåˆ—æ–¹å¼ï¼Œå¹¶ä¸”æ¨ªè·¨ä¸åŒæ•°æ®ä¸­å¿ƒï¼Œä»¥ä¿æŒä¸åŒæ•°æ®ä¸­å¿ƒçš„æ•°æ®ä¸€è‡´<br>![[file-20251107184907649.jpg | 600]]<br>åªè¦â€œä¸»è®°å½•â€å®Œæˆæ›´æ–°æ“ä½œå¹¶å‘å¸ƒæ¶ˆæ¯æˆåŠŸï¼Œå³å¯ä»¥è®¤ä¸ºæ›´æ–°æ“ä½œæˆåŠŸå®Œæˆï¼Œä¹‹åçš„æ•°æ®ä¸€è‡´æ€§ç”±â€œé›…è™æ¶ˆæ¯ä»£ç†â€æ¥ä¿è¯.</p>
<h3 id="æ•°æ®ä¸€è‡´æ€§"><a href="#æ•°æ®ä¸€è‡´æ€§" class="headerlink" title="æ•°æ®ä¸€è‡´æ€§"></a>æ•°æ®ä¸€è‡´æ€§</h3><p>PNUTSé‡‡å–äº†è®°å½•çº§åˆ«çš„æ—¶é—´è½´ä¸€è‡´æ€§ï¼Œå‰æ–‡è®²è¿°è¿‡ï¼Œæ‰€æœ‰æ›´æ–°æ“ä½œéƒ½ç”±â€œä¸»è®°å½•â€æ¥å®Œæˆï¼Œâ€œé›…è™æ¶ˆæ¯ä»£ç†â€è´Ÿè´£æŒ‰ç…§ç›¸åŒçš„æ›´æ–°é¡ºåºæ¥æ›´æ–°æ‰€æœ‰å…¶ä»–â€œå¤‡ä»½è®°å½•â€ã€‚<br>![[file-20251107185043983.jpg | 700]]</p>
<h2 id="Spanner"><a href="#Spanner" class="headerlink" title="Spanner"></a>Spanner</h2><p>Spanneræ˜¯Googleå¼€å‘çš„å¯åœ¨å…¨çƒèŒƒå›´éƒ¨ç½²çš„å…·æœ‰æå¼ºå¯æ‰©å±•æ€§çš„åˆ—å¼æ•°æ®åº“ç³»ç»Ÿï¼Œå…¶å¯ä»¥å°†åƒäº¿è§„æ¨¡çš„æ•°æ®è‡ªåŠ¨éƒ¨ç½²åˆ°ä¸–ç•ŒèŒƒå›´æ•°ç™¾ä¸ªæ•°æ®ä¸­å¿ƒä¸­çš„ç™¾ä¸‡å°æœåŠ¡å™¨ä¸­ï¼Œé€šè¿‡ç»†ç²’åº¦çš„æ•°æ®å¤‡ä»½æœºåˆ¶æå¤§åœ°æé«˜äº†æ•°æ®çš„å¯ç”¨æ€§ä»¥åŠåœ°ç†åˆ†å¸ƒä¸Šçš„æ•°æ®å±€éƒ¨æ€§ã€‚Spannerå…·å¤‡æ•°æ®ä¸­å¿ƒçº§åˆ«çš„å®¹ç¾èƒ½åŠ›ï¼Œå³ä½¿æ•´ä¸ªæ•°æ®ä¸­å¿ƒå®Œå…¨é­åˆ°ç ´åä¹Ÿå¯ä»¥ä¿è¯æ•°æ®çš„å¯ç”¨æ€§ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒSpannerè¿˜å…·å¤‡æ¥è¿‘äºä¼ ç»Ÿæ•°æ®åº“å…³ç³»å‹æ¨¡å‹çš„åŠç»“æ„åŒ–æ•°æ®æ¨¡å‹å®šä¹‰ã€ç±»SQLæŸ¥è¯¢è¯­è¨€ä»¥åŠå®Œå–„çš„äº‹åŠ¡æ”¯æŒç­‰ç‰¹æ€§ã€‚</p>
<p>Spannerè¿˜å…·å¤‡ä¼ ç»Ÿåˆ†å¸ƒå¼æ•°æ®åº“ç³»ç»Ÿæ‰€ä¸å…·å¤‡çš„ä¼˜ç‚¹ï¼šå…¶å¯æä¾›å¤–éƒ¨ä¸€è‡´ï¼ˆExternally Consistentï¼‰çš„è¯»ï¼å†™èƒ½åŠ›ï¼Œä»¥åŠè·¨æ•°æ®åº“çš„å…¨å±€ä¸€è‡´æ€§è¯»èƒ½åŠ›ã€‚</p>
<p><strong>é€šè¿‡TrueTimeæœºåˆ¶ä¸ºåˆ†å¸ƒå¼äº‹åŠ¡æ‰“ä¸Šå…·æœ‰å…¨å±€æ¯”è¾ƒæ„ä¹‰çš„æ—¶é—´æˆ³</strong>ï¼Œè¿™ä¸ªæ—¶é—´æˆ³ç”±äºè·¨æ•°æ®ä¸­å¿ƒå…¨å±€å¯æ¯”ï¼Œæ‰€ä»¥å¯ä»¥å°†å…¶ä½œä¸ºäº‹åŠ¡åºåˆ—åŒ–é¡ºåºï¼ˆSerialization Orderï¼‰çš„ä¾æ®ã€‚</p>
<p>Spanneræ˜¯ç¬¬ä¸€ä¸ªèƒ½å¤Ÿåœ¨å…¨å±€èŒƒå›´æä¾›å¦‚ä¸‹èƒ½åŠ›çš„åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿï¼š<br>å¦‚æœäº‹åŠ¡T1Â çš„æäº¤æ—¶é—´æ—©äºäº‹åŠ¡T2Â çš„å¼€å§‹æ—¶é—´ï¼Œé‚£ä¹ˆT1Â çš„æäº¤æ—¶é—´æˆ³è¦å°äºT2Â çš„æäº¤æ—¶é—´æˆ³ï¼Œå³å¯ä»¥ä¾æ®æäº¤æ—¶é—´æˆ³çš„å¤§å°é¡ºåºæ¥å°†åˆ†å¸ƒå¼äº‹åŠ¡å…¨å±€åºåˆ—åŒ–ã€‚</p>
<p>æ•´ä½“æ¶æ„ï¼š<br>ä¸€ä¸ªSpanneréƒ¨ç½²è¢«ç§°ä¸ºä¸€ä¸ªUniverseï¼Œå…¶ç”±ä¼—å¤šçš„Zonesé›†åˆæ„æˆ</p>
<ul>
<li>ä¸€ä¸ªZoneç±»ä¼¼äºä¸€å¥—BigTableç³»ç»Ÿéƒ¨ç½²å®ä¾‹ï¼Œæ•°æ®å¯ä»¥è·¨æ•°æ®ä¸­å¿ƒè¿›è¡Œå¤‡ä»½ã€‚Zoneæ˜¯éƒ¨ç½²å•ä½ï¼Œå¯ä»¥æ•´ä½“ä»Universeä¸­æ·»åŠ æˆ–è€…åˆ é™¤Zoneï¼Œä¸€ä¸ªæ•°æ®ä¸­å¿ƒå¯ä»¥éƒ¨ç½²å¤šä¸ªZoneã€‚</li>
<li>ä¸€ä¸ªZoneç”±å”¯ä¸€çš„ZoneMasterã€æ•°é‡åœ¨ä¸€ç™¾åˆ°æ•°åƒçš„SpanServerä»¥åŠè‹¥å¹²ä½ç½®ä»£ç†ï¼ˆLocation Proxyï¼‰æ„æˆã€‚<ul>
<li>ZoneMasterè´Ÿè´£å‘SpanServeråˆ†é…å…¶éœ€è¦ç®¡ç†çš„æ•°æ®ï¼ŒSpanServerè´Ÿè´£å“åº”å®¢æˆ·ç«¯æ•°æ®è¯·æ±‚ï¼Œä½ç½®ä»£ç†ä¸ºå®¢æˆ·ç«¯ç¨‹åºè¿›è¡Œæ•°æ®è·¯ç”±æ¥è®©å…¶èƒ½å¤Ÿå®šä½åˆ°å¯¹åº”çš„SpanServerã€‚</li>
</ul>
</li>
<li>ä¸€ä¸ªUniverseè¿˜åŒ…å«Universe Masterå’Œä¸€ä¸ªPlacement Driverï¼ŒUniverse Masteræ˜¯ä¸€ä¸ªèƒ½å¤Ÿæ˜¾ç¤ºZoneÂ çŠ¶æ€ä¿¡æ¯çš„æ§åˆ¶å°ï¼ŒPlacement Driverè´Ÿè´£æ•°æ®åœ¨ä¸åŒZoneä¹‹é—´è¿›è¡Œè‡ªåŠ¨è¿ç§»ã€‚</li>
</ul>
<p>![[file-20251120151559155.jpg | 400]]</p>
<h3 id="SpanServerè½¯ä»¶æ ˆ"><a href="#SpanServerè½¯ä»¶æ ˆ" class="headerlink" title="SpanServerè½¯ä»¶æ ˆ"></a><strong>SpanServerè½¯ä»¶æ ˆ</strong></h3><p>ä¸€å°SpanServerè´Ÿè´£ç®¡ç†100ï½1000æ•°é‡èŒƒå›´å†…çš„Tabletï¼ŒTabletç±»ä¼¼äºBigTableç³»ç»Ÿä¸­çš„å®šä¹‰ï¼Œä¸è¿‡ä¸å…¶ä¸åŒçš„ä¸€ç‚¹åœ¨äºï¼ŒSpanServerçš„Tabletä¸ºæ¯ä¸ªæ•°æ®å¢åŠ äº†æ—¶é—´æˆ³ã€‚</p>
<p>Tabletå­˜å‚¨åœ¨è¢«ç§°ä¸ºColossusçš„ç¬¬äºŒä»£GFSç³»ç»Ÿä¹‹ä¸Šã€‚ä¸ºäº†èƒ½å¤Ÿæ”¯æŒæ•°æ®è·¨æ•°æ®ä¸­å¿ƒå¤åˆ¶ï¼ŒSpanServerä¸ºæ¯ä¸ªTabletæ„é€ ä¸€ä¸ªå•è½®PaxosçŠ¶æ€æœºï¼ˆSingle Paxos State Machineï¼‰ï¼Œæ¯ä¸ªçŠ¶æ€æœºå°†å…¶å…ƒæ•°æ®å’ŒLogä¿¡æ¯è®°å…¥åˆ°å¯¹åº”çš„Tabletä¸­ã€‚PaxosçŠ¶æ€æœºç”¨äºç»´æŠ¤æ•°æ®å‰¯æœ¬ä¹‹é—´çš„ä¸€è‡´æ€§ï¼Œè‹¥å¹²ä¸ªå‰¯æœ¬Tabletç»„æˆä¸€ä¸ªPaxosç»„ï¼Œå…¶ä¸­ä¸€ä¸ªå‰¯æœ¬ä½œä¸ºé¢†å¯¼è€…ï¼Œæ‰€æœ‰å†™æ“ä½œéƒ½ç”±é¢†å¯¼è€…çš„Paxoså‘èµ·ï¼Œè€Œè¯»æ“ä½œåˆ™å¯ä»¥ä»ä»»æ„ä¸€ä¸ªå‰¯æœ¬ä¸­è¯»å‡ºè¶³å¤Ÿæ–°çš„æ•°æ®ã€‚</p>
<p>![[file-20251120152048133.jpg | 400]]</p>
<h3 id="æ•°æ®æ¨¡å‹-2"><a href="#æ•°æ®æ¨¡å‹-2" class="headerlink" title="æ•°æ®æ¨¡å‹"></a>æ•°æ®æ¨¡å‹</h3><p><strong>ç›®å½•</strong>æ˜¯Spannerè¿›è¡Œæ•°æ®å¤åˆ¶ä¸è¿ç§»çš„åŸºæœ¬å•ä½ï¼Œä¸€ä¸ªTabletå¾€å¾€ç”±å¤šä¸ªç›®å½•æ„æˆï¼Œç›®å½•å†…æ‰€æœ‰çš„è®°å½•ä¸»é”®æœ‰åºï¼Œä½†æ˜¯åŒä¸€ä¸ªTabletå†…å¤šä¸ªç›®å½•ä¹‹é—´è®°å½•å¹¶ä¸è¦æ±‚ä¸»é”®è¿ç»­ï¼Œè¿™ç‚¹æ˜¯å’ŒBigTableä¸­çš„Tabletæœ‰å·®å¼‚çš„åœ°æ–¹</p>
<p>ä¸€ä¸ªUniverseä¸­å¯ä»¥æœ‰ä¸åŒçš„æ•°æ®åº“ï¼ˆDatabaseï¼‰ï¼Œä¸€ä¸ªæ•°æ®åº“å¯ä»¥ç”±æ— é™é‡çš„å„ç§æ•°æ®è¡¨ï¼ˆTableï¼‰æ„æˆï¼Œæ•°æ®è¡¨ä¸å…³ç³»å‹æ•°æ®åº“çš„æ•°æ®æ¨¡å¼ç±»ä¼¼ï¼Œç”±æ•°æ®è¡Œã€æ•°æ®è¡Œå†…çš„æ•°æ®åˆ—ä»¥åŠæ•°æ®ç‰ˆæœ¬æ„æˆã€‚ä¹‹æ‰€ä»¥è¯´Spanneræ˜¯åŠå…³ç³»å‹æ•°æ®æ¨¡å‹è€Œéçº¯å…³ç³»å‹æ•°æ®åº“ï¼Œæ˜¯å› ä¸ºå…¶ç±»ä¼¼äºNoSQLæ•°æ®åº“ï¼Œæ¯è¡Œéƒ½éœ€è¦æœ‰ä¸ªæ˜ç¡®æŒ‡æ˜çš„åå­—ï¼ˆNameï¼‰ï¼Œè¿™ä¸ªåå­—å¾€å¾€æ˜¯ç”±é¡ºåºçš„ä¸€ä¸ªæˆ–å¤šä¸ªä¸»é”®æ•°æ®åˆ—å…±åŒæ„æˆçš„ã€‚</p>
<p>![[file-20251120152306500.jpg | 400]]</p>
<h3 id="TrueTime"><a href="#TrueTime" class="headerlink" title="TrueTime"></a>TrueTime</h3><p>TrueTimeçš„APIå¦‚å›¾æ‰€ç¤ºï¼Œå…¶ä¸­æœ€æ ¸å¿ƒçš„æ˜¯<strong>TT.now()<strong>ï¼Œå…¶å¹¶éè¿”å›å…·ä½“çš„æ—¶é—´ç‚¹ï¼Œè€Œæ˜¯</strong>è¿”å›ä¸€ä¸ªæ—¶é—´åŒºé—´</strong>TTintervalï¼ŒTrueTimeä¿è¯è°ƒç”¨TT.now()çš„è§¦å‘äº‹ä»¶çœŸå®å‘ç”Ÿçš„æ—¶é—´ä¸€å®šè½åœ¨è¿™ä¸ªæ—¶é—´åŒºé—´ä¹‹å†…ï¼Œè¿™ç§æ—¶é—´åŒºé—´ä»£è¡¨äº†æ—¶é—´è¡¨è¿°çš„æœ‰ç•Œçš„ä¸ç¡®å®šæ€§ã€‚å¦‚æœç”¨tÂ absÂ (e)è¡¨ç¤ºäº‹ä»¶eçš„ç»å¯¹æ—¶é—´ï¼Œé‚£ä¹ˆTrueTimeå¯ä»¥ä¿è¯åœ¨äº‹ä»¶eå‘ç”Ÿæ—¶åˆ»è°ƒç”¨TT.now()ã€‚å¦å¤–ä¸¤ä¸ªAPIåˆ™æ˜¯åœ¨TT.now()åŸºç¡€ä¸Šå°è£…è€Œæˆçš„ï¼Œä»£è¡¨äº†ç¡®å®šçš„æ—¶é—´å…ˆåå…³ç³»ã€‚</p>
<p>![[file-20251120152643397.jpg | 500]]</p>
<p>TrueTimeå…·ä½“å®ç°æ—¶ç»¼åˆäº†GPSå’ŒåŸå­æ—¶é’Ÿæ¥å…±åŒå†³å®šå‡†ç¡®çš„æ—¶é—´ï¼Œæ¯ä¸ªæ•°æ®ä¸­å¿ƒéƒ¨ç½²ä¸€äº›æ—¶é—´æœåŠ¡å™¨ï¼ˆTime Masterï¼‰ï¼Œå…¶ä¸­ä¸€äº›æœºå™¨é€šè¿‡GPSç¡®å®šæ—¶é—´ï¼Œå¦å¤–ä¸€äº›é€šè¿‡åŸå­æ—¶é’Ÿç¡®å®šæ—¶é—´ï¼Œå…¶ä»–æ‰€æœ‰æœºå™¨éƒ½å®‰è£…ä¸€ä¸ªæ—¶é—´ç›‘æ§è¿›ç¨‹ã€‚æ—¶é—´æœåŠ¡å™¨ä¹‹é—´é€šè¿‡å®šæ—¶äº’è¯¢æ¥ä¿®æ­£å„è‡ªçš„å‡†ç¡®æ—¶é—´ï¼Œä»¥é¿å…å•å°æ—¶é—´æœåŠ¡å™¨çš„æ—¶é—´å’ŒçœŸå®æ—¶é—´åç¦»å¤ªè¿œï¼Œæ—¶é—´ç›‘æ§è¿›ç¨‹å®šæœŸä»å¤šä¸ªæ•°æ®ä¸­å¿ƒçš„å¤šå°æ—¶é—´æœåŠ¡å™¨æ‹‰å–å®ƒä»¬å„è‡ªçš„æ—¶é—´æ ‡å‡†ï¼Œé€šè¿‡ä¸€å®šç®—æ³•ä¿è¯æ¯ä¸ªæœåŠ¡å™¨è‡ªå·±çš„æ—¶é—´è½åœ¨çœŸå®æ—¶é—´çš„ä¸€å®šç²¾åº¦èŒƒå›´å†…ã€‚</p>
<p>TrueTimeæä¾›äº†å…¨å±€å¯æ¯”æ—¶é—´æœåŠ¡ï¼Œå†ç»“åˆPaxosç®—æ³•ï¼ŒSpannerå¯ä»¥æä¾›è¯»ï¼å†™äº‹åŠ¡ã€åªè¯»äº‹åŠ¡ä»¥åŠå¿«ç…§è¯»äº‹åŠ¡ç­‰å„ç§åˆ†å¸ƒå¼äº‹åŠ¡æ”¯æŒï¼Œå¹¶æä¾›å¤–éƒ¨ä¸€è‡´æ€§è¯»ï¼å†™èƒ½åŠ›ï¼Œè¿™ä¸ºä¸Šå±‚åº”ç”¨å¼€å‘å¸¦æ¥äº†å¾ˆå¤§çš„çµæ´»æ€§å’Œä¾¿åˆ©æ€§ã€‚</p>
<h1 id="ç¬¬11ç« -å¤§è§„æ¨¡æ‰¹å¤„ç†ç³»ç»Ÿ"><a href="#ç¬¬11ç« -å¤§è§„æ¨¡æ‰¹å¤„ç†ç³»ç»Ÿ" class="headerlink" title="ç¬¬11ç«  å¤§è§„æ¨¡æ‰¹å¤„ç†ç³»ç»Ÿ"></a>ç¬¬11ç«  å¤§è§„æ¨¡æ‰¹å¤„ç†ç³»ç»Ÿ</h1><h2 id="MapReduceè®¡ç®—æ¨¡å‹ä¸æ¶æ„"><a href="#MapReduceè®¡ç®—æ¨¡å‹ä¸æ¶æ„" class="headerlink" title="MapReduceè®¡ç®—æ¨¡å‹ä¸æ¶æ„"></a>MapReduceè®¡ç®—æ¨¡å‹ä¸æ¶æ„</h2><p>MapReduceåˆ†å¸ƒå¼è®¡ç®—æ¡†æ¶æœ€åˆæ˜¯ç”±Googleå…¬å¸äº2004å¹´æå‡ºçš„ï¼Œè¿™ä¸ä»…ä»…æ˜¯ä¸€ç§åˆ†å¸ƒå¼è®¡ç®—æ¨¡å‹ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€æ•´å¥—æ„å»ºåœ¨å¤§è§„æ¨¡æ™®é€šå•†ä¸šPCï¼ˆæˆåƒå°æœºå™¨ï¼‰ä¹‹ä¸Šçš„æ‰¹å¤„ç†è®¡ç®—æ¡†æ¶ã€‚</p>
<h3 id="è®¡ç®—æ¨¡å—"><a href="#è®¡ç®—æ¨¡å—" class="headerlink" title="è®¡ç®—æ¨¡å—"></a>è®¡ç®—æ¨¡å—</h3><p>å¯¹äºæŸä¸ªè®¡ç®—ä»»åŠ¡æ¥è¯´ï¼Œå…¶è¾“å…¥æ˜¯Key&#x2F;Valueæ•°æ®å¯¹ï¼Œè¾“å‡ºä¹Ÿä»¥Key&#x2F;Valueæ•°æ®å¯¹æ–¹å¼è¡¨ç¤ºï¼š</p>
<ul>
<li>Mapå‡½æ•°ä»¥Key&#x2F;Valueæ•°æ®å¯¹ä½œä¸ºè¾“å…¥ï¼Œå°†è¾“å…¥æ•°æ®ç»è¿‡ä¸šåŠ¡é€»è¾‘è®¡ç®—äº§ç”Ÿè‹¥å¹²ä»æ—§ä»¥Key&#x2F;Valueå½¢å¼è¡¨è¾¾çš„ä¸­é—´æ•°æ®ã€‚MapReduceè®¡ç®—æ¡†æ¶ä¼šè‡ªåŠ¨å°†ä¸­é—´ç»“æœä¸­å…·æœ‰ç›¸åŒKeyå€¼çš„è®°å½•èšåˆåœ¨ä¸€èµ·ï¼Œå¹¶å°†æ•°æ®ä¼ é€ç»™Reduceå‡½æ•°å†…å®šä¹‰å¥½çš„å¤„ç†é€»è¾‘ä½œä¸ºå…¶è¾“å…¥å€¼ã€‚</li>
<li>Reduceå‡½æ•°æ¥æ”¶åˆ°Mapé˜¶æ®µä¼ è¿‡æ¥çš„æŸä¸ªKeyå€¼åŠå…¶å¯¹åº”çš„è‹¥å¹²Valueå€¼ç­‰ä¸­é—´æ•°æ®ï¼Œå‡½æ•°é€»è¾‘å¯¹è¿™ä¸ªKeyå¯¹åº”çš„Valueå†…å®¹è¿›è¡Œå¤„ç†ï¼Œä¸€èˆ¬æ˜¯å¯¹å…¶è¿›è¡Œç´¯åŠ ã€è¿‡æ»¤ã€è½¬æ¢ç­‰æ“ä½œï¼Œç”ŸæˆKey&#x2F;Valueå½¢å¼çš„ç»“æœï¼Œè¿™å°±æ˜¯æœ€ç»ˆçš„ä¸šåŠ¡è®¡ç®—ç»“æœã€‚</li>
</ul>
<p>ä¸‰ä¸ªä¾‹å­ï¼š<br>å®ä¾‹ä¸€ï¼šå•è¯ç»Ÿè®¡ï¼š<br>Mapï¼šKeyå€¼æ˜¯æŸä¸ªç½‘é¡µçš„ç½‘é¡µIDï¼Œå¯¹åº”çš„valueæ˜¯ç½‘é¡µå†…å®¹ã€‚Mapæ“ä½œå¯¹äºæ¯ä¸€ä¸ªé¡µé¢å†…å®¹ä¸­ä¾æ¬¡å‡ºç°çš„å•è¯ï¼Œäº§ç”Ÿä¸­é—´æ•°æ®&lt;w,1&gt;ï¼Œä»£è¡¨äº†å•è¯wåœ¨é¡µé¢å†…å®¹æŸä¸ªä½ç½®å‡ºç°äº†ä¸€æ¬¡<br>Reduceï¼šKeyå€¼ä¸ºæŸä¸ªå•è¯ï¼Œå¯¹åº”çš„Valueä¸ºå‡ºç°æ¬¡æ•°åˆ—è¡¨ï¼Œé€šè¿‡éå†ç›¸åŒKeyçš„æ¬¡æ•°åˆ—è¡¨å¹¶ç´¯åŠ å…¶å‡ºç°æ¬¡æ•°ï¼Œå³å¯è·å¾—æŸä¸ªå•è¯åœ¨ç½‘é¡µé›†åˆä¸­æ€»å…±å‡ºç°çš„æ¬¡æ•°ã€‚</p>
<p>![[file-20251120160027802.jpg |350]]<br>å®ä¾‹äºŒï¼šé“¾æ¥åè½¬</p>
<p>![[file-20251120163822458.jpg | 350]]</p>
<p>å®ä¾‹ä¸‰ï¼šé¡µé¢ç‚¹å‡»ç»Ÿè®¡<br>![[file-20251120163929971.jpg | 350]]</p>
<h3 id="ç³»ç»Ÿæ¶æ„-1"><a href="#ç³»ç»Ÿæ¶æ„-1" class="headerlink" title="ç³»ç»Ÿæ¶æ„"></a>ç³»ç»Ÿæ¶æ„</h3><ul>
<li>Googleçš„MapReduceæ¡†æ¶<br>![[file-20251120164003448.jpg | 400]]</li>
</ul>
<p>Hadoopçš„MapReduceæ¡†æ¶ï¼š<br>![[file-20251120164243215.jpg | 400]]</p>
<ol>
<li>MapReduceæ¡†æ¶å°†åº”ç”¨çš„è¾“å…¥æ•°æ®åˆ‡åˆ†æˆMÂ ä¸ªæ•°æ®å—ï¼Œå…¸å‹çš„æ•°æ®å—å¤§å°ä¸º64MBï¼Œç„¶åå¯ä»¥å¯åŠ¨ä½äºé›†ç¾¤ä¸­ä¸åŒæœºå™¨ä¸Šçš„è‹¥å¹²ç¨‹åºã€‚</li>
<li>Masterè´Ÿè´£ä¸ºWorkeråˆ†é…å…·ä½“çš„Mapä»»åŠ¡æˆ–è€…Reduceä»»åŠ¡å¹¶åšä¸€äº›å…¨å±€ç®¡ç†åŠŸèƒ½ã€‚æ•´ä¸ªåº”ç”¨æœ‰MÂ ä¸ªMapä»»åŠ¡å’ŒRÂ ä¸ªReduceä»»åŠ¡ï¼Œå…·ä½“çš„MÂ å’ŒRÂ ä¸ªæ•°å¯ä»¥ç”±åº”ç”¨å¼€å‘è€…æŒ‡å®šã€‚</li>
<li>è¢«åˆ†é…åˆ°Mapä»»åŠ¡çš„Workerè¯»å–å¯¹åº”çš„æ•°æ®å—å†…å®¹ï¼Œä»æ•°æ®å—ä¸­è§£æå‡ºä¸€ä¸ªä¸ªKey&#x2F;Valueè®°å½•æ•°æ®å¹¶å°†å…¶ä¼ ç»™ç”¨æˆ·è‡ªå®šä¹‰çš„Mapå‡½æ•°ï¼ŒMapå‡½æ•°è¾“å‡ºçš„ä¸­é—´ç»“æœKey&#x2F;Valueæ•°æ®åœ¨å†…å­˜ä¸­è¿›è¡Œç¼“å­˜ã€‚</li>
<li>ç¼“å­˜çš„Mapå‡½æ•°äº§ç”Ÿçš„ä¸­é—´ç»“æœå‘¨æœŸæ€§åœ°è¢«å†™å…¥æœ¬åœ°ç£ç›˜ï¼Œæ¯ä¸ªMapå‡½æ•°çš„ä¸­é—´ç»“æœåœ¨å†™å…¥ç£ç›˜å‰è¢«åˆ†å‰²å‡½æ•°ï¼ˆPartitionerï¼‰åˆ‡å‰²æˆRÂ ä»½ï¼ŒRÂ æ˜¯Reduceçš„ä¸ªæ•°ã€‚è¿™é‡Œçš„åˆ†å‰²å‡½æ•°ä¸€èˆ¬æ˜¯ç”¨Keyå¯¹RÂ è¿›è¡Œå“ˆå¸Œå–æ¨¡ï¼Œè¿™æ ·å°±å°†Mapå‡½æ•°çš„ä¸­é—´æ•°æ®åˆ†å‰²æˆRÂ ä»½å¯¹åº”æ¯ä¸ªReduceå‡½æ•°æ‰€éœ€çš„æ•°æ®åˆ†ç‰‡ä¸´æ—¶æ–‡ä»¶ã€‚Mapå‡½æ•°å®Œæˆå¯¹åº”æ•°æ®å—çš„å¤„ç†åå°†å…¶RÂ ä¸ªä¸´æ—¶æ–‡ä»¶ä½ç½®é€šçŸ¥Masterï¼Œå†ç”±Masterå°†å…¶è½¬äº¤ç»™Reduceä»»åŠ¡çš„Workerã€‚</li>
<li>å½“æŸä¸ªReduceä»»åŠ¡Workeræ¥æ”¶åˆ°Masterçš„é€šçŸ¥æ—¶ï¼Œå…¶é€šè¿‡RPCè¿œç¨‹è°ƒç”¨å°†Mapä»»åŠ¡äº§ç”Ÿçš„MÂ ä»½å±äºè‡ªå·±çš„æ•°æ®æ–‡ä»¶è¿œç¨‹æ‹‰å–ï¼ˆPullï¼‰åˆ°æœ¬åœ°ã€‚Reduceä»»åŠ¡ä»Mapä»»åŠ¡è·å–ä¸­é—´æ•°æ®æ—¶é‡‡ç”¨æ‹‰å–æ–¹å¼è€Œéç”±Mapä»»åŠ¡å°†ä¸­é—´æ•°æ®æ¨é€ï¼ˆPushï¼‰ç»™Reduceä»»åŠ¡</li>
<li>Reduceä»»åŠ¡Workeréå†å·²ç»æŒ‰ç…§ä¸­é—´ç»“æœKeyæœ‰åºçš„æ•°æ®ï¼Œå°†åŒä¸€ä¸ªKeyåŠå…¶å¯¹åº”çš„å¤šä¸ªValueä¼ é€’ç»™ç”¨æˆ·å®šä¹‰çš„Reduceå‡½æ•°ï¼ŒReduceå‡½æ•°æ‰§è¡Œä¸šåŠ¡é€»è¾‘åå°†ç»“æœè¿½åŠ åˆ°è¿™ä¸ªReduceä»»åŠ¡å¯¹åº”çš„ç»“æœæ–‡ä»¶æœ«å°¾ã€‚</li>
<li>å½“æ‰€æœ‰Mapå’ŒReduceä»»åŠ¡éƒ½æˆåŠŸæ‰§è¡Œå®Œæˆæ—¶ï¼ŒMasterä¾¿å”¤é†’ç”¨æˆ·çš„åº”ç”¨ç¨‹åºï¼Œæ­¤æ—¶ï¼ŒÂ MapReduceè°ƒç”¨ç»“æŸï¼Œè¿›å…¥ç”¨æˆ·ä»£ç æ‰§è¡Œç©ºé—´ã€‚</li>
<li>â€œCombineræ“ä½œâ€ï¼Œå³æ˜¯åœ¨Mapé˜¶æ®µæ‰§è¡Œçš„å°†ä¸­é—´æ•°æ®ä¸­å…·æœ‰ç›¸åŒKeyçš„Valueå€¼åˆå¹¶çš„è¿‡ç¨‹ï¼Œå…¶ä¸šåŠ¡é€»è¾‘ä¸€èˆ¬å’ŒReduceé˜¶æ®µçš„é€»è¾‘æ˜¯ç›¸ä¼¼çš„ï¼Œå’ŒReduceçš„åŒºåˆ«æ— éæ˜¯å…¶åœ¨Mapä»»åŠ¡æœ¬åœ°äº§ç”Ÿçš„å±€éƒ¨æ•°æ®ä¸Šæ“ä½œï¼Œè€ŒéåƒReduceä»»åŠ¡ä¸€æ ·æ˜¯åœ¨å…¨å±€æ•°æ®ä¸Šæ“ä½œè€Œå·²ã€‚</li>
</ol>
<h3 id="MapReduceè®¡ç®—çš„ç‰¹ç‚¹åŠä¸è¶³"><a href="#MapReduceè®¡ç®—çš„ç‰¹ç‚¹åŠä¸è¶³" class="headerlink" title="MapReduceè®¡ç®—çš„ç‰¹ç‚¹åŠä¸è¶³"></a>MapReduceè®¡ç®—çš„ç‰¹ç‚¹åŠä¸è¶³</h3><ul>
<li>ä¼˜ç‚¹ï¼šæ‰©å±•ã€å®¹é”™ã€ç®€å•</li>
<li>ç¼ºç‚¹ï¼šæ— é«˜å±‚æŠ½è±¡æ•°æ®æ“ä½œè¯­è¨€ã€æ•°æ®æ— SchemaåŠç´¢å¼•ã€å•èŠ‚ç‚¹æ•ˆç‡ä½ä¸‹ã€ä»»åŠ¡æµæè¿°æ–¹æ³•å•ä¸€ç­‰ã€‚<br>å¹¶ä¸é€‚åˆå¯¹æ—¶æ•ˆæ€§è¦æ±‚è¾ƒé«˜çš„åº”ç”¨åœºæ™¯ï¼š</li>
<li>å…¶Mapå’ŒReduceä»»åŠ¡å¯åŠ¨æ—¶é—´è¾ƒé•¿ã€‚</li>
<li>åœ¨ä¸€æ¬¡åº”ç”¨ä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼ŒMapReduceè®¡ç®—æ¨¡å‹å­˜åœ¨å¤šå¤„çš„ç£ç›˜è¯»ï¼å†™åŠç½‘ç»œä¼ è¾“è¿‡ç¨‹ã€‚</li>
</ul>
<h2 id="MapReduceè®¡ç®—æ¨¡å¼"><a href="#MapReduceè®¡ç®—æ¨¡å¼" class="headerlink" title="MapReduceè®¡ç®—æ¨¡å¼"></a>MapReduceè®¡ç®—æ¨¡å¼</h2><ul>
<li>æ±‚å’Œæ¨¡å¼ï¼š<ul>
<li>æ•°å€¼æ±‚å’Œï¼šç»Ÿè®¡è®¡ç®—åŒ…æ‹¬ç®€å•è®¡æ•°ã€æ±‚æœ€å°å€¼ï¼æœ€å¤§å€¼ã€æ±‚å¹³å‡å€¼ï¼ä¸­ä½æ•°ç­‰å„ç§æƒ…å†µã€‚</li>
<li>è®°å½•æ±‚å’Œï¼šéœ€è¦å°†éæ•°å€¼å†…å®¹è¿›è¡Œç´¯åŠ å½¢æˆé˜Ÿåˆ—ï¼Œä¸€èˆ¬åº”ç”¨ä¸­ç´¯åŠ å†…å®¹æ˜¯å¯¹è±¡çš„ID</li>
</ul>
</li>
<li>æ±‚å’Œæ¨¡å¼ï¼š<ul>
<li>ç®€å•è¿‡æ»¤ï¼šæ ¹æ®ä¸€å®šæ¡ä»¶ä»æµ·é‡æ•°æ®ä¸­ç­›é€‰å‡ºæ»¡è¶³æ¡ä»¶çš„è®°å½•ï¼Œæ¯”å¦‚å¯¹æ•°æ®è¿›è¡Œæ¸…ç†å°†æ— å…³æ•°æ®æ¸…é™¤ã€ä»å¤§é‡æ•°æ®ä¸­è¿½è¸ªæ„Ÿå…´è¶£çš„è®°å½•ã€åˆ†å¸ƒå¼Grepæ“ä½œã€è®°å½•éšæœºæŠ½æ ·ç­‰ã€‚</li>
<li>Top 10ï¼šä»å¤§é‡æ•°æ®ä¸­ï¼Œæ ¹æ®è®°å½•æŸä¸ªå­—æ®µå†…å®¹çš„å¤§å°å–å‡ºå…¶å€¼æœ€å¤§çš„kÂ ä¸ªè®°å½•</li>
</ul>
</li>
<li>ç»„ç»‡æ•°æ®æ¨¡å¼ï¼š<ul>
<li>æ•°æ®åˆ†ç‰‡ï¼šå°†æ‰€æœ‰è®°å½•æŒ‰ç…§æ—¥æœŸè¿›è¡Œåˆ†ç±»ï¼Œå°†åŒä¸€å¤©çš„æ•°æ®æ”¾åˆ°ä¸€èµ·ä»¥è¿›ä¸€æ­¥åšåç»­æ•°æ®åˆ†æ</li>
<li>å…¨å±€æ’åºï¼šå¯¹äºæµ·é‡æ•°æ®å…¨å±€æ’åºåº”ç”¨åœºæ™¯æ¥è¯´ï¼Œå¯ä»¥å……åˆ†åˆ©ç”¨MapReduceæœ¬èº«è‡ªå¸¦çš„æ’åºç‰¹æ€§æ¥å®ç°</li>
</ul>
</li>
<li>Joinæ¨¡å¼ï¼š<ul>
<li>Reduce-Side Joinï¼šè§£å†³æ•°æ®é›†åˆJoinæ“ä½œçš„ä¸€ç§æ¯”è¾ƒé€šç”¨çš„æ–¹æ³•ï¼Œå¾ˆå¤šå…¶ä»–ç±»å‹çš„Joinæ“ä½œä¹Ÿå¯ä»¥é€šè¿‡Reduce-Side Joinæ¥å®Œæˆ</li>
<li>Map-Side Joinï¼šå¤„ç†æ•ˆç‡è¦é«˜å¾ˆå¤šï¼Œå› ä¸ºå…¶é¿å…äº†Shuffleç½‘ç»œä¼ è¾“è¿‡ç¨‹ä»¥åŠReduceä¸­çš„æ’åºè¿‡ç¨‹</li>
</ul>
</li>
</ul>
<h2 id="DAGè®¡ç®—æ¨¡å‹"><a href="#DAGè®¡ç®—æ¨¡å‹" class="headerlink" title="DAGè®¡ç®—æ¨¡å‹"></a>DAGè®¡ç®—æ¨¡å‹</h2><p>åœ¨å¤§æ•°æ®å¤„ç†é¢†åŸŸï¼ŒDAGè®¡ç®—æ¨¡å‹å¾€å¾€æ˜¯æŒ‡å°†è®¡ç®—ä»»åŠ¡åœ¨å†…éƒ¨åˆ†è§£æˆä¸ºè‹¥å¹²ä¸ªå­ä»»åŠ¡ï¼Œè¿™äº›å­ä»»åŠ¡ä¹‹é—´ç”±é€»è¾‘å…³ç³»æˆ–è¿è¡Œå…ˆåé¡ºåºç­‰å› ç´ è¢«æ„å»ºæˆæœ‰å‘æ— ç¯å›¾ç»“æ„ã€‚</p>
<h3 id="DAGè®¡ç®—ç³»ç»Ÿçš„ä¸‰å±‚ç»“æ„"><a href="#DAGè®¡ç®—ç³»ç»Ÿçš„ä¸‰å±‚ç»“æ„" class="headerlink" title="DAGè®¡ç®—ç³»ç»Ÿçš„ä¸‰å±‚ç»“æ„"></a>DAGè®¡ç®—ç³»ç»Ÿçš„ä¸‰å±‚ç»“æ„</h3><p>ç”±ä¸Šåˆ°ä¸‹ä¸‰å±‚ç»“æ„ï¼š</p>
<ul>
<li>æœ€ä¸Šå±‚æ˜¯åº”ç”¨è¡¨è¾¾å±‚ï¼Œå³é€šè¿‡ä¸€å®šæ‰‹æ®µå°†è®¡ç®—ä»»åŠ¡åˆ†è§£æˆç”±è‹¥å¹²å­ä»»åŠ¡å½¢æˆçš„DAGç»“æ„ï¼Œè¿™å±‚çš„æ ¸å¿ƒæ˜¯è¡¨è¾¾çš„ä¾¿æ·æ€§ï¼Œä¸»è¦ç›®çš„æ˜¯æ–¹ä¾¿åº”ç”¨å¼€å‘è€…å¿«é€Ÿæè¿°æˆ–è€…æ„å»ºåº”ç”¨</li>
<li>æœ€ä¸‹å±‚æ˜¯ç‰©ç†æœºé›†ç¾¤ï¼Œå³ç”±å¤§é‡ç‰©ç†æœºå™¨æ­å»ºçš„åˆ†å¸ƒå¼è®¡ç®—ç¯å¢ƒï¼Œè¿™æ˜¯è®¡ç®—ä»»åŠ¡æœ€ç»ˆæ‰§è¡Œçš„åœºæ‰€ã€‚</li>
<li>ä¸­é—´å±‚æ˜¯DAGæ‰§è¡Œå¼•æ“å±‚ï¼Œå…¶ä¸»è¦ç›®çš„æ˜¯å°†ä¸Šå±‚ä»¥ç‰¹æ®Šæ–¹å¼è¡¨è¾¾çš„DAGè®¡ç®—ä»»åŠ¡é€šè¿‡è½¬æ¢å’Œæ˜ å°„ï¼Œå°†å…¶éƒ¨ç½²åˆ°ä¸‹å±‚çš„ç‰©ç†æœºé›†ç¾¤ä¸­æ¥çœŸæ­£è¿è¡Œã€‚</li>
</ul>
<h3 id="Dryad"><a href="#Dryad" class="headerlink" title="Dryad"></a>Dryad</h3><p>Dryadæ˜¯å¾®è½¯çš„æ‰¹å¤„ç†DAGè®¡ç®—ç³»ç»Ÿï¼Œå…¶ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†ä¾¿äºå¼€å‘è€…ä¾¿æ·åœ°è¿›è¡Œåˆ†å¸ƒå¼ä»»åŠ¡å¤„ç†ï¼Œå…¶æ˜¯åœ¨å¤§æ•°æ®å¤„ç†é¢†åŸŸè¾ƒæ—©æ˜ç¡®æå‡ºDAGè®¡ç®—æ¨¡å‹çš„ç³»ç»Ÿã€‚</p>
<p>æ•´ä½“æ¶æ„ï¼š</p>
<ul>
<li>ç³»ç»Ÿä¸­çš„â€œä»»åŠ¡ç®¡ç†å™¨â€ï¼ˆJob Managerï¼ŒJMï¼‰è´Ÿè´£å°†é€»è¾‘å½¢å¼å­˜åœ¨çš„DAGæè¿°æ˜ å°„åˆ°ç‰©ç†é›†ç¾¤æœºå™¨ä¸­ï¼Œèµ·åˆ°ä»»åŠ¡è°ƒåº¦å™¨ä»¥åŠå…¨å±€ç®¡ç†è€…çš„ä½œç”¨ã€‚</li>
<li>å‘½åæœåŠ¡å™¨ï¼ˆName Serverï¼ŒNSï¼‰è´Ÿè´£ç»´æŠ¤é›†ç¾¤ä¸­å½“å‰å¯ç”¨çš„æœºå™¨èµ„æºï¼Œä»å‘½åæœåŠ¡å™¨è¿˜å¯ä»¥æŸ¥åˆ°æœºå™¨åœ¨ç‰©ç†æ‹“æ‰‘ç»“æ„ä¸­çš„ä½ç½®ï¼Œè¿™æ ·ä¾¿äºJMåœ¨ä»»åŠ¡è°ƒåº¦æ—¶è€ƒè™‘åˆ°æ•°æ®å±€éƒ¨æ€§ï¼Œå°½å¯èƒ½åœ°å°†è®¡ç®—æ¨é€åˆ°æ•°æ®èŠ‚ç‚¹ä¸Š</li>
<li>é›†ç¾¤ä¸­æ¯å°å·¥ä½œæœºä¸Šå®‰è£…Daemonå®ˆæŠ¤è¿›ç¨‹ï¼ˆå›¾ä¸­æ ‡ä¸ºDçš„å³æ˜¯ï¼‰ï¼Œå…¶ä½œä¸ºJMåœ¨è®¡ç®—èŠ‚ç‚¹ä¸Šçš„ä»£ç†ï¼Œè´Ÿè´£å…·ä½“å­ä»»åŠ¡çš„æ‰§è¡Œå’Œç›‘æ§ã€‚Daemonè¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å’ŒJMé€šä¿¡ï¼Œæ¥æ±‡æŠ¥æ‰§è¡Œè¿›åº¦ä»¥åŠæ•°æ®å¤„ç†å®Œæˆæƒ…å†µ<br>![[file-20251120183411927.jpg | 400]]<br>Dryadé‡‡ç”¨äº†ç”±è‹¥å¹²ç®€å•çš„DAGç»“æ„åŠå…¶æè¿°ç¬¦çš„ä¸æ–­ç»„åˆæ¥æ„å»ºå¤æ‚ç»“æ„çš„æ–¹å¼ã€‚</li>
</ul>
<p>![[file-20251120183514392.jpg | 500]]</p>
<ul>
<li>Aâ‰¥Bï¼šå›¾Açš„è¾“å‡ºèŠ‚ç‚¹å’Œå›¾Bçš„è¾“å…¥èŠ‚ç‚¹é—´è¿›è¡Œç‚¹å¯¹ç‚¹çš„è¾¹è¿æ¥</li>
<li>A&gt;&gt;Bï¼šåœ¨Açš„è¾“å‡ºèŠ‚ç‚¹å’ŒBçš„è¾“å…¥èŠ‚ç‚¹ä¹‹é—´å½¢æˆå®Œå…¨äºŒåˆ†å›¾</li>
</ul>
<p>Dryadçš„ä»»åŠ¡æ‰§è¡Œï¼š<br>Dryadçš„JMå°†å›¾èŠ‚ç‚¹çš„å¯æ‰§è¡Œä»£ç åˆ†å‘åˆ°å¯ç”¨æœºå™¨èŠ‚ç‚¹ä¸Šï¼ŒåŒæ—¶å°†è¯¥å›¾èŠ‚ç‚¹æ¶‰åŠçš„è¾“å…¥å’Œè¾“å‡ºæ•°æ®è·¯å¾„åœ°å€å‘é€ç»™ç›¸åº”çš„å·¥ä½œæœºï¼Œè¿™æ ·è¯¥å·¥ä½œæœºå°±å¯æ‰§è¡Œè®¡ç®—ä»»åŠ¡ã€‚è°ƒåº¦ç¨‹åºè·Ÿè¸ªDAGå›¾ä¸­èŠ‚ç‚¹çš„æ‰§è¡ŒçŠ¶æ€å’Œæ‰§è¡Œå†å²ï¼Œå¦‚æœJMè°ƒåº¦ç¨‹åºå´©æºƒï¼Œåˆ™æ•´ä¸ªä»»åŠ¡å¤±è´¥ã€‚å¦‚æœå·¥ä½œèŠ‚ç‚¹å‘ç”Ÿæ•…éšœï¼Œè°ƒåº¦ç¨‹åºä¼šå°†å›¾èŠ‚ç‚¹å¯¹åº”ä»£ç å‘é€åˆ°å…¶ä»–å¯ç”¨èŠ‚ç‚¹é‡æ–°æ‰§è¡Œå›¾èŠ‚ç‚¹ç¨‹åºï¼Œä»¥æ­¤æ¥è¾¾åˆ°å®¹é”™ç›®çš„ã€‚</p>
<p>Googleçš„FlumeJavaå’ŒApache Tezä¹Ÿæ˜¯æ¯”è¾ƒè‘—åçš„æ‰¹å¤„ç†DAGç³»ç»Ÿã€‚</p>
<h1 id="ç¬¬12ç« -æµå¼è®¡ç®—"><a href="#ç¬¬12ç« -æµå¼è®¡ç®—" class="headerlink" title="ç¬¬12ç«  æµå¼è®¡ç®—"></a>ç¬¬12ç«  æµå¼è®¡ç®—</h1><p>æ—©æœŸå’Œå½“å‰çš„â€œæµå¼è®¡ç®—â€ç³»ç»Ÿåˆ†åˆ«ç§°ä¸ºâ€œè¿ç»­æŸ¥è¯¢å¤„ç†ç±»â€å’Œâ€œå¯æ‰©å±•æ•°æ®æµå¹³å°ç±»â€è®¡ç®—ç³»ç»Ÿã€‚</p>
<ul>
<li><strong>è¿ç»­æŸ¥è¯¢å¤„ç†</strong>ï¼šä¸€èˆ¬ç”¨æˆ·è¾“å…¥SQLæŸ¥è¯¢è¯­å¥åï¼Œæ•°æ®æµæŒ‰ç…§æ—¶é—´å…ˆåé¡ºåºè¢«åˆ‡å‰²æˆæ•°æ®çª—å£ï¼ŒDSMSåœ¨è¿ç»­æµåŠ¨çš„æ•°æ®çª—å£ä¸­æ‰§è¡Œç”¨æˆ·æäº¤çš„SQLè¯­å¥ï¼Œå¹¶å®æ—¶è¿”å›æŸ¥è¯¢ç»“æœã€‚</li>
<li><strong>å¯æ‰©å±•æ•°æ®æµå¹³å°ç±»</strong>ï¼šå‡ºäºæ¨¡ä»¿MapReduceè®¡ç®—æ¡†æ¶çš„æ€è·¯ï¼Œå³åœ¨å¯¹å¤„ç†æ—¶æ•ˆæ€§æœ‰é«˜è¦æ±‚çš„è®¡ç®—åœºæ™¯ä¸‹ï¼Œå¦‚ä½•æä¾›ä¸€ä¸ªå®Œå–„çš„è®¡ç®—æ¡†æ¶ï¼Œå¹¶æš´éœ²ç»™ç”¨æˆ·å°‘é‡çš„ç¼–ç¨‹æ¥å£ï¼ˆå¯¹MRæ¥è¯´å°±æ˜¯Mapå’ŒReduceå¤„ç†é€»è¾‘æ¥å£ï¼‰ï¼Œä½¿å¾—ç”¨æˆ·èƒ½å¤Ÿé›†ä¸­ç²¾åŠ›å¤„ç†åº”ç”¨é€»è¾‘ã€‚</li>
</ul>
<p>ä¼˜ç§€çš„æµå¼è®¡ç®—ç³»ç»Ÿåº”è¯¥å…·å¤‡ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ul>
<li>è®°å½•å¤„ç†ä½å»¶è¿Ÿ</li>
<li>æä½³çš„ç³»ç»Ÿå®¹é”™æ€§</li>
<li>æå¼ºçš„ç³»ç»Ÿæ‰©å±•èƒ½åŠ›</li>
<li>çµæ´»å¼ºå¤§çš„åº”ç”¨é€»è¾‘è¡¨è¾¾èƒ½åŠ›</li>
</ul>
<h2 id="æµå¼è®¡ç®—ç³»ç»Ÿæ¶æ„"><a href="#æµå¼è®¡ç®—ç³»ç»Ÿæ¶æ„" class="headerlink" title="æµå¼è®¡ç®—ç³»ç»Ÿæ¶æ„"></a>æµå¼è®¡ç®—ç³»ç»Ÿæ¶æ„</h2><p>å¸¸è§çš„æµå¼è®¡ç®—ç³»ç»Ÿæ¶æ„åˆ†ä¸ºä¸¤ç§ï¼šä¸»ä»æ¨¡å¼ï¼ˆMaster-Slaveï¼‰å’ŒP2Pæ¨¡å¼</p>
<h3 id="ä¸»ä»æ¶æ„"><a href="#ä¸»ä»æ¶æ„" class="headerlink" title="ä¸»ä»æ¶æ„"></a>ä¸»ä»æ¶æ„</h3><p>Stormæ¶æ„ä¸­å­˜åœ¨ä¸¤ç±»èŠ‚ç‚¹ï¼šä¸»æ§èŠ‚ç‚¹å’Œå·¥ä½œèŠ‚ç‚¹</p>
<ul>
<li>åˆ†å‘è®¡ç®—ä»£ç ã€åœ¨æœºå™¨é—´åˆ†é…è®¡ç®—ä»»åŠ¡ä»¥åŠæ•…éšœæ£€æµ‹ç­‰ç®¡ç†åŠŸèƒ½ï¼Œç±»ä¼¼äºHadoop 1.0ä¸­çš„JobTrackerçš„è§’è‰²</li>
<li>æ¯å°å·¥ä½œæœåŠ¡å™¨ä¸Šè¿è¡ŒSupervisorï¼Œå…¶ç›‘å¬Nimbusåˆ†é…ç»™è‡ªå·±çš„ä»»åŠ¡ï¼Œå¹¶æ ¹æ®å…¶è¦æ±‚å¯åŠ¨æˆ–è€…åœæ­¢ç›¸å…³çš„è®¡ç®—ä»»åŠ¡ï¼Œä¸€ä¸ªSupervisorå¯ä»¥è´Ÿè´£DAGå›¾ä¸­çš„å¤šä¸ªè®¡ç®—ä»»åŠ¡ã€‚</li>
<li>ZooKeeperé›†ç¾¤ç”¨æ¥åè°ƒNimbuså’ŒSupervisorä¹‹é—´çš„å·¥ä½œï¼ŒåŒæ—¶ï¼ŒStormå°†ä¸¤è€…çš„çŠ¶æ€ä¿¡æ¯å­˜å‚¨åœ¨ZooKeeperé›†ç¾¤ä¸Šï¼Œè¿™æ ·Nimbuså’ŒSupervisoréƒ½æˆä¸ºæ— çŠ¶æ€çš„æœåŠ¡ï¼Œä»è€Œå¯ä»¥æ–¹ä¾¿åœ°è¿›è¡Œæ•…éšœæ¢å¤ï¼Œæ— è®ºå“ªä¸ªæ„ä»¶å‘ç”Ÿæ•…éšœï¼Œéƒ½å¯ä»¥éšæ—¶åœ¨å¦å¤–ä¸€å°æœºå™¨ä¸Šå¿«é€Ÿé‡æ–°å¯åŠ¨è€Œä¸ä¼šä¸¢å¤±ä»»ä½•çŠ¶æ€ä¿¡æ¯ã€‚<br>![[file-20251121171135747.jpg | 400]]</li>
</ul>
<h3 id="P2Pæ¶æ„"><a href="#P2Pæ¶æ„" class="headerlink" title="P2Pæ¶æ„"></a>P2Pæ¶æ„</h3><ul>
<li>PEï¼ˆProcessing Elementï¼‰æ˜¯åŸºæœ¬è®¡ç®—å•å…ƒï¼Œå±äºDAGä»»åŠ¡çš„è®¡ç®—èŠ‚ç‚¹ï¼Œå…¶æ¥æ”¶åˆ°æ•°æ®åè§¦å‘ç”¨æˆ·åº”ç”¨é€»è¾‘å¯¹æ•°æ®è¿›è¡Œå¤„ç†ï¼Œå¹¶å¯èƒ½äº§ç”Ÿé€å‘ä¸‹æ¸¸è®¡ç®—èŠ‚ç‚¹çš„è¡ç”Ÿæ•°æ®ã€‚</li>
<li>é€šä¿¡å±‚ä¸»è¦è´Ÿè´£é›†ç¾¤ç®¡ç†ã€è‡ªåŠ¨å®¹é”™ä»¥åŠé€»è¾‘å®¿ä¸»åˆ°ç‰©ç†èŠ‚ç‚¹çš„æ˜ å°„ç­‰åŠŸèƒ½ï¼Œå…¶å¯ä»¥è‡ªåŠ¨ä¾¦æµ‹ç¡¬ä»¶æ•…éšœï¼Œå¹¶åšæ•…éšœåˆ‡æ¢ä»¥åŠä¿®æ­£é€»è¾‘å®¿ä¸»å’Œç‰©ç†èŠ‚ç‚¹æ˜ å°„è¡¨ã€‚</li>
</ul>
<p>![[file-20251121171234264.jpg| 300]]</p>
<h2 id="DAGæ‹“æ‰‘ç»“æ„"><a href="#DAGæ‹“æ‰‘ç»“æ„" class="headerlink" title="DAGæ‹“æ‰‘ç»“æ„"></a>DAGæ‹“æ‰‘ç»“æ„</h2><p>ä¸€èˆ¬çš„æµå¼è®¡ç®—ä»»åŠ¡éƒ½æ˜¯ç”±è®¡ç®—èŠ‚ç‚¹å’Œæµå¼æ•°æ®æ„æˆçš„DAGæœ‰å‘æ— ç¯å›¾ã€‚DAGä¸­çš„èŠ‚ç‚¹ä¸€èˆ¬æ˜¯å®Œæˆä¸€ä¸ªè®¡ç®—ä»»åŠ¡æ‰€éœ€è¦çš„å„ç§å¤„ç†åŠŸèƒ½ï¼Œæ¯”å¦‚è¿‡æ»¤ã€Â æ•°å€¼ç´¯åŠ ã€Joinç­‰å…·ä½“è®¡ç®—åŠŸèƒ½ï¼Œè€Œæµç»å„ä¸ªè®¡ç®—èŠ‚ç‚¹çš„å®æ—¶æ•°æ®æµæ„æˆäº†DAGä¸­çš„å„ç§æœ‰å‘è¾¹ã€‚<br>![[file-20251121171527109.jpg | 300]]</p>
<ul>
<li><strong>è®¡ç®—èŠ‚ç‚¹</strong>ï¼š<ul>
<li>æ•´ä¸ªè®¡ç®—ä»»åŠ¡çš„æ•°æ®è¾“å…¥èŠ‚ç‚¹ï¼Œè´Ÿè´£å’Œå¤–éƒ¨å…¶ä»–ç³»ç»Ÿè¿›è¡Œäº¤äº’ï¼Œå¹¶å°†è¾“å…¥æ•°æ®æ¥å…¥æµå¼è®¡ç®—ç³»ç»Ÿï¼ŒStormä¸­å°†è¿™ç±»è®¡ç®—èŠ‚ç‚¹ç§°ä¸ºSpout</li>
<li>å®Œæˆè®¡ç®—ä»»åŠ¡çš„ä»»åŠ¡è®¡ç®—èŠ‚ç‚¹ï¼Œåœ¨Stormä¸­è¢«ç§°ä¸ºBoltï¼Œæ•´ä¸ªè®¡ç®—ä»»åŠ¡å°±æ˜¯ç”±è‹¥å¹²æ­¤ç±»èŠ‚ç‚¹é€šè¿‡æµç»è®¡ç®—èŠ‚ç‚¹çš„æµå¼æ•°æ®ä¸²æ¥èµ·æ¥å®Œæˆçš„ã€‚æ¯ä¸ªæ­¤ç±»è®¡ç®—èŠ‚ç‚¹å¾€å¾€ä»ä¸Šæ¸¸èŠ‚ç‚¹æ¥æ”¶æ•°æ®æµï¼Œå¯¹æ•°æ®æµè¿›è¡Œç‰¹å®šçš„è®¡ç®—å¤„ç†ï¼Œç„¶åäº§ç”Ÿè¡ç”Ÿæ•°æ®æµï¼Œå¹¶åˆ†å‘åˆ°å…¶ä¸‹æ¸¸çš„è®¡ç®—èŠ‚ç‚¹</li>
</ul>
</li>
<li><strong>æ•°æ®æµ</strong>ï¼šDAGæ‹“æ‰‘ç»“æ„ä¸­çš„è¾¹æ˜¯ç”±è¿ç»­ä¸æ–­è¿›å…¥æµå¼è®¡ç®—ç³»ç»Ÿçš„æ•°æ®æ„æˆçš„æ•°æ®æµï¼Œè¿™å¯¹æ‰€æœ‰çš„æµå¼è®¡ç®—ç³»ç»Ÿéƒ½æ˜¯ä¸€æ ·çš„<ul>
<li>Stormåˆ™å°†æ¯æ¡æ•°æ®ç”¨æ•°æ®å…ƒç»„ï¼ˆData Tupleï¼‰æ¥è¡¨ç¤ºï¼Œè™½ç„¶å¹¶æœªæ˜ç¡®æŒ‡æ˜æ•°æ®ä¸»é”®ï¼Œä½†æ˜¯å®é™…å¯ä»¥å°†ä¸»é”®æ”¾åœ¨å…ƒç»„ä¸­ç‰¹å®šçš„ä½ç½®æ¥å¯¹ä¸»é”®å’Œå…¶ä»–å†…å®¹è¿›è¡ŒåŒºåˆ†ï¼Œæ¥æ”¶åˆ°æ•°æ®çš„è®¡ç®—èŠ‚ç‚¹å¯ä»¥ä»å…ƒç»„å¯¹åº”çš„å†…å®¹ä¸­è¯»å‡ºæ‰€éœ€çš„æ•°æ®ã€‚</li>
</ul>
</li>
<li><strong>æ‹“æ‰‘ç»“æ„</strong>ï¼šDAGç»“æ„ä¸­æœ€å¸¸è§çš„åŸºæœ¬æ‹“æ‰‘ç»“æ„åŒ…å«ï¼šæµæ°´çº¿ã€ä¹±åºåˆ†ç»„ã€å®šå‘åˆ†ç»„å’Œå¹¿æ’­æ¨¡å¼ã€‚<ul>
<li>åœ¨ç°æœ‰çš„æµå¼è®¡ç®—ç³»ç»Ÿä¸­ï¼ŒStormæ˜¯åœ¨å›¾æ‹“æ‰‘ç»“æ„å®šä¹‰æ–¹é¢æœ€çµæ´»çš„ï¼Œé™¤äº†èƒ½å¤Ÿæä¾›ä¸Šè¿°å‡ ç§åŸºæœ¬çš„æ‹“æ‰‘è¿æ¥æ–¹å¼ï¼Œè¿˜æä¾›äº†å…¶ä»–å‡ ç§ä¸å¸¸è§çš„æ¨¡å¼ã€‚</li>
</ul>
</li>
</ul>
<h2 id="é€è¾¾ä¿è¯"><a href="#é€è¾¾ä¿è¯" class="headerlink" title="é€è¾¾ä¿è¯"></a>é€è¾¾ä¿è¯</h2><p>å¦‚ä½•ä¿è¯æµæ•°æ®æ­£ç¡®åœ°ä»ä¸Šæ¸¸èŠ‚ç‚¹é€è¾¾ä¸‹æ¸¸èŠ‚ç‚¹æ˜¯éå¸¸é‡è¦çš„é—®é¢˜ï¼Œè¿™ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ¡ˆä¸€èˆ¬è¢«ç§°ä½œæ•°æ®çš„â€œé€è¾¾ä¿è¯æœºåˆ¶â€ã€‚</p>
<p>å®šä¹‰å¦‚ä¸‹ä¸‰ç§é€è¾¾å¯èƒ½ï¼š</p>
<ul>
<li>è‡³å°‘é€è¾¾ä¸€æ¬¡ï¼ˆAt-Least Once Deliveryï¼‰ï¼šå³ä¸Šæ¸¸èŠ‚ç‚¹ä¿è¯å‘ä¸‹æ¸¸èŠ‚ç‚¹é€è¾¾ä¸€æ¬¡æˆ–è€…å¤šæ¬¡ç›¸åŒçš„æ•°æ®ã€‚</li>
<li>è‡³å¤šé€è¾¾ä¸€æ¬¡ï¼ˆAt-Most Once Deliveryï¼‰ï¼šå³ä¸Šæ¸¸èŠ‚ç‚¹ä¸èƒ½ä¿è¯å°†æ¶ˆæ¯é€è¾¾ä¸‹æ¸¸èŠ‚ç‚¹ã€‚å¦‚æœæµå¼è®¡ç®—ç³»ç»Ÿå®¹é”™æœºåˆ¶ä¸å®Œå–„ï¼Œå­˜åœ¨ä¸¢å¤±æ•°æ®çš„æƒ…å½¢ï¼Œåˆ™ä¸€èˆ¬å±äºè¿™ç§ç±»å‹çš„é€è¾¾ä¿è¯æœºåˆ¶ã€‚</li>
<li>æ°å¥½é€è¾¾ä¸€æ¬¡ï¼ˆExact-Once Deliveryï¼‰ï¼šå³ä¸Šæ¸¸èŠ‚ç‚¹ä¿è¯å°†æµæ•°æ®æ­£ç¡®åœ°é€è¾¾ä¸‹æ¸¸èŠ‚ç‚¹ä¸”åªæ­£ç¡®é€è¾¾ä¸€æ¬¡ï¼Œä¸ä¼šå‡ºç°å¤šæ¬¡é€è¾¾çš„æƒ…å†µã€‚</li>
</ul>
<p>å¦‚æœæµå¼è®¡ç®—ç³»ç»Ÿèƒ½å¤Ÿæä¾›â€œæ°å¥½é€è¾¾ä¸€æ¬¡â€è¯­ä¹‰ï¼Œä¼šä¸ºåº”ç”¨å¼€å‘è€…æä¾›å¾ˆå¤§ä¾¿åˆ©ï¼Œå› ä¸ºåº”ç”¨å¼€å‘è€…å¯ä»¥å‡è®¾æ— è®ºå‘ç”Ÿä»€ä¹ˆçŠ¶å†µï¼Œç³»ç»Ÿåœ¨æ•°æ®ä¼ é€’æ–¹é¢æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œæ— é¡»åœ¨åº”ç”¨å±‚æä¾›è¿™ç§ä¿è¯ã€‚</p>
<p>Stormçš„é€è¾¾ä¿è¯æœºåˆ¶ï¼š<br>é€šè¿‡â€œé€è¾¾ä¿è¯æœºåˆ¶â€å’Œâ€œäº‹åŠ¡æ‹“æ‰‘â€ï¼ˆTransaction Topologyï¼‰è”åˆå®Œæˆçš„ï¼š</p>
<ul>
<li>â€œé€è¾¾ä¿è¯æœºåˆ¶â€èƒ½å¤Ÿå®ç°â€œè‡³å°‘é€è¾¾ä¸€æ¬¡â€è¯­ä¹‰</li>
<li>è€Œâ€œäº‹åŠ¡æ‹“æ‰‘â€åˆ™ä¿è¯ä¸ä¼šå‡ºç°å¤šæ¬¡é€è¾¾çš„æƒ…å½¢</li>
</ul>
<h2 id="çŠ¶æ€æŒä¹…åŒ–"><a href="#çŠ¶æ€æŒä¹…åŒ–" class="headerlink" title="çŠ¶æ€æŒä¹…åŒ–"></a>çŠ¶æ€æŒä¹…åŒ–</h2><p>å’Œå…¶ä»–ç³»ç»Ÿå®¹é”™æœºåˆ¶ä¸€æ ·ï¼Œæµå¼è®¡ç®—ç³»ç»Ÿä¸­å¸¸è§çš„ç³»ç»Ÿå®¹é”™æœ‰ä¸‰ç§æ¨¡å¼ï¼šå¤‡ç”¨æœåŠ¡ã€çƒ­å¤‡å’Œæ£€æŸ¥ç‚¹æœºåˆ¶ã€‚</p>
<ul>
<li><strong>å¤‡ç”¨æœåŠ¡</strong>ï¼šè®¡ç®—ä»»åŠ¡çš„æŸä¸ªè®¡ç®—èŠ‚ç‚¹Nåœ¨å¦å¤–ä¸€å°ç‰©ç†æœºä¸Šè®¾ç½®å…¶å¯¹åº”çš„å¤‡ä»½æœåŠ¡Sï¼Œè®¡ç®—æ¡†æ¶å®šæ—¶é€šè¿‡å¿ƒè·³æˆ–è€…ZooKeeperæ¥åŠæ—¶æ•è·æœåŠ¡çŠ¶æ€ï¼Œå½“èŠ‚ç‚¹Nå‘ç”Ÿæ•…éšœæ—¶ï¼Œå¯åŠ¨å¤‡ä»½æœåŠ¡Sæ¥æ¥æ›¿è®¡ç®—èŠ‚ç‚¹Nçš„åŠŸèƒ½ã€‚é€‚åˆè®¡ç®—èŠ‚ç‚¹å±äºæ— çŠ¶æ€ï¼ˆStatelessï¼‰ç±»å‹çš„æœåŠ¡</li>
<li><strong>çƒ­å¤‡</strong>ï¼šçƒ­å¤‡æœºåˆ¶çš„è®¡ç®—èŠ‚ç‚¹Nå’Œå…¶å¤‡ç”¨èŠ‚ç‚¹SåŒæ—¶è¿è¡Œç›¸åŒçš„åŠŸèƒ½ï¼Œä¸Šæ¸¸èŠ‚ç‚¹å°†æ•°æ®æµåŒæ—¶å‘å¾€ä¸‹æ¸¸çš„è®¡ç®—èŠ‚ç‚¹NåŠå…¶å¤‡ç”¨èŠ‚ç‚¹Sï¼Œå½“è®¡ç®—èŠ‚ç‚¹Nå‘ç”Ÿæ•…éšœæ—¶å¯¹ç³»ç»Ÿæ— ä»»ä½•å½±å“ï¼Œå› ä¸ºå¤‡ç”¨èŠ‚ç‚¹Sä¸€ç›´å’ŒèŠ‚ç‚¹NåŒæ—¶è¿è¡Œï¼Œæ‰€ä»¥å³ä½¿æ˜¯æœ‰çŠ¶æ€çš„æœåŠ¡ï¼Œä¸¤è€…ä¹Ÿæ—¶åˆ»ä¿æŒç€ç›¸åŒçš„çŠ¶æ€ä¿¡æ¯ã€‚</li>
<li><strong>æ£€æŸ¥ç‚¹</strong>ï¼šä¸ºäº†èƒ½å¤Ÿåœ¨æ•…éšœæ›¿æ¢æ—¶æ¢å¤è®¡ç®—èŠ‚ç‚¹Nçš„çŠ¶æ€ä¿¡æ¯ï¼Œè®¡ç®—èŠ‚ç‚¹Nå‘¨æœŸæ€§åœ°å°†å…¶çŠ¶æ€ä¿¡æ¯é€šè¿‡æ£€æŸ¥ç‚¹çš„æ–¹å¼åœ¨å…¶ä»–åœ°æ–¹è¿›è¡Œå¤‡ä»½ï¼Œå½“è®¡ç®—æ¡†æ¶ä¾¦æµ‹åˆ°è®¡ç®—èŠ‚ç‚¹Nå‘ç”Ÿæ•…éšœæ—¶ï¼Œåˆ™å¯åŠ¨å¤‡ç”¨èŠ‚ç‚¹Sï¼Œå¹¶ä»Logä¸­å°†å¯¹åº”çš„çŠ¶æ€ä¿¡æ¯è¿›è¡Œæ¢å¤</li>
</ul>
<p>ç›®å‰ä¸»æµçš„æµå¼è®¡ç®—ç³»ç»Ÿéƒ½é‡‡ç”¨æ£€æŸ¥ç‚¹çš„å®¹é”™æœºåˆ¶ï¼Œæ¯”å¦‚Stormã€MillWheelå’ŒSamzaéƒ½é‡‡ç”¨äº†è¿™ä¸€æœºåˆ¶ã€‚ä¸ºäº†ä¿è¯ä¸ä¼šä¸¢å¤±ä»»ä½•çŠ¶æ€ä¿¡æ¯ï¼Œå¯¹äºæµç»çš„æ¯æ¡æ•°æ®ï¼Œåªè¦è®¡ç®—èŠ‚ç‚¹å¤„ç†ä¹‹åçŠ¶æ€ä¿¡æ¯å‘ç”Ÿå˜åŒ–éƒ½éœ€è¦è¿›è¡ŒçŠ¶æ€ä¿¡æ¯å¤‡ä»½ã€‚</p>
<h1 id="ç¬¬13ç« -äº¤äº’å¼æ•°æ®åˆ†æ"><a href="#ç¬¬13ç« -äº¤äº’å¼æ•°æ®åˆ†æ" class="headerlink" title="ç¬¬13ç«  äº¤äº’å¼æ•°æ®åˆ†æ"></a>ç¬¬13ç«  äº¤äº’å¼æ•°æ®åˆ†æ</h1>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/6/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/8/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Uncle Antonio"
      src="/images/icon.JPG">
  <p class="site-author-name" itemprop="name">Uncle Antonio</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">72</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/UncleAntonio67" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;UncleAntonio67" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/antoniolq@163.com" title="E-Mail â†’ antoniolq@163.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="http://yoursite.com/" title="http:&#x2F;&#x2F;yoursite.com" rel="noopener" target="_blank">Title</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Uncle Antonio</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="/lib/three/three.min.js"></script>


  















  

  

</body>
</html>
